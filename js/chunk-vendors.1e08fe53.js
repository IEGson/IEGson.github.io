(self["webpackChunkvuethree"]=self["webpackChunkvuethree"]||[]).push([[998],{9662:function(t,e,n){var r=n(614),i=n(6330),s=TypeError;t.exports=function(t){if(r(t))return t;throw s(i(t)+" is not a function")}},6077:function(t,e,n){var r=n(614),i=String,s=TypeError;t.exports=function(t){if("object"==typeof t||r(t))return t;throw s("Can't set "+i(t)+" as a prototype")}},1223:function(t,e,n){var r=n(5112),i=n(30),s=n(3070).f,o=r("unscopables"),a=Array.prototype;void 0==a[o]&&s(a,o,{configurable:!0,value:i(null)}),t.exports=function(t){a[o][t]=!0}},5787:function(t,e,n){var r=n(7976),i=TypeError;t.exports=function(t,e){if(r(e,t))return t;throw i("Incorrect invocation")}},9670:function(t,e,n){var r=n(111),i=String,s=TypeError;t.exports=function(t){if(r(t))return t;throw s(i(t)+" is not an object")}},3013:function(t){t.exports="undefined"!=typeof ArrayBuffer&&"undefined"!=typeof DataView},260:function(t,e,n){"use strict";var r,i,s,o=n(3013),a=n(9781),l=n(7854),c=n(614),u=n(111),h=n(2597),d=n(648),f=n(6330),p=n(8880),m=n(8052),g=n(3070).f,v=n(7976),y=n(9518),x=n(7674),b=n(5112),w=n(9711),_=n(9909),M=_.enforce,A=_.get,S=l.Int8Array,E=S&&S.prototype,T=l.Uint8ClampedArray,C=T&&T.prototype,R=S&&y(S),I=E&&y(E),P=Object.prototype,L=l.TypeError,N=b("toStringTag"),k=w("TYPED_ARRAY_TAG"),O="TypedArrayConstructor",D=o&&!!x&&"Opera"!==d(l.opera),z=!1,F={Int8Array:1,Uint8Array:1,Uint8ClampedArray:1,Int16Array:2,Uint16Array:2,Int32Array:4,Uint32Array:4,Float32Array:4,Float64Array:8},U={BigInt64Array:8,BigUint64Array:8},B=function(t){if(!u(t))return!1;var e=d(t);return"DataView"===e||h(F,e)||h(U,e)},G=function(t){var e=y(t);if(u(e)){var n=A(e);return n&&h(n,O)?n[O]:G(e)}},H=function(t){if(!u(t))return!1;var e=d(t);return h(F,e)||h(U,e)},V=function(t){if(H(t))return t;throw L("Target is not a typed array")},j=function(t){if(c(t)&&(!x||v(R,t)))return t;throw L(f(t)+" is not a typed array constructor")},W=function(t,e,n,r){if(a){if(n)for(var i in F){var s=l[i];if(s&&h(s.prototype,t))try{delete s.prototype[t]}catch(o){try{s.prototype[t]=e}catch(c){}}}I[t]&&!n||m(I,t,n?e:D&&E[t]||e,r)}},q=function(t,e,n){var r,i;if(a){if(x){if(n)for(r in F)if(i=l[r],i&&h(i,t))try{delete i[t]}catch(s){}if(R[t]&&!n)return;try{return m(R,t,n?e:D&&R[t]||e)}catch(s){}}for(r in F)i=l[r],!i||i[t]&&!n||m(i,t,e)}};for(r in F)i=l[r],s=i&&i.prototype,s?M(s)[O]=i:D=!1;for(r in U)i=l[r],s=i&&i.prototype,s&&(M(s)[O]=i);if((!D||!c(R)||R===Function.prototype)&&(R=function(){throw L("Incorrect invocation")},D))for(r in F)l[r]&&x(l[r],R);if((!D||!I||I===P)&&(I=R.prototype,D))for(r in F)l[r]&&x(l[r].prototype,I);if(D&&y(C)!==I&&x(C,I),a&&!h(I,N))for(r in z=!0,g(I,N,{get:function(){return u(this)?this[k]:void 0}}),F)l[r]&&p(l[r],k,r);t.exports={NATIVE_ARRAY_BUFFER_VIEWS:D,TYPED_ARRAY_TAG:z&&k,aTypedArray:V,aTypedArrayConstructor:j,exportTypedArrayMethod:W,exportTypedArrayStaticMethod:q,getTypedArrayConstructor:G,isView:B,isTypedArray:H,TypedArray:R,TypedArrayPrototype:I}},1318:function(t,e,n){var r=n(5656),i=n(1400),s=n(6244),o=function(t){return function(e,n,o){var a,l=r(e),c=s(l),u=i(o,c);if(t&&n!=n){while(c>u)if(a=l[u++],a!=a)return!0}else for(;c>u;u++)if((t||u in l)&&l[u]===n)return t||u||0;return!t&&-1}};t.exports={includes:o(!0),indexOf:o(!1)}},9671:function(t,e,n){var r=n(9974),i=n(8361),s=n(7908),o=n(6244),a=function(t){var e=1==t;return function(n,a,l){var c,u,h=s(n),d=i(h),f=r(a,l),p=o(d);while(p-- >0)if(c=d[p],u=f(c,p,h),u)switch(t){case 0:return c;case 1:return p}return e?-1:void 0}};t.exports={findLast:a(0),findLastIndex:a(1)}},4326:function(t,e,n){var r=n(1702),i=r({}.toString),s=r("".slice);t.exports=function(t){return s(i(t),8,-1)}},648:function(t,e,n){var r=n(1694),i=n(614),s=n(4326),o=n(5112),a=o("toStringTag"),l=Object,c="Arguments"==s(function(){return arguments}()),u=function(t,e){try{return t[e]}catch(n){}};t.exports=r?s:function(t){var e,n,r;return void 0===t?"Undefined":null===t?"Null":"string"==typeof(n=u(e=l(t),a))?n:c?s(e):"Object"==(r=s(e))&&i(e.callee)?"Arguments":r}},9920:function(t,e,n){var r=n(2597),i=n(3887),s=n(1236),o=n(3070);t.exports=function(t,e,n){for(var a=i(e),l=o.f,c=s.f,u=0;u<a.length;u++){var h=a[u];r(t,h)||n&&r(n,h)||l(t,h,c(e,h))}}},8544:function(t,e,n){var r=n(7293);t.exports=!r((function(){function t(){}return t.prototype.constructor=null,Object.getPrototypeOf(new t)!==t.prototype}))},8880:function(t,e,n){var r=n(9781),i=n(3070),s=n(9114);t.exports=r?function(t,e,n){return i.f(t,e,s(1,n))}:function(t,e,n){return t[e]=n,t}},9114:function(t){t.exports=function(t,e){return{enumerable:!(1&t),configurable:!(2&t),writable:!(4&t),value:e}}},7045:function(t,e,n){var r=n(6339),i=n(3070);t.exports=function(t,e,n){return n.get&&r(n.get,e,{getter:!0}),n.set&&r(n.set,e,{setter:!0}),i.f(t,e,n)}},8052:function(t,e,n){var r=n(614),i=n(3070),s=n(6339),o=n(3072);t.exports=function(t,e,n,a){a||(a={});var l=a.enumerable,c=void 0!==a.name?a.name:e;if(r(n)&&s(n,c,a),a.global)l?t[e]=n:o(e,n);else{try{a.unsafe?t[e]&&(l=!0):delete t[e]}catch(u){}l?t[e]=n:i.f(t,e,{value:n,enumerable:!1,configurable:!a.nonConfigurable,writable:!a.nonWritable})}return t}},3072:function(t,e,n){var r=n(7854),i=Object.defineProperty;t.exports=function(t,e){try{i(r,t,{value:e,configurable:!0,writable:!0})}catch(n){r[t]=e}return e}},9781:function(t,e,n){var r=n(7293);t.exports=!r((function(){return 7!=Object.defineProperty({},1,{get:function(){return 7}})[1]}))},317:function(t,e,n){var r=n(7854),i=n(111),s=r.document,o=i(s)&&i(s.createElement);t.exports=function(t){return o?s.createElement(t):{}}},3678:function(t){t.exports={IndexSizeError:{s:"INDEX_SIZE_ERR",c:1,m:1},DOMStringSizeError:{s:"DOMSTRING_SIZE_ERR",c:2,m:0},HierarchyRequestError:{s:"HIERARCHY_REQUEST_ERR",c:3,m:1},WrongDocumentError:{s:"WRONG_DOCUMENT_ERR",c:4,m:1},InvalidCharacterError:{s:"INVALID_CHARACTER_ERR",c:5,m:1},NoDataAllowedError:{s:"NO_DATA_ALLOWED_ERR",c:6,m:0},NoModificationAllowedError:{s:"NO_MODIFICATION_ALLOWED_ERR",c:7,m:1},NotFoundError:{s:"NOT_FOUND_ERR",c:8,m:1},NotSupportedError:{s:"NOT_SUPPORTED_ERR",c:9,m:1},InUseAttributeError:{s:"INUSE_ATTRIBUTE_ERR",c:10,m:1},InvalidStateError:{s:"INVALID_STATE_ERR",c:11,m:1},SyntaxError:{s:"SYNTAX_ERR",c:12,m:1},InvalidModificationError:{s:"INVALID_MODIFICATION_ERR",c:13,m:1},NamespaceError:{s:"NAMESPACE_ERR",c:14,m:1},InvalidAccessError:{s:"INVALID_ACCESS_ERR",c:15,m:1},ValidationError:{s:"VALIDATION_ERR",c:16,m:0},TypeMismatchError:{s:"TYPE_MISMATCH_ERR",c:17,m:1},SecurityError:{s:"SECURITY_ERR",c:18,m:1},NetworkError:{s:"NETWORK_ERR",c:19,m:1},AbortError:{s:"ABORT_ERR",c:20,m:1},URLMismatchError:{s:"URL_MISMATCH_ERR",c:21,m:1},QuotaExceededError:{s:"QUOTA_EXCEEDED_ERR",c:22,m:1},TimeoutError:{s:"TIMEOUT_ERR",c:23,m:1},InvalidNodeTypeError:{s:"INVALID_NODE_TYPE_ERR",c:24,m:1},DataCloneError:{s:"DATA_CLONE_ERR",c:25,m:1}}},8113:function(t,e,n){var r=n(5005);t.exports=r("navigator","userAgent")||""},7392:function(t,e,n){var r,i,s=n(7854),o=n(8113),a=s.process,l=s.Deno,c=a&&a.versions||l&&l.version,u=c&&c.v8;u&&(r=u.split("."),i=r[0]>0&&r[0]<4?1:+(r[0]+r[1])),!i&&o&&(r=o.match(/Edge\/(\d+)/),(!r||r[1]>=74)&&(r=o.match(/Chrome\/(\d+)/),r&&(i=+r[1]))),t.exports=i},748:function(t){t.exports=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"]},1060:function(t,e,n){var r=n(1702),i=Error,s=r("".replace),o=function(t){return String(i(t).stack)}("zxcasd"),a=/\n\s*at [^:]*:[^\n]*/,l=a.test(o);t.exports=function(t,e){if(l&&"string"==typeof t&&!i.prepareStackTrace)while(e--)t=s(t,a,"");return t}},2914:function(t,e,n){var r=n(7293),i=n(9114);t.exports=!r((function(){var t=Error("a");return!("stack"in t)||(Object.defineProperty(t,"stack",i(1,7)),7!==t.stack)}))},2109:function(t,e,n){var r=n(7854),i=n(1236).f,s=n(8880),o=n(8052),a=n(3072),l=n(9920),c=n(4705);t.exports=function(t,e){var n,u,h,d,f,p,m=t.target,g=t.global,v=t.stat;if(u=g?r:v?r[m]||a(m,{}):(r[m]||{}).prototype,u)for(h in e){if(f=e[h],t.dontCallGetSet?(p=i(u,h),d=p&&p.value):d=u[h],n=c(g?h:m+(v?".":"#")+h,t.forced),!n&&void 0!==d){if(typeof f==typeof d)continue;l(f,d)}(t.sham||d&&d.sham)&&s(f,"sham",!0),o(u,h,f,t)}}},7293:function(t){t.exports=function(t){try{return!!t()}catch(e){return!0}}},2104:function(t,e,n){var r=n(4374),i=Function.prototype,s=i.apply,o=i.call;t.exports="object"==typeof Reflect&&Reflect.apply||(r?o.bind(s):function(){return o.apply(s,arguments)})},9974:function(t,e,n){var r=n(1702),i=n(9662),s=n(4374),o=r(r.bind);t.exports=function(t,e){return i(t),void 0===e?t:s?o(t,e):function(){return t.apply(e,arguments)}}},4374:function(t,e,n){var r=n(7293);t.exports=!r((function(){var t=function(){}.bind();return"function"!=typeof t||t.hasOwnProperty("prototype")}))},6916:function(t,e,n){var r=n(4374),i=Function.prototype.call;t.exports=r?i.bind(i):function(){return i.apply(i,arguments)}},6530:function(t,e,n){var r=n(9781),i=n(2597),s=Function.prototype,o=r&&Object.getOwnPropertyDescriptor,a=i(s,"name"),l=a&&"something"===function(){}.name,c=a&&(!r||r&&o(s,"name").configurable);t.exports={EXISTS:a,PROPER:l,CONFIGURABLE:c}},1702:function(t,e,n){var r=n(4374),i=Function.prototype,s=i.bind,o=i.call,a=r&&s.bind(o,o);t.exports=r?function(t){return t&&a(t)}:function(t){return t&&function(){return o.apply(t,arguments)}}},5005:function(t,e,n){var r=n(7854),i=n(614),s=function(t){return i(t)?t:void 0};t.exports=function(t,e){return arguments.length<2?s(r[t]):r[t]&&r[t][e]}},8173:function(t,e,n){var r=n(9662),i=n(8554);t.exports=function(t,e){var n=t[e];return i(n)?void 0:r(n)}},7854:function(t,e,n){var r=function(t){return t&&t.Math==Math&&t};t.exports=r("object"==typeof globalThis&&globalThis)||r("object"==typeof window&&window)||r("object"==typeof self&&self)||r("object"==typeof n.g&&n.g)||function(){return this}()||Function("return this")()},2597:function(t,e,n){var r=n(1702),i=n(7908),s=r({}.hasOwnProperty);t.exports=Object.hasOwn||function(t,e){return s(i(t),e)}},3501:function(t){t.exports={}},490:function(t,e,n){var r=n(5005);t.exports=r("document","documentElement")},4664:function(t,e,n){var r=n(9781),i=n(7293),s=n(317);t.exports=!r&&!i((function(){return 7!=Object.defineProperty(s("div"),"a",{get:function(){return 7}}).a}))},8361:function(t,e,n){var r=n(1702),i=n(7293),s=n(4326),o=Object,a=r("".split);t.exports=i((function(){return!o("z").propertyIsEnumerable(0)}))?function(t){return"String"==s(t)?a(t,""):o(t)}:o},9587:function(t,e,n){var r=n(614),i=n(111),s=n(7674);t.exports=function(t,e,n){var o,a;return s&&r(o=e.constructor)&&o!==n&&i(a=o.prototype)&&a!==n.prototype&&s(t,a),t}},2788:function(t,e,n){var r=n(1702),i=n(614),s=n(5465),o=r(Function.toString);i(s.inspectSource)||(s.inspectSource=function(t){return o(t)}),t.exports=s.inspectSource},8340:function(t,e,n){var r=n(111),i=n(8880);t.exports=function(t,e){r(e)&&"cause"in e&&i(t,"cause",e.cause)}},9909:function(t,e,n){var r,i,s,o=n(4811),a=n(7854),l=n(1702),c=n(111),u=n(8880),h=n(2597),d=n(5465),f=n(6200),p=n(3501),m="Object already initialized",g=a.TypeError,v=a.WeakMap,y=function(t){return s(t)?i(t):r(t,{})},x=function(t){return function(e){var n;if(!c(e)||(n=i(e)).type!==t)throw g("Incompatible receiver, "+t+" required");return n}};if(o||d.state){var b=d.state||(d.state=new v),w=l(b.get),_=l(b.has),M=l(b.set);r=function(t,e){if(_(b,t))throw g(m);return e.facade=t,M(b,t,e),e},i=function(t){return w(b,t)||{}},s=function(t){return _(b,t)}}else{var A=f("state");p[A]=!0,r=function(t,e){if(h(t,A))throw g(m);return e.facade=t,u(t,A,e),e},i=function(t){return h(t,A)?t[A]:{}},s=function(t){return h(t,A)}}t.exports={set:r,get:i,has:s,enforce:y,getterFor:x}},614:function(t){t.exports=function(t){return"function"==typeof t}},4705:function(t,e,n){var r=n(7293),i=n(614),s=/#|\.prototype\./,o=function(t,e){var n=l[a(t)];return n==u||n!=c&&(i(e)?r(e):!!e)},a=o.normalize=function(t){return String(t).replace(s,".").toLowerCase()},l=o.data={},c=o.NATIVE="N",u=o.POLYFILL="P";t.exports=o},8554:function(t){t.exports=function(t){return null===t||void 0===t}},111:function(t,e,n){var r=n(614),i="object"==typeof document&&document.all,s="undefined"==typeof i&&void 0!==i;t.exports=s?function(t){return"object"==typeof t?null!==t:r(t)||t===i}:function(t){return"object"==typeof t?null!==t:r(t)}},1913:function(t){t.exports=!1},2190:function(t,e,n){var r=n(5005),i=n(614),s=n(7976),o=n(3307),a=Object;t.exports=o?function(t){return"symbol"==typeof t}:function(t){var e=r("Symbol");return i(e)&&s(e.prototype,a(t))}},6244:function(t,e,n){var r=n(7466);t.exports=function(t){return r(t.length)}},6339:function(t,e,n){var r=n(7293),i=n(614),s=n(2597),o=n(9781),a=n(6530).CONFIGURABLE,l=n(2788),c=n(9909),u=c.enforce,h=c.get,d=Object.defineProperty,f=o&&!r((function(){return 8!==d((function(){}),"length",{value:8}).length})),p=String(String).split("String"),m=t.exports=function(t,e,n){"Symbol("===String(e).slice(0,7)&&(e="["+String(e).replace(/^Symbol\(([^)]*)\)/,"$1")+"]"),n&&n.getter&&(e="get "+e),n&&n.setter&&(e="set "+e),(!s(t,"name")||a&&t.name!==e)&&(o?d(t,"name",{value:e,configurable:!0}):t.name=e),f&&n&&s(n,"arity")&&t.length!==n.arity&&d(t,"length",{value:n.arity});try{n&&s(n,"constructor")&&n.constructor?o&&d(t,"prototype",{writable:!1}):t.prototype&&(t.prototype=void 0)}catch(i){}var r=u(t);return s(r,"source")||(r.source=p.join("string"==typeof e?e:"")),t};Function.prototype.toString=m((function(){return i(this)&&h(this).source||l(this)}),"toString")},4758:function(t){var e=Math.ceil,n=Math.floor;t.exports=Math.trunc||function(t){var r=+t;return(r>0?n:e)(r)}},6277:function(t,e,n){var r=n(1340);t.exports=function(t,e){return void 0===t?arguments.length<2?"":e:r(t)}},30:function(t,e,n){var r,i=n(9670),s=n(6048),o=n(748),a=n(3501),l=n(490),c=n(317),u=n(6200),h=">",d="<",f="prototype",p="script",m=u("IE_PROTO"),g=function(){},v=function(t){return d+p+h+t+d+"/"+p+h},y=function(t){t.write(v("")),t.close();var e=t.parentWindow.Object;return t=null,e},x=function(){var t,e=c("iframe"),n="java"+p+":";return e.style.display="none",l.appendChild(e),e.src=String(n),t=e.contentWindow.document,t.open(),t.write(v("document.F=Object")),t.close(),t.F},b=function(){try{r=new ActiveXObject("htmlfile")}catch(e){}b="undefined"!=typeof document?document.domain&&r?y(r):x():y(r);var t=o.length;while(t--)delete b[f][o[t]];return b()};a[m]=!0,t.exports=Object.create||function(t,e){var n;return null!==t?(g[f]=i(t),n=new g,g[f]=null,n[m]=t):n=b(),void 0===e?n:s.f(n,e)}},6048:function(t,e,n){var r=n(9781),i=n(3353),s=n(3070),o=n(9670),a=n(5656),l=n(1956);e.f=r&&!i?Object.defineProperties:function(t,e){o(t);var n,r=a(e),i=l(e),c=i.length,u=0;while(c>u)s.f(t,n=i[u++],r[n]);return t}},3070:function(t,e,n){var r=n(9781),i=n(4664),s=n(3353),o=n(9670),a=n(4948),l=TypeError,c=Object.defineProperty,u=Object.getOwnPropertyDescriptor,h="enumerable",d="configurable",f="writable";e.f=r?s?function(t,e,n){if(o(t),e=a(e),o(n),"function"===typeof t&&"prototype"===e&&"value"in n&&f in n&&!n[f]){var r=u(t,e);r&&r[f]&&(t[e]=n.value,n={configurable:d in n?n[d]:r[d],enumerable:h in n?n[h]:r[h],writable:!1})}return c(t,e,n)}:c:function(t,e,n){if(o(t),e=a(e),o(n),i)try{return c(t,e,n)}catch(r){}if("get"in n||"set"in n)throw l("Accessors not supported");return"value"in n&&(t[e]=n.value),t}},1236:function(t,e,n){var r=n(9781),i=n(6916),s=n(5296),o=n(9114),a=n(5656),l=n(4948),c=n(2597),u=n(4664),h=Object.getOwnPropertyDescriptor;e.f=r?h:function(t,e){if(t=a(t),e=l(e),u)try{return h(t,e)}catch(n){}if(c(t,e))return o(!i(s.f,t,e),t[e])}},8006:function(t,e,n){var r=n(6324),i=n(748),s=i.concat("length","prototype");e.f=Object.getOwnPropertyNames||function(t){return r(t,s)}},5181:function(t,e){e.f=Object.getOwnPropertySymbols},9518:function(t,e,n){var r=n(2597),i=n(614),s=n(7908),o=n(6200),a=n(8544),l=o("IE_PROTO"),c=Object,u=c.prototype;t.exports=a?c.getPrototypeOf:function(t){var e=s(t);if(r(e,l))return e[l];var n=e.constructor;return i(n)&&e instanceof n?n.prototype:e instanceof c?u:null}},7976:function(t,e,n){var r=n(1702);t.exports=r({}.isPrototypeOf)},6324:function(t,e,n){var r=n(1702),i=n(2597),s=n(5656),o=n(1318).indexOf,a=n(3501),l=r([].push);t.exports=function(t,e){var n,r=s(t),c=0,u=[];for(n in r)!i(a,n)&&i(r,n)&&l(u,n);while(e.length>c)i(r,n=e[c++])&&(~o(u,n)||l(u,n));return u}},1956:function(t,e,n){var r=n(6324),i=n(748);t.exports=Object.keys||function(t){return r(t,i)}},5296:function(t,e){"use strict";var n={}.propertyIsEnumerable,r=Object.getOwnPropertyDescriptor,i=r&&!n.call({1:2},1);e.f=i?function(t){var e=r(this,t);return!!e&&e.enumerable}:n},7674:function(t,e,n){var r=n(1702),i=n(9670),s=n(6077);t.exports=Object.setPrototypeOf||("__proto__"in{}?function(){var t,e=!1,n={};try{t=r(Object.getOwnPropertyDescriptor(Object.prototype,"__proto__").set),t(n,[]),e=n instanceof Array}catch(o){}return function(n,r){return i(n),s(r),e?t(n,r):n.__proto__=r,n}}():void 0)},2140:function(t,e,n){var r=n(6916),i=n(614),s=n(111),o=TypeError;t.exports=function(t,e){var n,a;if("string"===e&&i(n=t.toString)&&!s(a=r(n,t)))return a;if(i(n=t.valueOf)&&!s(a=r(n,t)))return a;if("string"!==e&&i(n=t.toString)&&!s(a=r(n,t)))return a;throw o("Can't convert object to primitive value")}},3887:function(t,e,n){var r=n(5005),i=n(1702),s=n(8006),o=n(5181),a=n(9670),l=i([].concat);t.exports=r("Reflect","ownKeys")||function(t){var e=s.f(a(t)),n=o.f;return n?l(e,n(t)):e}},2626:function(t,e,n){var r=n(3070).f;t.exports=function(t,e,n){n in t||r(t,n,{configurable:!0,get:function(){return e[n]},set:function(t){e[n]=t}})}},7066:function(t,e,n){"use strict";var r=n(9670);t.exports=function(){var t=r(this),e="";return t.hasIndices&&(e+="d"),t.global&&(e+="g"),t.ignoreCase&&(e+="i"),t.multiline&&(e+="m"),t.dotAll&&(e+="s"),t.unicode&&(e+="u"),t.unicodeSets&&(e+="v"),t.sticky&&(e+="y"),e}},4488:function(t,e,n){var r=n(8554),i=TypeError;t.exports=function(t){if(r(t))throw i("Can't call method on "+t);return t}},6200:function(t,e,n){var r=n(2309),i=n(9711),s=r("keys");t.exports=function(t){return s[t]||(s[t]=i(t))}},5465:function(t,e,n){var r=n(7854),i=n(3072),s="__core-js_shared__",o=r[s]||i(s,{});t.exports=o},2309:function(t,e,n){var r=n(1913),i=n(5465);(t.exports=function(t,e){return i[t]||(i[t]=void 0!==e?e:{})})("versions",[]).push({version:"3.25.0",mode:r?"pure":"global",copyright:"© 2014-2022 Denis Pushkarev (zloirock.ru)",license:"https://github.com/zloirock/core-js/blob/v3.25.0/LICENSE",source:"https://github.com/zloirock/core-js"})},6293:function(t,e,n){var r=n(7392),i=n(7293);t.exports=!!Object.getOwnPropertySymbols&&!i((function(){var t=Symbol();return!String(t)||!(Object(t)instanceof Symbol)||!Symbol.sham&&r&&r<41}))},1400:function(t,e,n){var r=n(9303),i=Math.max,s=Math.min;t.exports=function(t,e){var n=r(t);return n<0?i(n+e,0):s(n,e)}},5656:function(t,e,n){var r=n(8361),i=n(4488);t.exports=function(t){return r(i(t))}},9303:function(t,e,n){var r=n(4758);t.exports=function(t){var e=+t;return e!==e||0===e?0:r(e)}},7466:function(t,e,n){var r=n(9303),i=Math.min;t.exports=function(t){return t>0?i(r(t),9007199254740991):0}},7908:function(t,e,n){var r=n(4488),i=Object;t.exports=function(t){return i(r(t))}},7593:function(t,e,n){var r=n(6916),i=n(111),s=n(2190),o=n(8173),a=n(2140),l=n(5112),c=TypeError,u=l("toPrimitive");t.exports=function(t,e){if(!i(t)||s(t))return t;var n,l=o(t,u);if(l){if(void 0===e&&(e="default"),n=r(l,t,e),!i(n)||s(n))return n;throw c("Can't convert object to primitive value")}return void 0===e&&(e="number"),a(t,e)}},4948:function(t,e,n){var r=n(7593),i=n(2190);t.exports=function(t){var e=r(t,"string");return i(e)?e:e+""}},1694:function(t,e,n){var r=n(5112),i=r("toStringTag"),s={};s[i]="z",t.exports="[object z]"===String(s)},1340:function(t,e,n){var r=n(648),i=String;t.exports=function(t){if("Symbol"===r(t))throw TypeError("Cannot convert a Symbol value to a string");return i(t)}},6330:function(t){var e=String;t.exports=function(t){try{return e(t)}catch(n){return"Object"}}},9711:function(t,e,n){var r=n(1702),i=0,s=Math.random(),o=r(1..toString);t.exports=function(t){return"Symbol("+(void 0===t?"":t)+")_"+o(++i+s,36)}},3307:function(t,e,n){var r=n(6293);t.exports=r&&!Symbol.sham&&"symbol"==typeof Symbol.iterator},3353:function(t,e,n){var r=n(9781),i=n(7293);t.exports=r&&i((function(){return 42!=Object.defineProperty((function(){}),"prototype",{value:42,writable:!1}).prototype}))},4811:function(t,e,n){var r=n(7854),i=n(614),s=r.WeakMap;t.exports=i(s)&&/native code/.test(String(s))},5112:function(t,e,n){var r=n(7854),i=n(2309),s=n(2597),o=n(9711),a=n(6293),l=n(3307),c=i("wks"),u=r.Symbol,h=u&&u["for"],d=l?u:u&&u.withoutSetter||o;t.exports=function(t){if(!s(c,t)||!a&&"string"!=typeof c[t]){var e="Symbol."+t;a&&s(u,t)?c[t]=u[t]:c[t]=l&&h?h(e):d(e)}return c[t]}},9191:function(t,e,n){"use strict";var r=n(5005),i=n(2597),s=n(8880),o=n(7976),a=n(7674),l=n(9920),c=n(2626),u=n(9587),h=n(6277),d=n(8340),f=n(1060),p=n(2914),m=n(9781),g=n(1913);t.exports=function(t,e,n,v){var y="stackTraceLimit",x=v?2:1,b=t.split("."),w=b[b.length-1],_=r.apply(null,b);if(_){var M=_.prototype;if(!g&&i(M,"cause")&&delete M.cause,!n)return _;var A=r("Error"),S=e((function(t,e){var n=h(v?e:t,void 0),r=v?new _(t):new _;return void 0!==n&&s(r,"message",n),p&&s(r,"stack",f(r.stack,2)),this&&o(M,this)&&u(r,this,S),arguments.length>x&&d(r,arguments[x]),r}));if(S.prototype=M,"Error"!==w?a?a(S,A):l(S,A,{name:!0}):m&&y in _&&(c(S,_,y),c(S,_,"prepareStackTrace")),l(S,_),!g)try{M.name!==w&&s(M,"name",w),M.constructor=S}catch(E){}return S}}},2262:function(t,e,n){"use strict";var r=n(2109),i=n(7908),s=n(6244),o=n(9303),a=n(1223);r({target:"Array",proto:!0},{at:function(t){var e=i(this),n=s(e),r=o(t),a=r>=0?r:n+r;return a<0||a>=n?void 0:e[a]}}),a("at")},1703:function(t,e,n){var r=n(2109),i=n(7854),s=n(2104),o=n(9191),a="WebAssembly",l=i[a],c=7!==Error("e",{cause:7}).cause,u=function(t,e){var n={};n[t]=o(t,e,c),r({global:!0,constructor:!0,arity:1,forced:c},n)},h=function(t,e){if(l&&l[t]){var n={};n[t]=o(a+"."+t,e,c),r({target:a,stat:!0,constructor:!0,arity:1,forced:c},n)}};u("Error",(function(t){return function(e){return s(t,this,arguments)}})),u("EvalError",(function(t){return function(e){return s(t,this,arguments)}})),u("RangeError",(function(t){return function(e){return s(t,this,arguments)}})),u("ReferenceError",(function(t){return function(e){return s(t,this,arguments)}})),u("SyntaxError",(function(t){return function(e){return s(t,this,arguments)}})),u("TypeError",(function(t){return function(e){return s(t,this,arguments)}})),u("URIError",(function(t){return function(e){return s(t,this,arguments)}})),h("CompileError",(function(t){return function(e){return s(t,this,arguments)}})),h("LinkError",(function(t){return function(e){return s(t,this,arguments)}})),h("RuntimeError",(function(t){return function(e){return s(t,this,arguments)}}))},2087:function(t,e,n){var r=n(7854),i=n(9781),s=n(7045),o=n(7066),a=n(7293),l=r.RegExp,c=l.prototype,u=i&&a((function(){var t=!0;try{l(".","d")}catch(u){t=!1}var e={},n="",r=t?"dgimsy":"gimsy",i=function(t,r){Object.defineProperty(e,t,{get:function(){return n+=r,!0}})},s={dotAll:"s",global:"g",ignoreCase:"i",multiline:"m",sticky:"y"};for(var o in t&&(s.hasIndices="d"),s)i(o,s[o]);var a=Object.getOwnPropertyDescriptor(c,"flags").get.call(e);return a!==r||n!==r}));u&&s(c,"flags",{configurable:!0,get:o})},4506:function(t,e,n){"use strict";var r=n(2109),i=n(1702),s=n(4488),o=n(9303),a=n(1340),l=n(7293),c=i("".charAt),u=l((function(){return"\ud842"!=="𠮷".at(-2)}));r({target:"String",proto:!0,forced:u},{at:function(t){var e=a(s(this)),n=e.length,r=o(t),i=r>=0?r:n+r;return i<0||i>=n?void 0:c(e,i)}})},8675:function(t,e,n){"use strict";var r=n(260),i=n(6244),s=n(9303),o=r.aTypedArray,a=r.exportTypedArrayMethod;a("at",(function(t){var e=o(this),n=i(e),r=s(t),a=r>=0?r:n+r;return a<0||a>=n?void 0:e[a]}))},4590:function(t,e,n){"use strict";var r=n(260),i=n(9671).findLastIndex,s=r.aTypedArray,o=r.exportTypedArrayMethod;o("findLastIndex",(function(t){return i(s(this),t,arguments.length>1?arguments[1]:void 0)}))},3408:function(t,e,n){"use strict";var r=n(260),i=n(9671).findLast,s=r.aTypedArray,o=r.exportTypedArrayMethod;o("findLast",(function(t){return i(s(this),t,arguments.length>1?arguments[1]:void 0)}))},1118:function(t,e,n){n(4590)},7380:function(t,e,n){n(3408)},2801:function(t,e,n){"use strict";var r=n(2109),i=n(7854),s=n(5005),o=n(9114),a=n(3070).f,l=n(2597),c=n(5787),u=n(9587),h=n(6277),d=n(3678),f=n(1060),p=n(9781),m=n(1913),g="DOMException",v=s("Error"),y=s(g),x=function(){c(this,b);var t=arguments.length,e=h(t<1?void 0:arguments[0]),n=h(t<2?void 0:arguments[1],"Error"),r=new y(e,n),i=v(e);return i.name=g,a(r,"stack",o(1,f(i.stack,1))),u(r,this,x),r},b=x.prototype=y.prototype,w="stack"in v(g),_="stack"in new y(1,2),M=y&&p&&Object.getOwnPropertyDescriptor(i,g),A=!!M&&!(M.writable&&M.configurable),S=w&&!A&&!_;r({global:!0,constructor:!0,forced:m||S},{DOMException:S?x:y});var E=s(g),T=E.prototype;if(T.constructor!==E)for(var C in m||a(T,"constructor",o(1,E)),d)if(l(d,C)){var R=d[C],I=R.s;l(E,I)||a(E,I,o(6,R.c))}},4868:function(t,e,n){"use strict";n.d(e,{Sg:function(){return c},zt:function(){return u}});var r=n(3966),i=n(2224),s=n(8737);const o="abstract-provider/5.7.0";var a=function(t,e,n,r){function i(t){return t instanceof n?t:new n((function(e){e(t)}))}return new(n||(n=Promise))((function(n,s){function o(t){try{l(r.next(t))}catch(e){s(e)}}function a(t){try{l(r["throw"](t))}catch(e){s(e)}}function l(t){t.done?n(t.value):i(t.value).then(o,a)}l((r=r.apply(t,e||[])).next())}))};const l=new s.Yd(o);class c extends i.dk{static isForkEvent(t){return!(!t||!t._isForkEvent)}}class u{constructor(){l.checkAbstract(new.target,u),(0,i.zG)(this,"_isProvider",!0)}getFeeData(){return a(this,void 0,void 0,(function*(){const{block:t,gasPrice:e}=yield(0,i.mE)({block:this.getBlock("latest"),gasPrice:this.getGasPrice().catch((t=>null))});let n=null,s=null,o=null;return t&&t.baseFeePerGas&&(n=t.baseFeePerGas,o=r.O$.from("1500000000"),s=t.baseFeePerGas.mul(2).add(o)),{lastBaseFeePerGas:n,maxFeePerGas:s,maxPriorityFeePerGas:o,gasPrice:e}}))}addListener(t,e){return this.on(t,e)}removeListener(t,e){return this.off(t,e)}static isProvider(t){return!(!t||!t._isProvider)}}},1865:function(t,e,n){"use strict";n.d(e,{E:function(){return u},b:function(){return h}});var r=n(2224),i=n(8737);const s="abstract-signer/5.7.0";var o=function(t,e,n,r){function i(t){return t instanceof n?t:new n((function(e){e(t)}))}return new(n||(n=Promise))((function(n,s){function o(t){try{l(r.next(t))}catch(e){s(e)}}function a(t){try{l(r["throw"](t))}catch(e){s(e)}}function l(t){t.done?n(t.value):i(t.value).then(o,a)}l((r=r.apply(t,e||[])).next())}))};const a=new i.Yd(s),l=["accessList","ccipReadEnabled","chainId","customData","data","from","gasLimit","gasPrice","maxFeePerGas","maxPriorityFeePerGas","nonce","to","type","value"],c=[i.Yd.errors.INSUFFICIENT_FUNDS,i.Yd.errors.NONCE_EXPIRED,i.Yd.errors.REPLACEMENT_UNDERPRICED];class u{constructor(){a.checkAbstract(new.target,u),(0,r.zG)(this,"_isSigner",!0)}getBalance(t){return o(this,void 0,void 0,(function*(){return this._checkProvider("getBalance"),yield this.provider.getBalance(this.getAddress(),t)}))}getTransactionCount(t){return o(this,void 0,void 0,(function*(){return this._checkProvider("getTransactionCount"),yield this.provider.getTransactionCount(this.getAddress(),t)}))}estimateGas(t){return o(this,void 0,void 0,(function*(){this._checkProvider("estimateGas");const e=yield(0,r.mE)(this.checkTransaction(t));return yield this.provider.estimateGas(e)}))}call(t,e){return o(this,void 0,void 0,(function*(){this._checkProvider("call");const n=yield(0,r.mE)(this.checkTransaction(t));return yield this.provider.call(n,e)}))}sendTransaction(t){return o(this,void 0,void 0,(function*(){this._checkProvider("sendTransaction");const e=yield this.populateTransaction(t),n=yield this.signTransaction(e);return yield this.provider.sendTransaction(n)}))}getChainId(){return o(this,void 0,void 0,(function*(){this._checkProvider("getChainId");const t=yield this.provider.getNetwork();return t.chainId}))}getGasPrice(){return o(this,void 0,void 0,(function*(){return this._checkProvider("getGasPrice"),yield this.provider.getGasPrice()}))}getFeeData(){return o(this,void 0,void 0,(function*(){return this._checkProvider("getFeeData"),yield this.provider.getFeeData()}))}resolveName(t){return o(this,void 0,void 0,(function*(){return this._checkProvider("resolveName"),yield this.provider.resolveName(t)}))}checkTransaction(t){for(const n in t)-1===l.indexOf(n)&&a.throwArgumentError("invalid transaction key: "+n,"transaction",t);const e=(0,r.DC)(t);return null==e.from?e.from=this.getAddress():e.from=Promise.all([Promise.resolve(e.from),this.getAddress()]).then((e=>(e[0].toLowerCase()!==e[1].toLowerCase()&&a.throwArgumentError("from address mismatch","transaction",t),e[0]))),e}populateTransaction(t){return o(this,void 0,void 0,(function*(){const e=yield(0,r.mE)(this.checkTransaction(t));null!=e.to&&(e.to=Promise.resolve(e.to).then((t=>o(this,void 0,void 0,(function*(){if(null==t)return null;const e=yield this.resolveName(t);return null==e&&a.throwArgumentError("provided ENS name resolves to null","tx.to",t),e})))),e.to.catch((t=>{})));const n=null!=e.maxFeePerGas||null!=e.maxPriorityFeePerGas;if(null==e.gasPrice||2!==e.type&&!n?0!==e.type&&1!==e.type||!n||a.throwArgumentError("pre-eip-1559 transaction do not support maxFeePerGas/maxPriorityFeePerGas","transaction",t):a.throwArgumentError("eip-1559 transaction do not support gasPrice","transaction",t),2!==e.type&&null!=e.type||null==e.maxFeePerGas||null==e.maxPriorityFeePerGas)if(0===e.type||1===e.type)null==e.gasPrice&&(e.gasPrice=this.getGasPrice());else{const t=yield this.getFeeData();if(null==e.type)if(null!=t.maxFeePerGas&&null!=t.maxPriorityFeePerGas)if(e.type=2,null!=e.gasPrice){const t=e.gasPrice;delete e.gasPrice,e.maxFeePerGas=t,e.maxPriorityFeePerGas=t}else null==e.maxFeePerGas&&(e.maxFeePerGas=t.maxFeePerGas),null==e.maxPriorityFeePerGas&&(e.maxPriorityFeePerGas=t.maxPriorityFeePerGas);else null!=t.gasPrice?(n&&a.throwError("network does not support EIP-1559",i.Yd.errors.UNSUPPORTED_OPERATION,{operation:"populateTransaction"}),null==e.gasPrice&&(e.gasPrice=t.gasPrice),e.type=0):a.throwError("failed to get consistent fee data",i.Yd.errors.UNSUPPORTED_OPERATION,{operation:"signer.getFeeData"});else 2===e.type&&(null==e.maxFeePerGas&&(e.maxFeePerGas=t.maxFeePerGas),null==e.maxPriorityFeePerGas&&(e.maxPriorityFeePerGas=t.maxPriorityFeePerGas))}else e.type=2;return null==e.nonce&&(e.nonce=this.getTransactionCount("pending")),null==e.gasLimit&&(e.gasLimit=this.estimateGas(e).catch((t=>{if(c.indexOf(t.code)>=0)throw t;return a.throwError("cannot estimate gas; transaction may fail or may require manual gas limit",i.Yd.errors.UNPREDICTABLE_GAS_LIMIT,{error:t,tx:e})}))),null==e.chainId?e.chainId=this.getChainId():e.chainId=Promise.all([Promise.resolve(e.chainId),this.getChainId()]).then((e=>(0!==e[1]&&e[0]!==e[1]&&a.throwArgumentError("chainId address mismatch","transaction",t),e[0]))),yield(0,r.mE)(e)}))}_checkProvider(t){this.provider||a.throwError("missing provider",i.Yd.errors.UNSUPPORTED_OPERATION,{operation:t||"_checkProvider"})}static isSigner(t){return!(!t||!t._isSigner)}}class h extends u{constructor(t,e){super(),(0,r.zG)(this,"address",t),(0,r.zG)(this,"provider",e||null)}getAddress(){return Promise.resolve(this.address)}_fail(t,e){return Promise.resolve().then((()=>{a.throwError(t,i.Yd.errors.UNSUPPORTED_OPERATION,{operation:e})}))}signMessage(t){return this._fail("VoidSigner cannot sign messages","signMessage")}signTransaction(t){return this._fail("VoidSigner cannot sign transactions","signTransaction")}_signTypedData(t,e,n){return this._fail("VoidSigner cannot sign typed data","signTypedData")}connect(t){return new h(this.address,t)}}},594:function(t,e,n){"use strict";n.d(e,{Kn:function(){return g},CR:function(){return v}});n(8675),n(7380),n(1118);var r=n(6482),i=n(3966),s=n(6502),o=n(7991),a=n(8737);const l="address/5.7.0",c=new a.Yd(l);function u(t){(0,r.A7)(t,20)||c.throwArgumentError("invalid address","address",t),t=t.toLowerCase();const e=t.substring(2).split(""),n=new Uint8Array(40);for(let r=0;r<40;r++)n[r]=e[r].charCodeAt(0);const i=(0,r.lE)((0,s.w)(n));for(let r=0;r<40;r+=2)i[r>>1]>>4>=8&&(e[r]=e[r].toUpperCase()),(15&i[r>>1])>=8&&(e[r+1]=e[r+1].toUpperCase());return"0x"+e.join("")}const h=9007199254740991;function d(t){return Math.log10?Math.log10(t):Math.log(t)/Math.LN10}const f={};for(let y=0;y<10;y++)f[String(y)]=String(y);for(let y=0;y<26;y++)f[String.fromCharCode(65+y)]=String(10+y);const p=Math.floor(d(h));function m(t){t=t.toUpperCase(),t=t.substring(4)+t.substring(0,2)+"00";let e=t.split("").map((t=>f[t])).join("");while(e.length>=p){let t=e.substring(0,p);e=parseInt(t,10)%97+e.substring(t.length)}let n=String(98-parseInt(e,10)%97);while(n.length<2)n="0"+n;return n}function g(t){let e=null;if("string"!==typeof t&&c.throwArgumentError("invalid address","address",t),t.match(/^(0x)?[0-9a-fA-F]{40}$/))"0x"!==t.substring(0,2)&&(t="0x"+t),e=u(t),t.match(/([A-F].*[a-f])|([a-f].*[A-F])/)&&e!==t&&c.throwArgumentError("bad address checksum","address",t);else if(t.match(/^XE[0-9]{2}[0-9A-Za-z]{30,31}$/)){t.substring(2,4)!==m(t)&&c.throwArgumentError("bad icap checksum","address",t),e=(0,i.g$)(t.substring(4));while(e.length<40)e="0"+e;e=u("0x"+e)}else c.throwArgumentError("invalid address","address",t);return e}function v(t){let e=null;try{e=g(t.from)}catch(a){c.throwArgumentError("missing from address","transaction",t)}const n=(0,r.G1)((0,r.lE)(i.O$.from(t.nonce).toHexString()));return g((0,r.p3)((0,s.w)((0,o.c)([e,n])),12))}},3966:function(t,e,n){"use strict";n.d(e,{O$:function(){return f},g$:function(){return y}});var r=n(2396),i=n.n(r),s=n(6482),o=n(8737);const a="bignumber/5.7.0";var l=i().BN;const c=new o.Yd(a),u={},h=9007199254740991;let d=!1;class f{constructor(t,e){t!==u&&c.throwError("cannot call constructor directly; use BigNumber.from",o.Yd.errors.UNSUPPORTED_OPERATION,{operation:"new (BigNumber)"}),this._hex=e,this._isBigNumber=!0,Object.freeze(this)}fromTwos(t){return m(g(this).fromTwos(t))}toTwos(t){return m(g(this).toTwos(t))}abs(){return"-"===this._hex[0]?f.from(this._hex.substring(1)):this}add(t){return m(g(this).add(g(t)))}sub(t){return m(g(this).sub(g(t)))}div(t){const e=f.from(t);return e.isZero()&&v("division-by-zero","div"),m(g(this).div(g(t)))}mul(t){return m(g(this).mul(g(t)))}mod(t){const e=g(t);return e.isNeg()&&v("division-by-zero","mod"),m(g(this).umod(e))}pow(t){const e=g(t);return e.isNeg()&&v("negative-power","pow"),m(g(this).pow(e))}and(t){const e=g(t);return(this.isNegative()||e.isNeg())&&v("unbound-bitwise-result","and"),m(g(this).and(e))}or(t){const e=g(t);return(this.isNegative()||e.isNeg())&&v("unbound-bitwise-result","or"),m(g(this).or(e))}xor(t){const e=g(t);return(this.isNegative()||e.isNeg())&&v("unbound-bitwise-result","xor"),m(g(this).xor(e))}mask(t){return(this.isNegative()||t<0)&&v("negative-width","mask"),m(g(this).maskn(t))}shl(t){return(this.isNegative()||t<0)&&v("negative-width","shl"),m(g(this).shln(t))}shr(t){return(this.isNegative()||t<0)&&v("negative-width","shr"),m(g(this).shrn(t))}eq(t){return g(this).eq(g(t))}lt(t){return g(this).lt(g(t))}lte(t){return g(this).lte(g(t))}gt(t){return g(this).gt(g(t))}gte(t){return g(this).gte(g(t))}isNegative(){return"-"===this._hex[0]}isZero(){return g(this).isZero()}toNumber(){try{return g(this).toNumber()}catch(t){v("overflow","toNumber",this.toString())}return null}toBigInt(){try{return BigInt(this.toString())}catch(t){}return c.throwError("this platform does not support BigInt",o.Yd.errors.UNSUPPORTED_OPERATION,{value:this.toString()})}toString(){return arguments.length>0&&(10===arguments[0]?d||(d=!0,c.warn("BigNumber.toString does not accept any parameters; base-10 is assumed")):16===arguments[0]?c.throwError("BigNumber.toString does not accept any parameters; use bigNumber.toHexString()",o.Yd.errors.UNEXPECTED_ARGUMENT,{}):c.throwError("BigNumber.toString does not accept parameters",o.Yd.errors.UNEXPECTED_ARGUMENT,{})),g(this).toString(10)}toHexString(){return this._hex}toJSON(t){return{type:"BigNumber",hex:this.toHexString()}}static from(t){if(t instanceof f)return t;if("string"===typeof t)return t.match(/^-?0x[0-9a-f]+$/i)?new f(u,p(t)):t.match(/^-?[0-9]+$/)?new f(u,p(new l(t))):c.throwArgumentError("invalid BigNumber string","value",t);if("number"===typeof t)return t%1&&v("underflow","BigNumber.from",t),(t>=h||t<=-h)&&v("overflow","BigNumber.from",t),f.from(String(t));const e=t;if("bigint"===typeof e)return f.from(e.toString());if((0,s._t)(e))return f.from((0,s.Dv)(e));if(e)if(e.toHexString){const t=e.toHexString();if("string"===typeof t)return f.from(t)}else{let t=e._hex;if(null==t&&"BigNumber"===e.type&&(t=e.hex),"string"===typeof t&&((0,s.A7)(t)||"-"===t[0]&&(0,s.A7)(t.substring(1))))return f.from(t)}return c.throwArgumentError("invalid BigNumber value","value",t)}static isBigNumber(t){return!(!t||!t._isBigNumber)}}function p(t){if("string"!==typeof t)return p(t.toString(16));if("-"===t[0])return t=t.substring(1),"-"===t[0]&&c.throwArgumentError("invalid hex","value",t),t=p(t),"0x00"===t?t:"-"+t;if("0x"!==t.substring(0,2)&&(t="0x"+t),"0x"===t)return"0x00";t.length%2&&(t="0x0"+t.substring(2));while(t.length>4&&"0x00"===t.substring(0,4))t="0x"+t.substring(4);return t}function m(t){return f.from(p(t))}function g(t){const e=f.from(t).toHexString();return"-"===e[0]?new l("-"+e.substring(3),16):new l(e.substring(2),16)}function v(t,e,n){const r={fault:t,operation:e};return null!=n&&(r.value=n),c.throwError(t,o.Yd.errors.NUMERIC_FAULT,r)}function y(t){return new l(t,36).toString(16)}},6482:function(t,e,n){"use strict";n.d(e,{lE:function(){return h},zo:function(){return d},xs:function(){return b},E1:function(){return y},p3:function(){return x},$P:function(){return w},$m:function(){return M},Dv:function(){return v},_t:function(){return u},Zq:function(){return l},A7:function(){return m},N:function(){return A},G1:function(){return f}});n(8675),n(7380),n(1118);var r=n(8737);const i="bytes/5.7.0",s=new r.Yd(i);function o(t){return!!t.toHexString}function a(t){return t.slice||(t.slice=function(){const e=Array.prototype.slice.call(arguments);return a(new Uint8Array(Array.prototype.slice.apply(t,e)))}),t}function l(t){return m(t)&&!(t.length%2)||u(t)}function c(t){return"number"===typeof t&&t==t&&t%1===0}function u(t){if(null==t)return!1;if(t.constructor===Uint8Array)return!0;if("string"===typeof t)return!1;if(!c(t.length)||t.length<0)return!1;for(let e=0;e<t.length;e++){const n=t[e];if(!c(n)||n<0||n>=256)return!1}return!0}function h(t,e){if(e||(e={}),"number"===typeof t){s.checkSafeUint53(t,"invalid arrayify value");const e=[];while(t)e.unshift(255&t),t=parseInt(String(t/256));return 0===e.length&&e.push(0),a(new Uint8Array(e))}if(e.allowMissingPrefix&&"string"===typeof t&&"0x"!==t.substring(0,2)&&(t="0x"+t),o(t)&&(t=t.toHexString()),m(t)){let n=t.substring(2);n.length%2&&("left"===e.hexPad?n="0"+n:"right"===e.hexPad?n+="0":s.throwArgumentError("hex data is odd-length","value",t));const r=[];for(let t=0;t<n.length;t+=2)r.push(parseInt(n.substring(t,t+2),16));return a(new Uint8Array(r))}return u(t)?a(new Uint8Array(t)):s.throwArgumentError("invalid arrayify value","value",t)}function d(t){const e=t.map((t=>h(t))),n=e.reduce(((t,e)=>t+e.length),0),r=new Uint8Array(n);return e.reduce(((t,e)=>(r.set(e,t),t+e.length)),0),a(r)}function f(t){let e=h(t);if(0===e.length)return e;let n=0;while(n<e.length&&0===e[n])n++;return n&&(e=e.slice(n)),e}function p(t,e){t=h(t),t.length>e&&s.throwArgumentError("value out of range","value",arguments[0]);const n=new Uint8Array(e);return n.set(t,e-t.length),a(n)}function m(t,e){return!("string"!==typeof t||!t.match(/^0x[0-9A-Fa-f]*$/))&&(!e||t.length===2+2*e)}const g="0123456789abcdef";function v(t,e){if(e||(e={}),"number"===typeof t){s.checkSafeUint53(t,"invalid hexlify value");let e="";while(t)e=g[15&t]+e,t=Math.floor(t/16);return e.length?(e.length%2&&(e="0"+e),"0x"+e):"0x00"}if("bigint"===typeof t)return t=t.toString(16),t.length%2?"0x0"+t:"0x"+t;if(e.allowMissingPrefix&&"string"===typeof t&&"0x"!==t.substring(0,2)&&(t="0x"+t),o(t))return t.toHexString();if(m(t))return t.length%2&&("left"===e.hexPad?t="0x0"+t.substring(2):"right"===e.hexPad?t+="0":s.throwArgumentError("hex data is odd-length","value",t)),t.toLowerCase();if(u(t)){let e="0x";for(let n=0;n<t.length;n++){let r=t[n];e+=g[(240&r)>>4]+g[15&r]}return e}return s.throwArgumentError("invalid hexlify value","value",t)}function y(t){if("string"!==typeof t)t=v(t);else if(!m(t)||t.length%2)return null;return(t.length-2)/2}function x(t,e,n){return"string"!==typeof t?t=v(t):(!m(t)||t.length%2)&&s.throwArgumentError("invalid hexData","value",t),e=2+2*e,null!=n?"0x"+t.substring(e,2+2*n):"0x"+t.substring(e)}function b(t){let e="0x";return t.forEach((t=>{e+=v(t).substring(2)})),e}function w(t){const e=_(v(t,{hexPad:"left"}));return"0x"===e?"0x0":e}function _(t){"string"!==typeof t&&(t=v(t)),m(t)||s.throwArgumentError("invalid hex string","value",t),t=t.substring(2);let e=0;while(e<t.length&&"0"===t[e])e++;return"0x"+t.substring(e)}function M(t,e){"string"!==typeof t?t=v(t):m(t)||s.throwArgumentError("invalid hex string","value",t),t.length>2*e+2&&s.throwArgumentError("value out of range","value",arguments[1]);while(t.length<2*e+2)t="0x0"+t.substring(2);return t}function A(t){const e={r:"0x",s:"0x",_vs:"0x",recoveryParam:0,v:0,yParityAndS:"0x",compact:"0x"};if(l(t)){let n=h(t);64===n.length?(e.v=27+(n[32]>>7),n[32]&=127,e.r=v(n.slice(0,32)),e.s=v(n.slice(32,64))):65===n.length?(e.r=v(n.slice(0,32)),e.s=v(n.slice(32,64)),e.v=n[64]):s.throwArgumentError("invalid signature string","signature",t),e.v<27&&(0===e.v||1===e.v?e.v+=27:s.throwArgumentError("signature invalid v byte","signature",t)),e.recoveryParam=1-e.v%2,e.recoveryParam&&(n[32]|=128),e._vs=v(n.slice(32,64))}else{if(e.r=t.r,e.s=t.s,e.v=t.v,e.recoveryParam=t.recoveryParam,e._vs=t._vs,null!=e._vs){const n=p(h(e._vs),32);e._vs=v(n);const r=n[0]>=128?1:0;null==e.recoveryParam?e.recoveryParam=r:e.recoveryParam!==r&&s.throwArgumentError("signature recoveryParam mismatch _vs","signature",t),n[0]&=127;const i=v(n);null==e.s?e.s=i:e.s!==i&&s.throwArgumentError("signature v mismatch _vs","signature",t)}if(null==e.recoveryParam)null==e.v?s.throwArgumentError("signature missing v and recoveryParam","signature",t):0===e.v||1===e.v?e.recoveryParam=e.v:e.recoveryParam=1-e.v%2;else if(null==e.v)e.v=27+e.recoveryParam;else{const n=0===e.v||1===e.v?e.v:1-e.v%2;e.recoveryParam!==n&&s.throwArgumentError("signature recoveryParam mismatch v","signature",t)}null!=e.r&&m(e.r)?e.r=M(e.r,32):s.throwArgumentError("signature missing or invalid r","signature",t),null!=e.s&&m(e.s)?e.s=M(e.s,32):s.throwArgumentError("signature missing or invalid s","signature",t);const n=h(e.s);n[0]>=128&&s.throwArgumentError("signature s out of range","signature",t),e.recoveryParam&&(n[0]|=128);const r=v(n);e._vs&&(m(e._vs)||s.throwArgumentError("signature invalid _vs","signature",t),e._vs=M(e._vs,32)),null==e._vs?e._vs=r:e._vs!==r&&s.throwArgumentError("signature _vs mismatch v and s","signature",t)}return e.yParityAndS=e._vs,e.compact=e.r+e.yParityAndS.substring(2),e}},5554:function(t,e,n){"use strict";n.d(e,{Bz:function(){return a},_Y:function(){return s},fh:function(){return o},tL:function(){return i}});var r=n(3966);const i=r.O$.from(-1),s=r.O$.from(0),o=r.O$.from(1),a=r.O$.from("0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff")},6796:function(t,e,n){"use strict";n.d(e,{CH:function(){return zt}});n(1703),n(8675),n(7380),n(1118);var r=n(6482),i=n(3966),s=n(2224),o=n(8737);const a="abi/5.7.0",l=new o.Yd(a);function c(t){const e=[],n=function(t,r){if(Array.isArray(r))for(let s in r){const o=t.slice();o.push(s);try{n(o,r[s])}catch(i){e.push({path:o,error:i})}}};return n([],t),e}class u{constructor(t,e,n,r){this.name=t,this.type=e,this.localName=n,this.dynamic=r}_throwError(t,e){l.throwArgumentError(t,this.localName,e)}}class h{constructor(t){(0,s.zG)(this,"wordSize",t||32),this._data=[],this._dataLength=0,this._padding=new Uint8Array(t)}get data(){return(0,r.xs)(this._data)}get length(){return this._dataLength}_writeData(t){return this._data.push(t),this._dataLength+=t.length,t.length}appendWriter(t){return this._writeData((0,r.zo)(t._data))}writeBytes(t){let e=(0,r.lE)(t);const n=e.length%this.wordSize;return n&&(e=(0,r.zo)([e,this._padding.slice(n)])),this._writeData(e)}_getValue(t){let e=(0,r.lE)(i.O$.from(t));return e.length>this.wordSize&&l.throwError("value out-of-bounds",o.Yd.errors.BUFFER_OVERRUN,{length:this.wordSize,offset:e.length}),e.length%this.wordSize&&(e=(0,r.zo)([this._padding.slice(e.length%this.wordSize),e])),e}writeValue(t){return this._writeData(this._getValue(t))}writeUpdatableValue(){const t=this._data.length;return this._data.push(this._padding),this._dataLength+=this.wordSize,e=>{this._data[t]=this._getValue(e)}}}class d{constructor(t,e,n,i){(0,s.zG)(this,"_data",(0,r.lE)(t)),(0,s.zG)(this,"wordSize",e||32),(0,s.zG)(this,"_coerceFunc",n),(0,s.zG)(this,"allowLoose",i),this._offset=0}get data(){return(0,r.Dv)(this._data)}get consumed(){return this._offset}static coerce(t,e){let n=t.match("^u?int([0-9]+)$");return n&&parseInt(n[1])<=48&&(e=e.toNumber()),e}coerce(t,e){return this._coerceFunc?this._coerceFunc(t,e):d.coerce(t,e)}_peekBytes(t,e,n){let r=Math.ceil(e/this.wordSize)*this.wordSize;return this._offset+r>this._data.length&&(this.allowLoose&&n&&this._offset+e<=this._data.length?r=e:l.throwError("data out-of-bounds",o.Yd.errors.BUFFER_OVERRUN,{length:this._data.length,offset:this._offset+r})),this._data.slice(this._offset,this._offset+r)}subReader(t){return new d(this._data.slice(this._offset+t),this.wordSize,this._coerceFunc,this.allowLoose)}readBytes(t,e){let n=this._peekBytes(0,t,!!e);return this._offset+=n.length,n.slice(0,t)}readValue(){return i.O$.from(this.readBytes(this.wordSize))}}var f=n(594),p=n(8080),m=n(6502);class g extends u{constructor(t){super("address","address",t,!1)}defaultValue(){return"0x0000000000000000000000000000000000000000"}encode(t,e){try{e=(0,f.Kn)(e)}catch(n){this._throwError(n.message,e)}return t.writeValue(e)}decode(t){return(0,f.Kn)((0,r.$m)(t.readValue().toHexString(),20))}}class v extends u{constructor(t){super(t.name,t.type,void 0,t.dynamic),this.coder=t}defaultValue(){return this.coder.defaultValue()}encode(t,e){return this.coder.encode(t,e)}decode(t){return this.coder.decode(t)}}const y=new o.Yd(a);function x(t,e,n){let r=null;if(Array.isArray(n))r=n;else if(n&&"object"===typeof n){let t={};r=e.map((e=>{const r=e.localName;return r||y.throwError("cannot encode object for signature with missing names",o.Yd.errors.INVALID_ARGUMENT,{argument:"values",coder:e,value:n}),t[r]&&y.throwError("cannot encode object for signature with duplicate names",o.Yd.errors.INVALID_ARGUMENT,{argument:"values",coder:e,value:n}),t[r]=!0,n[r]}))}else y.throwArgumentError("invalid tuple value","tuple",n);e.length!==r.length&&y.throwArgumentError("types/value length mismatch","tuple",n);let i=new h(t.wordSize),s=new h(t.wordSize),a=[];e.forEach(((t,e)=>{let n=r[e];if(t.dynamic){let e=s.length;t.encode(s,n);let r=i.writeUpdatableValue();a.push((t=>{r(t+e)}))}else t.encode(i,n)})),a.forEach((t=>{t(i.length)}));let l=t.appendWriter(i);return l+=t.appendWriter(s),l}function b(t,e){let n=[],r=t.subReader(0);e.forEach((e=>{let i=null;if(e.dynamic){let n=t.readValue(),a=r.subReader(n.toNumber());try{i=e.decode(a)}catch(s){if(s.code===o.Yd.errors.BUFFER_OVERRUN)throw s;i=s,i.baseType=e.name,i.name=e.localName,i.type=e.type}}else try{i=e.decode(t)}catch(s){if(s.code===o.Yd.errors.BUFFER_OVERRUN)throw s;i=s,i.baseType=e.name,i.name=e.localName,i.type=e.type}void 0!=i&&n.push(i)}));const i=e.reduce(((t,e)=>{const n=e.localName;return n&&(t[n]||(t[n]=0),t[n]++),t}),{});e.forEach(((t,e)=>{let r=t.localName;if(!r||1!==i[r])return;if("length"===r&&(r="_length"),null!=n[r])return;const s=n[e];s instanceof Error?Object.defineProperty(n,r,{enumerable:!0,get:()=>{throw s}}):n[r]=s}));for(let s=0;s<n.length;s++){const t=n[s];t instanceof Error&&Object.defineProperty(n,s,{enumerable:!0,get:()=>{throw t}})}return Object.freeze(n)}class w extends u{constructor(t,e,n){const r=t.type+"["+(e>=0?e:"")+"]",i=-1===e||t.dynamic;super("array",r,n,i),this.coder=t,this.length=e}defaultValue(){const t=this.coder.defaultValue(),e=[];for(let n=0;n<this.length;n++)e.push(t);return e}encode(t,e){Array.isArray(e)||this._throwError("expected array value",e);let n=this.length;-1===n&&(n=e.length,t.writeValue(e.length)),y.checkArgumentCount(e.length,n,"coder array"+(this.localName?" "+this.localName:""));let r=[];for(let i=0;i<e.length;i++)r.push(this.coder);return x(t,r,e)}decode(t){let e=this.length;-1===e&&(e=t.readValue().toNumber(),32*e>t._data.length&&y.throwError("insufficient data length",o.Yd.errors.BUFFER_OVERRUN,{length:t._data.length,count:e}));let n=[];for(let r=0;r<e;r++)n.push(new v(this.coder));return t.coerce(this.name,b(t,n))}}class _ extends u{constructor(t){super("bool","bool",t,!1)}defaultValue(){return!1}encode(t,e){return t.writeValue(e?1:0)}decode(t){return t.coerce(this.type,!t.readValue().isZero())}}class M extends u{constructor(t,e){super(t,t,e,!0)}defaultValue(){return"0x"}encode(t,e){e=(0,r.lE)(e);let n=t.writeValue(e.length);return n+=t.writeBytes(e),n}decode(t){return t.readBytes(t.readValue().toNumber(),!0)}}class A extends M{constructor(t){super("bytes",t)}decode(t){return t.coerce(this.name,(0,r.Dv)(super.decode(t)))}}class S extends u{constructor(t,e){let n="bytes"+String(t);super(n,n,e,!1),this.size=t}defaultValue(){return"0x0000000000000000000000000000000000000000000000000000000000000000".substring(0,2+2*this.size)}encode(t,e){let n=(0,r.lE)(e);return n.length!==this.size&&this._throwError("incorrect data length",e),t.writeBytes(n)}decode(t){return t.coerce(this.name,(0,r.Dv)(t.readBytes(this.size)))}}class E extends u{constructor(t){super("null","",t,!1)}defaultValue(){return null}encode(t,e){return null!=e&&this._throwError("not null",e),t.writeBytes([])}decode(t){return t.readBytes(0),t.coerce(this.name,null)}}var T=n(5554);class C extends u{constructor(t,e,n){const r=(e?"int":"uint")+8*t;super(r,r,n,!1),this.size=t,this.signed=e}defaultValue(){return 0}encode(t,e){let n=i.O$.from(e),r=T.Bz.mask(8*t.wordSize);if(this.signed){let t=r.mask(8*this.size-1);(n.gt(t)||n.lt(t.add(T.fh).mul(T.tL)))&&this._throwError("value out-of-bounds",e)}else(n.lt(T._Y)||n.gt(r.mask(8*this.size)))&&this._throwError("value out-of-bounds",e);return n=n.toTwos(8*this.size).mask(8*this.size),this.signed&&(n=n.fromTwos(8*this.size).toTwos(8*t.wordSize)),t.writeValue(n)}decode(t){let e=t.readValue().mask(8*this.size);return this.signed&&(e=e.fromTwos(8*this.size)),t.coerce(this.name,e)}}var R=n(4469);class I extends M{constructor(t){super("string",t)}defaultValue(){return""}encode(t,e){return super.encode(t,(0,R.Y0)(e))}decode(t){return(0,R.ZN)(super.decode(t))}}class P extends u{constructor(t,e){let n=!1;const r=[];t.forEach((t=>{t.dynamic&&(n=!0),r.push(t.type)}));const i="tuple("+r.join(",")+")";super("tuple",i,e,n),this.coders=t}defaultValue(){const t=[];this.coders.forEach((e=>{t.push(e.defaultValue())}));const e=this.coders.reduce(((t,e)=>{const n=e.localName;return n&&(t[n]||(t[n]=0),t[n]++),t}),{});return this.coders.forEach(((n,r)=>{let i=n.localName;i&&1===e[i]&&("length"===i&&(i="_length"),null==t[i]&&(t[i]=t[r]))})),Object.freeze(t)}encode(t,e){return x(t,this.coders,e)}decode(t){return t.coerce(this.name,b(t,this.coders))}}const L=new o.Yd(a),N={};let k={calldata:!0,memory:!0,storage:!0},O={calldata:!0,memory:!0};function D(t,e){if("bytes"===t||"string"===t){if(k[e])return!0}else if("address"===t){if("payable"===e)return!0}else if((t.indexOf("[")>=0||"tuple"===t)&&O[e])return!0;return(k[e]||"payable"===e)&&L.throwArgumentError("invalid modifier","name",e),!1}function z(t,e){let n=t;function r(e){L.throwArgumentError(`unexpected character at position ${e}`,"param",t)}function i(t){let n={type:"",name:"",parent:t,state:{allowType:!0}};return e&&(n.indexed=!1),n}t=t.replace(/\s/g," ");let s={type:"",name:"",state:{allowType:!0}},o=s;for(let a=0;a<t.length;a++){let n=t[a];switch(n){case"(":o.state.allowType&&""===o.type?o.type="tuple":o.state.allowParams||r(a),o.state.allowType=!1,o.type=Q(o.type),o.components=[i(o)],o=o.components[0];break;case")":delete o.state,"indexed"===o.name&&(e||r(a),o.indexed=!0,o.name=""),D(o.type,o.name)&&(o.name=""),o.type=Q(o.type);let t=o;o=o.parent,o||r(a),delete t.parent,o.state.allowParams=!1,o.state.allowName=!0,o.state.allowArray=!0;break;case",":delete o.state,"indexed"===o.name&&(e||r(a),o.indexed=!0,o.name=""),D(o.type,o.name)&&(o.name=""),o.type=Q(o.type);let s=i(o.parent);o.parent.components.push(s),delete o.parent,o=s;break;case" ":o.state.allowType&&""!==o.type&&(o.type=Q(o.type),delete o.state.allowType,o.state.allowName=!0,o.state.allowParams=!0),o.state.allowName&&""!==o.name&&("indexed"===o.name?(e||r(a),o.indexed&&r(a),o.indexed=!0,o.name=""):D(o.type,o.name)?o.name="":o.state.allowName=!1);break;case"[":o.state.allowArray||r(a),o.type+=n,o.state.allowArray=!1,o.state.allowName=!1,o.state.readArray=!0;break;case"]":o.state.readArray||r(a),o.type+=n,o.state.readArray=!1,o.state.allowArray=!0,o.state.allowName=!0;break;default:o.state.allowType?(o.type+=n,o.state.allowParams=!0,o.state.allowArray=!0):o.state.allowName?(o.name+=n,delete o.state.allowArray):o.state.readArray?o.type+=n:r(a)}}return o.parent&&L.throwArgumentError("unexpected eof","param",t),delete s.state,"indexed"===o.name?(e||r(n.length-7),o.indexed&&r(n.length-7),o.indexed=!0,o.name=""):D(o.type,o.name)&&(o.name=""),s.type=Q(s.type),s}function F(t,e){for(let n in e)(0,s.zG)(t,n,e[n])}const U=Object.freeze({sighash:"sighash",minimal:"minimal",full:"full",json:"json"}),B=new RegExp(/^(.*)\[([0-9]*)\]$/);class G{constructor(t,e){t!==N&&L.throwError("use fromString",o.Yd.errors.UNSUPPORTED_OPERATION,{operation:"new ParamType()"}),F(this,e);let n=this.type.match(B);F(this,n?{arrayLength:parseInt(n[2]||"-1"),arrayChildren:G.fromObject({type:n[1],components:this.components}),baseType:"array"}:{arrayLength:null,arrayChildren:null,baseType:null!=this.components?"tuple":this.type}),this._isParamType=!0,Object.freeze(this)}format(t){if(t||(t=U.sighash),U[t]||L.throwArgumentError("invalid format type","format",t),t===U.json){let e={type:"tuple"===this.baseType?"tuple":this.type,name:this.name||void 0};return"boolean"===typeof this.indexed&&(e.indexed=this.indexed),this.components&&(e.components=this.components.map((e=>JSON.parse(e.format(t))))),JSON.stringify(e)}let e="";return"array"===this.baseType?(e+=this.arrayChildren.format(t),e+="["+(this.arrayLength<0?"":String(this.arrayLength))+"]"):"tuple"===this.baseType?(t!==U.sighash&&(e+=this.type),e+="("+this.components.map((e=>e.format(t))).join(t===U.full?", ":",")+")"):e+=this.type,t!==U.sighash&&(!0===this.indexed&&(e+=" indexed"),t===U.full&&this.name&&(e+=" "+this.name)),e}static from(t,e){return"string"===typeof t?G.fromString(t,e):G.fromObject(t)}static fromObject(t){return G.isParamType(t)?t:new G(N,{name:t.name||null,type:Q(t.type),indexed:null==t.indexed?null:!!t.indexed,components:t.components?t.components.map(G.fromObject):null})}static fromString(t,e){function n(t){return G.fromObject({name:t.name,type:t.type,indexed:t.indexed,components:t.components})}return n(z(t,!!e))}static isParamType(t){return!(null==t||!t._isParamType)}}function H(t,e){return nt(t).map((t=>G.fromString(t,e)))}class V{constructor(t,e){t!==N&&L.throwError("use a static from method",o.Yd.errors.UNSUPPORTED_OPERATION,{operation:"new Fragment()"}),F(this,e),this._isFragment=!0,Object.freeze(this)}static from(t){return V.isFragment(t)?t:"string"===typeof t?V.fromString(t):V.fromObject(t)}static fromObject(t){if(V.isFragment(t))return t;switch(t.type){case"function":return J.fromObject(t);case"event":return j.fromObject(t);case"constructor":return X.fromObject(t);case"error":return Z.fromObject(t);case"fallback":case"receive":return null}return L.throwArgumentError("invalid fragment object","value",t)}static fromString(t){return t=t.replace(/\s/g," "),t=t.replace(/\(/g," (").replace(/\)/g,") ").replace(/\s+/g," "),t=t.trim(),"event"===t.split(" ")[0]?j.fromString(t.substring(5).trim()):"function"===t.split(" ")[0]?J.fromString(t.substring(8).trim()):"constructor"===t.split("(")[0].trim()?X.fromString(t.trim()):"error"===t.split(" ")[0]?Z.fromString(t.substring(5).trim()):L.throwArgumentError("unsupported fragment","value",t)}static isFragment(t){return!(!t||!t._isFragment)}}class j extends V{format(t){if(t||(t=U.sighash),U[t]||L.throwArgumentError("invalid format type","format",t),t===U.json)return JSON.stringify({type:"event",anonymous:this.anonymous,name:this.name,inputs:this.inputs.map((e=>JSON.parse(e.format(t))))});let e="";return t!==U.sighash&&(e+="event "),e+=this.name+"("+this.inputs.map((e=>e.format(t))).join(t===U.full?", ":",")+") ",t!==U.sighash&&this.anonymous&&(e+="anonymous "),e.trim()}static from(t){return"string"===typeof t?j.fromString(t):j.fromObject(t)}static fromObject(t){if(j.isEventFragment(t))return t;"event"!==t.type&&L.throwArgumentError("invalid event object","value",t);const e={name:tt(t.name),anonymous:t.anonymous,inputs:t.inputs?t.inputs.map(G.fromObject):[],type:"event"};return new j(N,e)}static fromString(t){let e=t.match(et);e||L.throwArgumentError("invalid event string","value",t);let n=!1;return e[3].split(" ").forEach((t=>{switch(t.trim()){case"anonymous":n=!0;break;case"":break;default:L.warn("unknown modifier: "+t)}})),j.fromObject({name:e[1].trim(),anonymous:n,inputs:H(e[2],!0),type:"event"})}static isEventFragment(t){return t&&t._isFragment&&"event"===t.type}}function W(t,e){e.gas=null;let n=t.split("@");return 1!==n.length?(n.length>2&&L.throwArgumentError("invalid human-readable ABI signature","value",t),n[1].match(/^[0-9]+$/)||L.throwArgumentError("invalid human-readable ABI signature gas","value",t),e.gas=i.O$.from(n[1]),n[0]):t}function q(t,e){e.constant=!1,e.payable=!1,e.stateMutability="nonpayable",t.split(" ").forEach((t=>{switch(t.trim()){case"constant":e.constant=!0;break;case"payable":e.payable=!0,e.stateMutability="payable";break;case"nonpayable":e.payable=!1,e.stateMutability="nonpayable";break;case"pure":e.constant=!0,e.stateMutability="pure";break;case"view":e.constant=!0,e.stateMutability="view";break;case"external":case"public":case"":break;default:console.log("unknown modifier: "+t)}}))}function Y(t){let e={constant:!1,payable:!0,stateMutability:"payable"};return null!=t.stateMutability?(e.stateMutability=t.stateMutability,e.constant="view"===e.stateMutability||"pure"===e.stateMutability,null!=t.constant&&!!t.constant!==e.constant&&L.throwArgumentError("cannot have constant function with mutability "+e.stateMutability,"value",t),e.payable="payable"===e.stateMutability,null!=t.payable&&!!t.payable!==e.payable&&L.throwArgumentError("cannot have payable function with mutability "+e.stateMutability,"value",t)):null!=t.payable?(e.payable=!!t.payable,null!=t.constant||e.payable||"constructor"===t.type||L.throwArgumentError("unable to determine stateMutability","value",t),e.constant=!!t.constant,e.constant?e.stateMutability="view":e.stateMutability=e.payable?"payable":"nonpayable",e.payable&&e.constant&&L.throwArgumentError("cannot have constant payable function","value",t)):null!=t.constant?(e.constant=!!t.constant,e.payable=!e.constant,e.stateMutability=e.constant?"view":"payable"):"constructor"!==t.type&&L.throwArgumentError("unable to determine stateMutability","value",t),e}class X extends V{format(t){if(t||(t=U.sighash),U[t]||L.throwArgumentError("invalid format type","format",t),t===U.json)return JSON.stringify({type:"constructor",stateMutability:"nonpayable"!==this.stateMutability?this.stateMutability:void 0,payable:this.payable,gas:this.gas?this.gas.toNumber():void 0,inputs:this.inputs.map((e=>JSON.parse(e.format(t))))});t===U.sighash&&L.throwError("cannot format a constructor for sighash",o.Yd.errors.UNSUPPORTED_OPERATION,{operation:"format(sighash)"});let e="constructor("+this.inputs.map((e=>e.format(t))).join(t===U.full?", ":",")+") ";return this.stateMutability&&"nonpayable"!==this.stateMutability&&(e+=this.stateMutability+" "),e.trim()}static from(t){return"string"===typeof t?X.fromString(t):X.fromObject(t)}static fromObject(t){if(X.isConstructorFragment(t))return t;"constructor"!==t.type&&L.throwArgumentError("invalid constructor object","value",t);let e=Y(t);e.constant&&L.throwArgumentError("constructor cannot be constant","value",t);const n={name:null,type:t.type,inputs:t.inputs?t.inputs.map(G.fromObject):[],payable:e.payable,stateMutability:e.stateMutability,gas:t.gas?i.O$.from(t.gas):null};return new X(N,n)}static fromString(t){let e={type:"constructor"};t=W(t,e);let n=t.match(et);return n&&"constructor"===n[1].trim()||L.throwArgumentError("invalid constructor string","value",t),e.inputs=H(n[2].trim(),!1),q(n[3].trim(),e),X.fromObject(e)}static isConstructorFragment(t){return t&&t._isFragment&&"constructor"===t.type}}class J extends X{format(t){if(t||(t=U.sighash),U[t]||L.throwArgumentError("invalid format type","format",t),t===U.json)return JSON.stringify({type:"function",name:this.name,constant:this.constant,stateMutability:"nonpayable"!==this.stateMutability?this.stateMutability:void 0,payable:this.payable,gas:this.gas?this.gas.toNumber():void 0,inputs:this.inputs.map((e=>JSON.parse(e.format(t)))),outputs:this.outputs.map((e=>JSON.parse(e.format(t))))});let e="";return t!==U.sighash&&(e+="function "),e+=this.name+"("+this.inputs.map((e=>e.format(t))).join(t===U.full?", ":",")+") ",t!==U.sighash&&(this.stateMutability?"nonpayable"!==this.stateMutability&&(e+=this.stateMutability+" "):this.constant&&(e+="view "),this.outputs&&this.outputs.length&&(e+="returns ("+this.outputs.map((e=>e.format(t))).join(", ")+") "),null!=this.gas&&(e+="@"+this.gas.toString()+" ")),e.trim()}static from(t){return"string"===typeof t?J.fromString(t):J.fromObject(t)}static fromObject(t){if(J.isFunctionFragment(t))return t;"function"!==t.type&&L.throwArgumentError("invalid function object","value",t);let e=Y(t);const n={type:t.type,name:tt(t.name),constant:e.constant,inputs:t.inputs?t.inputs.map(G.fromObject):[],outputs:t.outputs?t.outputs.map(G.fromObject):[],payable:e.payable,stateMutability:e.stateMutability,gas:t.gas?i.O$.from(t.gas):null};return new J(N,n)}static fromString(t){let e={type:"function"};t=W(t,e);let n=t.split(" returns ");n.length>2&&L.throwArgumentError("invalid function string","value",t);let r=n[0].match(et);if(r||L.throwArgumentError("invalid function signature","value",t),e.name=r[1].trim(),e.name&&tt(e.name),e.inputs=H(r[2],!1),q(r[3].trim(),e),n.length>1){let r=n[1].match(et);""==r[1].trim()&&""==r[3].trim()||L.throwArgumentError("unexpected tokens","value",t),e.outputs=H(r[2],!1)}else e.outputs=[];return J.fromObject(e)}static isFunctionFragment(t){return t&&t._isFragment&&"function"===t.type}}function K(t){const e=t.format();return"Error(string)"!==e&&"Panic(uint256)"!==e||L.throwArgumentError(`cannot specify user defined ${e} error`,"fragment",t),t}class Z extends V{format(t){if(t||(t=U.sighash),U[t]||L.throwArgumentError("invalid format type","format",t),t===U.json)return JSON.stringify({type:"error",name:this.name,inputs:this.inputs.map((e=>JSON.parse(e.format(t))))});let e="";return t!==U.sighash&&(e+="error "),e+=this.name+"("+this.inputs.map((e=>e.format(t))).join(t===U.full?", ":",")+") ",e.trim()}static from(t){return"string"===typeof t?Z.fromString(t):Z.fromObject(t)}static fromObject(t){if(Z.isErrorFragment(t))return t;"error"!==t.type&&L.throwArgumentError("invalid error object","value",t);const e={type:t.type,name:tt(t.name),inputs:t.inputs?t.inputs.map(G.fromObject):[]};return K(new Z(N,e))}static fromString(t){let e={type:"error"},n=t.match(et);return n||L.throwArgumentError("invalid error signature","value",t),e.name=n[1].trim(),e.name&&tt(e.name),e.inputs=H(n[2],!1),K(Z.fromObject(e))}static isErrorFragment(t){return t&&t._isFragment&&"error"===t.type}}function Q(t){return t.match(/^uint($|[^1-9])/)?t="uint256"+t.substring(4):t.match(/^int($|[^1-9])/)&&(t="int256"+t.substring(3)),t}const $=new RegExp("^[a-zA-Z$_][a-zA-Z0-9$_]*$");function tt(t){return t&&t.match($)||L.throwArgumentError(`invalid identifier "${t}"`,"value",t),t}const et=new RegExp("^([^)(]*)\\((.*)\\)([^)(]*)$");function nt(t){t=t.trim();let e=[],n="",r=0;for(let i=0;i<t.length;i++){let s=t[i];","===s&&0===r?(e.push(n),n=""):(n+=s,"("===s?r++:")"===s&&(r--,-1===r&&L.throwArgumentError("unbalanced parenthesis","value",t)))}return n&&e.push(n),e}const rt=new o.Yd(a),it=new RegExp(/^bytes([0-9]*)$/),st=new RegExp(/^(u?int)([0-9]*)$/);class ot{constructor(t){(0,s.zG)(this,"coerceFunc",t||null)}_getCoder(t){switch(t.baseType){case"address":return new g(t.name);case"bool":return new _(t.name);case"string":return new I(t.name);case"bytes":return new A(t.name);case"array":return new w(this._getCoder(t.arrayChildren),t.arrayLength,t.name);case"tuple":return new P((t.components||[]).map((t=>this._getCoder(t))),t.name);case"":return new E(t.name)}let e=t.type.match(st);if(e){let n=parseInt(e[2]||"256");return(0===n||n>256||n%8!==0)&&rt.throwArgumentError("invalid "+e[1]+" bit length","param",t),new C(n/8,"int"===e[1],t.name)}if(e=t.type.match(it),e){let n=parseInt(e[1]);return(0===n||n>32)&&rt.throwArgumentError("invalid bytes length","param",t),new S(n,t.name)}return rt.throwArgumentError("invalid type","type",t.type)}_getWordSize(){return 32}_getReader(t,e){return new d(t,this._getWordSize(),this.coerceFunc,e)}_getWriter(){return new h(this._getWordSize())}getDefaultValue(t){const e=t.map((t=>this._getCoder(G.from(t)))),n=new P(e,"_");return n.defaultValue()}encode(t,e){t.length!==e.length&&rt.throwError("types/values length mismatch",o.Yd.errors.INVALID_ARGUMENT,{count:{types:t.length,values:e.length},value:{types:t,values:e}});const n=t.map((t=>this._getCoder(G.from(t)))),r=new P(n,"_"),i=this._getWriter();return r.encode(i,e),i.data}decode(t,e,n){const i=t.map((t=>this._getCoder(G.from(t)))),s=new P(i,"_");return s.decode(this._getReader((0,r.lE)(e),n))}}const at=new ot,lt=new o.Yd(a);class ct extends s.dk{}class ut extends s.dk{}class ht extends s.dk{}class dt extends s.dk{static isIndexed(t){return!(!t||!t._isIndexed)}}const ft={"0x08c379a0":{signature:"Error(string)",name:"Error",inputs:["string"],reason:!0},"0x4e487b71":{signature:"Panic(uint256)",name:"Panic",inputs:["uint256"]}};function pt(t,e){const n=new Error(`deferred error during ABI decoding triggered accessing ${t}`);return n.error=e,n}class mt{constructor(t){let e=[];e="string"===typeof t?JSON.parse(t):t,(0,s.zG)(this,"fragments",e.map((t=>V.from(t))).filter((t=>null!=t))),(0,s.zG)(this,"_abiCoder",(0,s.tu)(new.target,"getAbiCoder")()),(0,s.zG)(this,"functions",{}),(0,s.zG)(this,"errors",{}),(0,s.zG)(this,"events",{}),(0,s.zG)(this,"structs",{}),this.fragments.forEach((t=>{let e=null;switch(t.type){case"constructor":return this.deploy?void lt.warn("duplicate definition - constructor"):void(0,s.zG)(this,"deploy",t);case"function":e=this.functions;break;case"event":e=this.events;break;case"error":e=this.errors;break;default:return}let n=t.format();e[n]?lt.warn("duplicate definition - "+n):e[n]=t})),this.deploy||(0,s.zG)(this,"deploy",X.from({payable:!1,type:"constructor"})),(0,s.zG)(this,"_isInterface",!0)}format(t){t||(t=U.full),t===U.sighash&&lt.throwArgumentError("interface does not support formatting sighash","format",t);const e=this.fragments.map((e=>e.format(t)));return t===U.json?JSON.stringify(e.map((t=>JSON.parse(t)))):e}static getAbiCoder(){return at}static getAddress(t){return(0,f.Kn)(t)}static getSighash(t){return(0,r.p3)((0,p.id)(t.format()),0,4)}static getEventTopic(t){return(0,p.id)(t.format())}getFunction(t){if((0,r.A7)(t)){for(const e in this.functions)if(t===this.getSighash(e))return this.functions[e];lt.throwArgumentError("no matching function","sighash",t)}if(-1===t.indexOf("(")){const e=t.trim(),n=Object.keys(this.functions).filter((t=>t.split("(")[0]===e));return 0===n.length?lt.throwArgumentError("no matching function","name",e):n.length>1&&lt.throwArgumentError("multiple matching functions","name",e),this.functions[n[0]]}const e=this.functions[J.fromString(t).format()];return e||lt.throwArgumentError("no matching function","signature",t),e}getEvent(t){if((0,r.A7)(t)){const e=t.toLowerCase();for(const t in this.events)if(e===this.getEventTopic(t))return this.events[t];lt.throwArgumentError("no matching event","topichash",e)}if(-1===t.indexOf("(")){const e=t.trim(),n=Object.keys(this.events).filter((t=>t.split("(")[0]===e));return 0===n.length?lt.throwArgumentError("no matching event","name",e):n.length>1&&lt.throwArgumentError("multiple matching events","name",e),this.events[n[0]]}const e=this.events[j.fromString(t).format()];return e||lt.throwArgumentError("no matching event","signature",t),e}getError(t){if((0,r.A7)(t)){const e=(0,s.tu)(this.constructor,"getSighash");for(const n in this.errors){const r=this.errors[n];if(t===e(r))return this.errors[n]}lt.throwArgumentError("no matching error","sighash",t)}if(-1===t.indexOf("(")){const e=t.trim(),n=Object.keys(this.errors).filter((t=>t.split("(")[0]===e));return 0===n.length?lt.throwArgumentError("no matching error","name",e):n.length>1&&lt.throwArgumentError("multiple matching errors","name",e),this.errors[n[0]]}const e=this.errors[J.fromString(t).format()];return e||lt.throwArgumentError("no matching error","signature",t),e}getSighash(t){if("string"===typeof t)try{t=this.getFunction(t)}catch(e){try{t=this.getError(t)}catch(n){throw e}}return(0,s.tu)(this.constructor,"getSighash")(t)}getEventTopic(t){return"string"===typeof t&&(t=this.getEvent(t)),(0,s.tu)(this.constructor,"getEventTopic")(t)}_decodeParams(t,e){return this._abiCoder.decode(t,e)}_encodeParams(t,e){return this._abiCoder.encode(t,e)}encodeDeploy(t){return this._encodeParams(this.deploy.inputs,t||[])}decodeErrorResult(t,e){"string"===typeof t&&(t=this.getError(t));const n=(0,r.lE)(e);return(0,r.Dv)(n.slice(0,4))!==this.getSighash(t)&&lt.throwArgumentError(`data signature does not match error ${t.name}.`,"data",(0,r.Dv)(n)),this._decodeParams(t.inputs,n.slice(4))}encodeErrorResult(t,e){return"string"===typeof t&&(t=this.getError(t)),(0,r.Dv)((0,r.zo)([this.getSighash(t),this._encodeParams(t.inputs,e||[])]))}decodeFunctionData(t,e){"string"===typeof t&&(t=this.getFunction(t));const n=(0,r.lE)(e);return(0,r.Dv)(n.slice(0,4))!==this.getSighash(t)&&lt.throwArgumentError(`data signature does not match function ${t.name}.`,"data",(0,r.Dv)(n)),this._decodeParams(t.inputs,n.slice(4))}encodeFunctionData(t,e){return"string"===typeof t&&(t=this.getFunction(t)),(0,r.Dv)((0,r.zo)([this.getSighash(t),this._encodeParams(t.inputs,e||[])]))}decodeFunctionResult(t,e){"string"===typeof t&&(t=this.getFunction(t));let n=(0,r.lE)(e),i=null,s="",a=null,l=null,c=null;switch(n.length%this._abiCoder._getWordSize()){case 0:try{return this._abiCoder.decode(t.outputs,n)}catch(u){}break;case 4:{const t=(0,r.Dv)(n.slice(0,4)),e=ft[t];if(e)a=this._abiCoder.decode(e.inputs,n.slice(4)),l=e.name,c=e.signature,e.reason&&(i=a[0]),"Error"===l?s=`; VM Exception while processing transaction: reverted with reason string ${JSON.stringify(a[0])}`:"Panic"===l&&(s=`; VM Exception while processing transaction: reverted with panic code ${a[0]}`);else try{const e=this.getError(t);a=this._abiCoder.decode(e.inputs,n.slice(4)),l=e.name,c=e.format()}catch(u){}break}}return lt.throwError("call revert exception"+s,o.Yd.errors.CALL_EXCEPTION,{method:t.format(),data:(0,r.Dv)(e),errorArgs:a,errorName:l,errorSignature:c,reason:i})}encodeFunctionResult(t,e){return"string"===typeof t&&(t=this.getFunction(t)),(0,r.Dv)(this._abiCoder.encode(t.outputs,e||[]))}encodeFilterTopics(t,e){"string"===typeof t&&(t=this.getEvent(t)),e.length>t.inputs.length&&lt.throwError("too many arguments for "+t.format(),o.Yd.errors.UNEXPECTED_ARGUMENT,{argument:"values",value:e});let n=[];t.anonymous||n.push(this.getEventTopic(t));const s=(t,e)=>"string"===t.type?(0,p.id)(e):"bytes"===t.type?(0,m.w)((0,r.Dv)(e)):("bool"===t.type&&"boolean"===typeof e&&(e=e?"0x01":"0x00"),t.type.match(/^u?int/)&&(e=i.O$.from(e).toHexString()),"address"===t.type&&this._abiCoder.encode(["address"],[e]),(0,r.$m)((0,r.Dv)(e),32));e.forEach(((e,r)=>{let i=t.inputs[r];i.indexed?null==e?n.push(null):"array"===i.baseType||"tuple"===i.baseType?lt.throwArgumentError("filtering with tuples or arrays not supported","contract."+i.name,e):Array.isArray(e)?n.push(e.map((t=>s(i,t)))):n.push(s(i,e)):null!=e&&lt.throwArgumentError("cannot filter non-indexed parameters; must be null","contract."+i.name,e)}));while(n.length&&null===n[n.length-1])n.pop();return n}encodeEventLog(t,e){"string"===typeof t&&(t=this.getEvent(t));const n=[],r=[],i=[];return t.anonymous||n.push(this.getEventTopic(t)),e.length!==t.inputs.length&&lt.throwArgumentError("event arguments/values mismatch","values",e),t.inputs.forEach(((t,s)=>{const o=e[s];if(t.indexed)if("string"===t.type)n.push((0,p.id)(o));else if("bytes"===t.type)n.push((0,m.w)(o));else{if("tuple"===t.baseType||"array"===t.baseType)throw new Error("not implemented");n.push(this._abiCoder.encode([t.type],[o]))}else r.push(t),i.push(o)})),{data:this._abiCoder.encode(r,i),topics:n}}decodeEventLog(t,e,n){if("string"===typeof t&&(t=this.getEvent(t)),null!=n&&!t.anonymous){let e=this.getEventTopic(t);(0,r.A7)(n[0],32)&&n[0].toLowerCase()===e||lt.throwError("fragment/topic mismatch",o.Yd.errors.INVALID_ARGUMENT,{argument:"topics[0]",expected:e,value:n[0]}),n=n.slice(1)}let i=[],s=[],a=[];t.inputs.forEach(((t,e)=>{t.indexed?"string"===t.type||"bytes"===t.type||"tuple"===t.baseType||"array"===t.baseType?(i.push(G.fromObject({type:"bytes32",name:t.name})),a.push(!0)):(i.push(t),a.push(!1)):(s.push(t),a.push(!1))}));let l=null!=n?this._abiCoder.decode(i,(0,r.zo)(n)):null,c=this._abiCoder.decode(s,e,!0),u=[],h=0,d=0;t.inputs.forEach(((t,e)=>{if(t.indexed)if(null==l)u[e]=new dt({_isIndexed:!0,hash:null});else if(a[e])u[e]=new dt({_isIndexed:!0,hash:l[d++]});else try{u[e]=l[d++]}catch(n){u[e]=n}else try{u[e]=c[h++]}catch(n){u[e]=n}if(t.name&&null==u[t.name]){const n=u[e];n instanceof Error?Object.defineProperty(u,t.name,{enumerable:!0,get:()=>{throw pt(`property ${JSON.stringify(t.name)}`,n)}}):u[t.name]=n}}));for(let r=0;r<u.length;r++){const t=u[r];t instanceof Error&&Object.defineProperty(u,r,{enumerable:!0,get:()=>{throw pt(`index ${r}`,t)}})}return Object.freeze(u)}parseTransaction(t){let e=this.getFunction(t.data.substring(0,10).toLowerCase());return e?new ut({args:this._abiCoder.decode(e.inputs,"0x"+t.data.substring(10)),functionFragment:e,name:e.name,signature:e.format(),sighash:this.getSighash(e),value:i.O$.from(t.value||"0")}):null}parseLog(t){let e=this.getEvent(t.topics[0]);return!e||e.anonymous?null:new ct({eventFragment:e,name:e.name,signature:e.format(),topic:this.getEventTopic(e),args:this.decodeEventLog(e,t.data,t.topics)})}parseError(t){const e=(0,r.Dv)(t);let n=this.getError(e.substring(0,10).toLowerCase());return n?new ht({args:this._abiCoder.decode(n.inputs,"0x"+e.substring(10)),errorFragment:n,name:n.name,signature:n.format(),sighash:this.getSighash(n)}):null}static isInterface(t){return!(!t||!t._isInterface)}}var gt=n(4868),vt=n(1865),yt=n(8019);const xt="contracts/5.7.0";var bt=function(t,e,n,r){function i(t){return t instanceof n?t:new n((function(e){e(t)}))}return new(n||(n=Promise))((function(n,s){function o(t){try{l(r.next(t))}catch(e){s(e)}}function a(t){try{l(r["throw"](t))}catch(e){s(e)}}function l(t){t.done?n(t.value):i(t.value).then(o,a)}l((r=r.apply(t,e||[])).next())}))};const wt=new o.Yd(xt);function _t(t,e){return bt(this,void 0,void 0,(function*(){const n=yield e;"string"!==typeof n&&wt.throwArgumentError("invalid address or ENS name","name",n);try{return(0,f.Kn)(n)}catch(i){}t||wt.throwError("a provider or signer is needed to resolve ENS names",o.Yd.errors.UNSUPPORTED_OPERATION,{operation:"resolveName"});const r=yield t.resolveName(n);return null==r&&wt.throwArgumentError("resolver or addr is not configured for ENS name","name",n),r}))}function Mt(t,e,n){return bt(this,void 0,void 0,(function*(){return Array.isArray(n)?yield Promise.all(n.map(((n,r)=>Mt(t,Array.isArray(e)?e[r]:e[n.name],n)))):"address"===n.type?yield _t(t,e):"tuple"===n.type?yield Mt(t,e,n.components):"array"===n.baseType?Array.isArray(e)?yield Promise.all(e.map((e=>Mt(t,e,n.arrayChildren)))):Promise.reject(wt.makeError("invalid value for array",o.Yd.errors.INVALID_ARGUMENT,{argument:"value",value:e})):e}))}function At(t,e,n){return bt(this,void 0,void 0,(function*(){let a={};n.length===e.inputs.length+1&&"object"===typeof n[n.length-1]&&(a=(0,s.DC)(n.pop())),wt.checkArgumentCount(n.length,e.inputs.length,"passed to contract"),t.signer?a.from?a.from=(0,s.mE)({override:_t(t.signer,a.from),signer:t.signer.getAddress()}).then((t=>bt(this,void 0,void 0,(function*(){return(0,f.Kn)(t.signer)!==t.override&&wt.throwError("Contract with a Signer cannot override from",o.Yd.errors.UNSUPPORTED_OPERATION,{operation:"overrides.from"}),t.override})))):a.from=t.signer.getAddress():a.from&&(a.from=_t(t.provider,a.from));const l=yield(0,s.mE)({args:Mt(t.signer||t.provider,n,e.inputs),address:t.resolvedAddress,overrides:(0,s.mE)(a)||{}}),c=t.interface.encodeFunctionData(e,l.args),u={data:c,to:l.address},h=l.overrides;if(null!=h.nonce&&(u.nonce=i.O$.from(h.nonce).toNumber()),null!=h.gasLimit&&(u.gasLimit=i.O$.from(h.gasLimit)),null!=h.gasPrice&&(u.gasPrice=i.O$.from(h.gasPrice)),null!=h.maxFeePerGas&&(u.maxFeePerGas=i.O$.from(h.maxFeePerGas)),null!=h.maxPriorityFeePerGas&&(u.maxPriorityFeePerGas=i.O$.from(h.maxPriorityFeePerGas)),null!=h.from&&(u.from=h.from),null!=h.type&&(u.type=h.type),null!=h.accessList&&(u.accessList=(0,yt.z7)(h.accessList)),null==u.gasLimit&&null!=e.gas){let t=21e3;const n=(0,r.lE)(c);for(let e=0;e<n.length;e++)t+=4,n[e]&&(t+=64);u.gasLimit=i.O$.from(e.gas).add(t)}if(h.value){const t=i.O$.from(h.value);t.isZero()||e.payable||wt.throwError("non-payable method cannot override value",o.Yd.errors.UNSUPPORTED_OPERATION,{operation:"overrides.value",value:a.value}),u.value=t}h.customData&&(u.customData=(0,s.DC)(h.customData)),h.ccipReadEnabled&&(u.ccipReadEnabled=!!h.ccipReadEnabled),delete a.nonce,delete a.gasLimit,delete a.gasPrice,delete a.from,delete a.value,delete a.type,delete a.accessList,delete a.maxFeePerGas,delete a.maxPriorityFeePerGas,delete a.customData,delete a.ccipReadEnabled;const d=Object.keys(a).filter((t=>null!=a[t]));return d.length&&wt.throwError(`cannot override ${d.map((t=>JSON.stringify(t))).join(",")}`,o.Yd.errors.UNSUPPORTED_OPERATION,{operation:"overrides",overrides:d}),u}))}function St(t,e){return function(...n){return At(t,e,n)}}function Et(t,e){const n=t.signer||t.provider;return function(...r){return bt(this,void 0,void 0,(function*(){n||wt.throwError("estimate require a provider or signer",o.Yd.errors.UNSUPPORTED_OPERATION,{operation:"estimateGas"});const i=yield At(t,e,r);return yield n.estimateGas(i)}))}}function Tt(t,e){const n=e.wait.bind(e);e.wait=e=>n(e).then((e=>(e.events=e.logs.map((n=>{let r=(0,s.p$)(n),i=null;try{i=t.interface.parseLog(n)}catch(o){}return i&&(r.args=i.args,r.decode=(e,n)=>t.interface.decodeEventLog(i.eventFragment,e,n),r.event=i.name,r.eventSignature=i.signature),r.removeListener=()=>t.provider,r.getBlock=()=>t.provider.getBlock(e.blockHash),r.getTransaction=()=>t.provider.getTransaction(e.transactionHash),r.getTransactionReceipt=()=>Promise.resolve(e),r})),e)))}function Ct(t,e,n){const r=t.signer||t.provider;return function(...i){return bt(this,void 0,void 0,(function*(){let a;if(i.length===e.inputs.length+1&&"object"===typeof i[i.length-1]){const t=(0,s.DC)(i.pop());null!=t.blockTag&&(a=yield t.blockTag),delete t.blockTag,i.push(t)}null!=t.deployTransaction&&(yield t._deployed(a));const l=yield At(t,e,i),c=yield r.call(l,a);try{let r=t.interface.decodeFunctionResult(e,c);return n&&1===e.outputs.length&&(r=r[0]),r}catch(u){throw u.code===o.Yd.errors.CALL_EXCEPTION&&(u.address=t.address,u.args=i,u.transaction=l),u}}))}}function Rt(t,e){return function(...n){return bt(this,void 0,void 0,(function*(){t.signer||wt.throwError("sending a transaction requires a signer",o.Yd.errors.UNSUPPORTED_OPERATION,{operation:"sendTransaction"}),null!=t.deployTransaction&&(yield t._deployed());const r=yield At(t,e,n),i=yield t.signer.sendTransaction(r);return Tt(t,i),i}))}}function It(t,e,n){return e.constant?Ct(t,e,n):Rt(t,e)}function Pt(t){return!t.address||null!=t.topics&&0!==t.topics.length?(t.address||"*")+"@"+(t.topics?t.topics.map((t=>Array.isArray(t)?t.join("|"):t)).join(":"):""):"*"}class Lt{constructor(t,e){(0,s.zG)(this,"tag",t),(0,s.zG)(this,"filter",e),this._listeners=[]}addListener(t,e){this._listeners.push({listener:t,once:e})}removeListener(t){let e=!1;this._listeners=this._listeners.filter((n=>!(!e&&n.listener===t)||(e=!0,!1)))}removeAllListeners(){this._listeners=[]}listeners(){return this._listeners.map((t=>t.listener))}listenerCount(){return this._listeners.length}run(t){const e=this.listenerCount();return this._listeners=this._listeners.filter((e=>{const n=t.slice();return setTimeout((()=>{e.listener.apply(this,n)}),0),!e.once})),e}prepareEvent(t){}getEmit(t){return[t]}}class Nt extends Lt{constructor(){super("error",null)}}class kt extends Lt{constructor(t,e,n,r){const i={address:t};let o=e.getEventTopic(n);r?(o!==r[0]&&wt.throwArgumentError("topic mismatch","topics",r),i.topics=r.slice()):i.topics=[o],super(Pt(i),i),(0,s.zG)(this,"address",t),(0,s.zG)(this,"interface",e),(0,s.zG)(this,"fragment",n)}prepareEvent(t){super.prepareEvent(t),t.event=this.fragment.name,t.eventSignature=this.fragment.format(),t.decode=(t,e)=>this.interface.decodeEventLog(this.fragment,t,e);try{t.args=this.interface.decodeEventLog(this.fragment,t.data,t.topics)}catch(e){t.args=null,t.decodeError=e}}getEmit(t){const e=c(t.args);if(e.length)throw e[0].error;const n=(t.args||[]).slice();return n.push(t),n}}class Ot extends Lt{constructor(t,e){super("*",{address:t}),(0,s.zG)(this,"address",t),(0,s.zG)(this,"interface",e)}prepareEvent(t){super.prepareEvent(t);try{const e=this.interface.parseLog(t);t.event=e.name,t.eventSignature=e.signature,t.decode=(t,n)=>this.interface.decodeEventLog(e.eventFragment,t,n),t.args=e.args}catch(e){}}}class Dt{constructor(t,e,n){(0,s.zG)(this,"interface",(0,s.tu)(new.target,"getInterface")(e)),null==n?((0,s.zG)(this,"provider",null),(0,s.zG)(this,"signer",null)):vt.E.isSigner(n)?((0,s.zG)(this,"provider",n.provider||null),(0,s.zG)(this,"signer",n)):gt.zt.isProvider(n)?((0,s.zG)(this,"provider",n),(0,s.zG)(this,"signer",null)):wt.throwArgumentError("invalid signer or provider","signerOrProvider",n),(0,s.zG)(this,"callStatic",{}),(0,s.zG)(this,"estimateGas",{}),(0,s.zG)(this,"functions",{}),(0,s.zG)(this,"populateTransaction",{}),(0,s.zG)(this,"filters",{});{const t={};Object.keys(this.interface.events).forEach((e=>{const n=this.interface.events[e];(0,s.zG)(this.filters,e,((...t)=>({address:this.address,topics:this.interface.encodeFilterTopics(n,t)}))),t[n.name]||(t[n.name]=[]),t[n.name].push(e)})),Object.keys(t).forEach((e=>{const n=t[e];1===n.length?(0,s.zG)(this.filters,e,this.filters[n[0]]):wt.warn(`Duplicate definition of ${e} (${n.join(", ")})`)}))}if((0,s.zG)(this,"_runningEvents",{}),(0,s.zG)(this,"_wrappedEmits",{}),null==t&&wt.throwArgumentError("invalid contract address or ENS name","addressOrName",t),(0,s.zG)(this,"address",t),this.provider)(0,s.zG)(this,"resolvedAddress",_t(this.provider,t));else try{(0,s.zG)(this,"resolvedAddress",Promise.resolve((0,f.Kn)(t)))}catch(a){wt.throwError("provider is required to use ENS name as contract address",o.Yd.errors.UNSUPPORTED_OPERATION,{operation:"new Contract"})}this.resolvedAddress.catch((t=>{}));const r={},i={};Object.keys(this.interface.functions).forEach((t=>{const e=this.interface.functions[t];if(i[t])wt.warn(`Duplicate ABI entry for ${JSON.stringify(t)}`);else{i[t]=!0;{const n=e.name;r[`%${n}`]||(r[`%${n}`]=[]),r[`%${n}`].push(t)}null==this[t]&&(0,s.zG)(this,t,It(this,e,!0)),null==this.functions[t]&&(0,s.zG)(this.functions,t,It(this,e,!1)),null==this.callStatic[t]&&(0,s.zG)(this.callStatic,t,Ct(this,e,!0)),null==this.populateTransaction[t]&&(0,s.zG)(this.populateTransaction,t,St(this,e)),null==this.estimateGas[t]&&(0,s.zG)(this.estimateGas,t,Et(this,e))}})),Object.keys(r).forEach((t=>{const e=r[t];if(e.length>1)return;t=t.substring(1);const n=e[0];try{null==this[t]&&(0,s.zG)(this,t,this[n])}catch(i){}null==this.functions[t]&&(0,s.zG)(this.functions,t,this.functions[n]),null==this.callStatic[t]&&(0,s.zG)(this.callStatic,t,this.callStatic[n]),null==this.populateTransaction[t]&&(0,s.zG)(this.populateTransaction,t,this.populateTransaction[n]),null==this.estimateGas[t]&&(0,s.zG)(this.estimateGas,t,this.estimateGas[n])}))}static getContractAddress(t){return(0,f.CR)(t)}static getInterface(t){return mt.isInterface(t)?t:new mt(t)}deployed(){return this._deployed()}_deployed(t){return this._deployedPromise||(this.deployTransaction?this._deployedPromise=this.deployTransaction.wait().then((()=>this)):this._deployedPromise=this.provider.getCode(this.address,t).then((t=>("0x"===t&&wt.throwError("contract not deployed",o.Yd.errors.UNSUPPORTED_OPERATION,{contractAddress:this.address,operation:"getDeployed"}),this)))),this._deployedPromise}fallback(t){this.signer||wt.throwError("sending a transactions require a signer",o.Yd.errors.UNSUPPORTED_OPERATION,{operation:"sendTransaction(fallback)"});const e=(0,s.DC)(t||{});return["from","to"].forEach((function(t){null!=e[t]&&wt.throwError("cannot override "+t,o.Yd.errors.UNSUPPORTED_OPERATION,{operation:t})})),e.to=this.resolvedAddress,this.deployed().then((()=>this.signer.sendTransaction(e)))}connect(t){"string"===typeof t&&(t=new vt.b(t,this.provider));const e=new this.constructor(this.address,this.interface,t);return this.deployTransaction&&(0,s.zG)(e,"deployTransaction",this.deployTransaction),e}attach(t){return new this.constructor(t,this.interface,this.signer||this.provider)}static isIndexed(t){return dt.isIndexed(t)}_normalizeRunningEvent(t){return this._runningEvents[t.tag]?this._runningEvents[t.tag]:t}_getRunningEvent(t){if("string"===typeof t){if("error"===t)return this._normalizeRunningEvent(new Nt);if("event"===t)return this._normalizeRunningEvent(new Lt("event",null));if("*"===t)return this._normalizeRunningEvent(new Ot(this.address,this.interface));const e=this.interface.getEvent(t);return this._normalizeRunningEvent(new kt(this.address,this.interface,e))}if(t.topics&&t.topics.length>0){try{const e=t.topics[0];if("string"!==typeof e)throw new Error("invalid topic");const n=this.interface.getEvent(e);return this._normalizeRunningEvent(new kt(this.address,this.interface,n,t.topics))}catch(e){}const n={address:this.address,topics:t.topics};return this._normalizeRunningEvent(new Lt(Pt(n),n))}return this._normalizeRunningEvent(new Ot(this.address,this.interface))}_checkRunningEvents(t){if(0===t.listenerCount()){delete this._runningEvents[t.tag];const e=this._wrappedEmits[t.tag];e&&t.filter&&(this.provider.off(t.filter,e),delete this._wrappedEmits[t.tag])}}_wrapEvent(t,e,n){const r=(0,s.p$)(e);return r.removeListener=()=>{n&&(t.removeListener(n),this._checkRunningEvents(t))},r.getBlock=()=>this.provider.getBlock(e.blockHash),r.getTransaction=()=>this.provider.getTransaction(e.transactionHash),r.getTransactionReceipt=()=>this.provider.getTransactionReceipt(e.transactionHash),t.prepareEvent(r),r}_addEventListener(t,e,n){if(this.provider||wt.throwError("events require a provider or a signer with a provider",o.Yd.errors.UNSUPPORTED_OPERATION,{operation:"once"}),t.addListener(e,n),this._runningEvents[t.tag]=t,!this._wrappedEmits[t.tag]){const n=n=>{let r=this._wrapEvent(t,n,e);if(null==r.decodeError)try{const e=t.getEmit(r);this.emit(t.filter,...e)}catch(i){r.decodeError=i.error}null!=t.filter&&this.emit("event",r),null!=r.decodeError&&this.emit("error",r.decodeError,r)};this._wrappedEmits[t.tag]=n,null!=t.filter&&this.provider.on(t.filter,n)}}queryFilter(t,e,n){const i=this._getRunningEvent(t),o=(0,s.DC)(i.filter);return"string"===typeof e&&(0,r.A7)(e,32)?(null!=n&&wt.throwArgumentError("cannot specify toBlock with blockhash","toBlock",n),o.blockHash=e):(o.fromBlock=null!=e?e:0,o.toBlock=null!=n?n:"latest"),this.provider.getLogs(o).then((t=>t.map((t=>this._wrapEvent(i,t,null)))))}on(t,e){return this._addEventListener(this._getRunningEvent(t),e,!1),this}once(t,e){return this._addEventListener(this._getRunningEvent(t),e,!0),this}emit(t,...e){if(!this.provider)return!1;const n=this._getRunningEvent(t),r=n.run(e)>0;return this._checkRunningEvents(n),r}listenerCount(t){return this.provider?null==t?Object.keys(this._runningEvents).reduce(((t,e)=>t+this._runningEvents[e].listenerCount()),0):this._getRunningEvent(t).listenerCount():0}listeners(t){if(!this.provider)return[];if(null==t){const t=[];for(let e in this._runningEvents)this._runningEvents[e].listeners().forEach((e=>{t.push(e)}));return t}return this._getRunningEvent(t).listeners()}removeAllListeners(t){if(!this.provider)return this;if(null==t){for(const t in this._runningEvents){const e=this._runningEvents[t];e.removeAllListeners(),this._checkRunningEvents(e)}return this}const e=this._getRunningEvent(t);return e.removeAllListeners(),this._checkRunningEvents(e),this}off(t,e){if(!this.provider)return this;const n=this._getRunningEvent(t);return n.removeListener(e),this._checkRunningEvents(n),this}removeListener(t,e){return this.off(t,e)}}class zt extends Dt{}},8080:function(t,e,n){"use strict";n.d(e,{id:function(){return s}});var r=n(6502),i=n(4469);function s(t){return(0,r.w)((0,i.Y0)(t))}},6502:function(t,e,n){"use strict";n.d(e,{w:function(){return o}});var r=n(9893),i=n.n(r),s=n(6482);function o(t){return"0x"+i().keccak_256((0,s.lE)(t))}},8737:function(t,e,n){"use strict";n.d(e,{Yd:function(){return p}});n(1703),n(8675),n(7380),n(1118);const r="logger/5.7.0";let i=!1,s=!1;const o={debug:1,default:2,info:2,warning:3,error:4,off:5};let a=o["default"],l=null;function c(){try{const t=[];if(["NFD","NFC","NFKD","NFKC"].forEach((e=>{try{if("test"!=="test".normalize(e))throw new Error("bad normalize")}catch(n){t.push(e)}})),t.length)throw new Error("missing "+t.join(", "));if(String.fromCharCode(233).normalize("NFD")!==String.fromCharCode(101,769))throw new Error("broken implementation")}catch(t){return t.message}return null}const u=c();var h,d;(function(t){t["DEBUG"]="DEBUG",t["INFO"]="INFO",t["WARNING"]="WARNING",t["ERROR"]="ERROR",t["OFF"]="OFF"})(h||(h={})),function(t){t["UNKNOWN_ERROR"]="UNKNOWN_ERROR",t["NOT_IMPLEMENTED"]="NOT_IMPLEMENTED",t["UNSUPPORTED_OPERATION"]="UNSUPPORTED_OPERATION",t["NETWORK_ERROR"]="NETWORK_ERROR",t["SERVER_ERROR"]="SERVER_ERROR",t["TIMEOUT"]="TIMEOUT",t["BUFFER_OVERRUN"]="BUFFER_OVERRUN",t["NUMERIC_FAULT"]="NUMERIC_FAULT",t["MISSING_NEW"]="MISSING_NEW",t["INVALID_ARGUMENT"]="INVALID_ARGUMENT",t["MISSING_ARGUMENT"]="MISSING_ARGUMENT",t["UNEXPECTED_ARGUMENT"]="UNEXPECTED_ARGUMENT",t["CALL_EXCEPTION"]="CALL_EXCEPTION",t["INSUFFICIENT_FUNDS"]="INSUFFICIENT_FUNDS",t["NONCE_EXPIRED"]="NONCE_EXPIRED",t["REPLACEMENT_UNDERPRICED"]="REPLACEMENT_UNDERPRICED",t["UNPREDICTABLE_GAS_LIMIT"]="UNPREDICTABLE_GAS_LIMIT",t["TRANSACTION_REPLACED"]="TRANSACTION_REPLACED",t["ACTION_REJECTED"]="ACTION_REJECTED"}(d||(d={}));const f="0123456789abcdef";class p{constructor(t){Object.defineProperty(this,"version",{enumerable:!0,value:t,writable:!1})}_log(t,e){const n=t.toLowerCase();null==o[n]&&this.throwArgumentError("invalid log level name","logLevel",t),a>o[n]||console.log.apply(console,e)}debug(...t){this._log(p.levels.DEBUG,t)}info(...t){this._log(p.levels.INFO,t)}warn(...t){this._log(p.levels.WARNING,t)}makeError(t,e,n){if(s)return this.makeError("censored error",e,{});e||(e=p.errors.UNKNOWN_ERROR),n||(n={});const r=[];Object.keys(n).forEach((t=>{const e=n[t];try{if(e instanceof Uint8Array){let n="";for(let t=0;t<e.length;t++)n+=f[e[t]>>4],n+=f[15&e[t]];r.push(t+"=Uint8Array(0x"+n+")")}else r.push(t+"="+JSON.stringify(e))}catch(a){r.push(t+"="+JSON.stringify(n[t].toString()))}})),r.push(`code=${e}`),r.push(`version=${this.version}`);const i=t;let o="";switch(e){case d.NUMERIC_FAULT:{o="NUMERIC_FAULT";const e=t;switch(e){case"overflow":case"underflow":case"division-by-zero":o+="-"+e;break;case"negative-power":case"negative-width":o+="-unsupported";break;case"unbound-bitwise-result":o+="-unbound-result";break}break}case d.CALL_EXCEPTION:case d.INSUFFICIENT_FUNDS:case d.MISSING_NEW:case d.NONCE_EXPIRED:case d.REPLACEMENT_UNDERPRICED:case d.TRANSACTION_REPLACED:case d.UNPREDICTABLE_GAS_LIMIT:o=e;break}o&&(t+=" [ See: https://links.ethers.org/v5-errors-"+o+" ]"),r.length&&(t+=" ("+r.join(", ")+")");const a=new Error(t);return a.reason=i,a.code=e,Object.keys(n).forEach((function(t){a[t]=n[t]})),a}throwError(t,e,n){throw this.makeError(t,e,n)}throwArgumentError(t,e,n){return this.throwError(t,p.errors.INVALID_ARGUMENT,{argument:e,value:n})}assert(t,e,n,r){t||this.throwError(e,n,r)}assertArgument(t,e,n,r){t||this.throwArgumentError(e,n,r)}checkNormalize(t){null==t&&(t="platform missing String.prototype.normalize"),u&&this.throwError("platform missing String.prototype.normalize",p.errors.UNSUPPORTED_OPERATION,{operation:"String.prototype.normalize",form:u})}checkSafeUint53(t,e){"number"===typeof t&&(null==e&&(e="value not safe"),(t<0||t>=9007199254740991)&&this.throwError(e,p.errors.NUMERIC_FAULT,{operation:"checkSafeInteger",fault:"out-of-safe-range",value:t}),t%1&&this.throwError(e,p.errors.NUMERIC_FAULT,{operation:"checkSafeInteger",fault:"non-integer",value:t}))}checkArgumentCount(t,e,n){n=n?": "+n:"",t<e&&this.throwError("missing argument"+n,p.errors.MISSING_ARGUMENT,{count:t,expectedCount:e}),t>e&&this.throwError("too many arguments"+n,p.errors.UNEXPECTED_ARGUMENT,{count:t,expectedCount:e})}checkNew(t,e){t!==Object&&null!=t||this.throwError("missing new",p.errors.MISSING_NEW,{name:e.name})}checkAbstract(t,e){t===e?this.throwError("cannot instantiate abstract class "+JSON.stringify(e.name)+" directly; use a sub-class",p.errors.UNSUPPORTED_OPERATION,{name:t.name,operation:"new"}):t!==Object&&null!=t||this.throwError("missing new",p.errors.MISSING_NEW,{name:e.name})}static globalLogger(){return l||(l=new p(r)),l}static setCensorship(t,e){if(!t&&e&&this.globalLogger().throwError("cannot permanently disable censorship",p.errors.UNSUPPORTED_OPERATION,{operation:"setCensorship"}),i){if(!t)return;this.globalLogger().throwError("error censorship permanent",p.errors.UNSUPPORTED_OPERATION,{operation:"setCensorship"})}s=!!t,i=!!e}static setLogLevel(t){const e=o[t.toLowerCase()];null!=e?a=e:p.globalLogger().warn("invalid log level - "+t)}static from(t){return new p(t)}}p.errors=d,p.levels=h},2224:function(t,e,n){"use strict";n.d(e,{dk:function(){return g},uj:function(){return u},p$:function(){return m},zG:function(){return a},tu:function(){return l},mE:function(){return c},DC:function(){return h}});var r=n(8737);const i="properties/5.7.0";var s=function(t,e,n,r){function i(t){return t instanceof n?t:new n((function(e){e(t)}))}return new(n||(n=Promise))((function(n,s){function o(t){try{l(r.next(t))}catch(e){s(e)}}function a(t){try{l(r["throw"](t))}catch(e){s(e)}}function l(t){t.done?n(t.value):i(t.value).then(o,a)}l((r=r.apply(t,e||[])).next())}))};const o=new r.Yd(i);function a(t,e,n){Object.defineProperty(t,e,{enumerable:!0,value:n,writable:!1})}function l(t,e){for(let n=0;n<32;n++){if(t[e])return t[e];if(!t.prototype||"object"!==typeof t.prototype)break;t=Object.getPrototypeOf(t.prototype).constructor}return null}function c(t){return s(this,void 0,void 0,(function*(){const e=Object.keys(t).map((e=>{const n=t[e];return Promise.resolve(n).then((t=>({key:e,value:t})))})),n=yield Promise.all(e);return n.reduce(((t,e)=>(t[e.key]=e.value,t)),{})}))}function u(t,e){t&&"object"===typeof t||o.throwArgumentError("invalid object","object",t),Object.keys(t).forEach((n=>{e[n]||o.throwArgumentError("invalid object key - "+n,"transaction:"+n,t)}))}function h(t){const e={};for(const n in t)e[n]=t[n];return e}const d={bigint:!0,boolean:!0,function:!0,number:!0,string:!0};function f(t){if(void 0===t||null===t||d[typeof t])return!0;if(Array.isArray(t)||"object"===typeof t){if(!Object.isFrozen(t))return!1;const n=Object.keys(t);for(let r=0;r<n.length;r++){let i=null;try{i=t[n[r]]}catch(e){continue}if(!f(i))return!1}return!0}return o.throwArgumentError("Cannot deepCopy "+typeof t,"object",t)}function p(t){if(f(t))return t;if(Array.isArray(t))return Object.freeze(t.map((t=>m(t))));if("object"===typeof t){const e={};for(const n in t){const r=t[n];void 0!==r&&a(e,n,m(r))}return e}return o.throwArgumentError("Cannot deepCopy "+typeof t,"object",t)}function m(t){return p(t)}class g{constructor(t){for(const e in t)this[e]=m(t[e])}}},6141:function(t,e,n){"use strict";n.d(e,{Q:function(){return Ue}});n(1703);var r=n(2224),i=n(8737);const s="providers/5.7.0";var o=n(1865),a=n(3966),l=n(6482),c=(n(8675),n(7380),n(1118),n(594)),u=n(6502);const h="hash/5.7.0";var d=n(8080),f=function(t,e,n,r){function i(t){return t instanceof n?t:new n((function(e){e(t)}))}return new(n||(n=Promise))((function(n,s){function o(t){try{l(r.next(t))}catch(e){s(e)}}function a(t){try{l(r["throw"](t))}catch(e){s(e)}}function l(t){t.done?n(t.value):i(t.value).then(o,a)}l((r=r.apply(t,e||[])).next())}))};const p=new i.Yd(h),m=new Uint8Array(32);m.fill(0);const g=a.O$.from(-1),v=a.O$.from(0),y=a.O$.from(1),x=a.O$.from("0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff");function b(t){const e=(0,l.lE)(t),n=e.length%32;return n?(0,l.xs)([e,m.slice(n)]):(0,l.Dv)(e)}const w=(0,l.$m)(y.toHexString(),32),_=(0,l.$m)(v.toHexString(),32),M={name:"string",version:"string",chainId:"uint256",verifyingContract:"address",salt:"bytes32"},A=["name","version","chainId","verifyingContract","salt"];function S(t){return function(e){return"string"!==typeof e&&p.throwArgumentError(`invalid domain value for ${JSON.stringify(t)}`,`domain.${t}`,e),e}}const E={name:S("name"),version:S("version"),chainId:function(t){try{return a.O$.from(t).toString()}catch(e){}return p.throwArgumentError('invalid domain value for "chainId"',"domain.chainId",t)},verifyingContract:function(t){try{return(0,c.Kn)(t).toLowerCase()}catch(e){}return p.throwArgumentError('invalid domain value "verifyingContract"',"domain.verifyingContract",t)},salt:function(t){try{const e=(0,l.lE)(t);if(32!==e.length)throw new Error("bad length");return(0,l.Dv)(e)}catch(e){}return p.throwArgumentError('invalid domain value "salt"',"domain.salt",t)}};function T(t){{const e=t.match(/^(u?)int(\d*)$/);if(e){const n=""===e[1],r=parseInt(e[2]||"256");(r%8!==0||r>256||e[2]&&e[2]!==String(r))&&p.throwArgumentError("invalid numeric width","type",t);const i=x.mask(n?r-1:r),s=n?i.add(y).mul(g):v;return function(e){const n=a.O$.from(e);return(n.lt(s)||n.gt(i))&&p.throwArgumentError(`value out-of-bounds for ${t}`,"value",e),(0,l.$m)(n.toTwos(256).toHexString(),32)}}}{const e=t.match(/^bytes(\d+)$/);if(e){const n=parseInt(e[1]);return(0===n||n>32||e[1]!==String(n))&&p.throwArgumentError("invalid bytes width","type",t),function(e){const r=(0,l.lE)(e);return r.length!==n&&p.throwArgumentError(`invalid length for ${t}`,"value",e),b(e)}}}switch(t){case"address":return function(t){return(0,l.$m)((0,c.Kn)(t),32)};case"bool":return function(t){return t?w:_};case"bytes":return function(t){return(0,u.w)(t)};case"string":return function(t){return(0,d.id)(t)}}return null}function C(t,e){return`${t}(${e.map((({name:t,type:e})=>e+" "+t)).join(",")})`}class R{constructor(t){(0,r.zG)(this,"types",Object.freeze((0,r.p$)(t))),(0,r.zG)(this,"_encoderCache",{}),(0,r.zG)(this,"_types",{});const e={},n={},i={};Object.keys(t).forEach((t=>{e[t]={},n[t]=[],i[t]={}}));for(const r in t){const i={};t[r].forEach((s=>{i[s.name]&&p.throwArgumentError(`duplicate variable name ${JSON.stringify(s.name)} in ${JSON.stringify(r)}`,"types",t),i[s.name]=!0;const o=s.type.match(/^([^\x5b]*)(\x5b|$)/)[1];o===r&&p.throwArgumentError(`circular type reference to ${JSON.stringify(o)}`,"types",t);const a=T(o);a||(n[o]||p.throwArgumentError(`unknown type ${JSON.stringify(o)}`,"types",t),n[o].push(r),e[r][o]=!0)}))}const s=Object.keys(n).filter((t=>0===n[t].length));function o(r,s){s[r]&&p.throwArgumentError(`circular type reference to ${JSON.stringify(r)}`,"types",t),s[r]=!0,Object.keys(e[r]).forEach((t=>{n[t]&&(o(t,s),Object.keys(s).forEach((e=>{i[e][t]=!0})))})),delete s[r]}0===s.length?p.throwArgumentError("missing primary type","types",t):s.length>1&&p.throwArgumentError(`ambiguous primary types or unused types: ${s.map((t=>JSON.stringify(t))).join(", ")}`,"types",t),(0,r.zG)(this,"primaryType",s[0]),o(this.primaryType,{});for(const r in i){const e=Object.keys(i[r]);e.sort(),this._types[r]=C(r,t[r])+e.map((e=>C(e,t[e]))).join("")}}getEncoder(t){let e=this._encoderCache[t];return e||(e=this._encoderCache[t]=this._getEncoder(t)),e}_getEncoder(t){{const e=T(t);if(e)return e}const e=t.match(/^(.*)(\x5b(\d*)\x5d)$/);if(e){const t=e[1],n=this.getEncoder(t),r=parseInt(e[3]);return e=>{r>=0&&e.length!==r&&p.throwArgumentError("array length mismatch; expected length ${ arrayLength }","value",e);let i=e.map(n);return this._types[t]&&(i=i.map(u.w)),(0,u.w)((0,l.xs)(i))}}const n=this.types[t];if(n){const e=(0,d.id)(this._types[t]);return t=>{const r=n.map((({name:e,type:n})=>{const r=this.getEncoder(n)(t[e]);return this._types[n]?(0,u.w)(r):r}));return r.unshift(e),(0,l.xs)(r)}}return p.throwArgumentError(`unknown type: ${t}`,"type",t)}encodeType(t){const e=this._types[t];return e||p.throwArgumentError(`unknown type: ${JSON.stringify(t)}`,"name",t),e}encodeData(t,e){return this.getEncoder(t)(e)}hashStruct(t,e){return(0,u.w)(this.encodeData(t,e))}encode(t){return this.encodeData(this.primaryType,t)}hash(t){return this.hashStruct(this.primaryType,t)}_visit(t,e,n){{const r=T(t);if(r)return n(t,e)}const r=t.match(/^(.*)(\x5b(\d*)\x5d)$/);if(r){const t=r[1],i=parseInt(r[3]);return i>=0&&e.length!==i&&p.throwArgumentError("array length mismatch; expected length ${ arrayLength }","value",e),e.map((e=>this._visit(t,e,n)))}const i=this.types[t];return i?i.reduce(((t,{name:r,type:i})=>(t[r]=this._visit(i,e[r],n),t)),{}):p.throwArgumentError(`unknown type: ${t}`,"type",t)}visit(t,e){return this._visit(this.primaryType,t,e)}static from(t){return new R(t)}static getPrimaryType(t){return R.from(t).primaryType}static hashStruct(t,e,n){return R.from(e).hashStruct(t,n)}static hashDomain(t){const e=[];for(const n in t){const r=M[n];r||p.throwArgumentError(`invalid typed-data domain key: ${JSON.stringify(n)}`,"domain",t),e.push({name:n,type:r})}return e.sort(((t,e)=>A.indexOf(t.name)-A.indexOf(e.name))),R.hashStruct("EIP712Domain",{EIP712Domain:e},t)}static encode(t,e,n){return(0,l.xs)(["0x1901",R.hashDomain(t),R.from(e).hash(n)])}static hash(t,e,n){return(0,u.w)(R.encode(t,e,n))}static resolveNames(t,e,n,i){return f(this,void 0,void 0,(function*(){t=(0,r.DC)(t);const s={};t.verifyingContract&&!(0,l.A7)(t.verifyingContract,20)&&(s[t.verifyingContract]="0x");const o=R.from(e);o.visit(n,((t,e)=>("address"!==t||(0,l.A7)(e,20)||(s[e]="0x"),e)));for(const t in s)s[t]=yield i(t);return t.verifyingContract&&s[t.verifyingContract]&&(t.verifyingContract=s[t.verifyingContract]),n=o.visit(n,((t,e)=>"address"===t&&s[e]?s[e]:e)),{domain:t,value:n}}))}static getPayload(t,e,n){R.hashDomain(t);const i={},s=[];A.forEach((e=>{const n=t[e];null!=n&&(i[e]=E[e](n),s.push({name:e,type:M[e]}))}));const o=R.from(e),c=(0,r.DC)(e);return c.EIP712Domain?p.throwArgumentError("types must not contain EIP712Domain type","types.EIP712Domain",e):c.EIP712Domain=s,o.encode(n),{types:c,domain:i,primaryType:o.primaryType,message:o.visit(n,((t,e)=>{if(t.match(/^bytes(\d*)/))return(0,l.Dv)((0,l.lE)(e));if(t.match(/^u?int/))return a.O$.from(e).toString();switch(t){case"address":return e.toLowerCase();case"bool":return!!e;case"string":return"string"!==typeof e&&p.throwArgumentError("invalid string","value",e),e}return p.throwArgumentError("unsupported type","type",t)}))}}}var I=n(4469),P=n(8019);n(2801);function L(t){t=atob(t);const e=[];for(let n=0;n<t.length;n++)e.push(t.charCodeAt(n));return(0,l.lE)(e)}function N(t){t=(0,l.lE)(t);let e="";for(let n=0;n<t.length;n++)e+=String.fromCharCode(t[n]);return btoa(e)}const k="web/5.7.0";var O=function(t,e,n,r){function i(t){return t instanceof n?t:new n((function(e){e(t)}))}return new(n||(n=Promise))((function(n,s){function o(t){try{l(r.next(t))}catch(e){s(e)}}function a(t){try{l(r["throw"](t))}catch(e){s(e)}}function l(t){t.done?n(t.value):i(t.value).then(o,a)}l((r=r.apply(t,e||[])).next())}))};function D(t,e){return O(this,void 0,void 0,(function*(){null==e&&(e={});const n={method:e.method||"GET",headers:e.headers||{},body:e.body||void 0};if(!0!==e.skipFetchSetup&&(n.mode="cors",n.cache="no-cache",n.credentials="same-origin",n.redirect="follow",n.referrer="client"),null!=e.fetchOptions){const t=e.fetchOptions;t.mode&&(n.mode=t.mode),t.cache&&(n.cache=t.cache),t.credentials&&(n.credentials=t.credentials),t.redirect&&(n.redirect=t.redirect),t.referrer&&(n.referrer=t.referrer)}const r=yield fetch(t,n),i=yield r.arrayBuffer(),s={};return r.headers.forEach?r.headers.forEach(((t,e)=>{s[e.toLowerCase()]=t})):r.headers.keys().forEach((t=>{s[t.toLowerCase()]=r.headers.get(t)})),{headers:s,statusCode:r.status,statusMessage:r.statusText,body:(0,l.lE)(new Uint8Array(i))}}))}var z=function(t,e,n,r){function i(t){return t instanceof n?t:new n((function(e){e(t)}))}return new(n||(n=Promise))((function(n,s){function o(t){try{l(r.next(t))}catch(e){s(e)}}function a(t){try{l(r["throw"](t))}catch(e){s(e)}}function l(t){t.done?n(t.value):i(t.value).then(o,a)}l((r=r.apply(t,e||[])).next())}))};const F=new i.Yd(k);function U(t){return new Promise((e=>{setTimeout(e,t)}))}function B(t,e){if(null==t)return null;if("string"===typeof t)return t;if((0,l.Zq)(t)){if(e&&("text"===e.split("/")[0]||"application/json"===e.split(";")[0].trim()))try{return(0,I.ZN)(t)}catch(n){}return(0,l.Dv)(t)}return t}function G(t,e,n){const s="object"===typeof t&&null!=t.throttleLimit?t.throttleLimit:12;F.assertArgument(s>0&&s%1===0,"invalid connection throttle limit","connection.throttleLimit",s);const o="object"===typeof t?t.throttleCallback:null,a="object"===typeof t&&"number"===typeof t.throttleSlotInterval?t.throttleSlotInterval:100;F.assertArgument(a>0&&a%1===0,"invalid connection throttle slot interval","connection.throttleSlotInterval",a);const l="object"===typeof t&&!!t.errorPassThrough,c={};let u=null;const h={method:"GET"};let d=!1,f=12e4;if("string"===typeof t)u=t;else if("object"===typeof t){if(null!=t&&null!=t.url||F.throwArgumentError("missing URL","connection.url",t),u=t.url,"number"===typeof t.timeout&&t.timeout>0&&(f=t.timeout),t.headers)for(const e in t.headers)c[e.toLowerCase()]={key:e,value:String(t.headers[e])},["if-none-match","if-modified-since"].indexOf(e.toLowerCase())>=0&&(d=!0);if(h.allowGzip=!!t.allowGzip,null!=t.user&&null!=t.password){"https:"!==u.substring(0,6)&&!0!==t.allowInsecureAuthentication&&F.throwError("basic authentication requires a secure https url",i.Yd.errors.INVALID_ARGUMENT,{argument:"url",url:u,user:t.user,password:"[REDACTED]"});const e=t.user+":"+t.password;c["authorization"]={key:"Authorization",value:"Basic "+N((0,I.Y0)(e))}}null!=t.skipFetchSetup&&(h.skipFetchSetup=!!t.skipFetchSetup),null!=t.fetchOptions&&(h.fetchOptions=(0,r.DC)(t.fetchOptions))}const p=new RegExp("^data:([a-z0-9-]+/[a-z0-9-]+);base64,(.*)$","i"),m=u?u.match(p):null;if(m)try{const t={statusCode:200,statusMessage:"OK",headers:{"content-type":m[1]},body:L(m[2])};let e=t.body;return n&&(e=n(t.body,t)),Promise.resolve(e)}catch(x){F.throwError("processing response error",i.Yd.errors.SERVER_ERROR,{body:B(m[1],m[2]),error:x,requestBody:null,requestMethod:"GET",url:u})}e&&(h.method="POST",h.body=e,null==c["content-type"]&&(c["content-type"]={key:"Content-Type",value:"application/octet-stream"}),null==c["content-length"]&&(c["content-length"]={key:"Content-Length",value:String(e.length)}));const g={};Object.keys(c).forEach((t=>{const e=c[t];g[e.key]=e.value})),h.headers=g;const v=function(){let t=null;const e=new Promise((function(e,n){f&&(t=setTimeout((()=>{null!=t&&(t=null,n(F.makeError("timeout",i.Yd.errors.TIMEOUT,{requestBody:B(h.body,g["content-type"]),requestMethod:h.method,timeout:f,url:u})))}),f))})),n=function(){null!=t&&(clearTimeout(t),t=null)};return{promise:e,cancel:n}}(),y=function(){return z(this,void 0,void 0,(function*(){for(let t=0;t<s;t++){let e=null;try{if(e=yield D(u,h),t<s)if(301===e.statusCode||302===e.statusCode){const t=e.headers.location||"";if("GET"===h.method&&t.match(/^https:/)){u=e.headers.location;continue}}else if(429===e.statusCode){let n=!0;if(o&&(n=yield o(t,u)),n){let n=0;const r=e.headers["retry-after"];n="string"===typeof r&&r.match(/^[1-9][0-9]*$/)?1e3*parseInt(r):a*parseInt(String(Math.random()*Math.pow(2,t))),yield U(n);continue}}}catch(x){e=x.response,null==e&&(v.cancel(),F.throwError("missing response",i.Yd.errors.SERVER_ERROR,{requestBody:B(h.body,g["content-type"]),requestMethod:h.method,serverError:x,url:u}))}let r=e.body;if(d&&304===e.statusCode?r=null:!l&&(e.statusCode<200||e.statusCode>=300)&&(v.cancel(),F.throwError("bad response",i.Yd.errors.SERVER_ERROR,{status:e.statusCode,headers:e.headers,body:B(r,e.headers?e.headers["content-type"]:null),requestBody:B(h.body,g["content-type"]),requestMethod:h.method,url:u})),n)try{const t=yield n(r,e);return v.cancel(),t}catch(x){if(x.throttleRetry&&t<s){let e=!0;if(o&&(e=yield o(t,u)),e){const e=a*parseInt(String(Math.random()*Math.pow(2,t)));yield U(e);continue}}v.cancel(),F.throwError("processing response error",i.Yd.errors.SERVER_ERROR,{body:B(r,e.headers?e.headers["content-type"]:null),error:x,requestBody:B(h.body,g["content-type"]),requestMethod:h.method,url:u})}return v.cancel(),r}return F.throwError("failed response",i.Yd.errors.SERVER_ERROR,{requestBody:B(h.body,g["content-type"]),requestMethod:h.method,url:u})}))}();return Promise.race([v.promise,y])}function H(t,e,n){let s=(t,e)=>{let r=null;if(null!=t)try{r=JSON.parse((0,I.ZN)(t))}catch(s){F.throwError("invalid JSON",i.Yd.errors.SERVER_ERROR,{body:t,error:s})}return n&&(r=n(r,e)),r},o=null;if(null!=e){o=(0,I.Y0)(e);const n="string"===typeof t?{url:t}:(0,r.DC)(t);if(n.headers){const t=0!==Object.keys(n.headers).filter((t=>"content-type"===t.toLowerCase())).length;t||(n.headers=(0,r.DC)(n.headers),n.headers["content-type"]="application/json")}else n.headers={"content-type":"application/json"};t=n}return G(t,o,s)}function V(t,e){return e||(e={}),e=(0,r.DC)(e),null==e.floor&&(e.floor=0),null==e.ceiling&&(e.ceiling=1e4),null==e.interval&&(e.interval=250),new Promise((function(n,r){let i=null,s=!1;const o=()=>!s&&(s=!0,i&&clearTimeout(i),!0);e.timeout&&(i=setTimeout((()=>{o()&&r(new Error("timeout"))}),e.timeout));const a=e.retryLimit;let l=0;function c(){return t().then((function(t){if(void 0!==t)o()&&n(t);else if(e.oncePoll)e.oncePoll.once("poll",c);else if(e.onceBlock)e.onceBlock.once("block",c);else if(!s){if(l++,l>a)return void(o()&&r(new Error("retry limit reached")));let t=e.interval*parseInt(String(Math.random()*Math.pow(2,l)));t<e.floor&&(t=e.floor),t>e.ceiling&&(t=e.ceiling),setTimeout(c,t)}return null}),(function(t){o()&&r(t)}))}c()}))}var j=n(4868);class W{constructor(t){(0,r.zG)(this,"alphabet",t),(0,r.zG)(this,"base",t.length),(0,r.zG)(this,"_alphabetMap",{}),(0,r.zG)(this,"_leader",t.charAt(0));for(let e=0;e<t.length;e++)this._alphabetMap[t.charAt(e)]=e}encode(t){let e=(0,l.lE)(t);if(0===e.length)return"";let n=[0];for(let i=0;i<e.length;++i){let t=e[i];for(let e=0;e<n.length;++e)t+=n[e]<<8,n[e]=t%this.base,t=t/this.base|0;while(t>0)n.push(t%this.base),t=t/this.base|0}let r="";for(let i=0;0===e[i]&&i<e.length-1;++i)r+=this._leader;for(let i=n.length-1;i>=0;--i)r+=this.alphabet[n[i]];return r}decode(t){if("string"!==typeof t)throw new TypeError("Expected String");let e=[];if(0===t.length)return new Uint8Array(e);e.push(0);for(let n=0;n<t.length;n++){let r=this._alphabetMap[t[n]];if(void 0===r)throw new Error("Non-base"+this.base+" character");let i=r;for(let t=0;t<e.length;++t)i+=e[t]*this.base,e[t]=255&i,i>>=8;while(i>0)e.push(255&i),i>>=8}for(let n=0;t[n]===this._leader&&n<t.length-1;++n)e.push(0);return(0,l.lE)(new Uint8Array(e.reverse()))}}new W("abcdefghijklmnopqrstuvwxyz234567");const q=new W("123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"),Y="0x0000000000000000000000000000000000000000000000000000000000000000";function X(t,e){null==e&&(e=1);const n=[],r=n.forEach,i=function(t,e){r.call(t,(function(t){e>0&&Array.isArray(t)?i(t,e-1):n.push(t)}))};return i(t,e),n}function J(t){const e={};for(let n=0;n<t.length;n++){const r=t[n];e[r[0]]=r[1]}return e}function K(t){let e=0;function n(){return t[e++]<<8|t[e++]}let r=n(),i=1,s=[0,1];for(let w=1;w<r;w++)s.push(i+=n());let o=n(),a=e;e+=o;let l=0,c=0;function u(){return 0==l&&(c=c<<8|t[e++],l=8),c>>--l&1}const h=31,d=Math.pow(2,h),f=d>>>1,p=f>>1,m=d-1;let g=0;for(let w=0;w<h;w++)g=g<<1|u();let v=[],y=0,x=d;while(1){let t=Math.floor(((g-y+1)*i-1)/x),e=0,n=r;while(n-e>1){let r=e+n>>>1;t<s[r]?n=r:e=r}if(0==e)break;v.push(e);let o=y+Math.floor(x*s[e]/i),a=y+Math.floor(x*s[e+1]/i)-1;while(0==((o^a)&f))g=g<<1&m|u(),o=o<<1&m,a=a<<1&m|1;while(o&~a&p)g=g&f|g<<1&m>>>1|u(),o=o<<1^f,a=(a^f)<<1|f|1;y=o,x=1+a-o}let b=r-4;return v.map((e=>{switch(e-b){case 3:return b+65792+(t[a++]<<16|t[a++]<<8|t[a++]);case 2:return b+256+(t[a++]<<8|t[a++]);case 1:return b+t[a++];default:return e-1}}))}function Z(t){let e=0;return()=>t[e++]}function Q(t){return Z(K(t))}function $(t){return 1&t?~t>>1:t>>1}function tt(t,e){let n=Array(t);for(let r=0;r<t;r++)n[r]=1+e();return n}function et(t,e){let n=Array(t);for(let r=0,i=-1;r<t;r++)n[r]=i+=1+e();return n}function nt(t,e){let n=Array(t);for(let r=0,i=0;r<t;r++)n[r]=i+=$(e());return n}function rt(t,e){let n=et(t(),t),r=t(),i=et(r,t),s=tt(r,t);for(let o=0;o<r;o++)for(let t=0;t<s[o];t++)n.push(i[o]+t);return e?n.map((t=>e[t])):n}function it(t){let e=[];while(1){let n=t();if(0==n)break;e.push(at(n,t))}while(1){let n=t()-1;if(n<0)break;e.push(lt(n,t))}return J(X(e))}function st(t){let e=[];while(1){let n=t();if(0==n)break;e.push(n)}return e}function ot(t,e,n){let r=Array(t).fill(void 0).map((()=>[]));for(let i=0;i<e;i++)nt(t,n).forEach(((t,e)=>r[e].push(t)));return r}function at(t,e){let n=1+e(),r=e(),i=st(e),s=ot(i.length,1+t,e);return X(s.map(((t,e)=>{const s=t[0],o=t.slice(1);return Array(i[e]).fill(void 0).map(((t,e)=>{let i=e*r;return[s+e*n,o.map((t=>t+i))]}))})))}function lt(t,e){let n=1+e(),r=ot(n,1+t,e);return r.map((t=>[t[0],t.slice(1)]))}function ct(t){let e=rt(t).sort(((t,e)=>t-e));return n();function n(){let r=[];while(1){let i=rt(t,e);if(0==i.length)break;r.push({set:new Set(i),node:n()})}r.sort(((t,e)=>e.set.size-t.set.size));let i=t(),s=i%3;i=i/3|0;let o=!!(1&i);i>>=1;let a=1==i,l=2==i;return{branches:r,valid:s,fe0f:o,save:a,check:l}}}function ut(){return Q(L("AEQF2AO2DEsA2wIrAGsBRABxAN8AZwCcAEwAqgA0AGwAUgByADcATAAVAFYAIQAyACEAKAAYAFgAGwAjABQAMAAmADIAFAAfABQAKwATACoADgAbAA8AHQAYABoAGQAxADgALAAoADwAEwA9ABMAGgARAA4ADwAWABMAFgAIAA8AHgQXBYMA5BHJAS8JtAYoAe4AExozi0UAH21tAaMnBT8CrnIyhrMDhRgDygIBUAEHcoFHUPe8AXBjAewCjgDQR8IICIcEcQLwATXCDgzvHwBmBoHNAqsBdBcUAykgDhAMShskMgo8AY8jqAQfAUAfHw8BDw87MioGlCIPBwZCa4ELatMAAMspJVgsDl8AIhckSg8XAHdvTwBcIQEiDT4OPhUqbyECAEoAS34Aej8Ybx83JgT/Xw8gHxZ/7w8RICxPHA9vBw+Pfw8PHwAPFv+fAsAvCc8vEr8ivwD/EQ8Bol8OEBa/A78hrwAPCU8vESNvvwWfHwNfAVoDHr+ZAAED34YaAdJPAK7PLwSEgDLHAGo1Pz8Pvx9fUwMrpb8O/58VTzAPIBoXIyQJNF8hpwIVAT8YGAUADDNBaX3RAMomJCg9EhUeA29MABsZBTMNJipjOhc19gcIDR8bBwQHEggCWi6DIgLuAQYA+BAFCha3A5XiAEsqM7UFFgFLhAMjFTMYE1Klnw74nRVBG/ASCm0BYRN/BrsU3VoWy+S0vV8LQx+vN8gF2AC2AK5EAWwApgYDKmAAroQ0NDQ0AT+OCg7wAAIHRAbpNgVcBV0APTA5BfbPFgMLzcYL/QqqA82eBALKCjQCjqYCht0/k2+OAsXQAoP3ASTKDgDw6ACKAUYCMpIKJpRaAE4A5womABzZvs0REEKiACIQAd5QdAECAj4Ywg/wGqY2AVgAYADYvAoCGAEubA0gvAY2ALAAbpbvqpyEAGAEpgQAJgAG7gAgAEACmghUFwCqAMpAINQIwC4DthRAAPcycKgApoIdABwBfCisABoATwBqASIAvhnSBP8aH/ECeAKXAq40NjgDBTwFYQU6AXs3oABgAD4XNgmcCY1eCl5tIFZeUqGgyoNHABgAEQAaABNwWQAmABMATPMa3T34ADldyprmM1M2XociUQgLzvwAXT3xABgAEQAaABNwIGFAnADD8AAgAD4BBJWzaCcIAIEBFMAWwKoAAdq9BWAF5wLQpALEtQAKUSGkahR4GnJM+gsAwCgeFAiUAECQ0BQuL8AAIAAAADKeIheclvFqQAAETr4iAMxIARMgAMIoHhQIAn0E0pDQFC4HhznoAAAAIAI2C0/4lvFqQAAETgBJJwYCAy4ABgYAFAA8MBKYEH4eRhTkAjYeFcgACAYAeABsOqyQ5gRwDayqugEgaIIAtgoACgDmEABmBAWGme5OBJJA2m4cDeoAmITWAXwrMgOgAGwBCh6CBXYF1Tzg1wKAAFdiuABRAFwAXQBsAG8AdgBrAHYAbwCEAHEwfxQBVE5TEQADVFhTBwBDANILAqcCzgLTApQCrQL6vAAMAL8APLhNBKkE6glGKTAU4Dr4N2EYEwBCkABKk8rHAbYBmwIoAiU4Ajf/Aq4CowCAANIChzgaNBsCsTgeODcFXrgClQKdAqQBiQGYAqsCsjTsNHsfNPA0ixsAWTWiOAMFPDQSNCk2BDZHNow2TTZUNhk28Jk9VzI3QkEoAoICoQKwAqcAQAAxBV4FXbS9BW47YkIXP1ciUqs05DS/FwABUwJW11e6nHuYZmSh/RAYA8oMKvZ8KASoUAJYWAJ6ILAsAZSoqjpgA0ocBIhmDgDWAAawRDQoAAcuAj5iAHABZiR2AIgiHgCaAU68ACxuHAG0ygM8MiZIAlgBdF4GagJqAPZOHAMuBgoATkYAsABiAHgAMLoGDPj0HpKEBAAOJgAuALggTAHWAeAMEDbd20Uege0ADwAWADkAQgA9OHd+2MUQZBBhBgNNDkxxPxUQArEPqwvqERoM1irQ090ANK4H8ANYB/ADWANYB/AH8ANYB/ADWANYA1gDWBwP8B/YxRBkD00EcgWTBZAE2wiIJk4RhgctCNdUEnQjHEwDSgEBIypJITuYMxAlR0wRTQgIATZHbKx9PQNMMbBU+pCnA9AyVDlxBgMedhKlAC8PeCE1uk6DekxxpQpQT7NX9wBFBgASqwAS5gBJDSgAUCwGPQBI4zTYABNGAE2bAE3KAExdGABKaAbgAFBXAFCOAFBJABI2SWdObALDOq0//QomCZhvwHdTBkIQHCemEPgMNAG2ATwN7kvZBPIGPATKH34ZGg/OlZ0Ipi3eDO4m5C6igFsj9iqEBe5L9TzeC05RaQ9aC2YJ5DpkgU8DIgEOIowK3g06CG4Q9ArKbA3mEUYHOgPWSZsApgcCCxIdNhW2JhFirQsKOXgG/Br3C5AmsBMqev0F1BoiBk4BKhsAANAu6IWxWjJcHU9gBgQLJiPIFKlQIQ0mQLh4SRocBxYlqgKSQ3FKiFE3HpQh9zw+DWcuFFF9B/Y8BhlQC4I8n0asRQ8R0z6OPUkiSkwtBDaALDAnjAnQD4YMunxzAVoJIgmyDHITMhEYN8YIOgcaLpclJxYIIkaWYJsE+KAD9BPSAwwFQAlCBxQDthwuEy8VKgUOgSXYAvQ21i60ApBWgQEYBcwPJh/gEFFH4Q7qCJwCZgOEJewALhUiABginAhEZABgj9lTBi7MCMhqbSN1A2gU6GIRdAeSDlgHqBw0FcAc4nDJXgyGCSiksAlcAXYJmgFgBOQICjVcjKEgQmdUi1kYnCBiQUBd/QIyDGYVoES+h3kCjA9sEhwBNgF0BzoNAgJ4Ee4RbBCWCOyGBTW2M/k6JgRQIYQgEgooA1BszwsoJvoM+WoBpBJjAw00PnfvZ6xgtyUX/gcaMsZBYSHyC5NPzgydGsIYQ1QvGeUHwAP0GvQn60FYBgADpAQUOk4z7wS+C2oIjAlAAEoOpBgH2BhrCnKM0QEyjAG4mgNYkoQCcJAGOAcMAGgMiAV65gAeAqgIpAAGANADWAA6Aq4HngAaAIZCAT4DKDABIuYCkAOUCDLMAZYwAfQqBBzEDBYA+DhuSwLDsgKAa2ajBd5ZAo8CSjYBTiYEBk9IUgOwcuIA3ABMBhTgSAEWrEvMG+REAeBwLADIAPwABjYHBkIBzgH0bgC4AWALMgmjtLYBTuoqAIQAFmwB2AKKAN4ANgCA8gFUAE4FWvoF1AJQSgESMhksWGIBvAMgATQBDgB6BsyOpsoIIARuB9QCEBwV4gLvLwe2AgMi4BPOQsYCvd9WADIXUu5eZwqoCqdeaAC0YTQHMnM9UQAPH6k+yAdy/BZIiQImSwBQ5gBQQzSaNTFWSTYBpwGqKQK38AFtqwBI/wK37gK3rQK3sAK6280C0gK33AK3zxAAUEIAUD9SklKDArekArw5AEQAzAHCO147WTteO1k7XjtZO147WTteO1kDmChYI03AVU0oJqkKbV9GYewMpw3VRMk6ShPcYFJgMxPJLbgUwhXPJVcZPhq9JwYl5VUKDwUt1GYxCC00dhe9AEApaYNCY4ceMQpMHOhTklT5LRwAskujM7ANrRsWREEFSHXuYisWDwojAmSCAmJDXE6wXDchAqH4AmiZAmYKAp+FOBwMAmY8AmYnBG8EgAN/FAN+kzkHOXgYOYM6JCQCbB4CMjc4CwJtyAJtr/CLADRoRiwBaADfAOIASwYHmQyOAP8MwwAOtgJ3MAJ2o0ACeUxEAni7Hl3cRa9G9AJ8QAJ6yQJ9CgJ88UgBSH5kJQAsFklZSlwWGErNAtECAtDNSygDiFADh+dExpEzAvKiXQQDA69Lz0wuJgTQTU1NsAKLQAKK2cIcCB5EaAa4Ao44Ao5dQZiCAo7aAo5deVG1UzYLUtVUhgKT/AKTDQDqAB1VH1WwVdEHLBwplocy4nhnRTw6ApegAu+zWCKpAFomApaQApZ9nQCqWa1aCoJOADwClrYClk9cRVzSApnMApllXMtdCBoCnJw5wzqeApwXAp+cAp65iwAeEDIrEAKd8gKekwC2PmE1YfACntQCoG8BqgKeoCACnk+mY8lkKCYsAiewAiZ/AqD8AqBN2AKmMAKlzwKoAAB+AqfzaH1osgAESmodatICrOQCrK8CrWgCrQMCVx4CVd0CseLYAx9PbJgCsr4OArLpGGzhbWRtSWADJc4Ctl08QG6RAylGArhfArlIFgK5K3hwN3DiAr0aAy2zAzISAr6JcgMDM3ICvhtzI3NQAsPMAsMFc4N0TDZGdOEDPKgDPJsDPcACxX0CxkgCxhGKAshqUgLIRQLJUALJLwJkngLd03h6YniveSZL0QMYpGcDAmH1GfSVJXsMXpNevBICz2wCz20wTFTT9BSgAMeuAs90ASrrA04TfkwGAtwoAtuLAtJQA1JdA1NgAQIDVY2AikABzBfuYUZ2AILPg44C2sgC2d+EEYRKpz0DhqYAMANkD4ZyWvoAVgLfZgLeuXR4AuIw7RUB8zEoAfScAfLTiALr9ALpcXoAAur6AurlAPpIAboC7ooC652Wq5cEAu5AA4XhmHpw4XGiAvMEAGoDjheZlAL3FAORbwOSiAL3mQL52gL4Z5odmqy8OJsfA52EAv77ARwAOp8dn7QDBY4DpmsDptoA0sYDBmuhiaIGCgMMSgFgASACtgNGAJwEgLpoBgC8BGzAEowcggCEDC6kdjoAJAM0C5IKRoABZCgiAIzw3AYBLACkfng9ogigkgNmWAN6AEQCvrkEVqTGAwCsBRbAA+4iQkMCHR072jI2PTbUNsk2RjY5NvA23TZKNiU3EDcZN5I+RTxDRTBCJkK5VBYKFhZfwQCWygU3AJBRHpu+OytgNxa61A40GMsYjsn7BVwFXQVcBV0FaAVdBVwFXQVcBV0FXAVdBVwFXUsaCNyKAK4AAQUHBwKU7oICoW1e7jAEzgPxA+YDwgCkBFDAwADABKzAAOxFLhitA1UFTDeyPkM+bj51QkRCuwTQWWQ8X+0AWBYzsACNA8xwzAGm7EZ/QisoCTAbLDs6fnLfb8H2GccsbgFw13M1HAVkBW/Jxsm9CNRO8E8FDD0FBQw9FkcClOYCoMFegpDfADgcMiA2AJQACB8AsigKAIzIEAJKeBIApY5yPZQIAKQiHb4fvj5BKSRPQrZCOz0oXyxgOywfKAnGbgMClQaCAkILXgdeCD9IIGUgQj5fPoY+dT52Ao5CM0dAX9BTVG9SDzFwWTQAbxBzJF/lOEIQQglCCkKJIAls5AcClQICoKPMODEFxhi6KSAbiyfIRrMjtCgdWCAkPlFBIitCsEJRzAbMAV/OEyQzDg0OAQQEJ36i328/Mk9AybDJsQlq3tDRApUKAkFzXf1d/j9uALYP6hCoFgCTGD8kPsFKQiobrm0+zj0KSD8kPnVCRBwMDyJRTHFgMTJa5rwXQiQ2YfI/JD7BMEJEHGINTw4TOFlIRzwJO0icMQpyPyQ+wzJCRBv6DVgnKB01NgUKj2bwYzMqCoBkznBgEF+zYDIocwRIX+NgHj4HICNfh2C4CwdwFWpTG/lgUhYGAwRfv2Ts8mAaXzVgml/XYIJfuWC4HI1gUF9pYJZgMR6ilQHMAOwLAlDRefC0in4AXAEJA6PjCwc0IamOANMMCAECRQDFNRTZBgd+CwQlRA+r6+gLBDEFBnwUBXgKATIArwAGRAAHA3cDdAN2A3kDdwN9A3oDdQN7A30DfAN4A3oDfQAYEAAlAtYASwMAUAFsAHcKAHcAmgB3AHUAdQB2AHVu8UgAygDAAHcAdQB1AHYAdQALCgB3AAsAmgB3AAsCOwB3AAtu8UgAygDAAHgKAJoAdwB3AHUAdQB2AHUAeAB1AHUAdgB1bvFIAMoAwAALCgCaAHcACwB3AAsCOwB3AAtu8UgAygDAAH4ACwGgALcBpwC6AahdAu0COwLtbvFIAMoAwAALCgCaAu0ACwLtAAsCOwLtAAtu8UgAygDAA24ACwNvAAu0VsQAAzsAABCkjUIpAAsAUIusOggWcgMeBxVsGwL67U/2HlzmWOEeOgALASvuAAseAfpKUpnpGgYJDCIZM6YyARUE9ThqAD5iXQgnAJYJPnOzw0ZAEZxEKsIAkA4DhAHnTAIDxxUDK0lxCQlPYgIvIQVYJQBVqE1GakUAKGYiDToSBA1EtAYAXQJYAIF8GgMHRyAAIAjOe9YncekRAA0KACUrjwE7Ayc6AAYWAqaiKG4McEcqANoN3+Mg9TwCBhIkuCny+JwUQ29L008JluRxu3K+oAdqiHOqFH0AG5SUIfUJ5SxCGfxdipRzqTmT4V5Zb+r1Uo4Vm+NqSSEl2mNvR2JhIa8SpYO6ntdwFXHCWTCK8f2+Hxo7uiG3drDycAuKIMP5bhi06ACnqArH1rz4Rqg//lm6SgJGEVbF9xJHISaR6HxqxSnkw6shDnelHKNEfGUXSJRJ1GcsmtJw25xrZMDK9gXSm1/YMkdX4/6NKYOdtk/NQ3/NnDASjTc3fPjIjW/5sVfVObX2oTDWkr1dF9f3kxBsD3/3aQO8hPfRz+e0uEiJqt1161griu7gz8hDDwtpy+F+BWtefnKHZPAxcZoWbnznhJpy0e842j36bcNzGnIEusgGX0a8ZxsnjcSsPDZ09yZ36fCQbriHeQ72JRMILNl6ePPf2HWoVwgWAm1fb3V2sAY0+B6rAXqSwPBgseVmoqsBTSrm91+XasMYYySI8eeRxH3ZvHkMz3BQ5aJ3iUVbYPNM3/7emRtjlsMgv/9VyTsyt/mK+8fgWeT6SoFaclXqn42dAIsvAarF5vNNWHzKSkKQ/8Hfk5ZWK7r9yliOsooyBjRhfkHP4Q2DkWXQi6FG/9r/IwbmkV5T7JSopHKn1pJwm9tb5Ot0oyN1Z2mPpKXHTxx2nlK08fKk1hEYA8WgVVWL5lgx0iTv+KdojJeU23ZDjmiubXOxVXJKKi2Wjuh2HLZOFLiSC7Tls5SMh4f+Pj6xUSrNjFqLGehRNB8lC0QSLNmkJJx/wSG3MnjE9T1CkPwJI0wH2lfzwETIiVqUxg0dfu5q39Gt+hwdcxkhhNvQ4TyrBceof3Mhs/IxFci1HmHr4FMZgXEEczPiGCx0HRwzAqDq2j9AVm1kwN0mRVLWLylgtoPNapF5cY4Y1wJh/e0BBwZj44YgZrDNqvD/9Hv7GFYdUQeDJuQ3EWI4HaKqavU1XjC/n41kT4L79kqGq0kLhdTZvgP3TA3fS0ozVz+5piZsoOtIvBUFoMKbNcmBL6YxxaUAusHB38XrS8dQMnQwJfUUkpRoGr5AUeWicvBTzyK9g77+yCkf5PAysL7r/JjcZgrbvRpMW9iyaxZvKO6ceZN2EwIxKwVFPuvFuiEPGCoagbMo+SpydLrXqBzNCDGFCrO/rkcwa2xhokQZ5CdZ0AsU3JfSqJ6n5I14YA+P/uAgfhPU84Tlw7cEFfp7AEE8ey4sP12PTt4Cods1GRgDOB5xvyiR5m+Bx8O5nBCNctU8BevfV5A08x6RHd5jcwPTMDSZJOedIZ1cGQ704lxbAzqZOP05ZxaOghzSdvFBHYqomATARyAADK4elP8Ly3IrUZKfWh23Xy20uBUmLS4Pfagu9+oyVa2iPgqRP3F2CTUsvJ7+RYnN8fFZbU/HVvxvcFFDKkiTqV5UBZ3Gz54JAKByi9hkKMZJvuGgcSYXFmw08UyoQyVdfTD1/dMkCHXcTGAKeROgArsvmRrQTLUOXioOHGK2QkjHuoYFgXciZoTJd6Fs5q1QX1G+p/e26hYsEf7QZD1nnIyl/SFkNtYYmmBhpBrxl9WbY0YpHWRuw2Ll/tj9mD8P4snVzJl4F9J+1arVeTb9E5r2ILH04qStjxQNwn3m4YNqxmaNbLAqW2TN6LidwuJRqS+NXbtqxoeDXpxeGWmxzSkWxjkyCkX4NQRme6q5SAcC+M7+9ETfA/EwrzQajKakCwYyeunP6ZFlxU2oMEn1Pz31zeStW74G406ZJFCl1wAXIoUKkWotYEpOuXB1uVNxJ63dpJEqfxBeptwIHNrPz8BllZoIcBoXwgfJ+8VAUnVPvRvexnw0Ma/WiGYuJO5y8QTvEYBigFmhUxY5RqzE8OcywN/8m4UYrlaniJO75XQ6KSo9+tWHlu+hMi0UVdiKQp7NelnoZUzNaIyBPVeOwK6GNp+FfHuPOoyhaWuNvTYFkvxscMQWDh+zeFCFkgwbXftiV23ywJ4+uwRqmg9k3KzwIQpzppt8DBBOMbrqwQM5Gb05sEwdKzMiAqOloaA/lr0KA+1pr0/+HiWoiIjHA/wir2nIuS3PeU/ji3O6ZwoxcR1SZ9FhtLC5S0FIzFhbBWcGVP/KpxOPSiUoAdWUpqKH++6Scz507iCcxYI6rdMBICPJZea7OcmeFw5mObJSiqpjg2UoWNIs+cFhyDSt6geV5qgi3FunmwwDoGSMgerFOZGX1m0dMCYo5XOruxO063dwENK9DbnVM9wYFREzh4vyU1WYYJ/LRRp6oxgjqP/X5a8/4Af6p6NWkQferzBmXme0zY/4nwMJm/wd1tIqSwGz+E3xPEAOoZlJit3XddD7/BT1pllzOx+8bmQtANQ/S6fZexc6qi3W+Q2xcmXTUhuS5mpHQRvcxZUN0S5+PL9lXWUAaRZhEH8hTdAcuNMMCuVNKTEGtSUKNi3O6KhSaTzck8csZ2vWRZ+d7mW8c4IKwXIYd25S/zIftPkwPzufjEvOHWVD1m+FjpDVUTV0DGDuHj6QnaEwLu/dEgdLQOg9E1Sro9XHJ8ykLAwtPu+pxqKDuFexqON1sKQm7rwbE1E68UCfA/erovrTCG+DBSNg0l4goDQvZN6uNlbyLpcZAwj2UclycvLpIZMgv4yRlpb3YuMftozorbcGVHt/VeDV3+Fdf1TP0iuaCsPi2G4XeGhsyF1ubVDxkoJhmniQ0/jSg/eYML9KLfnCFgISWkp91eauR3IQvED0nAPXK+6hPCYs+n3+hCZbiskmVMG2da+0EsZPonUeIY8EbfusQXjsK/eFDaosbPjEfQS0RKG7yj5GG69M7MeO1HmiUYocgygJHL6M1qzUDDwUSmr99V7Sdr2F3JjQAJY+F0yH33Iv3+C9M38eML7gTgmNu/r2bUMiPvpYbZ6v1/IaESirBHNa7mPKn4dEmYg7v/+HQgPN1G79jBQ1+soydfDC2r+h2Bl/KIc5KjMK7OH6nb1jLsNf0EHVe2KBiE51ox636uyG6Lho0t3J34L5QY/ilE3mikaF4HKXG1mG1rCevT1Vv6GavltxoQe/bMrpZvRggnBxSEPEeEzkEdOxTnPXHVjUYdw8JYvjB/o7Eegc3Ma+NUxLLnsK0kJlinPmUHzHGtrk5+CAbVzFOBqpyy3QVUnzTDfC/0XD94/okH+OB+i7g9lolhWIjSnfIb+Eq43ZXOWmwvjyV/qqD+t0e+7mTEM74qP/Ozt8nmC7mRpyu63OB4KnUzFc074SqoyPUAgM+/TJGFo6T44EHnQU4X4z6qannVqgw/U7zCpwcmXV1AubIrvOmkKHazJAR55ePjp5tLBsN8vAqs3NAHdcEHOR2xQ0lsNAFzSUuxFQCFYvXLZJdOj9p4fNq6p0HBGUik2YzaI4xySy91KzhQ0+q1hjxvImRwPRf76tChlRkhRCi74NXZ9qUNeIwP+s5p+3m5nwPdNOHgSLD79n7O9m1n1uDHiMntq4nkYwV5OZ1ENbXxFd4PgrlvavZsyUO4MqYlqqn1O8W/I1dEZq5dXhrbETLaZIbC2Kj/Aa/QM+fqUOHdf0tXAQ1huZ3cmWECWSXy/43j35+Mvq9xws7JKseriZ1pEWKc8qlzNrGPUGcVgOa9cPJYIJsGnJTAUsEcDOEVULO5x0rXBijc1lgXEzQQKhROf8zIV82w8eswc78YX11KYLWQRcgHNJElBxfXr72lS2RBSl07qTKorO2uUDZr3sFhYsvnhLZn0A94KRzJ/7DEGIAhW5ZWFpL8gEwu1aLA9MuWZzNwl8Oze9Y+bX+v9gywRVnoB5I/8kXTXU3141yRLYrIOOz6SOnyHNy4SieqzkBXharjfjqq1q6tklaEbA8Qfm2DaIPs7OTq/nvJBjKfO2H9bH2cCMh1+5gspfycu8f/cuuRmtDjyqZ7uCIMyjdV3a+p3fqmXsRx4C8lujezIFHnQiVTXLXuI1XrwN3+siYYj2HHTvESUx8DlOTXpak9qFRK+L3mgJ1WsD7F4cu1aJoFoYQnu+wGDMOjJM3kiBQWHCcvhJ/HRdxodOQp45YZaOTA22Nb4XKCVxqkbwMYFhzYQYIAnCW8FW14uf98jhUG2zrKhQQ0q0CEq0t5nXyvUyvR8DvD69LU+g3i+HFWQMQ8PqZuHD+sNKAV0+M6EJC0szq7rEr7B5bQ8BcNHzvDMc9eqB5ZCQdTf80Obn4uzjwpYU7SISdtV0QGa9D3Wrh2BDQtpBKxaNFV+/Cy2P/Sv+8s7Ud0Fd74X4+o/TNztWgETUapy+majNQ68Lq3ee0ZO48VEbTZYiH1Co4OlfWef82RWeyUXo7woM03PyapGfikTnQinoNq5z5veLpeMV3HCAMTaZmA1oGLAn7XS3XYsz+XK7VMQsc4XKrmDXOLU/pSXVNUq8dIqTba///3x6LiLS6xs1xuCAYSfcQ3+rQgmu7uvf3THKt5Ooo97TqcbRqxx7EASizaQCBQllG/rYxVapMLgtLbZS64w1MDBMXX+PQpBKNwqUKOf2DDRDUXQf9EhOS0Qj4nTmlA8dzSLz/G1d+Ud8MTy/6ghhdiLpeerGY/UlDOfiuqFsMUU5/UYlP+BAmgRLuNpvrUaLlVkrqDievNVEAwF+4CoM1MZTmjxjJMsKJq+u8Zd7tNCUFy6LiyYXRJQ4VyvEQFFaCGKsxIwQkk7EzZ6LTJq2hUuPhvAW+gQnSG6J+MszC+7QCRHcnqDdyNRJ6T9xyS87A6MDutbzKGvGktpbXqtzWtXb9HsfK2cBMomjN9a4y+TaJLnXxAeX/HWzmf4cR4vALt/P4w4qgKY04ml4ZdLOinFYS6cup3G/1ie4+t1eOnpBNlqGqs75ilzkT4+DsZQxNvaSKJ//6zIbbk/M7LOhFmRc/1R+kBtz7JFGdZm/COotIdvQoXpTqP/1uqEUmCb/QWoGLMwO5ANcHzxdY48IGP5+J+zKOTBFZ4Pid+GTM+Wq12MV/H86xEJptBa6T+p3kgpwLedManBHC2GgNrFpoN2xnrMz9WFWX/8/ygSBkavq2Uv7FdCsLEYLu9LLIvAU0bNRDtzYl+/vXmjpIvuJFYjmI0im6QEYqnIeMsNjXG4vIutIGHijeAG/9EDBozKV5cldkHbLxHh25vT+ZEzbhXlqvpzKJwcEgfNwLAKFeo0/pvEE10XDB+EXRTXtSzJozQKFFAJhMxYkVaCW+E9AL7tMeU8acxidHqzb6lX4691UsDpy/LLRmT+epgW56+5Cw8tB4kMUv6s9lh3eRKbyGs+H/4mQMaYzPTf2OOdokEn+zzgvoD3FqNKk8QqGAXVsqcGdXrT62fSPkR2vROFi68A6se86UxRUk4cajfPyCC4G5wDhD+zNq4jodQ4u4n/m37Lr36n4LIAAsVr02dFi9AiwA81MYs2rm4eDlDNmdMRvEKRHfBwW5DdMNp0jPFZMeARqF/wL4XBfd+EMLBfMzpH5GH6NaW+1vrvMdg+VxDzatk3MXgO3ro3P/DpcC6+Mo4MySJhKJhSR01SGGGp5hPWmrrUgrv3lDnP+HhcI3nt3YqBoVAVTBAQT5iuhTg8nvPtd8ZeYj6w1x6RqGUBrSku7+N1+BaasZvjTk64RoIDlL8brpEcJx3OmY7jLoZsswdtmhfC/G21llXhITOwmvRDDeTTPbyASOa16cF5/A1fZAidJpqju3wYAy9avPR1ya6eNp9K8XYrrtuxlqi+bDKwlfrYdR0RRiKRVTLOH85+ZY7XSmzRpfZBJjaTa81VDcJHpZnZnSQLASGYW9l51ZV/h7eVzTi3Hv6hUsgc/51AqJRTkpbFVLXXszoBL8nBX0u/0jBLT8nH+fJePbrwURT58OY+UieRjd1vs04w0VG5VN2U6MoGZkQzKN/ptz0Q366dxoTGmj7i1NQGHi9GgnquXFYdrCfZBmeb7s0T6yrdlZH5cZuwHFyIJ/kAtGsTg0xH5taAAq44BAk1CPk9KVVbqQzrCUiFdF/6gtlPQ8bHHc1G1W92MXGZ5HEHftyLYs8mbD/9xYRUWkHmlM0zC2ilJlnNgV4bfALpQghxOUoZL7VTqtCHIaQSXm+YUMnpkXybnV+A6xlm2CVy8fn0Xlm2XRa0+zzOa21JWWmixfiPMSCZ7qA4rS93VN3pkpF1s5TonQjisHf7iU9ZGvUPOAKZcR1pbeVf/Ul7OhepGCaId9wOtqo7pJ7yLcBZ0pFkOF28y4zEI/kcUNmutBHaQpBdNM8vjCS6HZRokkeo88TBAjGyG7SR+6vUgTcyK9Imalj0kuxz0wmK+byQU11AiJFk/ya5dNduRClcnU64yGu/ieWSeOos1t3ep+RPIWQ2pyTYVbZltTbsb7NiwSi3AV+8KLWk7LxCnfZUetEM8ThnsSoGH38/nyAwFguJp8FjvlHtcWZuU4hPva0rHfr0UhOOJ/F6vS62FW7KzkmRll2HEc7oUq4fyi5T70Vl7YVIfsPHUCdHesf9Lk7WNVWO75JDkYbMI8TOW8JKVtLY9d6UJRITO8oKo0xS+o99Yy04iniGHAaGj88kEWgwv0OrHdY/nr76DOGNS59hXCGXzTKUvDl9iKpLSWYN1lxIeyywdNpTkhay74w2jFT6NS8qkjo5CxA1yfSYwp6AJIZNKIeEK5PJAW7ORgWgwp0VgzYpqovMrWxbu+DGZ6Lhie1RAqpzm8VUzKJOH3mCzWuTOLsN3VT/dv2eeYe9UjbR8YTBsLz7q60VN1sU51k+um1f8JxD5pPhbhSC8rRaB454tmh6YUWrJI3+GWY0qeWioj/tbkYITOkJaeuGt4JrJvHA+l0Gu7kY7XOaa05alMnRWVCXqFgLIwSY4uF59Ue5SU4QKuc/HamDxbr0x6csCetXGoP7Qn1Bk/J9DsynO/UD6iZ1Hyrz+jit0hDCwi/E9OjgKTbB3ZQKQ/0ZOvevfNHG0NK4Aj3Cp7NpRk07RT1i/S0EL93Ag8GRgKI9CfpajKyK6+Jj/PI1KO5/85VAwz2AwzP8FTBb075IxCXv6T9RVvWT2tUaqxDS92zrGUbWzUYk9mSs82pECH+fkqsDt93VW++4YsR/dHCYcQSYTO/KaBMDj9LSD/J/+z20Kq8XvZUAIHtm9hRPP3ItbuAu2Hm5lkPs92pd7kCxgRs0xOVBnZ13ccdA0aunrwv9SdqElJRC3g+oCu+nXyCgmXUs9yMjTMAIHfxZV+aPKcZeUBWt057Xo85Ks1Ir5gzEHCWqZEhrLZMuF11ziGtFQUds/EESajhagzcKsxamcSZxGth4UII+adPhQkUnx2WyN+4YWR+r3f8MnkyGFuR4zjzxJS8WsQYR5PTyRaD9ixa6Mh741nBHbzfjXHskGDq179xaRNrCIB1z1xRfWfjqw2pHc1zk9xlPpL8sQWAIuETZZhbnmL54rceXVNRvUiKrrqIkeogsl0XXb17ylNb0f4GA9Wd44vffEG8FSZGHEL2fbaTGRcSiCeA8PmA/f6Hz8HCS76fXUHwgwkzSwlI71ekZ7Fapmlk/KC+Hs8hUcw3N2LN5LhkVYyizYFl/uPeVP5lsoJHhhfWvvSWruCUW1ZcJOeuTbrDgywJ/qG07gZJplnTvLcYdNaH0KMYOYMGX+rB4NGPFmQsNaIwlWrfCezxre8zXBrsMT+edVLbLqN1BqB76JH4BvZTqUIMfGwPGEn+EnmTV86fPBaYbFL3DFEhjB45CewkXEAtJxk4/Ms2pPXnaRqdky0HOYdcUcE2zcXq4vaIvW2/v0nHFJH2XXe22ueDmq/18XGtELSq85j9X8q0tcNSSKJIX8FTuJF/Pf8j5PhqG2u+osvsLxYrvvfeVJL+4tkcXcr9JV7v0ERmj/X6fM3NC4j6dS1+9Umr2oPavqiAydTZPLMNRGY23LO9zAVDly7jD+70G5TPPLdhRIl4WxcYjLnM+SNcJ26FOrkrISUtPObIz5Zb3AG612krnpy15RMW+1cQjlnWFI6538qky9axd2oJmHIHP08KyP0ubGO+TQNOYuv2uh17yCIvR8VcStw7o1g0NM60sk+8Tq7YfIBJrtp53GkvzXH7OA0p8/n/u1satf/VJhtR1l8Wa6Gmaug7haSpaCaYQax6ta0mkutlb+eAOSG1aobM81D9A4iS1RRlzBBoVX6tU1S6WE2N9ORY6DfeLRC4l9Rvr5h95XDWB2mR1d4WFudpsgVYwiTwT31ljskD8ZyDOlm5DkGh9N/UB/0AI5Xvb8ZBmai2hQ4BWMqFwYnzxwB26YHSOv9WgY3JXnvoN+2R4rqGVh/LLDMtpFP+SpMGJNWvbIl5SOodbCczW2RKleksPoUeGEzrjtKHVdtZA+kfqO+rVx/iclCqwoopepvJpSTDjT+b9GWylGRF8EDbGlw6eUzmJM95Ovoz+kwLX3c2fTjFeYEsE7vUZm3mqdGJuKh2w9/QGSaqRHs99aScGOdDqkFcACoqdbBoQqqjamhH6Q9ng39JCg3lrGJwd50Qk9ovnqBTr8MME7Ps2wiVfygUmPoUBJJfJWX5Nda0nuncbFkA=="))}const ht=ut(),dt=new Set(rt(ht)),ft=new Set(rt(ht)),pt=it(ht),mt=ct(ht),gt=45,vt=95;function yt(t){return(0,I.XL)(t)}function xt(t){return t.filter((t=>65039!=t))}function bt(t){for(let n of t.split(".")){let t=yt(n);try{for(let e=t.lastIndexOf(vt)-1;e>=0;e--)if(t[e]!==vt)throw new Error("underscore only allowed at start");if(t.length>=4&&t.every((t=>t<128))&&t[2]===gt&&t[3]===gt)throw new Error("invalid label extension")}catch(e){throw new Error(`Invalid label "${n}": ${e.message}`)}}return t}function wt(t){return bt(_t(t,xt))}function _t(t,e){let n=yt(t).reverse(),r=[];while(n.length){let t=At(n);if(t){r.push(...e(t));continue}let i=n.pop();if(dt.has(i)){r.push(i);continue}if(ft.has(i))continue;let s=pt[i];if(!s)throw new Error(`Disallowed codepoint: 0x${i.toString(16).toUpperCase()}`);r.push(...s)}return bt(Mt(String.fromCodePoint(...r)))}function Mt(t){return t.normalize("NFC")}function At(t,e){var n;let r,i,s=mt,o=[],a=t.length;e&&(e.length=0);while(a){let l=t[--a];if(s=null===(n=s.branches.find((t=>t.set.has(l))))||void 0===n?void 0:n.node,!s)break;if(s.save)i=l;else if(s.check&&l===i)break;o.push(l),s.fe0f&&(o.push(65039),a>0&&65039==t[a-1]&&a--),s.valid&&(r=o.slice(),2==s.valid&&r.splice(1,1),e&&e.push(...t.slice(a).reverse()),t.length=a)}return r}const St=new i.Yd(h),Et=new Uint8Array(32);function Tt(t){if(0===t.length)throw new Error("invalid ENS name; empty component");return t}function Ct(t){const e=(0,I.Y0)(wt(t)),n=[];if(0===t.length)return n;let r=0;for(let i=0;i<e.length;i++){const t=e[i];46===t&&(n.push(Tt(e.slice(r,i))),r=i+1)}if(r>=e.length)throw new Error("invalid ENS name; empty component");return n.push(Tt(e.slice(r))),n}function Rt(t){"string"!==typeof t&&St.throwArgumentError("invalid ENS name; not a string","name",t);let e=Et;const n=Ct(t);while(n.length)e=(0,u.w)((0,l.zo)([e,(0,u.w)(n.pop())]));return(0,l.Dv)(e)}function It(t){return(0,l.Dv)((0,l.zo)(Ct(t).map((t=>{if(t.length>63)throw new Error("invalid DNS encoded entry; length exceeds 63 bytes");const e=new Uint8Array(t.length+1);return e.set(t,1),e[0]=e.length-1,e}))))+"00"}Et.fill(0);const Pt="networks/5.7.0",Lt=new i.Yd(Pt);function Nt(t){return t&&"function"===typeof t.renetwork}function kt(t){const e=function(e,n){null==n&&(n={});const r=[];if(e.InfuraProvider&&"-"!==n.infura)try{r.push(new e.InfuraProvider(t,n.infura))}catch(i){}if(e.EtherscanProvider&&"-"!==n.etherscan)try{r.push(new e.EtherscanProvider(t,n.etherscan))}catch(i){}if(e.AlchemyProvider&&"-"!==n.alchemy)try{r.push(new e.AlchemyProvider(t,n.alchemy))}catch(i){}if(e.PocketProvider&&"-"!==n.pocket){const s=["goerli","ropsten","rinkeby"];try{const i=new e.PocketProvider(t,n.pocket);i.network&&-1===s.indexOf(i.network.name)&&r.push(i)}catch(i){}}if(e.CloudflareProvider&&"-"!==n.cloudflare)try{r.push(new e.CloudflareProvider(t))}catch(i){}if(e.AnkrProvider&&"-"!==n.ankr)try{const i=["ropsten"],s=new e.AnkrProvider(t,n.ankr);s.network&&-1===i.indexOf(s.network.name)&&r.push(s)}catch(i){}if(0===r.length)return null;if(e.FallbackProvider){let i=1;return null!=n.quorum?i=n.quorum:"homestead"===t&&(i=2),new e.FallbackProvider(r,i)}return r[0]};return e.renetwork=function(t){return kt(t)},e}function Ot(t,e){const n=function(n,r){return n.JsonRpcProvider?new n.JsonRpcProvider(t,e):null};return n.renetwork=function(e){return Ot(t,e)},n}const Dt={chainId:1,ensAddress:"0x00000000000C2E074eC69A0dFb2997BA6C7d2e1e",name:"homestead",_defaultProvider:kt("homestead")},zt={chainId:3,ensAddress:"0x00000000000C2E074eC69A0dFb2997BA6C7d2e1e",name:"ropsten",_defaultProvider:kt("ropsten")},Ft={chainId:63,name:"classicMordor",_defaultProvider:Ot("https://www.ethercluster.com/mordor","classicMordor")},Ut={unspecified:{chainId:0,name:"unspecified"},homestead:Dt,mainnet:Dt,morden:{chainId:2,name:"morden"},ropsten:zt,testnet:zt,rinkeby:{chainId:4,ensAddress:"0x00000000000C2E074eC69A0dFb2997BA6C7d2e1e",name:"rinkeby",_defaultProvider:kt("rinkeby")},kovan:{chainId:42,name:"kovan",_defaultProvider:kt("kovan")},goerli:{chainId:5,ensAddress:"0x00000000000C2E074eC69A0dFb2997BA6C7d2e1e",name:"goerli",_defaultProvider:kt("goerli")},kintsugi:{chainId:1337702,name:"kintsugi"},classic:{chainId:61,name:"classic",_defaultProvider:Ot("https://www.ethercluster.com/etc","classic")},classicMorden:{chainId:62,name:"classicMorden"},classicMordor:Ft,classicTestnet:Ft,classicKotti:{chainId:6,name:"classicKotti",_defaultProvider:Ot("https://www.ethercluster.com/kotti","classicKotti")},xdai:{chainId:100,name:"xdai"},matic:{chainId:137,name:"matic",_defaultProvider:kt("matic")},maticmum:{chainId:80001,name:"maticmum"},optimism:{chainId:10,name:"optimism",_defaultProvider:kt("optimism")},"optimism-kovan":{chainId:69,name:"optimism-kovan"},"optimism-goerli":{chainId:420,name:"optimism-goerli"},arbitrum:{chainId:42161,name:"arbitrum"},"arbitrum-rinkeby":{chainId:421611,name:"arbitrum-rinkeby"},"arbitrum-goerli":{chainId:421613,name:"arbitrum-goerli"},bnb:{chainId:56,name:"bnb"},bnbt:{chainId:97,name:"bnbt"}};function Bt(t){if(null==t)return null;if("number"===typeof t){for(const e in Ut){const n=Ut[e];if(n.chainId===t)return{name:n.name,chainId:n.chainId,ensAddress:n.ensAddress||null,_defaultProvider:n._defaultProvider||null}}return{chainId:t,name:"unknown"}}if("string"===typeof t){const e=Ut[t];return null==e?null:{name:e.name,chainId:e.chainId,ensAddress:e.ensAddress,_defaultProvider:e._defaultProvider||null}}const e=Ut[t.name];if(!e)return"number"!==typeof t.chainId&&Lt.throwArgumentError("invalid network chainId","network",t),t;0!==t.chainId&&t.chainId!==e.chainId&&Lt.throwArgumentError("network chainId mismatch","network",t);let n=t._defaultProvider||null;return null==n&&e._defaultProvider&&(n=Nt(e._defaultProvider)?e._defaultProvider.renetwork(t):e._defaultProvider),{name:t.name,chainId:e.chainId,ensAddress:t.ensAddress||e.ensAddress||null,_defaultProvider:n}}var Gt=n(8730),Ht=n.n(Gt);const Vt="sha2/5.7.0";new i.Yd(Vt);function jt(t){return"0x"+Ht().sha256().update((0,l.lE)(t)).digest("hex")}var Wt=n(1742),qt=n.n(Wt);const Yt="0x0000000000000000000000000000000000000000",Xt=new i.Yd(s);class Jt{constructor(){this.formats=this.getDefaultFormats()}getDefaultFormats(){const t={},e=this.address.bind(this),n=this.bigNumber.bind(this),i=this.blockTag.bind(this),s=this.data.bind(this),o=this.hash.bind(this),a=this.hex.bind(this),l=this.number.bind(this),c=this.type.bind(this),u=t=>this.data(t,!0);return t.transaction={hash:o,type:c,accessList:Jt.allowNull(this.accessList.bind(this),null),blockHash:Jt.allowNull(o,null),blockNumber:Jt.allowNull(l,null),transactionIndex:Jt.allowNull(l,null),confirmations:Jt.allowNull(l,null),from:e,gasPrice:Jt.allowNull(n),maxPriorityFeePerGas:Jt.allowNull(n),maxFeePerGas:Jt.allowNull(n),gasLimit:n,to:Jt.allowNull(e,null),value:n,nonce:l,data:s,r:Jt.allowNull(this.uint256),s:Jt.allowNull(this.uint256),v:Jt.allowNull(l),creates:Jt.allowNull(e,null),raw:Jt.allowNull(s)},t.transactionRequest={from:Jt.allowNull(e),nonce:Jt.allowNull(l),gasLimit:Jt.allowNull(n),gasPrice:Jt.allowNull(n),maxPriorityFeePerGas:Jt.allowNull(n),maxFeePerGas:Jt.allowNull(n),to:Jt.allowNull(e),value:Jt.allowNull(n),data:Jt.allowNull(u),type:Jt.allowNull(l),accessList:Jt.allowNull(this.accessList.bind(this),null)},t.receiptLog={transactionIndex:l,blockNumber:l,transactionHash:o,address:e,topics:Jt.arrayOf(o),data:s,logIndex:l,blockHash:o},t.receipt={to:Jt.allowNull(this.address,null),from:Jt.allowNull(this.address,null),contractAddress:Jt.allowNull(e,null),transactionIndex:l,root:Jt.allowNull(a),gasUsed:n,logsBloom:Jt.allowNull(s),blockHash:o,transactionHash:o,logs:Jt.arrayOf(this.receiptLog.bind(this)),blockNumber:l,confirmations:Jt.allowNull(l,null),cumulativeGasUsed:n,effectiveGasPrice:Jt.allowNull(n),status:Jt.allowNull(l),type:c},t.block={hash:Jt.allowNull(o),parentHash:o,number:l,timestamp:l,nonce:Jt.allowNull(a),difficulty:this.difficulty.bind(this),gasLimit:n,gasUsed:n,miner:Jt.allowNull(e),extraData:s,transactions:Jt.allowNull(Jt.arrayOf(o)),baseFeePerGas:Jt.allowNull(n)},t.blockWithTransactions=(0,r.DC)(t.block),t.blockWithTransactions.transactions=Jt.allowNull(Jt.arrayOf(this.transactionResponse.bind(this))),t.filter={fromBlock:Jt.allowNull(i,void 0),toBlock:Jt.allowNull(i,void 0),blockHash:Jt.allowNull(o,void 0),address:Jt.allowNull(e,void 0),topics:Jt.allowNull(this.topics.bind(this),void 0)},t.filterLog={blockNumber:Jt.allowNull(l),blockHash:Jt.allowNull(o),transactionIndex:l,removed:Jt.allowNull(this.boolean.bind(this)),address:e,data:Jt.allowFalsish(s,"0x"),topics:Jt.arrayOf(o),transactionHash:o,logIndex:l},t}accessList(t){return(0,P.z7)(t||[])}number(t){return"0x"===t?0:a.O$.from(t).toNumber()}type(t){return"0x"===t||null==t?0:a.O$.from(t).toNumber()}bigNumber(t){return a.O$.from(t)}boolean(t){if("boolean"===typeof t)return t;if("string"===typeof t){if(t=t.toLowerCase(),"true"===t)return!0;if("false"===t)return!1}throw new Error("invalid boolean - "+t)}hex(t,e){return"string"===typeof t&&(e||"0x"===t.substring(0,2)||(t="0x"+t),(0,l.A7)(t))?t.toLowerCase():Xt.throwArgumentError("invalid hash","value",t)}data(t,e){const n=this.hex(t,e);if(n.length%2!==0)throw new Error("invalid data; odd-length - "+t);return n}address(t){return(0,c.Kn)(t)}callAddress(t){if(!(0,l.A7)(t,32))return null;const e=(0,c.Kn)((0,l.p3)(t,12));return e===Yt?null:e}contractAddress(t){return(0,c.CR)(t)}blockTag(t){if(null==t)return"latest";if("earliest"===t)return"0x0";switch(t){case"earliest":return"0x0";case"latest":case"pending":case"safe":case"finalized":return t}if("number"===typeof t||(0,l.A7)(t))return(0,l.$P)(t);throw new Error("invalid blockTag")}hash(t,e){const n=this.hex(t,e);return 32!==(0,l.E1)(n)?Xt.throwArgumentError("invalid hash","value",t):n}difficulty(t){if(null==t)return null;const e=a.O$.from(t);try{return e.toNumber()}catch(n){}return null}uint256(t){if(!(0,l.A7)(t))throw new Error("invalid uint256");return(0,l.$m)(t,32)}_block(t,e){null!=t.author&&null==t.miner&&(t.miner=t.author);const n=null!=t._difficulty?t._difficulty:t.difficulty,r=Jt.check(e,t);return r._difficulty=null==n?null:a.O$.from(n),r}block(t){return this._block(t,this.formats.block)}blockWithTransactions(t){return this._block(t,this.formats.blockWithTransactions)}transactionRequest(t){return Jt.check(this.formats.transactionRequest,t)}transactionResponse(t){null!=t.gas&&null==t.gasLimit&&(t.gasLimit=t.gas),t.to&&a.O$.from(t.to).isZero()&&(t.to="0x0000000000000000000000000000000000000000"),null!=t.input&&null==t.data&&(t.data=t.input),null==t.to&&null==t.creates&&(t.creates=this.contractAddress(t)),1!==t.type&&2!==t.type||null!=t.accessList||(t.accessList=[]);const e=Jt.check(this.formats.transaction,t);if(null!=t.chainId){let n=t.chainId;(0,l.A7)(n)&&(n=a.O$.from(n).toNumber()),e.chainId=n}else{let n=t.networkId;null==n&&null==e.v&&(n=t.chainId),(0,l.A7)(n)&&(n=a.O$.from(n).toNumber()),"number"!==typeof n&&null!=e.v&&(n=(e.v-35)/2,n<0&&(n=0),n=parseInt(n)),"number"!==typeof n&&(n=0),e.chainId=n}return e.blockHash&&"x"===e.blockHash.replace(/0/g,"")&&(e.blockHash=null),e}transaction(t){return(0,P.Qc)(t)}receiptLog(t){return Jt.check(this.formats.receiptLog,t)}receipt(t){const e=Jt.check(this.formats.receipt,t);if(null!=e.root)if(e.root.length<=4){const t=a.O$.from(e.root).toNumber();0===t||1===t?(null!=e.status&&e.status!==t&&Xt.throwArgumentError("alt-root-status/status mismatch","value",{root:e.root,status:e.status}),e.status=t,delete e.root):Xt.throwArgumentError("invalid alt-root-status","value.root",e.root)}else 66!==e.root.length&&Xt.throwArgumentError("invalid root hash","value.root",e.root);return null!=e.status&&(e.byzantium=!0),e}topics(t){return Array.isArray(t)?t.map((t=>this.topics(t))):null!=t?this.hash(t,!0):null}filter(t){return Jt.check(this.formats.filter,t)}filterLog(t){return Jt.check(this.formats.filterLog,t)}static check(t,e){const n={};for(const i in t)try{const r=t[i](e[i]);void 0!==r&&(n[i]=r)}catch(r){throw r.checkKey=i,r.checkValue=e[i],r}return n}static allowNull(t,e){return function(n){return null==n?e:t(n)}}static allowFalsish(t,e){return function(n){return n?t(n):e}}static arrayOf(t){return function(e){if(!Array.isArray(e))throw new Error("not an array");const n=[];return e.forEach((function(e){n.push(t(e))})),n}}}var Kt=function(t,e,n,r){function i(t){return t instanceof n?t:new n((function(e){e(t)}))}return new(n||(n=Promise))((function(n,s){function o(t){try{l(r.next(t))}catch(e){s(e)}}function a(t){try{l(r["throw"](t))}catch(e){s(e)}}function l(t){t.done?n(t.value):i(t.value).then(o,a)}l((r=r.apply(t,e||[])).next())}))};const Zt=new i.Yd(s),Qt=10;function $t(t){return null==t?"null":(32!==(0,l.E1)(t)&&Zt.throwArgumentError("invalid topic","topic",t),t.toLowerCase())}function te(t){t=t.slice();while(t.length>0&&null==t[t.length-1])t.pop();return t.map((t=>{if(Array.isArray(t)){const e={};t.forEach((t=>{e[$t(t)]=!0}));const n=Object.keys(e);return n.sort(),n.join("|")}return $t(t)})).join("&")}function ee(t){return""===t?[]:t.split(/&/g).map((t=>{if(""===t)return[];const e=t.split("|").map((t=>"null"===t?null:t));return 1===e.length?e[0]:e}))}function ne(t){if("string"===typeof t){if(t=t.toLowerCase(),32===(0,l.E1)(t))return"tx:"+t;if(-1===t.indexOf(":"))return t}else{if(Array.isArray(t))return"filter:*:"+te(t);if(j.Sg.isForkEvent(t))throw Zt.warn("not implemented"),new Error("not implemented");if(t&&"object"===typeof t)return"filter:"+(t.address||"*")+":"+te(t.topics||[])}throw new Error("invalid event - "+t)}function re(){return(new Date).getTime()}function ie(t){return new Promise((e=>{setTimeout(e,t)}))}const se=["block","network","pending","poll"];class oe{constructor(t,e,n){(0,r.zG)(this,"tag",t),(0,r.zG)(this,"listener",e),(0,r.zG)(this,"once",n),this._lastBlockNumber=-2,this._inflight=!1}get event(){switch(this.type){case"tx":return this.hash;case"filter":return this.filter}return this.tag}get type(){return this.tag.split(":")[0]}get hash(){const t=this.tag.split(":");return"tx"!==t[0]?null:t[1]}get filter(){const t=this.tag.split(":");if("filter"!==t[0])return null;const e=t[1],n=ee(t[2]),r={};return n.length>0&&(r.topics=n),e&&"*"!==e&&(r.address=e),r}pollable(){return this.tag.indexOf(":")>=0||se.indexOf(this.tag)>=0}}const ae={0:{symbol:"btc",p2pkh:0,p2sh:5,prefix:"bc"},2:{symbol:"ltc",p2pkh:48,p2sh:50,prefix:"ltc"},3:{symbol:"doge",p2pkh:30,p2sh:22},60:{symbol:"eth",ilk:"eth"},61:{symbol:"etc",ilk:"eth"},700:{symbol:"xdai",ilk:"eth"}};function le(t){return(0,l.$m)(a.O$.from(t).toHexString(),32)}function ce(t){return q.encode((0,l.zo)([t,(0,l.p3)(jt(jt(t)),0,4)]))}const ue=new RegExp("^(ipfs)://(.*)$","i"),he=[new RegExp("^(https)://(.*)$","i"),new RegExp("^(data):(.*)$","i"),ue,new RegExp("^eip155:[0-9]+/(erc[0-9]+):(.*)$","i")];function de(t,e){try{return(0,I.ZN)(fe(t,e))}catch(n){}return null}function fe(t,e){if("0x"===t)return null;const n=a.O$.from((0,l.p3)(t,e,e+32)).toNumber(),r=a.O$.from((0,l.p3)(t,n,n+32)).toNumber();return(0,l.p3)(t,n+32,n+32+r)}function pe(t){return t.match(/^ipfs:\/\/ipfs\//i)?t=t.substring(12):t.match(/^ipfs:\/\//i)?t=t.substring(7):Zt.throwArgumentError("unsupported IPFS format","link",t),`https://gateway.ipfs.io/ipfs/${t}`}function me(t){const e=(0,l.lE)(t);if(e.length>32)throw new Error("internal; should not happen");const n=new Uint8Array(32);return n.set(e,32-e.length),n}function ge(t){if(t.length%32===0)return t;const e=new Uint8Array(32*Math.ceil(t.length/32));return e.set(t),e}function ve(t){const e=[];let n=0;for(let r=0;r<t.length;r++)e.push(null),n+=32;for(let r=0;r<t.length;r++){const i=(0,l.lE)(t[r]);e[r]=me(n),e.push(me(i.length)),e.push(ge(i)),n+=32+32*Math.ceil(i.length/32)}return(0,l.xs)(e)}class ye{constructor(t,e,n,i){(0,r.zG)(this,"provider",t),(0,r.zG)(this,"name",n),(0,r.zG)(this,"address",t.formatter.address(e)),(0,r.zG)(this,"_resolvedAddress",i)}supportsWildcard(){return this._supportsEip2544||(this._supportsEip2544=this.provider.call({to:this.address,data:"0x01ffc9a79061b92300000000000000000000000000000000000000000000000000000000"}).then((t=>a.O$.from(t).eq(1))).catch((t=>{if(t.code===i.Yd.errors.CALL_EXCEPTION)return!1;throw this._supportsEip2544=null,t}))),this._supportsEip2544}_fetch(t,e){return Kt(this,void 0,void 0,(function*(){const n={to:this.address,ccipReadEnabled:!0,data:(0,l.xs)([t,Rt(this.name),e||"0x"])};let r=!1;(yield this.supportsWildcard())&&(r=!0,n.data=(0,l.xs)(["0x9061b923",ve([It(this.name),n.data])]));try{let t=yield this.provider.call(n);return(0,l.lE)(t).length%32===4&&Zt.throwError("resolver threw error",i.Yd.errors.CALL_EXCEPTION,{transaction:n,data:t}),r&&(t=fe(t,0)),t}catch(s){if(s.code===i.Yd.errors.CALL_EXCEPTION)return null;throw s}}))}_fetchBytes(t,e){return Kt(this,void 0,void 0,(function*(){const n=yield this._fetch(t,e);return null!=n?fe(n,0):null}))}_getAddress(t,e){const n=ae[String(t)];if(null==n&&Zt.throwError(`unsupported coin type: ${t}`,i.Yd.errors.UNSUPPORTED_OPERATION,{operation:`getAddress(${t})`}),"eth"===n.ilk)return this.provider.formatter.address(e);const r=(0,l.lE)(e);if(null!=n.p2pkh){const t=e.match(/^0x76a9([0-9a-f][0-9a-f])([0-9a-f]*)88ac$/);if(t){const e=parseInt(t[1],16);if(t[2].length===2*e&&e>=1&&e<=75)return ce((0,l.zo)([[n.p2pkh],"0x"+t[2]]))}}if(null!=n.p2sh){const t=e.match(/^0xa9([0-9a-f][0-9a-f])([0-9a-f]*)87$/);if(t){const e=parseInt(t[1],16);if(t[2].length===2*e&&e>=1&&e<=75)return ce((0,l.zo)([[n.p2sh],"0x"+t[2]]))}}if(null!=n.prefix){const t=r[1];let e=r[0];if(0===e?20!==t&&32!==t&&(e=-1):e=-1,e>=0&&r.length===2+t&&t>=1&&t<=75){const t=qt().toWords(r.slice(2));return t.unshift(e),qt().encode(n.prefix,t)}}return null}getAddress(t){return Kt(this,void 0,void 0,(function*(){if(null==t&&(t=60),60===t)try{const t=yield this._fetch("0x3b3b57de");return"0x"===t||t===Y?null:this.provider.formatter.callAddress(t)}catch(r){if(r.code===i.Yd.errors.CALL_EXCEPTION)return null;throw r}const e=yield this._fetchBytes("0xf1cb7e06",le(t));if(null==e||"0x"===e)return null;const n=this._getAddress(t,e);return null==n&&Zt.throwError("invalid or unsupported coin data",i.Yd.errors.UNSUPPORTED_OPERATION,{operation:`getAddress(${t})`,coinType:t,data:e}),n}))}getAvatar(){return Kt(this,void 0,void 0,(function*(){const t=[{type:"name",content:this.name}];try{const e=yield this.getText("avatar");if(null==e)return null;for(let n=0;n<he.length;n++){const r=e.match(he[n]);if(null==r)continue;const i=r[1].toLowerCase();switch(i){case"https":return t.push({type:"url",content:e}),{linkage:t,url:e};case"data":return t.push({type:"data",content:e}),{linkage:t,url:e};case"ipfs":return t.push({type:"ipfs",content:e}),{linkage:t,url:pe(e)};case"erc721":case"erc1155":{const n="erc721"===i?"0xc87b56dd":"0x0e89341c";t.push({type:i,content:e});const s=this._resolvedAddress||(yield this.getAddress()),o=(r[2]||"").split("/");if(2!==o.length)return null;const c=yield this.provider.formatter.address(o[0]),u=(0,l.$m)(a.O$.from(o[1]).toHexString(),32);if("erc721"===i){const e=this.provider.formatter.callAddress(yield this.provider.call({to:c,data:(0,l.xs)(["0x6352211e",u])}));if(s!==e)return null;t.push({type:"owner",content:e})}else if("erc1155"===i){const e=a.O$.from(yield this.provider.call({to:c,data:(0,l.xs)(["0x00fdd58e",(0,l.$m)(s,32),u])}));if(e.isZero())return null;t.push({type:"balance",content:e.toString()})}const h={to:this.provider.formatter.address(o[0]),data:(0,l.xs)([n,u])};let d=de(yield this.provider.call(h),0);if(null==d)return null;t.push({type:"metadata-url-base",content:d}),"erc1155"===i&&(d=d.replace("{id}",u.substring(2)),t.push({type:"metadata-url-expanded",content:d})),d.match(/^ipfs:/i)&&(d=pe(d)),t.push({type:"metadata-url",content:d});const f=yield H(d);if(!f)return null;t.push({type:"metadata",content:JSON.stringify(f)});let p=f.image;if("string"!==typeof p)return null;if(p.match(/^(https:\/\/|data:)/i));else{const e=p.match(ue);if(null==e)return null;t.push({type:"url-ipfs",content:p}),p=pe(p)}return t.push({type:"url",content:p}),{linkage:t,url:p}}}}}catch(e){}return null}))}getContentHash(){return Kt(this,void 0,void 0,(function*(){const t=yield this._fetchBytes("0xbc1c58d1");if(null==t||"0x"===t)return null;const e=t.match(/^0xe3010170(([0-9a-f][0-9a-f])([0-9a-f][0-9a-f])([0-9a-f]*))$/);if(e){const t=parseInt(e[3],16);if(e[4].length===2*t)return"ipfs://"+q.encode("0x"+e[1])}const n=t.match(/^0xe5010172(([0-9a-f][0-9a-f])([0-9a-f][0-9a-f])([0-9a-f]*))$/);if(n){const t=parseInt(n[3],16);if(n[4].length===2*t)return"ipns://"+q.encode("0x"+n[1])}const r=t.match(/^0xe40101fa011b20([0-9a-f]*)$/);if(r&&64===r[1].length)return"bzz://"+r[1];const s=t.match(/^0x90b2c605([0-9a-f]*)$/);if(s&&68===s[1].length){const t={"=":"","+":"-","/":"_"},e=N("0x"+s[1]).replace(/[=+\/]/g,(e=>t[e]));return"sia://"+e}return Zt.throwError("invalid or unsupported content hash data",i.Yd.errors.UNSUPPORTED_OPERATION,{operation:"getContentHash()",data:t})}))}getText(t){return Kt(this,void 0,void 0,(function*(){let e=(0,I.Y0)(t);e=(0,l.zo)([le(64),le(e.length),e]),e.length%32!==0&&(e=(0,l.zo)([e,(0,l.$m)("0x",32-t.length%32)]));const n=yield this._fetchBytes("0x59d1d43c",(0,l.Dv)(e));return null==n||"0x"===n?null:(0,I.ZN)(n)}))}}let xe=null,be=1;class we extends j.zt{constructor(t){if(super(),this._events=[],this._emitted={block:-2},this.disableCcipRead=!1,this.formatter=new.target.getFormatter(),(0,r.zG)(this,"anyNetwork","any"===t),this.anyNetwork&&(t=this.detectNetwork()),t instanceof Promise)this._networkPromise=t,t.catch((t=>{})),this._ready().catch((t=>{}));else{const e=(0,r.tu)(new.target,"getNetwork")(t);e?((0,r.zG)(this,"_network",e),this.emit("network",e,null)):Zt.throwArgumentError("invalid network","network",t)}this._maxInternalBlockNumber=-1024,this._lastBlockNumber=-2,this._maxFilterBlockRange=10,this._pollingInterval=4e3,this._fastQueryDate=0}_ready(){return Kt(this,void 0,void 0,(function*(){if(null==this._network){let e=null;if(this._networkPromise)try{e=yield this._networkPromise}catch(t){}null==e&&(e=yield this.detectNetwork()),e||Zt.throwError("no network detected",i.Yd.errors.UNKNOWN_ERROR,{}),null==this._network&&(this.anyNetwork?this._network=e:(0,r.zG)(this,"_network",e),this.emit("network",e,null))}return this._network}))}get ready(){return V((()=>this._ready().then((t=>t),(t=>{if(t.code!==i.Yd.errors.NETWORK_ERROR||"noNetwork"!==t.event)throw t}))))}static getFormatter(){return null==xe&&(xe=new Jt),xe}static getNetwork(t){return Bt(null==t?"homestead":t)}ccipReadFetch(t,e,n){return Kt(this,void 0,void 0,(function*(){if(this.disableCcipRead||0===n.length)return null;const r=t.to.toLowerCase(),s=e.toLowerCase(),o=[];for(let t=0;t<n.length;t++){const e=n[t],a=e.replace("{sender}",r).replace("{data}",s),l=e.indexOf("{data}")>=0?null:JSON.stringify({data:s,sender:r}),c=yield H({url:a,errorPassThrough:!0},l,((t,e)=>(t.status=e.statusCode,t)));if(c.data)return c.data;const u=c.message||"unknown error";if(c.status>=400&&c.status<500)return Zt.throwError(`response not found during CCIP fetch: ${u}`,i.Yd.errors.SERVER_ERROR,{url:e,errorMessage:u});o.push(u)}return Zt.throwError(`error encountered during CCIP fetch: ${o.map((t=>JSON.stringify(t))).join(", ")}`,i.Yd.errors.SERVER_ERROR,{urls:n,errorMessages:o})}))}_getInternalBlockNumber(t){return Kt(this,void 0,void 0,(function*(){if(yield this._ready(),t>0)while(this._internalBlockNumber){const e=this._internalBlockNumber;try{const n=yield e;if(re()-n.respTime<=t)return n.blockNumber;break}catch(i){if(this._internalBlockNumber===e)break}}const e=re(),n=(0,r.mE)({blockNumber:this.perform("getBlockNumber",{}),networkError:this.getNetwork().then((t=>null),(t=>t))}).then((({blockNumber:t,networkError:r})=>{if(r)throw this._internalBlockNumber===n&&(this._internalBlockNumber=null),r;const i=re();return t=a.O$.from(t).toNumber(),t<this._maxInternalBlockNumber&&(t=this._maxInternalBlockNumber),this._maxInternalBlockNumber=t,this._setFastBlockNumber(t),{blockNumber:t,reqTime:e,respTime:i}}));return this._internalBlockNumber=n,n.catch((t=>{this._internalBlockNumber===n&&(this._internalBlockNumber=null)})),(yield n).blockNumber}))}poll(){return Kt(this,void 0,void 0,(function*(){const t=be++,e=[];let n=null;try{n=yield this._getInternalBlockNumber(100+this.pollingInterval/2)}catch(r){return void this.emit("error",r)}if(this._setFastBlockNumber(n),this.emit("poll",t,n),n!==this._lastBlockNumber){if(-2===this._emitted.block&&(this._emitted.block=n-1),Math.abs(this._emitted.block-n)>1e3)Zt.warn(`network block skew detected; skipping block events (emitted=${this._emitted.block} blockNumber${n})`),this.emit("error",Zt.makeError("network block skew detected",i.Yd.errors.NETWORK_ERROR,{blockNumber:n,event:"blockSkew",previousBlockNumber:this._emitted.block})),this.emit("block",n);else for(let t=this._emitted.block+1;t<=n;t++)this.emit("block",t);this._emitted.block!==n&&(this._emitted.block=n,Object.keys(this._emitted).forEach((t=>{if("block"===t)return;const e=this._emitted[t];"pending"!==e&&n-e>12&&delete this._emitted[t]}))),-2===this._lastBlockNumber&&(this._lastBlockNumber=n-1),this._events.forEach((t=>{switch(t.type){case"tx":{const n=t.hash;let r=this.getTransactionReceipt(n).then((t=>t&&null!=t.blockNumber?(this._emitted["t:"+n]=t.blockNumber,this.emit(n,t),null):null)).catch((t=>{this.emit("error",t)}));e.push(r);break}case"filter":if(!t._inflight){t._inflight=!0,-2===t._lastBlockNumber&&(t._lastBlockNumber=n-1);const r=t.filter;r.fromBlock=t._lastBlockNumber+1,r.toBlock=n;const i=r.toBlock-this._maxFilterBlockRange;i>r.fromBlock&&(r.fromBlock=i),r.fromBlock<0&&(r.fromBlock=0);const s=this.getLogs(r).then((e=>{t._inflight=!1,0!==e.length&&e.forEach((e=>{e.blockNumber>t._lastBlockNumber&&(t._lastBlockNumber=e.blockNumber),this._emitted["b:"+e.blockHash]=e.blockNumber,this._emitted["t:"+e.transactionHash]=e.blockNumber,this.emit(r,e)}))})).catch((e=>{this.emit("error",e),t._inflight=!1}));e.push(s)}break}})),this._lastBlockNumber=n,Promise.all(e).then((()=>{this.emit("didPoll",t)})).catch((t=>{this.emit("error",t)}))}else this.emit("didPoll",t)}))}resetEventsBlock(t){this._lastBlockNumber=t-1,this.polling&&this.poll()}get network(){return this._network}detectNetwork(){return Kt(this,void 0,void 0,(function*(){return Zt.throwError("provider does not support network detection",i.Yd.errors.UNSUPPORTED_OPERATION,{operation:"provider.detectNetwork"})}))}getNetwork(){return Kt(this,void 0,void 0,(function*(){const t=yield this._ready(),e=yield this.detectNetwork();if(t.chainId!==e.chainId){if(this.anyNetwork)return this._network=e,this._lastBlockNumber=-2,this._fastBlockNumber=null,this._fastBlockNumberPromise=null,this._fastQueryDate=0,this._emitted.block=-2,this._maxInternalBlockNumber=-1024,this._internalBlockNumber=null,this.emit("network",e,t),yield ie(0),this._network;const n=Zt.makeError("underlying network changed",i.Yd.errors.NETWORK_ERROR,{event:"changed",network:t,detectedNetwork:e});throw this.emit("error",n),n}return t}))}get blockNumber(){return this._getInternalBlockNumber(100+this.pollingInterval/2).then((t=>{this._setFastBlockNumber(t)}),(t=>{})),null!=this._fastBlockNumber?this._fastBlockNumber:-1}get polling(){return null!=this._poller}set polling(t){t&&!this._poller?(this._poller=setInterval((()=>{this.poll()}),this.pollingInterval),this._bootstrapPoll||(this._bootstrapPoll=setTimeout((()=>{this.poll(),this._bootstrapPoll=setTimeout((()=>{this._poller||this.poll(),this._bootstrapPoll=null}),this.pollingInterval)}),0))):!t&&this._poller&&(clearInterval(this._poller),this._poller=null)}get pollingInterval(){return this._pollingInterval}set pollingInterval(t){if("number"!==typeof t||t<=0||parseInt(String(t))!=t)throw new Error("invalid polling interval");this._pollingInterval=t,this._poller&&(clearInterval(this._poller),this._poller=setInterval((()=>{this.poll()}),this._pollingInterval))}_getFastBlockNumber(){const t=re();return t-this._fastQueryDate>2*this._pollingInterval&&(this._fastQueryDate=t,this._fastBlockNumberPromise=this.getBlockNumber().then((t=>((null==this._fastBlockNumber||t>this._fastBlockNumber)&&(this._fastBlockNumber=t),this._fastBlockNumber)))),this._fastBlockNumberPromise}_setFastBlockNumber(t){null!=this._fastBlockNumber&&t<this._fastBlockNumber||(this._fastQueryDate=re(),(null==this._fastBlockNumber||t>this._fastBlockNumber)&&(this._fastBlockNumber=t,this._fastBlockNumberPromise=Promise.resolve(t)))}waitForTransaction(t,e,n){return Kt(this,void 0,void 0,(function*(){return this._waitForTransaction(t,null==e?1:e,n||0,null)}))}_waitForTransaction(t,e,n,r){return Kt(this,void 0,void 0,(function*(){const s=yield this.getTransactionReceipt(t);return(s?s.confirmations:0)>=e?s:new Promise(((s,o)=>{const a=[];let l=!1;const c=function(){return!!l||(l=!0,a.forEach((t=>{t()})),!1)},u=t=>{t.confirmations<e||c()||s(t)};if(this.on(t,u),a.push((()=>{this.removeListener(t,u)})),r){let n=r.startBlock,s=null;const u=a=>Kt(this,void 0,void 0,(function*(){l||(yield ie(1e3),this.getTransactionCount(r.from).then((h=>Kt(this,void 0,void 0,(function*(){if(!l){if(h<=r.nonce)n=a;else{{const e=yield this.getTransaction(t);if(e&&null!=e.blockNumber)return}null==s&&(s=n-3,s<r.startBlock&&(s=r.startBlock));while(s<=a){if(l)return;const n=yield this.getBlockWithTransactions(s);for(let s=0;s<n.transactions.length;s++){const a=n.transactions[s];if(a.hash===t)return;if(a.from===r.from&&a.nonce===r.nonce){if(l)return;const n=yield this.waitForTransaction(a.hash,e);if(c())return;let s="replaced";return a.data===r.data&&a.to===r.to&&a.value.eq(r.value)?s="repriced":"0x"===a.data&&a.from===a.to&&a.value.isZero()&&(s="cancelled"),void o(Zt.makeError("transaction was replaced",i.Yd.errors.TRANSACTION_REPLACED,{cancelled:"replaced"===s||"cancelled"===s,reason:s,replacement:this._wrapTransaction(a),hash:t,receipt:n}))}}s++}}l||this.once("block",u)}}))),(t=>{l||this.once("block",u)})))}));if(l)return;this.once("block",u),a.push((()=>{this.removeListener("block",u)}))}if("number"===typeof n&&n>0){const t=setTimeout((()=>{c()||o(Zt.makeError("timeout exceeded",i.Yd.errors.TIMEOUT,{timeout:n}))}),n);t.unref&&t.unref(),a.push((()=>{clearTimeout(t)}))}}))}))}getBlockNumber(){return Kt(this,void 0,void 0,(function*(){return this._getInternalBlockNumber(0)}))}getGasPrice(){return Kt(this,void 0,void 0,(function*(){yield this.getNetwork();const t=yield this.perform("getGasPrice",{});try{return a.O$.from(t)}catch(e){return Zt.throwError("bad result from backend",i.Yd.errors.SERVER_ERROR,{method:"getGasPrice",result:t,error:e})}}))}getBalance(t,e){return Kt(this,void 0,void 0,(function*(){yield this.getNetwork();const n=yield(0,r.mE)({address:this._getAddress(t),blockTag:this._getBlockTag(e)}),s=yield this.perform("getBalance",n);try{return a.O$.from(s)}catch(o){return Zt.throwError("bad result from backend",i.Yd.errors.SERVER_ERROR,{method:"getBalance",params:n,result:s,error:o})}}))}getTransactionCount(t,e){return Kt(this,void 0,void 0,(function*(){yield this.getNetwork();const n=yield(0,r.mE)({address:this._getAddress(t),blockTag:this._getBlockTag(e)}),s=yield this.perform("getTransactionCount",n);try{return a.O$.from(s).toNumber()}catch(o){return Zt.throwError("bad result from backend",i.Yd.errors.SERVER_ERROR,{method:"getTransactionCount",params:n,result:s,error:o})}}))}getCode(t,e){return Kt(this,void 0,void 0,(function*(){yield this.getNetwork();const n=yield(0,r.mE)({address:this._getAddress(t),blockTag:this._getBlockTag(e)}),s=yield this.perform("getCode",n);try{return(0,l.Dv)(s)}catch(o){return Zt.throwError("bad result from backend",i.Yd.errors.SERVER_ERROR,{method:"getCode",params:n,result:s,error:o})}}))}getStorageAt(t,e,n){return Kt(this,void 0,void 0,(function*(){yield this.getNetwork();const s=yield(0,r.mE)({address:this._getAddress(t),blockTag:this._getBlockTag(n),position:Promise.resolve(e).then((t=>(0,l.$P)(t)))}),o=yield this.perform("getStorageAt",s);try{return(0,l.Dv)(o)}catch(a){return Zt.throwError("bad result from backend",i.Yd.errors.SERVER_ERROR,{method:"getStorageAt",params:s,result:o,error:a})}}))}_wrapTransaction(t,e,n){if(null!=e&&32!==(0,l.E1)(e))throw new Error("invalid response - sendTransaction");const r=t;return null!=e&&t.hash!==e&&Zt.throwError("Transaction hash mismatch from Provider.sendTransaction.",i.Yd.errors.UNKNOWN_ERROR,{expectedHash:t.hash,returnedHash:e}),r.wait=(e,r)=>Kt(this,void 0,void 0,(function*(){let s;null==e&&(e=1),null==r&&(r=0),0!==e&&null!=n&&(s={data:t.data,from:t.from,nonce:t.nonce,to:t.to,value:t.value,startBlock:n});const o=yield this._waitForTransaction(t.hash,e,r,s);return null==o&&0===e?null:(this._emitted["t:"+t.hash]=o.blockNumber,0===o.status&&Zt.throwError("transaction failed",i.Yd.errors.CALL_EXCEPTION,{transactionHash:t.hash,transaction:t,receipt:o}),o)})),r}sendTransaction(t){return Kt(this,void 0,void 0,(function*(){yield this.getNetwork();const e=yield Promise.resolve(t).then((t=>(0,l.Dv)(t))),n=this.formatter.transaction(t);null==n.confirmations&&(n.confirmations=0);const r=yield this._getInternalBlockNumber(100+2*this.pollingInterval);try{const t=yield this.perform("sendTransaction",{signedTransaction:e});return this._wrapTransaction(n,t,r)}catch(i){throw i.transaction=n,i.transactionHash=n.hash,i}}))}_getTransactionRequest(t){return Kt(this,void 0,void 0,(function*(){const e=yield t,n={};return["from","to"].forEach((t=>{null!=e[t]&&(n[t]=Promise.resolve(e[t]).then((t=>t?this._getAddress(t):null)))})),["gasLimit","gasPrice","maxFeePerGas","maxPriorityFeePerGas","value"].forEach((t=>{null!=e[t]&&(n[t]=Promise.resolve(e[t]).then((t=>t?a.O$.from(t):null)))})),["type"].forEach((t=>{null!=e[t]&&(n[t]=Promise.resolve(e[t]).then((t=>null!=t?t:null)))})),e.accessList&&(n.accessList=this.formatter.accessList(e.accessList)),["data"].forEach((t=>{null!=e[t]&&(n[t]=Promise.resolve(e[t]).then((t=>t?(0,l.Dv)(t):null)))})),this.formatter.transactionRequest(yield(0,r.mE)(n))}))}_getFilter(t){return Kt(this,void 0,void 0,(function*(){t=yield t;const e={};return null!=t.address&&(e.address=this._getAddress(t.address)),["blockHash","topics"].forEach((n=>{null!=t[n]&&(e[n]=t[n])})),["fromBlock","toBlock"].forEach((n=>{null!=t[n]&&(e[n]=this._getBlockTag(t[n]))})),this.formatter.filter(yield(0,r.mE)(e))}))}_call(t,e,n){return Kt(this,void 0,void 0,(function*(){n>=Qt&&Zt.throwError("CCIP read exceeded maximum redirections",i.Yd.errors.SERVER_ERROR,{redirects:n,transaction:t});const r=t.to,s=yield this.perform("call",{transaction:t,blockTag:e});if(n>=0&&"latest"===e&&null!=r&&"0x556f1830"===s.substring(0,10)&&(0,l.E1)(s)%32===4)try{const o=(0,l.p3)(s,4),c=(0,l.p3)(o,0,32);a.O$.from(c).eq(r)||Zt.throwError("CCIP Read sender did not match",i.Yd.errors.CALL_EXCEPTION,{name:"OffchainLookup",signature:"OffchainLookup(address,string[],bytes,bytes4,bytes)",transaction:t,data:s});const u=[],h=a.O$.from((0,l.p3)(o,32,64)).toNumber(),d=a.O$.from((0,l.p3)(o,h,h+32)).toNumber(),f=(0,l.p3)(o,h+32);for(let e=0;e<d;e++){const n=de(f,32*e);null==n&&Zt.throwError("CCIP Read contained corrupt URL string",i.Yd.errors.CALL_EXCEPTION,{name:"OffchainLookup",signature:"OffchainLookup(address,string[],bytes,bytes4,bytes)",transaction:t,data:s}),u.push(n)}const p=fe(o,64);a.O$.from((0,l.p3)(o,100,128)).isZero()||Zt.throwError("CCIP Read callback selector included junk",i.Yd.errors.CALL_EXCEPTION,{name:"OffchainLookup",signature:"OffchainLookup(address,string[],bytes,bytes4,bytes)",transaction:t,data:s});const m=(0,l.p3)(o,96,100),g=fe(o,128),v=yield this.ccipReadFetch(t,p,u);null==v&&Zt.throwError("CCIP Read disabled or provided no URLs",i.Yd.errors.CALL_EXCEPTION,{name:"OffchainLookup",signature:"OffchainLookup(address,string[],bytes,bytes4,bytes)",transaction:t,data:s});const y={to:r,data:(0,l.xs)([m,ve([v,g])])};return this._call(y,e,n+1)}catch(o){if(o.code===i.Yd.errors.SERVER_ERROR)throw o}try{return(0,l.Dv)(s)}catch(o){return Zt.throwError("bad result from backend",i.Yd.errors.SERVER_ERROR,{method:"call",params:{transaction:t,blockTag:e},result:s,error:o})}}))}call(t,e){return Kt(this,void 0,void 0,(function*(){yield this.getNetwork();const n=yield(0,r.mE)({transaction:this._getTransactionRequest(t),blockTag:this._getBlockTag(e),ccipReadEnabled:Promise.resolve(t.ccipReadEnabled)});return this._call(n.transaction,n.blockTag,n.ccipReadEnabled?0:-1)}))}estimateGas(t){return Kt(this,void 0,void 0,(function*(){yield this.getNetwork();const e=yield(0,r.mE)({transaction:this._getTransactionRequest(t)}),n=yield this.perform("estimateGas",e);try{return a.O$.from(n)}catch(s){return Zt.throwError("bad result from backend",i.Yd.errors.SERVER_ERROR,{method:"estimateGas",params:e,result:n,error:s})}}))}_getAddress(t){return Kt(this,void 0,void 0,(function*(){t=yield t,"string"!==typeof t&&Zt.throwArgumentError("invalid address or ENS name","name",t);const e=yield this.resolveName(t);return null==e&&Zt.throwError("ENS name not configured",i.Yd.errors.UNSUPPORTED_OPERATION,{operation:`resolveName(${JSON.stringify(t)})`}),e}))}_getBlock(t,e){return Kt(this,void 0,void 0,(function*(){yield this.getNetwork(),t=yield t;let n=-128;const r={includeTransactions:!!e};if((0,l.A7)(t,32))r.blockHash=t;else try{r.blockTag=yield this._getBlockTag(t),(0,l.A7)(r.blockTag)&&(n=parseInt(r.blockTag.substring(2),16))}catch(i){Zt.throwArgumentError("invalid block hash or block tag","blockHashOrBlockTag",t)}return V((()=>Kt(this,void 0,void 0,(function*(){const t=yield this.perform("getBlock",r);if(null==t)return null!=r.blockHash&&null==this._emitted["b:"+r.blockHash]||null!=r.blockTag&&n>this._emitted.block?null:void 0;if(e){let e=null;for(let r=0;r<t.transactions.length;r++){const n=t.transactions[r];if(null==n.blockNumber)n.confirmations=0;else if(null==n.confirmations){null==e&&(e=yield this._getInternalBlockNumber(100+2*this.pollingInterval));let t=e-n.blockNumber+1;t<=0&&(t=1),n.confirmations=t}}const n=this.formatter.blockWithTransactions(t);return n.transactions=n.transactions.map((t=>this._wrapTransaction(t))),n}return this.formatter.block(t)}))),{oncePoll:this})}))}getBlock(t){return this._getBlock(t,!1)}getBlockWithTransactions(t){return this._getBlock(t,!0)}getTransaction(t){return Kt(this,void 0,void 0,(function*(){yield this.getNetwork(),t=yield t;const e={transactionHash:this.formatter.hash(t,!0)};return V((()=>Kt(this,void 0,void 0,(function*(){const n=yield this.perform("getTransaction",e);if(null==n)return null==this._emitted["t:"+t]?null:void 0;const r=this.formatter.transactionResponse(n);if(null==r.blockNumber)r.confirmations=0;else if(null==r.confirmations){const t=yield this._getInternalBlockNumber(100+2*this.pollingInterval);let e=t-r.blockNumber+1;e<=0&&(e=1),r.confirmations=e}return this._wrapTransaction(r)}))),{oncePoll:this})}))}getTransactionReceipt(t){return Kt(this,void 0,void 0,(function*(){yield this.getNetwork(),t=yield t;const e={transactionHash:this.formatter.hash(t,!0)};return V((()=>Kt(this,void 0,void 0,(function*(){const n=yield this.perform("getTransactionReceipt",e);if(null==n)return null==this._emitted["t:"+t]?null:void 0;if(null==n.blockHash)return;const r=this.formatter.receipt(n);if(null==r.blockNumber)r.confirmations=0;else if(null==r.confirmations){const t=yield this._getInternalBlockNumber(100+2*this.pollingInterval);let e=t-r.blockNumber+1;e<=0&&(e=1),r.confirmations=e}return r}))),{oncePoll:this})}))}getLogs(t){return Kt(this,void 0,void 0,(function*(){yield this.getNetwork();const e=yield(0,r.mE)({filter:this._getFilter(t)}),n=yield this.perform("getLogs",e);return n.forEach((t=>{null==t.removed&&(t.removed=!1)})),Jt.arrayOf(this.formatter.filterLog.bind(this.formatter))(n)}))}getEtherPrice(){return Kt(this,void 0,void 0,(function*(){return yield this.getNetwork(),this.perform("getEtherPrice",{})}))}_getBlockTag(t){return Kt(this,void 0,void 0,(function*(){if(t=yield t,"number"===typeof t&&t<0){t%1&&Zt.throwArgumentError("invalid BlockTag","blockTag",t);let e=yield this._getInternalBlockNumber(100+2*this.pollingInterval);return e+=t,e<0&&(e=0),this.formatter.blockTag(e)}return this.formatter.blockTag(t)}))}getResolver(t){return Kt(this,void 0,void 0,(function*(){let e=t;while(1){if(""===e||"."===e)return null;if("eth"!==t&&"eth"===e)return null;const n=yield this._getResolver(e,"getResolver");if(null!=n){const r=new ye(this,n,t);return e===t||(yield r.supportsWildcard())?r:null}e=e.split(".").slice(1).join(".")}}))}_getResolver(t,e){return Kt(this,void 0,void 0,(function*(){null==e&&(e="ENS");const n=yield this.getNetwork();n.ensAddress||Zt.throwError("network does not support ENS",i.Yd.errors.UNSUPPORTED_OPERATION,{operation:e,network:n.name});try{const e=yield this.call({to:n.ensAddress,data:"0x0178b8bf"+Rt(t).substring(2)});return this.formatter.callAddress(e)}catch(r){}return null}))}resolveName(t){return Kt(this,void 0,void 0,(function*(){t=yield t;try{return Promise.resolve(this.formatter.address(t))}catch(n){if((0,l.A7)(t))throw n}"string"!==typeof t&&Zt.throwArgumentError("invalid ENS name","name",t);const e=yield this.getResolver(t);return e?yield e.getAddress():null}))}lookupAddress(t){return Kt(this,void 0,void 0,(function*(){t=yield t,t=this.formatter.address(t);const e=t.substring(2).toLowerCase()+".addr.reverse",n=yield this._getResolver(e,"lookupAddress");if(null==n)return null;const r=de(yield this.call({to:n,data:"0x691f3431"+Rt(e).substring(2)}),0),i=yield this.resolveName(r);return i!=t?null:r}))}getAvatar(t){return Kt(this,void 0,void 0,(function*(){let e=null;if((0,l.A7)(t)){const n=this.formatter.address(t),s=n.substring(2).toLowerCase()+".addr.reverse",o=yield this._getResolver(s,"getAvatar");if(!o)return null;e=new ye(this,o,s);try{const t=yield e.getAvatar();if(t)return t.url}catch(r){if(r.code!==i.Yd.errors.CALL_EXCEPTION)throw r}try{const t=de(yield this.call({to:o,data:"0x691f3431"+Rt(s).substring(2)}),0);e=yield this.getResolver(t)}catch(r){if(r.code!==i.Yd.errors.CALL_EXCEPTION)throw r;return null}}else if(e=yield this.getResolver(t),!e)return null;const n=yield e.getAvatar();return null==n?null:n.url}))}perform(t,e){return Zt.throwError(t+" not implemented",i.Yd.errors.NOT_IMPLEMENTED,{operation:t})}_startEvent(t){this.polling=this._events.filter((t=>t.pollable())).length>0}_stopEvent(t){this.polling=this._events.filter((t=>t.pollable())).length>0}_addEventListener(t,e,n){const r=new oe(ne(t),e,n);return this._events.push(r),this._startEvent(r),this}on(t,e){return this._addEventListener(t,e,!1)}once(t,e){return this._addEventListener(t,e,!0)}emit(t,...e){let n=!1,r=[],i=ne(t);return this._events=this._events.filter((t=>t.tag!==i||(setTimeout((()=>{t.listener.apply(this,e)}),0),n=!0,!t.once||(r.push(t),!1)))),r.forEach((t=>{this._stopEvent(t)})),n}listenerCount(t){if(!t)return this._events.length;let e=ne(t);return this._events.filter((t=>t.tag===e)).length}listeners(t){if(null==t)return this._events.map((t=>t.listener));let e=ne(t);return this._events.filter((t=>t.tag===e)).map((t=>t.listener))}off(t,e){if(null==e)return this.removeAllListeners(t);const n=[];let r=!1,i=ne(t);return this._events=this._events.filter((t=>t.tag!==i||t.listener!=e||(!!r||(r=!0,n.push(t),!1)))),n.forEach((t=>{this._stopEvent(t)})),this}removeAllListeners(t){let e=[];if(null==t)e=this._events,this._events=[];else{const n=ne(t);this._events=this._events.filter((t=>t.tag!==n||(e.push(t),!1)))}return e.forEach((t=>{this._stopEvent(t)})),this}}var _e=function(t,e,n,r){function i(t){return t instanceof n?t:new n((function(e){e(t)}))}return new(n||(n=Promise))((function(n,s){function o(t){try{l(r.next(t))}catch(e){s(e)}}function a(t){try{l(r["throw"](t))}catch(e){s(e)}}function l(t){t.done?n(t.value):i(t.value).then(o,a)}l((r=r.apply(t,e||[])).next())}))};const Me=new i.Yd(s),Ae=["call","estimateGas"];function Se(t,e){if(null==t)return null;if("string"===typeof t.message&&t.message.match("reverted")){const n=(0,l.A7)(t.data)?t.data:null;if(!e||n)return{message:t.message,data:n}}if("object"===typeof t){for(const n in t){const r=Se(t[n],e);if(r)return r}return null}if("string"===typeof t)try{return Se(JSON.parse(t),e)}catch(n){}return null}function Ee(t,e,n){const r=n.transaction||n.signedTransaction;if("call"===t){const t=Se(e,!0);if(t)return t.data;Me.throwError("missing revert data in call exception; Transaction reverted without a reason string",i.Yd.errors.CALL_EXCEPTION,{data:"0x",transaction:r,error:e})}if("estimateGas"===t){let n=Se(e.body,!1);null==n&&(n=Se(e,!1)),n&&Me.throwError("cannot estimate gas; transaction may fail or may require manual gas limit",i.Yd.errors.UNPREDICTABLE_GAS_LIMIT,{reason:n.message,method:t,transaction:r,error:e})}let s=e.message;throw e.code===i.Yd.errors.SERVER_ERROR&&e.error&&"string"===typeof e.error.message?s=e.error.message:"string"===typeof e.body?s=e.body:"string"===typeof e.responseText&&(s=e.responseText),s=(s||"").toLowerCase(),s.match(/insufficient funds|base fee exceeds gas limit/i)&&Me.throwError("insufficient funds for intrinsic transaction cost",i.Yd.errors.INSUFFICIENT_FUNDS,{error:e,method:t,transaction:r}),s.match(/nonce (is )?too low/i)&&Me.throwError("nonce has already been used",i.Yd.errors.NONCE_EXPIRED,{error:e,method:t,transaction:r}),s.match(/replacement transaction underpriced|transaction gas price.*too low/i)&&Me.throwError("replacement fee too low",i.Yd.errors.REPLACEMENT_UNDERPRICED,{error:e,method:t,transaction:r}),s.match(/only replay-protected/i)&&Me.throwError("legacy pre-eip-155 transactions not supported",i.Yd.errors.UNSUPPORTED_OPERATION,{error:e,method:t,transaction:r}),Ae.indexOf(t)>=0&&s.match(/gas required exceeds allowance|always failing transaction|execution reverted/)&&Me.throwError("cannot estimate gas; transaction may fail or may require manual gas limit",i.Yd.errors.UNPREDICTABLE_GAS_LIMIT,{error:e,method:t,transaction:r}),e}function Te(t){return new Promise((function(e){setTimeout(e,t)}))}function Ce(t){if(t.error){const e=new Error(t.error.message);throw e.code=t.error.code,e.data=t.error.data,e}return t.result}function Re(t){return t?t.toLowerCase():t}const Ie={};class Pe extends o.E{constructor(t,e,n){if(super(),t!==Ie)throw new Error("do not call the JsonRpcSigner constructor directly; use provider.getSigner");(0,r.zG)(this,"provider",e),null==n&&(n=0),"string"===typeof n?((0,r.zG)(this,"_address",this.provider.formatter.address(n)),(0,r.zG)(this,"_index",null)):"number"===typeof n?((0,r.zG)(this,"_index",n),(0,r.zG)(this,"_address",null)):Me.throwArgumentError("invalid address or index","addressOrIndex",n)}connect(t){return Me.throwError("cannot alter JSON-RPC Signer connection",i.Yd.errors.UNSUPPORTED_OPERATION,{operation:"connect"})}connectUnchecked(){return new Le(Ie,this.provider,this._address||this._index)}getAddress(){return this._address?Promise.resolve(this._address):this.provider.send("eth_accounts",[]).then((t=>(t.length<=this._index&&Me.throwError("unknown account #"+this._index,i.Yd.errors.UNSUPPORTED_OPERATION,{operation:"getAddress"}),this.provider.formatter.address(t[this._index]))))}sendUncheckedTransaction(t){t=(0,r.DC)(t);const e=this.getAddress().then((t=>(t&&(t=t.toLowerCase()),t)));if(null==t.gasLimit){const n=(0,r.DC)(t);n.from=e,t.gasLimit=this.provider.estimateGas(n)}return null!=t.to&&(t.to=Promise.resolve(t.to).then((t=>_e(this,void 0,void 0,(function*(){if(null==t)return null;const e=yield this.provider.resolveName(t);return null==e&&Me.throwArgumentError("provided ENS name resolves to null","tx.to",t),e}))))),(0,r.mE)({tx:(0,r.mE)(t),sender:e}).then((({tx:e,sender:n})=>{null!=e.from?e.from.toLowerCase()!==n&&Me.throwArgumentError("from address mismatch","transaction",t):e.from=n;const r=this.provider.constructor.hexlifyTransaction(e,{from:!0});return this.provider.send("eth_sendTransaction",[r]).then((t=>t),(t=>("string"===typeof t.message&&t.message.match(/user denied/i)&&Me.throwError("user rejected transaction",i.Yd.errors.ACTION_REJECTED,{action:"sendTransaction",transaction:e}),Ee("sendTransaction",t,r))))}))}signTransaction(t){return Me.throwError("signing transactions is unsupported",i.Yd.errors.UNSUPPORTED_OPERATION,{operation:"signTransaction"})}sendTransaction(t){return _e(this,void 0,void 0,(function*(){const e=yield this.provider._getInternalBlockNumber(100+2*this.provider.pollingInterval),n=yield this.sendUncheckedTransaction(t);try{return yield V((()=>_e(this,void 0,void 0,(function*(){const t=yield this.provider.getTransaction(n);if(null!==t)return this.provider._wrapTransaction(t,n,e)}))),{oncePoll:this.provider})}catch(r){throw r.transactionHash=n,r}}))}signMessage(t){return _e(this,void 0,void 0,(function*(){const e="string"===typeof t?(0,I.Y0)(t):t,n=yield this.getAddress();try{return yield this.provider.send("personal_sign",[(0,l.Dv)(e),n.toLowerCase()])}catch(r){throw"string"===typeof r.message&&r.message.match(/user denied/i)&&Me.throwError("user rejected signing",i.Yd.errors.ACTION_REJECTED,{action:"signMessage",from:n,message:e}),r}}))}_legacySignMessage(t){return _e(this,void 0,void 0,(function*(){const e="string"===typeof t?(0,I.Y0)(t):t,n=yield this.getAddress();try{return yield this.provider.send("eth_sign",[n.toLowerCase(),(0,l.Dv)(e)])}catch(r){throw"string"===typeof r.message&&r.message.match(/user denied/i)&&Me.throwError("user rejected signing",i.Yd.errors.ACTION_REJECTED,{action:"_legacySignMessage",from:n,message:e}),r}}))}_signTypedData(t,e,n){return _e(this,void 0,void 0,(function*(){const r=yield R.resolveNames(t,e,n,(t=>this.provider.resolveName(t))),s=yield this.getAddress();try{return yield this.provider.send("eth_signTypedData_v4",[s.toLowerCase(),JSON.stringify(R.getPayload(r.domain,e,r.value))])}catch(o){throw"string"===typeof o.message&&o.message.match(/user denied/i)&&Me.throwError("user rejected signing",i.Yd.errors.ACTION_REJECTED,{action:"_signTypedData",from:s,message:{domain:r.domain,types:e,value:r.value}}),o}}))}unlock(t){return _e(this,void 0,void 0,(function*(){const e=this.provider,n=yield this.getAddress();return e.send("personal_unlockAccount",[n.toLowerCase(),t,null])}))}}class Le extends Pe{sendTransaction(t){return this.sendUncheckedTransaction(t).then((t=>({hash:t,nonce:null,gasLimit:null,gasPrice:null,data:null,value:null,chainId:null,confirmations:0,from:null,wait:e=>this.provider.waitForTransaction(t,e)})))}}const Ne={chainId:!0,data:!0,gasLimit:!0,gasPrice:!0,nonce:!0,to:!0,value:!0,type:!0,accessList:!0,maxFeePerGas:!0,maxPriorityFeePerGas:!0};class ke extends we{constructor(t,e){let n=e;null==n&&(n=new Promise(((t,e)=>{setTimeout((()=>{this.detectNetwork().then((e=>{t(e)}),(t=>{e(t)}))}),0)}))),super(n),t||(t=(0,r.tu)(this.constructor,"defaultUrl")()),"string"===typeof t?(0,r.zG)(this,"connection",Object.freeze({url:t})):(0,r.zG)(this,"connection",Object.freeze((0,r.DC)(t))),this._nextId=42}get _cache(){return null==this._eventLoopCache&&(this._eventLoopCache={}),this._eventLoopCache}static defaultUrl(){return"http://localhost:8545"}detectNetwork(){return this._cache["detectNetwork"]||(this._cache["detectNetwork"]=this._uncachedDetectNetwork(),setTimeout((()=>{this._cache["detectNetwork"]=null}),0)),this._cache["detectNetwork"]}_uncachedDetectNetwork(){return _e(this,void 0,void 0,(function*(){yield Te(0);let t=null;try{t=yield this.send("eth_chainId",[])}catch(e){try{t=yield this.send("net_version",[])}catch(e){}}if(null!=t){const n=(0,r.tu)(this.constructor,"getNetwork");try{return n(a.O$.from(t).toNumber())}catch(e){return Me.throwError("could not detect network",i.Yd.errors.NETWORK_ERROR,{chainId:t,event:"invalidNetwork",serverError:e})}}return Me.throwError("could not detect network",i.Yd.errors.NETWORK_ERROR,{event:"noNetwork"})}))}getSigner(t){return new Pe(Ie,this,t)}getUncheckedSigner(t){return this.getSigner(t).connectUnchecked()}listAccounts(){return this.send("eth_accounts",[]).then((t=>t.map((t=>this.formatter.address(t)))))}send(t,e){const n={method:t,params:e,id:this._nextId++,jsonrpc:"2.0"};this.emit("debug",{action:"request",request:(0,r.p$)(n),provider:this});const i=["eth_chainId","eth_blockNumber"].indexOf(t)>=0;if(i&&this._cache[t])return this._cache[t];const s=H(this.connection,JSON.stringify(n),Ce).then((t=>(this.emit("debug",{action:"response",request:n,response:t,provider:this}),t)),(t=>{throw this.emit("debug",{action:"response",error:t,request:n,provider:this}),t}));return i&&(this._cache[t]=s,setTimeout((()=>{this._cache[t]=null}),0)),s}prepareRequest(t,e){switch(t){case"getBlockNumber":return["eth_blockNumber",[]];case"getGasPrice":return["eth_gasPrice",[]];case"getBalance":return["eth_getBalance",[Re(e.address),e.blockTag]];case"getTransactionCount":return["eth_getTransactionCount",[Re(e.address),e.blockTag]];case"getCode":return["eth_getCode",[Re(e.address),e.blockTag]];case"getStorageAt":return["eth_getStorageAt",[Re(e.address),(0,l.$m)(e.position,32),e.blockTag]];case"sendTransaction":return["eth_sendRawTransaction",[e.signedTransaction]];case"getBlock":return e.blockTag?["eth_getBlockByNumber",[e.blockTag,!!e.includeTransactions]]:e.blockHash?["eth_getBlockByHash",[e.blockHash,!!e.includeTransactions]]:null;case"getTransaction":return["eth_getTransactionByHash",[e.transactionHash]];case"getTransactionReceipt":return["eth_getTransactionReceipt",[e.transactionHash]];case"call":{const t=(0,r.tu)(this.constructor,"hexlifyTransaction");return["eth_call",[t(e.transaction,{from:!0}),e.blockTag]]}case"estimateGas":{const t=(0,r.tu)(this.constructor,"hexlifyTransaction");return["eth_estimateGas",[t(e.transaction,{from:!0})]]}case"getLogs":return e.filter&&null!=e.filter.address&&(e.filter.address=Re(e.filter.address)),["eth_getLogs",[e.filter]];default:break}return null}perform(t,e){return _e(this,void 0,void 0,(function*(){if("call"===t||"estimateGas"===t){const t=e.transaction;if(t&&null!=t.type&&a.O$.from(t.type).isZero()&&null==t.maxFeePerGas&&null==t.maxPriorityFeePerGas){const n=yield this.getFeeData();null==n.maxFeePerGas&&null==n.maxPriorityFeePerGas&&(e=(0,r.DC)(e),e.transaction=(0,r.DC)(t),delete e.transaction.type)}}const n=this.prepareRequest(t,e);null==n&&Me.throwError(t+" not implemented",i.Yd.errors.NOT_IMPLEMENTED,{operation:t});try{return yield this.send(n[0],n[1])}catch(s){return Ee(t,s,e)}}))}_startEvent(t){"pending"===t.tag&&this._startPending(),super._startEvent(t)}_startPending(){if(null!=this._pendingFilter)return;const t=this,e=this.send("eth_newPendingTransactionFilter",[]);this._pendingFilter=e,e.then((function(n){function r(){t.send("eth_getFilterChanges",[n]).then((function(n){if(t._pendingFilter!=e)return null;let r=Promise.resolve();return n.forEach((function(e){t._emitted["t:"+e.toLowerCase()]="pending",r=r.then((function(){return t.getTransaction(e).then((function(e){return t.emit("pending",e),null}))}))})),r.then((function(){return Te(1e3)}))})).then((function(){if(t._pendingFilter==e)return setTimeout((function(){r()}),0),null;t.send("eth_uninstallFilter",[n])})).catch((t=>{}))}return r(),n})).catch((t=>{}))}_stopEvent(t){"pending"===t.tag&&0===this.listenerCount("pending")&&(this._pendingFilter=null),super._stopEvent(t)}static hexlifyTransaction(t,e){const n=(0,r.DC)(Ne);if(e)for(const r in e)e[r]&&(n[r]=!0);(0,r.uj)(t,n);const i={};return["chainId","gasLimit","gasPrice","type","maxFeePerGas","maxPriorityFeePerGas","nonce","value"].forEach((function(e){if(null==t[e])return;const n=(0,l.$P)(a.O$.from(t[e]));"gasLimit"===e&&(e="gas"),i[e]=n})),["from","to","data"].forEach((function(e){null!=t[e]&&(i[e]=(0,l.Dv)(t[e]))})),t.accessList&&(i["accessList"]=(0,P.z7)(t.accessList)),i}}const Oe=new i.Yd(s);let De=1;function ze(t,e){const n="Web3LegacyFetcher";return function(t,i){const s={method:t,params:i,id:De++,jsonrpc:"2.0"};return new Promise(((t,i)=>{this.emit("debug",{action:"request",fetcher:n,request:(0,r.p$)(s),provider:this}),e(s,((e,r)=>{if(e)return this.emit("debug",{action:"response",fetcher:n,error:e,request:s,provider:this}),i(e);if(this.emit("debug",{action:"response",fetcher:n,request:s,response:r,provider:this}),r.error){const t=new Error(r.error.message);return t.code=r.error.code,t.data=r.error.data,i(t)}t(r.result)}))}))}}function Fe(t){return function(e,n){null==n&&(n=[]);const i={method:e,params:n};return this.emit("debug",{action:"request",fetcher:"Eip1193Fetcher",request:(0,r.p$)(i),provider:this}),t.request(i).then((t=>(this.emit("debug",{action:"response",fetcher:"Eip1193Fetcher",request:i,response:t,provider:this}),t)),(t=>{throw this.emit("debug",{action:"response",fetcher:"Eip1193Fetcher",request:i,error:t,provider:this}),t}))}}class Ue extends ke{constructor(t,e){null==t&&Oe.throwArgumentError("missing provider","provider",t);let n=null,i=null,s=null;"function"===typeof t?(n="unknown:",i=t):(n=t.host||t.path||"",!n&&t.isMetaMask&&(n="metamask"),s=t,t.request?(""===n&&(n="eip-1193:"),i=Fe(t)):t.sendAsync?i=ze(t,t.sendAsync.bind(t)):t.send?i=ze(t,t.send.bind(t)):Oe.throwArgumentError("unsupported provider","provider",t),n||(n="unknown:")),super(n,e),(0,r.zG)(this,"jsonRpcFetchFunc",i),(0,r.zG)(this,"provider",s)}send(t,e){return this.jsonRpcFetchFunc(t,e)}}},7991:function(t,e,n){"use strict";n.d(e,{J:function(){return f},c:function(){return u}});var r=n(6482),i=n(8737);const s="rlp/5.7.0",o=new i.Yd(s);function a(t){const e=[];while(t)e.unshift(255&t),t>>=8;return e}function l(t,e,n){let r=0;for(let i=0;i<n;i++)r=256*r+t[e+i];return r}function c(t){if(Array.isArray(t)){let e=[];if(t.forEach((function(t){e=e.concat(c(t))})),e.length<=55)return e.unshift(192+e.length),e;const n=a(e.length);return n.unshift(247+n.length),n.concat(e)}(0,r.Zq)(t)||o.throwArgumentError("RLP object must be BytesLike","object",t);const e=Array.prototype.slice.call((0,r.lE)(t));if(1===e.length&&e[0]<=127)return e;if(e.length<=55)return e.unshift(128+e.length),e;const n=a(e.length);return n.unshift(183+n.length),n.concat(e)}function u(t){return(0,r.Dv)(c(t))}function h(t,e,n,r){const s=[];while(n<e+1+r){const a=d(t,n);s.push(a.result),n+=a.consumed,n>e+1+r&&o.throwError("child data too short",i.Yd.errors.BUFFER_OVERRUN,{})}return{consumed:1+r,result:s}}function d(t,e){if(0===t.length&&o.throwError("data too short",i.Yd.errors.BUFFER_OVERRUN,{}),t[e]>=248){const n=t[e]-247;e+1+n>t.length&&o.throwError("data short segment too short",i.Yd.errors.BUFFER_OVERRUN,{});const r=l(t,e+1,n);return e+1+n+r>t.length&&o.throwError("data long segment too short",i.Yd.errors.BUFFER_OVERRUN,{}),h(t,e,e+1+n,n+r)}if(t[e]>=192){const n=t[e]-192;return e+1+n>t.length&&o.throwError("data array too short",i.Yd.errors.BUFFER_OVERRUN,{}),h(t,e,e+1,n)}if(t[e]>=184){const n=t[e]-183;e+1+n>t.length&&o.throwError("data array too short",i.Yd.errors.BUFFER_OVERRUN,{});const s=l(t,e+1,n);e+1+n+s>t.length&&o.throwError("data array too short",i.Yd.errors.BUFFER_OVERRUN,{});const a=(0,r.Dv)(t.slice(e+1+n,e+1+n+s));return{consumed:1+n+s,result:a}}if(t[e]>=128){const n=t[e]-128;e+1+n>t.length&&o.throwError("data too short",i.Yd.errors.BUFFER_OVERRUN,{});const s=(0,r.Dv)(t.slice(e+1,e+1+n));return{consumed:1+n,result:s}}return{consumed:1,result:(0,r.Dv)(t[e])}}function f(t){const e=(0,r.lE)(t),n=d(e,0);return n.consumed!==e.length&&o.throwArgumentError("invalid rlp data","data",t),n.result}},4469:function(t,e,n){"use strict";n.d(e,{Y0:function(){return p},XL:function(){return v},ZN:function(){return g}});n(1703);var r=n(6482),i=n(8737);const s="strings/5.7.0",o=new i.Yd(s);var a,l;function c(t,e,n,r,i){return o.throwArgumentError(`invalid codepoint at offset ${e}; ${t}`,"bytes",n)}function u(t,e,n,r,i){if(t===l.BAD_PREFIX||t===l.UNEXPECTED_CONTINUE){let t=0;for(let r=e+1;r<n.length;r++){if(n[r]>>6!==2)break;t++}return t}return t===l.OVERRUN?n.length-e-1:0}function h(t,e,n,r,i){return t===l.OVERLONG?(r.push(i),0):(r.push(65533),u(t,e,n,r,i))}(function(t){t["current"]="",t["NFC"]="NFC",t["NFD"]="NFD",t["NFKC"]="NFKC",t["NFKD"]="NFKD"})(a||(a={})),function(t){t["UNEXPECTED_CONTINUE"]="unexpected continuation byte",t["BAD_PREFIX"]="bad codepoint prefix",t["OVERRUN"]="string overrun",t["MISSING_CONTINUE"]="missing continuation byte",t["OUT_OF_RANGE"]="out of UTF-8 range",t["UTF16_SURROGATE"]="UTF-16 surrogate",t["OVERLONG"]="overlong representation"}(l||(l={}));const d=Object.freeze({error:c,ignore:u,replace:h});function f(t,e){null==e&&(e=d.error),t=(0,r.lE)(t);const n=[];let i=0;while(i<t.length){const r=t[i++];if(r>>7===0){n.push(r);continue}let s=null,o=null;if(192===(224&r))s=1,o=127;else if(224===(240&r))s=2,o=2047;else{if(240!==(248&r)){i+=e(128===(192&r)?l.UNEXPECTED_CONTINUE:l.BAD_PREFIX,i-1,t,n);continue}s=3,o=65535}if(i-1+s>=t.length){i+=e(l.OVERRUN,i-1,t,n);continue}let a=r&(1<<8-s-1)-1;for(let c=0;c<s;c++){let r=t[i];if(128!=(192&r)){i+=e(l.MISSING_CONTINUE,i,t,n),a=null;break}a=a<<6|63&r,i++}null!==a&&(a>1114111?i+=e(l.OUT_OF_RANGE,i-1-s,t,n,a):a>=55296&&a<=57343?i+=e(l.UTF16_SURROGATE,i-1-s,t,n,a):a<=o?i+=e(l.OVERLONG,i-1-s,t,n,a):n.push(a))}return n}function p(t,e=a.current){e!=a.current&&(o.checkNormalize(),t=t.normalize(e));let n=[];for(let r=0;r<t.length;r++){const e=t.charCodeAt(r);if(e<128)n.push(e);else if(e<2048)n.push(e>>6|192),n.push(63&e|128);else if(55296==(64512&e)){r++;const i=t.charCodeAt(r);if(r>=t.length||56320!==(64512&i))throw new Error("invalid utf-8 string");const s=65536+((1023&e)<<10)+(1023&i);n.push(s>>18|240),n.push(s>>12&63|128),n.push(s>>6&63|128),n.push(63&s|128)}else n.push(e>>12|224),n.push(e>>6&63|128),n.push(63&e|128)}return(0,r.lE)(n)}function m(t){return t.map((t=>t<=65535?String.fromCharCode(t):(t-=65536,String.fromCharCode(55296+(t>>10&1023),56320+(1023&t))))).join("")}function g(t,e){return m(f(t,e))}function v(t,e=a.current){return f(p(t,e))}},8019:function(t,e,n){"use strict";n.d(e,{z7:function(){return mt},Qc:function(){return Mt}});n(1703);var r=n(594),i=n(3966),s=n(6482),o=n(5554),a=n(6502),l=n(7991),c=n(2396),u=n.n(c),h=n(8730),d=n.n(h);"undefined"!==typeof globalThis?globalThis:"undefined"!==typeof window?window:"undefined"!==typeof n.g?n.g:"undefined"!==typeof self&&self;function f(t,e,n){return n={path:e,exports:{},require:function(t,e){return p(t,void 0===e||null===e?n.path:e)}},t(n,n.exports),n.exports}function p(){throw new Error("Dynamic requires are not currently supported by @rollup/plugin-commonjs")}var m=g;function g(t,e){if(!t)throw new Error(e||"Assertion failed")}g.equal=function(t,e,n){if(t!=e)throw new Error(n||"Assertion failed: "+t+" != "+e)};var v=f((function(t,e){var n=e;function r(t,e){if(Array.isArray(t))return t.slice();if(!t)return[];var n=[];if("string"!==typeof t){for(var r=0;r<t.length;r++)n[r]=0|t[r];return n}if("hex"===e){t=t.replace(/[^a-z0-9]+/gi,""),t.length%2!==0&&(t="0"+t);for(r=0;r<t.length;r+=2)n.push(parseInt(t[r]+t[r+1],16))}else for(r=0;r<t.length;r++){var i=t.charCodeAt(r),s=i>>8,o=255&i;s?n.push(s,o):n.push(o)}return n}function i(t){return 1===t.length?"0"+t:t}function s(t){for(var e="",n=0;n<t.length;n++)e+=i(t[n].toString(16));return e}n.toArray=r,n.zero2=i,n.toHex=s,n.encode=function(t,e){return"hex"===e?s(t):t}})),y=f((function(t,e){var n=e;function r(t,e,n){var r=new Array(Math.max(t.bitLength(),n)+1);r.fill(0);for(var i=1<<e+1,s=t.clone(),o=0;o<r.length;o++){var a,l=s.andln(i-1);s.isOdd()?(a=l>(i>>1)-1?(i>>1)-l:l,s.isubn(a)):a=0,r[o]=a,s.iushrn(1)}return r}function i(t,e){var n=[[],[]];t=t.clone(),e=e.clone();var r,i=0,s=0;while(t.cmpn(-i)>0||e.cmpn(-s)>0){var o,a,l=t.andln(3)+i&3,c=e.andln(3)+s&3;3===l&&(l=-1),3===c&&(c=-1),0===(1&l)?o=0:(r=t.andln(7)+i&7,o=3!==r&&5!==r||2!==c?l:-l),n[0].push(o),0===(1&c)?a=0:(r=e.andln(7)+s&7,a=3!==r&&5!==r||2!==l?c:-c),n[1].push(a),2*i===o+1&&(i=1-i),2*s===a+1&&(s=1-s),t.iushrn(1),e.iushrn(1)}return n}function s(t,e,n){var r="_"+e;t.prototype[e]=function(){return void 0!==this[r]?this[r]:this[r]=n.call(this)}}function o(t){return"string"===typeof t?n.toArray(t,"hex"):t}function a(t){return new(u())(t,"hex","le")}n.assert=m,n.toArray=v.toArray,n.zero2=v.zero2,n.toHex=v.toHex,n.encode=v.encode,n.getNAF=r,n.getJSF=i,n.cachedProperty=s,n.parseBytes=o,n.intFromLE=a})),x=y.getNAF,b=y.getJSF,w=y.assert;function _(t,e){this.type=t,this.p=new(u())(e.p,16),this.red=e.prime?u().red(e.prime):u().mont(this.p),this.zero=new(u())(0).toRed(this.red),this.one=new(u())(1).toRed(this.red),this.two=new(u())(2).toRed(this.red),this.n=e.n&&new(u())(e.n,16),this.g=e.g&&this.pointFromJSON(e.g,e.gRed),this._wnafT1=new Array(4),this._wnafT2=new Array(4),this._wnafT3=new Array(4),this._wnafT4=new Array(4),this._bitLength=this.n?this.n.bitLength():0;var n=this.n&&this.p.div(this.n);!n||n.cmpn(100)>0?this.redN=null:(this._maxwellTrick=!0,this.redN=this.n.toRed(this.red))}var M=_;function A(t,e){this.curve=t,this.type=e,this.precomputed=null}_.prototype.point=function(){throw new Error("Not implemented")},_.prototype.validate=function(){throw new Error("Not implemented")},_.prototype._fixedNafMul=function(t,e){w(t.precomputed);var n=t._getDoubles(),r=x(e,1,this._bitLength),i=(1<<n.step+1)-(n.step%2===0?2:1);i/=3;var s,o,a=[];for(s=0;s<r.length;s+=n.step){o=0;for(var l=s+n.step-1;l>=s;l--)o=(o<<1)+r[l];a.push(o)}for(var c=this.jpoint(null,null,null),u=this.jpoint(null,null,null),h=i;h>0;h--){for(s=0;s<a.length;s++)o=a[s],o===h?u=u.mixedAdd(n.points[s]):o===-h&&(u=u.mixedAdd(n.points[s].neg()));c=c.add(u)}return c.toP()},_.prototype._wnafMul=function(t,e){var n=4,r=t._getNAFPoints(n);n=r.wnd;for(var i=r.points,s=x(e,n,this._bitLength),o=this.jpoint(null,null,null),a=s.length-1;a>=0;a--){for(var l=0;a>=0&&0===s[a];a--)l++;if(a>=0&&l++,o=o.dblp(l),a<0)break;var c=s[a];w(0!==c),o="affine"===t.type?c>0?o.mixedAdd(i[c-1>>1]):o.mixedAdd(i[-c-1>>1].neg()):c>0?o.add(i[c-1>>1]):o.add(i[-c-1>>1].neg())}return"affine"===t.type?o.toP():o},_.prototype._wnafMulAdd=function(t,e,n,r,i){var s,o,a,l=this._wnafT1,c=this._wnafT2,u=this._wnafT3,h=0;for(s=0;s<r;s++){a=e[s];var d=a._getNAFPoints(t);l[s]=d.wnd,c[s]=d.points}for(s=r-1;s>=1;s-=2){var f=s-1,p=s;if(1===l[f]&&1===l[p]){var m=[e[f],null,null,e[p]];0===e[f].y.cmp(e[p].y)?(m[1]=e[f].add(e[p]),m[2]=e[f].toJ().mixedAdd(e[p].neg())):0===e[f].y.cmp(e[p].y.redNeg())?(m[1]=e[f].toJ().mixedAdd(e[p]),m[2]=e[f].add(e[p].neg())):(m[1]=e[f].toJ().mixedAdd(e[p]),m[2]=e[f].toJ().mixedAdd(e[p].neg()));var g=[-3,-1,-5,-7,0,7,5,1,3],v=b(n[f],n[p]);for(h=Math.max(v[0].length,h),u[f]=new Array(h),u[p]=new Array(h),o=0;o<h;o++){var y=0|v[0][o],w=0|v[1][o];u[f][o]=g[3*(y+1)+(w+1)],u[p][o]=0,c[f]=m}}else u[f]=x(n[f],l[f],this._bitLength),u[p]=x(n[p],l[p],this._bitLength),h=Math.max(u[f].length,h),h=Math.max(u[p].length,h)}var _=this.jpoint(null,null,null),M=this._wnafT4;for(s=h;s>=0;s--){var A=0;while(s>=0){var S=!0;for(o=0;o<r;o++)M[o]=0|u[o][s],0!==M[o]&&(S=!1);if(!S)break;A++,s--}if(s>=0&&A++,_=_.dblp(A),s<0)break;for(o=0;o<r;o++){var E=M[o];0!==E&&(E>0?a=c[o][E-1>>1]:E<0&&(a=c[o][-E-1>>1].neg()),_="affine"===a.type?_.mixedAdd(a):_.add(a))}}for(s=0;s<r;s++)c[s]=null;return i?_:_.toP()},_.BasePoint=A,A.prototype.eq=function(){throw new Error("Not implemented")},A.prototype.validate=function(){return this.curve.validate(this)},_.prototype.decodePoint=function(t,e){t=y.toArray(t,e);var n=this.p.byteLength();if((4===t[0]||6===t[0]||7===t[0])&&t.length-1===2*n){6===t[0]?w(t[t.length-1]%2===0):7===t[0]&&w(t[t.length-1]%2===1);var r=this.point(t.slice(1,1+n),t.slice(1+n,1+2*n));return r}if((2===t[0]||3===t[0])&&t.length-1===n)return this.pointFromX(t.slice(1,1+n),3===t[0]);throw new Error("Unknown point format")},A.prototype.encodeCompressed=function(t){return this.encode(t,!0)},A.prototype._encode=function(t){var e=this.curve.p.byteLength(),n=this.getX().toArray("be",e);return t?[this.getY().isEven()?2:3].concat(n):[4].concat(n,this.getY().toArray("be",e))},A.prototype.encode=function(t,e){return y.encode(this._encode(e),t)},A.prototype.precompute=function(t){if(this.precomputed)return this;var e={doubles:null,naf:null,beta:null};return e.naf=this._getNAFPoints(8),e.doubles=this._getDoubles(4,t),e.beta=this._getBeta(),this.precomputed=e,this},A.prototype._hasDoubles=function(t){if(!this.precomputed)return!1;var e=this.precomputed.doubles;return!!e&&e.points.length>=Math.ceil((t.bitLength()+1)/e.step)},A.prototype._getDoubles=function(t,e){if(this.precomputed&&this.precomputed.doubles)return this.precomputed.doubles;for(var n=[this],r=this,i=0;i<e;i+=t){for(var s=0;s<t;s++)r=r.dbl();n.push(r)}return{step:t,points:n}},A.prototype._getNAFPoints=function(t){if(this.precomputed&&this.precomputed.naf)return this.precomputed.naf;for(var e=[this],n=(1<<t)-1,r=1===n?null:this.dbl(),i=1;i<n;i++)e[i]=e[i-1].add(r);return{wnd:t,points:e}},A.prototype._getBeta=function(){return null},A.prototype.dblp=function(t){for(var e=this,n=0;n<t;n++)e=e.dbl();return e};var S=f((function(t){"function"===typeof Object.create?t.exports=function(t,e){e&&(t.super_=e,t.prototype=Object.create(e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}))}:t.exports=function(t,e){if(e){t.super_=e;var n=function(){};n.prototype=e.prototype,t.prototype=new n,t.prototype.constructor=t}}})),E=y.assert;function T(t){M.call(this,"short",t),this.a=new(u())(t.a,16).toRed(this.red),this.b=new(u())(t.b,16).toRed(this.red),this.tinv=this.two.redInvm(),this.zeroA=0===this.a.fromRed().cmpn(0),this.threeA=0===this.a.fromRed().sub(this.p).cmpn(-3),this.endo=this._getEndomorphism(t),this._endoWnafT1=new Array(4),this._endoWnafT2=new Array(4)}S(T,M);var C=T;function R(t,e,n,r){M.BasePoint.call(this,t,"affine"),null===e&&null===n?(this.x=null,this.y=null,this.inf=!0):(this.x=new(u())(e,16),this.y=new(u())(n,16),r&&(this.x.forceRed(this.curve.red),this.y.forceRed(this.curve.red)),this.x.red||(this.x=this.x.toRed(this.curve.red)),this.y.red||(this.y=this.y.toRed(this.curve.red)),this.inf=!1)}function I(t,e,n,r){M.BasePoint.call(this,t,"jacobian"),null===e&&null===n&&null===r?(this.x=this.curve.one,this.y=this.curve.one,this.z=new(u())(0)):(this.x=new(u())(e,16),this.y=new(u())(n,16),this.z=new(u())(r,16)),this.x.red||(this.x=this.x.toRed(this.curve.red)),this.y.red||(this.y=this.y.toRed(this.curve.red)),this.z.red||(this.z=this.z.toRed(this.curve.red)),this.zOne=this.z===this.curve.one}T.prototype._getEndomorphism=function(t){if(this.zeroA&&this.g&&this.n&&1===this.p.modn(3)){var e,n,r;if(t.beta)e=new(u())(t.beta,16).toRed(this.red);else{var i=this._getEndoRoots(this.p);e=i[0].cmp(i[1])<0?i[0]:i[1],e=e.toRed(this.red)}if(t.lambda)n=new(u())(t.lambda,16);else{var s=this._getEndoRoots(this.n);0===this.g.mul(s[0]).x.cmp(this.g.x.redMul(e))?n=s[0]:(n=s[1],E(0===this.g.mul(n).x.cmp(this.g.x.redMul(e))))}return r=t.basis?t.basis.map((function(t){return{a:new(u())(t.a,16),b:new(u())(t.b,16)}})):this._getEndoBasis(n),{beta:e,lambda:n,basis:r}}},T.prototype._getEndoRoots=function(t){var e=t===this.p?this.red:u().mont(t),n=new(u())(2).toRed(e).redInvm(),r=n.redNeg(),i=new(u())(3).toRed(e).redNeg().redSqrt().redMul(n),s=r.redAdd(i).fromRed(),o=r.redSub(i).fromRed();return[s,o]},T.prototype._getEndoBasis=function(t){var e,n,r,i,s,o,a,l,c,h=this.n.ushrn(Math.floor(this.n.bitLength()/2)),d=t,f=this.n.clone(),p=new(u())(1),m=new(u())(0),g=new(u())(0),v=new(u())(1),y=0;while(0!==d.cmpn(0)){var x=f.div(d);l=f.sub(x.mul(d)),c=g.sub(x.mul(p));var b=v.sub(x.mul(m));if(!r&&l.cmp(h)<0)e=a.neg(),n=p,r=l.neg(),i=c;else if(r&&2===++y)break;a=l,f=d,d=l,g=p,p=c,v=m,m=b}s=l.neg(),o=c;var w=r.sqr().add(i.sqr()),_=s.sqr().add(o.sqr());return _.cmp(w)>=0&&(s=e,o=n),r.negative&&(r=r.neg(),i=i.neg()),s.negative&&(s=s.neg(),o=o.neg()),[{a:r,b:i},{a:s,b:o}]},T.prototype._endoSplit=function(t){var e=this.endo.basis,n=e[0],r=e[1],i=r.b.mul(t).divRound(this.n),s=n.b.neg().mul(t).divRound(this.n),o=i.mul(n.a),a=s.mul(r.a),l=i.mul(n.b),c=s.mul(r.b),u=t.sub(o).sub(a),h=l.add(c).neg();return{k1:u,k2:h}},T.prototype.pointFromX=function(t,e){t=new(u())(t,16),t.red||(t=t.toRed(this.red));var n=t.redSqr().redMul(t).redIAdd(t.redMul(this.a)).redIAdd(this.b),r=n.redSqrt();if(0!==r.redSqr().redSub(n).cmp(this.zero))throw new Error("invalid point");var i=r.fromRed().isOdd();return(e&&!i||!e&&i)&&(r=r.redNeg()),this.point(t,r)},T.prototype.validate=function(t){if(t.inf)return!0;var e=t.x,n=t.y,r=this.a.redMul(e),i=e.redSqr().redMul(e).redIAdd(r).redIAdd(this.b);return 0===n.redSqr().redISub(i).cmpn(0)},T.prototype._endoWnafMulAdd=function(t,e,n){for(var r=this._endoWnafT1,i=this._endoWnafT2,s=0;s<t.length;s++){var o=this._endoSplit(e[s]),a=t[s],l=a._getBeta();o.k1.negative&&(o.k1.ineg(),a=a.neg(!0)),o.k2.negative&&(o.k2.ineg(),l=l.neg(!0)),r[2*s]=a,r[2*s+1]=l,i[2*s]=o.k1,i[2*s+1]=o.k2}for(var c=this._wnafMulAdd(1,r,i,2*s,n),u=0;u<2*s;u++)r[u]=null,i[u]=null;return c},S(R,M.BasePoint),T.prototype.point=function(t,e,n){return new R(this,t,e,n)},T.prototype.pointFromJSON=function(t,e){return R.fromJSON(this,t,e)},R.prototype._getBeta=function(){if(this.curve.endo){var t=this.precomputed;if(t&&t.beta)return t.beta;var e=this.curve.point(this.x.redMul(this.curve.endo.beta),this.y);if(t){var n=this.curve,r=function(t){return n.point(t.x.redMul(n.endo.beta),t.y)};t.beta=e,e.precomputed={beta:null,naf:t.naf&&{wnd:t.naf.wnd,points:t.naf.points.map(r)},doubles:t.doubles&&{step:t.doubles.step,points:t.doubles.points.map(r)}}}return e}},R.prototype.toJSON=function(){return this.precomputed?[this.x,this.y,this.precomputed&&{doubles:this.precomputed.doubles&&{step:this.precomputed.doubles.step,points:this.precomputed.doubles.points.slice(1)},naf:this.precomputed.naf&&{wnd:this.precomputed.naf.wnd,points:this.precomputed.naf.points.slice(1)}}]:[this.x,this.y]},R.fromJSON=function(t,e,n){"string"===typeof e&&(e=JSON.parse(e));var r=t.point(e[0],e[1],n);if(!e[2])return r;function i(e){return t.point(e[0],e[1],n)}var s=e[2];return r.precomputed={beta:null,doubles:s.doubles&&{step:s.doubles.step,points:[r].concat(s.doubles.points.map(i))},naf:s.naf&&{wnd:s.naf.wnd,points:[r].concat(s.naf.points.map(i))}},r},R.prototype.inspect=function(){return this.isInfinity()?"<EC Point Infinity>":"<EC Point x: "+this.x.fromRed().toString(16,2)+" y: "+this.y.fromRed().toString(16,2)+">"},R.prototype.isInfinity=function(){return this.inf},R.prototype.add=function(t){if(this.inf)return t;if(t.inf)return this;if(this.eq(t))return this.dbl();if(this.neg().eq(t))return this.curve.point(null,null);if(0===this.x.cmp(t.x))return this.curve.point(null,null);var e=this.y.redSub(t.y);0!==e.cmpn(0)&&(e=e.redMul(this.x.redSub(t.x).redInvm()));var n=e.redSqr().redISub(this.x).redISub(t.x),r=e.redMul(this.x.redSub(n)).redISub(this.y);return this.curve.point(n,r)},R.prototype.dbl=function(){if(this.inf)return this;var t=this.y.redAdd(this.y);if(0===t.cmpn(0))return this.curve.point(null,null);var e=this.curve.a,n=this.x.redSqr(),r=t.redInvm(),i=n.redAdd(n).redIAdd(n).redIAdd(e).redMul(r),s=i.redSqr().redISub(this.x.redAdd(this.x)),o=i.redMul(this.x.redSub(s)).redISub(this.y);return this.curve.point(s,o)},R.prototype.getX=function(){return this.x.fromRed()},R.prototype.getY=function(){return this.y.fromRed()},R.prototype.mul=function(t){return t=new(u())(t,16),this.isInfinity()?this:this._hasDoubles(t)?this.curve._fixedNafMul(this,t):this.curve.endo?this.curve._endoWnafMulAdd([this],[t]):this.curve._wnafMul(this,t)},R.prototype.mulAdd=function(t,e,n){var r=[this,e],i=[t,n];return this.curve.endo?this.curve._endoWnafMulAdd(r,i):this.curve._wnafMulAdd(1,r,i,2)},R.prototype.jmulAdd=function(t,e,n){var r=[this,e],i=[t,n];return this.curve.endo?this.curve._endoWnafMulAdd(r,i,!0):this.curve._wnafMulAdd(1,r,i,2,!0)},R.prototype.eq=function(t){return this===t||this.inf===t.inf&&(this.inf||0===this.x.cmp(t.x)&&0===this.y.cmp(t.y))},R.prototype.neg=function(t){if(this.inf)return this;var e=this.curve.point(this.x,this.y.redNeg());if(t&&this.precomputed){var n=this.precomputed,r=function(t){return t.neg()};e.precomputed={naf:n.naf&&{wnd:n.naf.wnd,points:n.naf.points.map(r)},doubles:n.doubles&&{step:n.doubles.step,points:n.doubles.points.map(r)}}}return e},R.prototype.toJ=function(){if(this.inf)return this.curve.jpoint(null,null,null);var t=this.curve.jpoint(this.x,this.y,this.curve.one);return t},S(I,M.BasePoint),T.prototype.jpoint=function(t,e,n){return new I(this,t,e,n)},I.prototype.toP=function(){if(this.isInfinity())return this.curve.point(null,null);var t=this.z.redInvm(),e=t.redSqr(),n=this.x.redMul(e),r=this.y.redMul(e).redMul(t);return this.curve.point(n,r)},I.prototype.neg=function(){return this.curve.jpoint(this.x,this.y.redNeg(),this.z)},I.prototype.add=function(t){if(this.isInfinity())return t;if(t.isInfinity())return this;var e=t.z.redSqr(),n=this.z.redSqr(),r=this.x.redMul(e),i=t.x.redMul(n),s=this.y.redMul(e.redMul(t.z)),o=t.y.redMul(n.redMul(this.z)),a=r.redSub(i),l=s.redSub(o);if(0===a.cmpn(0))return 0!==l.cmpn(0)?this.curve.jpoint(null,null,null):this.dbl();var c=a.redSqr(),u=c.redMul(a),h=r.redMul(c),d=l.redSqr().redIAdd(u).redISub(h).redISub(h),f=l.redMul(h.redISub(d)).redISub(s.redMul(u)),p=this.z.redMul(t.z).redMul(a);return this.curve.jpoint(d,f,p)},I.prototype.mixedAdd=function(t){if(this.isInfinity())return t.toJ();if(t.isInfinity())return this;var e=this.z.redSqr(),n=this.x,r=t.x.redMul(e),i=this.y,s=t.y.redMul(e).redMul(this.z),o=n.redSub(r),a=i.redSub(s);if(0===o.cmpn(0))return 0!==a.cmpn(0)?this.curve.jpoint(null,null,null):this.dbl();var l=o.redSqr(),c=l.redMul(o),u=n.redMul(l),h=a.redSqr().redIAdd(c).redISub(u).redISub(u),d=a.redMul(u.redISub(h)).redISub(i.redMul(c)),f=this.z.redMul(o);return this.curve.jpoint(h,d,f)},I.prototype.dblp=function(t){if(0===t)return this;if(this.isInfinity())return this;if(!t)return this.dbl();var e;if(this.curve.zeroA||this.curve.threeA){var n=this;for(e=0;e<t;e++)n=n.dbl();return n}var r=this.curve.a,i=this.curve.tinv,s=this.x,o=this.y,a=this.z,l=a.redSqr().redSqr(),c=o.redAdd(o);for(e=0;e<t;e++){var u=s.redSqr(),h=c.redSqr(),d=h.redSqr(),f=u.redAdd(u).redIAdd(u).redIAdd(r.redMul(l)),p=s.redMul(h),m=f.redSqr().redISub(p.redAdd(p)),g=p.redISub(m),v=f.redMul(g);v=v.redIAdd(v).redISub(d);var y=c.redMul(a);e+1<t&&(l=l.redMul(d)),s=m,a=y,c=v}return this.curve.jpoint(s,c.redMul(i),a)},I.prototype.dbl=function(){return this.isInfinity()?this:this.curve.zeroA?this._zeroDbl():this.curve.threeA?this._threeDbl():this._dbl()},I.prototype._zeroDbl=function(){var t,e,n;if(this.zOne){var r=this.x.redSqr(),i=this.y.redSqr(),s=i.redSqr(),o=this.x.redAdd(i).redSqr().redISub(r).redISub(s);o=o.redIAdd(o);var a=r.redAdd(r).redIAdd(r),l=a.redSqr().redISub(o).redISub(o),c=s.redIAdd(s);c=c.redIAdd(c),c=c.redIAdd(c),t=l,e=a.redMul(o.redISub(l)).redISub(c),n=this.y.redAdd(this.y)}else{var u=this.x.redSqr(),h=this.y.redSqr(),d=h.redSqr(),f=this.x.redAdd(h).redSqr().redISub(u).redISub(d);f=f.redIAdd(f);var p=u.redAdd(u).redIAdd(u),m=p.redSqr(),g=d.redIAdd(d);g=g.redIAdd(g),g=g.redIAdd(g),t=m.redISub(f).redISub(f),e=p.redMul(f.redISub(t)).redISub(g),n=this.y.redMul(this.z),n=n.redIAdd(n)}return this.curve.jpoint(t,e,n)},I.prototype._threeDbl=function(){var t,e,n;if(this.zOne){var r=this.x.redSqr(),i=this.y.redSqr(),s=i.redSqr(),o=this.x.redAdd(i).redSqr().redISub(r).redISub(s);o=o.redIAdd(o);var a=r.redAdd(r).redIAdd(r).redIAdd(this.curve.a),l=a.redSqr().redISub(o).redISub(o);t=l;var c=s.redIAdd(s);c=c.redIAdd(c),c=c.redIAdd(c),e=a.redMul(o.redISub(l)).redISub(c),n=this.y.redAdd(this.y)}else{var u=this.z.redSqr(),h=this.y.redSqr(),d=this.x.redMul(h),f=this.x.redSub(u).redMul(this.x.redAdd(u));f=f.redAdd(f).redIAdd(f);var p=d.redIAdd(d);p=p.redIAdd(p);var m=p.redAdd(p);t=f.redSqr().redISub(m),n=this.y.redAdd(this.z).redSqr().redISub(h).redISub(u);var g=h.redSqr();g=g.redIAdd(g),g=g.redIAdd(g),g=g.redIAdd(g),e=f.redMul(p.redISub(t)).redISub(g)}return this.curve.jpoint(t,e,n)},I.prototype._dbl=function(){var t=this.curve.a,e=this.x,n=this.y,r=this.z,i=r.redSqr().redSqr(),s=e.redSqr(),o=n.redSqr(),a=s.redAdd(s).redIAdd(s).redIAdd(t.redMul(i)),l=e.redAdd(e);l=l.redIAdd(l);var c=l.redMul(o),u=a.redSqr().redISub(c.redAdd(c)),h=c.redISub(u),d=o.redSqr();d=d.redIAdd(d),d=d.redIAdd(d),d=d.redIAdd(d);var f=a.redMul(h).redISub(d),p=n.redAdd(n).redMul(r);return this.curve.jpoint(u,f,p)},I.prototype.trpl=function(){if(!this.curve.zeroA)return this.dbl().add(this);var t=this.x.redSqr(),e=this.y.redSqr(),n=this.z.redSqr(),r=e.redSqr(),i=t.redAdd(t).redIAdd(t),s=i.redSqr(),o=this.x.redAdd(e).redSqr().redISub(t).redISub(r);o=o.redIAdd(o),o=o.redAdd(o).redIAdd(o),o=o.redISub(s);var a=o.redSqr(),l=r.redIAdd(r);l=l.redIAdd(l),l=l.redIAdd(l),l=l.redIAdd(l);var c=i.redIAdd(o).redSqr().redISub(s).redISub(a).redISub(l),u=e.redMul(c);u=u.redIAdd(u),u=u.redIAdd(u);var h=this.x.redMul(a).redISub(u);h=h.redIAdd(h),h=h.redIAdd(h);var d=this.y.redMul(c.redMul(l.redISub(c)).redISub(o.redMul(a)));d=d.redIAdd(d),d=d.redIAdd(d),d=d.redIAdd(d);var f=this.z.redAdd(o).redSqr().redISub(n).redISub(a);return this.curve.jpoint(h,d,f)},I.prototype.mul=function(t,e){return t=new(u())(t,e),this.curve._wnafMul(this,t)},I.prototype.eq=function(t){if("affine"===t.type)return this.eq(t.toJ());if(this===t)return!0;var e=this.z.redSqr(),n=t.z.redSqr();if(0!==this.x.redMul(n).redISub(t.x.redMul(e)).cmpn(0))return!1;var r=e.redMul(this.z),i=n.redMul(t.z);return 0===this.y.redMul(i).redISub(t.y.redMul(r)).cmpn(0)},I.prototype.eqXToP=function(t){var e=this.z.redSqr(),n=t.toRed(this.curve.red).redMul(e);if(0===this.x.cmp(n))return!0;for(var r=t.clone(),i=this.curve.redN.redMul(e);;){if(r.iadd(this.curve.n),r.cmp(this.curve.p)>=0)return!1;if(n.redIAdd(i),0===this.x.cmp(n))return!0}},I.prototype.inspect=function(){return this.isInfinity()?"<EC JPoint Infinity>":"<EC JPoint x: "+this.x.toString(16,2)+" y: "+this.y.toString(16,2)+" z: "+this.z.toString(16,2)+">"},I.prototype.isInfinity=function(){return 0===this.z.cmpn(0)};var P=f((function(t,e){var n=e;n.base=M,n.short=C,n.mont=null,n.edwards=null})),L=f((function(t,e){var n,r=e,i=y.assert;function s(t){"short"===t.type?this.curve=new P.short(t):"edwards"===t.type?this.curve=new P.edwards(t):this.curve=new P.mont(t),this.g=this.curve.g,this.n=this.curve.n,this.hash=t.hash,i(this.g.validate(),"Invalid curve"),i(this.g.mul(this.n).isInfinity(),"Invalid curve, G*N != O")}function o(t,e){Object.defineProperty(r,t,{configurable:!0,enumerable:!0,get:function(){var n=new s(e);return Object.defineProperty(r,t,{configurable:!0,enumerable:!0,value:n}),n}})}r.PresetCurve=s,o("p192",{type:"short",prime:"p192",p:"ffffffff ffffffff ffffffff fffffffe ffffffff ffffffff",a:"ffffffff ffffffff ffffffff fffffffe ffffffff fffffffc",b:"64210519 e59c80e7 0fa7e9ab 72243049 feb8deec c146b9b1",n:"ffffffff ffffffff ffffffff 99def836 146bc9b1 b4d22831",hash:d().sha256,gRed:!1,g:["188da80e b03090f6 7cbf20eb 43a18800 f4ff0afd 82ff1012","07192b95 ffc8da78 631011ed 6b24cdd5 73f977a1 1e794811"]}),o("p224",{type:"short",prime:"p224",p:"ffffffff ffffffff ffffffff ffffffff 00000000 00000000 00000001",a:"ffffffff ffffffff ffffffff fffffffe ffffffff ffffffff fffffffe",b:"b4050a85 0c04b3ab f5413256 5044b0b7 d7bfd8ba 270b3943 2355ffb4",n:"ffffffff ffffffff ffffffff ffff16a2 e0b8f03e 13dd2945 5c5c2a3d",hash:d().sha256,gRed:!1,g:["b70e0cbd 6bb4bf7f 321390b9 4a03c1d3 56c21122 343280d6 115c1d21","bd376388 b5f723fb 4c22dfe6 cd4375a0 5a074764 44d58199 85007e34"]}),o("p256",{type:"short",prime:null,p:"ffffffff 00000001 00000000 00000000 00000000 ffffffff ffffffff ffffffff",a:"ffffffff 00000001 00000000 00000000 00000000 ffffffff ffffffff fffffffc",b:"5ac635d8 aa3a93e7 b3ebbd55 769886bc 651d06b0 cc53b0f6 3bce3c3e 27d2604b",n:"ffffffff 00000000 ffffffff ffffffff bce6faad a7179e84 f3b9cac2 fc632551",hash:d().sha256,gRed:!1,g:["6b17d1f2 e12c4247 f8bce6e5 63a440f2 77037d81 2deb33a0 f4a13945 d898c296","4fe342e2 fe1a7f9b 8ee7eb4a 7c0f9e16 2bce3357 6b315ece cbb64068 37bf51f5"]}),o("p384",{type:"short",prime:null,p:"ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffe ffffffff 00000000 00000000 ffffffff",a:"ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffe ffffffff 00000000 00000000 fffffffc",b:"b3312fa7 e23ee7e4 988e056b e3f82d19 181d9c6e fe814112 0314088f 5013875a c656398d 8a2ed19d 2a85c8ed d3ec2aef",n:"ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff c7634d81 f4372ddf 581a0db2 48b0a77a ecec196a ccc52973",hash:d().sha384,gRed:!1,g:["aa87ca22 be8b0537 8eb1c71e f320ad74 6e1d3b62 8ba79b98 59f741e0 82542a38 5502f25d bf55296c 3a545e38 72760ab7","3617de4a 96262c6f 5d9e98bf 9292dc29 f8f41dbd 289a147c e9da3113 b5f0b8c0 0a60b1ce 1d7e819d 7a431d7c 90ea0e5f"]}),o("p521",{type:"short",prime:null,p:"000001ff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff",a:"000001ff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffc",b:"00000051 953eb961 8e1c9a1f 929a21a0 b68540ee a2da725b 99b315f3 b8b48991 8ef109e1 56193951 ec7e937b 1652c0bd 3bb1bf07 3573df88 3d2c34f1 ef451fd4 6b503f00",n:"000001ff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffa 51868783 bf2f966b 7fcc0148 f709a5d0 3bb5c9b8 899c47ae bb6fb71e 91386409",hash:d().sha512,gRed:!1,g:["000000c6 858e06b7 0404e9cd 9e3ecb66 2395b442 9c648139 053fb521 f828af60 6b4d3dba a14b5e77 efe75928 fe1dc127 a2ffa8de 3348b3c1 856a429b f97e7e31 c2e5bd66","00000118 39296a78 9a3bc004 5c8a5fb4 2c7d1bd9 98f54449 579b4468 17afbd17 273e662c 97ee7299 5ef42640 c550b901 3fad0761 353c7086 a272c240 88be9476 9fd16650"]}),o("curve25519",{type:"mont",prime:"p25519",p:"7fffffffffffffff ffffffffffffffff ffffffffffffffff ffffffffffffffed",a:"76d06",b:"1",n:"1000000000000000 0000000000000000 14def9dea2f79cd6 5812631a5cf5d3ed",hash:d().sha256,gRed:!1,g:["9"]}),o("ed25519",{type:"edwards",prime:"p25519",p:"7fffffffffffffff ffffffffffffffff ffffffffffffffff ffffffffffffffed",a:"-1",c:"1",d:"52036cee2b6ffe73 8cc740797779e898 00700a4d4141d8ab 75eb4dca135978a3",n:"1000000000000000 0000000000000000 14def9dea2f79cd6 5812631a5cf5d3ed",hash:d().sha256,gRed:!1,g:["216936d3cd6e53fec0a4e231fdd6dc5c692cc7609525a7b2c9562d608f25d51a","6666666666666666666666666666666666666666666666666666666666666658"]});try{n=null.crash()}catch(a){n=void 0}o("secp256k1",{type:"short",prime:"k256",p:"ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffe fffffc2f",a:"0",b:"7",n:"ffffffff ffffffff ffffffff fffffffe baaedce6 af48a03b bfd25e8c d0364141",h:"1",hash:d().sha256,beta:"7ae96a2b657c07106e64479eac3434e99cf0497512f58995c1396c28719501ee",lambda:"5363ad4cc05c30e0a5261c028812645a122e22ea20816678df02967c1b23bd72",basis:[{a:"3086d221a7d46bcde86c90e49284eb15",b:"-e4437ed6010e88286f547fa90abfe4c3"},{a:"114ca50f7a8e2f3f657c1108d9d44cfd8",b:"3086d221a7d46bcde86c90e49284eb15"}],gRed:!1,g:["79be667ef9dcbbac55a06295ce870b07029bfcdb2dce28d959f2815b16f81798","483ada7726a3c4655da4fbfc0e1108a8fd17b448a68554199c47d08ffb10d4b8",n]})}));function N(t){if(!(this instanceof N))return new N(t);this.hash=t.hash,this.predResist=!!t.predResist,this.outLen=this.hash.outSize,this.minEntropy=t.minEntropy||this.hash.hmacStrength,this._reseed=null,this.reseedInterval=null,this.K=null,this.V=null;var e=v.toArray(t.entropy,t.entropyEnc||"hex"),n=v.toArray(t.nonce,t.nonceEnc||"hex"),r=v.toArray(t.pers,t.persEnc||"hex");m(e.length>=this.minEntropy/8,"Not enough entropy. Minimum is: "+this.minEntropy+" bits"),this._init(e,n,r)}var k=N;N.prototype._init=function(t,e,n){var r=t.concat(e).concat(n);this.K=new Array(this.outLen/8),this.V=new Array(this.outLen/8);for(var i=0;i<this.V.length;i++)this.K[i]=0,this.V[i]=1;this._update(r),this._reseed=1,this.reseedInterval=281474976710656},N.prototype._hmac=function(){return new(d().hmac)(this.hash,this.K)},N.prototype._update=function(t){var e=this._hmac().update(this.V).update([0]);t&&(e=e.update(t)),this.K=e.digest(),this.V=this._hmac().update(this.V).digest(),t&&(this.K=this._hmac().update(this.V).update([1]).update(t).digest(),this.V=this._hmac().update(this.V).digest())},N.prototype.reseed=function(t,e,n,r){"string"!==typeof e&&(r=n,n=e,e=null),t=v.toArray(t,e),n=v.toArray(n,r),m(t.length>=this.minEntropy/8,"Not enough entropy. Minimum is: "+this.minEntropy+" bits"),this._update(t.concat(n||[])),this._reseed=1},N.prototype.generate=function(t,e,n,r){if(this._reseed>this.reseedInterval)throw new Error("Reseed is required");"string"!==typeof e&&(r=n,n=e,e=null),n&&(n=v.toArray(n,r||"hex"),this._update(n));var i=[];while(i.length<t)this.V=this._hmac().update(this.V).digest(),i=i.concat(this.V);var s=i.slice(0,t);return this._update(n),this._reseed++,v.encode(s,e)};var O=y.assert;function D(t,e){this.ec=t,this.priv=null,this.pub=null,e.priv&&this._importPrivate(e.priv,e.privEnc),e.pub&&this._importPublic(e.pub,e.pubEnc)}var z=D;D.fromPublic=function(t,e,n){return e instanceof D?e:new D(t,{pub:e,pubEnc:n})},D.fromPrivate=function(t,e,n){return e instanceof D?e:new D(t,{priv:e,privEnc:n})},D.prototype.validate=function(){var t=this.getPublic();return t.isInfinity()?{result:!1,reason:"Invalid public key"}:t.validate()?t.mul(this.ec.curve.n).isInfinity()?{result:!0,reason:null}:{result:!1,reason:"Public key * N != O"}:{result:!1,reason:"Public key is not a point"}},D.prototype.getPublic=function(t,e){return"string"===typeof t&&(e=t,t=null),this.pub||(this.pub=this.ec.g.mul(this.priv)),e?this.pub.encode(e,t):this.pub},D.prototype.getPrivate=function(t){return"hex"===t?this.priv.toString(16,2):this.priv},D.prototype._importPrivate=function(t,e){this.priv=new(u())(t,e||16),this.priv=this.priv.umod(this.ec.curve.n)},D.prototype._importPublic=function(t,e){if(t.x||t.y)return"mont"===this.ec.curve.type?O(t.x,"Need x coordinate"):"short"!==this.ec.curve.type&&"edwards"!==this.ec.curve.type||O(t.x&&t.y,"Need both x and y coordinate"),void(this.pub=this.ec.curve.point(t.x,t.y));this.pub=this.ec.curve.decodePoint(t,e)},D.prototype.derive=function(t){return t.validate()||O(t.validate(),"public point not validated"),t.mul(this.priv).getX()},D.prototype.sign=function(t,e,n){return this.ec.sign(t,this,e,n)},D.prototype.verify=function(t,e){return this.ec.verify(t,e,this)},D.prototype.inspect=function(){return"<Key priv: "+(this.priv&&this.priv.toString(16,2))+" pub: "+(this.pub&&this.pub.inspect())+" >"};var F=y.assert;function U(t,e){if(t instanceof U)return t;this._importDER(t,e)||(F(t.r&&t.s,"Signature without r or s"),this.r=new(u())(t.r,16),this.s=new(u())(t.s,16),void 0===t.recoveryParam?this.recoveryParam=null:this.recoveryParam=t.recoveryParam)}var B=U;function G(){this.place=0}function H(t,e){var n=t[e.place++];if(!(128&n))return n;var r=15&n;if(0===r||r>4)return!1;for(var i=0,s=0,o=e.place;s<r;s++,o++)i<<=8,i|=t[o],i>>>=0;return!(i<=127)&&(e.place=o,i)}function V(t){var e=0,n=t.length-1;while(!t[e]&&!(128&t[e+1])&&e<n)e++;return 0===e?t:t.slice(e)}function j(t,e){if(e<128)t.push(e);else{var n=1+(Math.log(e)/Math.LN2>>>3);t.push(128|n);while(--n)t.push(e>>>(n<<3)&255);t.push(e)}}U.prototype._importDER=function(t,e){t=y.toArray(t,e);var n=new G;if(48!==t[n.place++])return!1;var r=H(t,n);if(!1===r)return!1;if(r+n.place!==t.length)return!1;if(2!==t[n.place++])return!1;var i=H(t,n);if(!1===i)return!1;var s=t.slice(n.place,i+n.place);if(n.place+=i,2!==t[n.place++])return!1;var o=H(t,n);if(!1===o)return!1;if(t.length!==o+n.place)return!1;var a=t.slice(n.place,o+n.place);if(0===s[0]){if(!(128&s[1]))return!1;s=s.slice(1)}if(0===a[0]){if(!(128&a[1]))return!1;a=a.slice(1)}return this.r=new(u())(s),this.s=new(u())(a),this.recoveryParam=null,!0},U.prototype.toDER=function(t){var e=this.r.toArray(),n=this.s.toArray();128&e[0]&&(e=[0].concat(e)),128&n[0]&&(n=[0].concat(n)),e=V(e),n=V(n);while(!n[0]&&!(128&n[1]))n=n.slice(1);var r=[2];j(r,e.length),r=r.concat(e),r.push(2),j(r,n.length);var i=r.concat(n),s=[48];return j(s,i.length),s=s.concat(i),y.encode(s,t)};var W=function(){throw new Error("unsupported")},q=y.assert;function Y(t){if(!(this instanceof Y))return new Y(t);"string"===typeof t&&(q(Object.prototype.hasOwnProperty.call(L,t),"Unknown curve "+t),t=L[t]),t instanceof L.PresetCurve&&(t={curve:t}),this.curve=t.curve.curve,this.n=this.curve.n,this.nh=this.n.ushrn(1),this.g=this.curve.g,this.g=t.curve.g,this.g.precompute(t.curve.n.bitLength()+1),this.hash=t.hash||t.curve.hash}var X=Y;Y.prototype.keyPair=function(t){return new z(this,t)},Y.prototype.keyFromPrivate=function(t,e){return z.fromPrivate(this,t,e)},Y.prototype.keyFromPublic=function(t,e){return z.fromPublic(this,t,e)},Y.prototype.genKeyPair=function(t){t||(t={});for(var e=new k({hash:this.hash,pers:t.pers,persEnc:t.persEnc||"utf8",entropy:t.entropy||W(this.hash.hmacStrength),entropyEnc:t.entropy&&t.entropyEnc||"utf8",nonce:this.n.toArray()}),n=this.n.byteLength(),r=this.n.sub(new(u())(2));;){var i=new(u())(e.generate(n));if(!(i.cmp(r)>0))return i.iaddn(1),this.keyFromPrivate(i)}},Y.prototype._truncateToN=function(t,e){var n=8*t.byteLength()-this.n.bitLength();return n>0&&(t=t.ushrn(n)),!e&&t.cmp(this.n)>=0?t.sub(this.n):t},Y.prototype.sign=function(t,e,n,r){"object"===typeof n&&(r=n,n=null),r||(r={}),e=this.keyFromPrivate(e,n),t=this._truncateToN(new(u())(t,16));for(var i=this.n.byteLength(),s=e.getPrivate().toArray("be",i),o=t.toArray("be",i),a=new k({hash:this.hash,entropy:s,nonce:o,pers:r.pers,persEnc:r.persEnc||"utf8"}),l=this.n.sub(new(u())(1)),c=0;;c++){var h=r.k?r.k(c):new(u())(a.generate(this.n.byteLength()));if(h=this._truncateToN(h,!0),!(h.cmpn(1)<=0||h.cmp(l)>=0)){var d=this.g.mul(h);if(!d.isInfinity()){var f=d.getX(),p=f.umod(this.n);if(0!==p.cmpn(0)){var m=h.invm(this.n).mul(p.mul(e.getPrivate()).iadd(t));if(m=m.umod(this.n),0!==m.cmpn(0)){var g=(d.getY().isOdd()?1:0)|(0!==f.cmp(p)?2:0);return r.canonical&&m.cmp(this.nh)>0&&(m=this.n.sub(m),g^=1),new B({r:p,s:m,recoveryParam:g})}}}}}},Y.prototype.verify=function(t,e,n,r){t=this._truncateToN(new(u())(t,16)),n=this.keyFromPublic(n,r),e=new B(e,"hex");var i=e.r,s=e.s;if(i.cmpn(1)<0||i.cmp(this.n)>=0)return!1;if(s.cmpn(1)<0||s.cmp(this.n)>=0)return!1;var o,a=s.invm(this.n),l=a.mul(t).umod(this.n),c=a.mul(i).umod(this.n);return this.curve._maxwellTrick?(o=this.g.jmulAdd(l,n.getPublic(),c),!o.isInfinity()&&o.eqXToP(i)):(o=this.g.mulAdd(l,n.getPublic(),c),!o.isInfinity()&&0===o.getX().umod(this.n).cmp(i))},Y.prototype.recoverPubKey=function(t,e,n,r){q((3&n)===n,"The recovery param is more than two bits"),e=new B(e,r);var i=this.n,s=new(u())(t),o=e.r,a=e.s,l=1&n,c=n>>1;if(o.cmp(this.curve.p.umod(this.curve.n))>=0&&c)throw new Error("Unable to find sencond key candinate");o=c?this.curve.pointFromX(o.add(this.curve.n),l):this.curve.pointFromX(o,l);var h=e.r.invm(i),d=i.sub(s).mul(h).umod(i),f=a.mul(h).umod(i);return this.g.mulAdd(d,o,f)},Y.prototype.getKeyRecoveryParam=function(t,e,n,r){if(e=new B(e,r),null!==e.recoveryParam)return e.recoveryParam;for(var i=0;i<4;i++){var s;try{s=this.recoverPubKey(t,e,i)}catch(t){continue}if(s.eq(n))return i}throw new Error("Unable to find valid recovery factor")};var J=f((function(t,e){var n=e;n.version={version:"6.5.4"}.version,n.utils=y,n.rand=function(){throw new Error("unsupported")},n.curve=P,n.curves=L,n.ec=X,n.eddsa=null})),K=J.ec,Z=n(2224),Q=n(8737);const $="signing-key/5.7.0",tt=new Q.Yd($);let et=null;function nt(){return et||(et=new K("secp256k1")),et}class rt{constructor(t){(0,Z.zG)(this,"curve","secp256k1"),(0,Z.zG)(this,"privateKey",(0,s.Dv)(t)),32!==(0,s.E1)(this.privateKey)&&tt.throwArgumentError("invalid private key","privateKey","[[ REDACTED ]]");const e=nt().keyFromPrivate((0,s.lE)(this.privateKey));(0,Z.zG)(this,"publicKey","0x"+e.getPublic(!1,"hex")),(0,Z.zG)(this,"compressedPublicKey","0x"+e.getPublic(!0,"hex")),(0,Z.zG)(this,"_isSigningKey",!0)}_addPoint(t){const e=nt().keyFromPublic((0,s.lE)(this.publicKey)),n=nt().keyFromPublic((0,s.lE)(t));return"0x"+e.pub.add(n.pub).encodeCompressed("hex")}signDigest(t){const e=nt().keyFromPrivate((0,s.lE)(this.privateKey)),n=(0,s.lE)(t);32!==n.length&&tt.throwArgumentError("bad digest length","digest",t);const r=e.sign(n,{canonical:!0});return(0,s.N)({recoveryParam:r.recoveryParam,r:(0,s.$m)("0x"+r.r.toString(16),32),s:(0,s.$m)("0x"+r.s.toString(16),32)})}computeSharedSecret(t){const e=nt().keyFromPrivate((0,s.lE)(this.privateKey)),n=nt().keyFromPublic((0,s.lE)(st(t)));return(0,s.$m)("0x"+e.derive(n.getPublic()).toString(16),32)}static isSigningKey(t){return!(!t||!t._isSigningKey)}}function it(t,e){const n=(0,s.N)(e),r={r:(0,s.lE)(n.r),s:(0,s.lE)(n.s)};return"0x"+nt().recoverPubKey((0,s.lE)(t),r,n.recoveryParam).encode("hex",!1)}function st(t,e){const n=(0,s.lE)(t);if(32===n.length){const t=new rt(n);return e?"0x"+nt().keyFromPrivate(n).getPublic(!0,"hex"):t.publicKey}return 33===n.length?e?(0,s.Dv)(n):"0x"+nt().keyFromPublic(n).getPublic(!1,"hex"):65===n.length?e?"0x"+nt().keyFromPublic(n).getPublic(!0,"hex"):(0,s.Dv)(n):tt.throwArgumentError("invalid public or private key","key","[REDACTED]")}const ot="transactions/5.7.0",at=new Q.Yd(ot);var lt;function ct(t){return"0x"===t?null:(0,r.Kn)(t)}function ut(t){return"0x"===t?o._Y:i.O$.from(t)}(function(t){t[t["legacy"]=0]="legacy",t[t["eip2930"]=1]="eip2930",t[t["eip1559"]=2]="eip1559"})(lt||(lt={}));function ht(t){const e=st(t);return(0,r.Kn)((0,s.p3)((0,a.w)((0,s.p3)(e,1)),12))}function dt(t,e){return ht(it((0,s.lE)(t),e))}function ft(t,e){const n=(0,s.G1)(i.O$.from(t).toHexString());return n.length>32&&at.throwArgumentError("invalid length for "+e,"transaction:"+e,t),n}function pt(t,e){return{address:(0,r.Kn)(t),storageKeys:(e||[]).map(((e,n)=>(32!==(0,s.E1)(e)&&at.throwArgumentError("invalid access list storageKey",`accessList[${t}:${n}]`,e),e.toLowerCase())))}}function mt(t){if(Array.isArray(t))return t.map(((t,e)=>Array.isArray(t)?(t.length>2&&at.throwArgumentError("access list expected to be [ address, storageKeys[] ]",`value[${e}]`,t),pt(t[0],t[1])):pt(t.address,t.storageKeys)));const e=Object.keys(t).map((e=>{const n=t[e].reduce(((t,e)=>(t[e]=!0,t)),{});return pt(e,Object.keys(n).sort())}));return e.sort(((t,e)=>t.address.localeCompare(e.address))),e}function gt(t){return mt(t).map((t=>[t.address,t.storageKeys]))}function vt(t,e){if(null!=t.gasPrice){const e=i.O$.from(t.gasPrice),n=i.O$.from(t.maxFeePerGas||0);e.eq(n)||at.throwArgumentError("mismatch EIP-1559 gasPrice != maxFeePerGas","tx",{gasPrice:e,maxFeePerGas:n})}const n=[ft(t.chainId||0,"chainId"),ft(t.nonce||0,"nonce"),ft(t.maxPriorityFeePerGas||0,"maxPriorityFeePerGas"),ft(t.maxFeePerGas||0,"maxFeePerGas"),ft(t.gasLimit||0,"gasLimit"),null!=t.to?(0,r.Kn)(t.to):"0x",ft(t.value||0,"value"),t.data||"0x",gt(t.accessList||[])];if(e){const t=(0,s.N)(e);n.push(ft(t.recoveryParam,"recoveryParam")),n.push((0,s.G1)(t.r)),n.push((0,s.G1)(t.s))}return(0,s.xs)(["0x02",l.c(n)])}function yt(t,e){const n=[ft(t.chainId||0,"chainId"),ft(t.nonce||0,"nonce"),ft(t.gasPrice||0,"gasPrice"),ft(t.gasLimit||0,"gasLimit"),null!=t.to?(0,r.Kn)(t.to):"0x",ft(t.value||0,"value"),t.data||"0x",gt(t.accessList||[])];if(e){const t=(0,s.N)(e);n.push(ft(t.recoveryParam,"recoveryParam")),n.push((0,s.G1)(t.r)),n.push((0,s.G1)(t.s))}return(0,s.xs)(["0x01",l.c(n)])}function xt(t,e,n){try{const n=ut(e[0]).toNumber();if(0!==n&&1!==n)throw new Error("bad recid");t.v=n}catch(r){at.throwArgumentError("invalid v for transaction type: 1","v",e[0])}t.r=(0,s.$m)(e[1],32),t.s=(0,s.$m)(e[2],32);try{const e=(0,a.w)(n(t));t.from=dt(e,{r:t.r,s:t.s,recoveryParam:t.v})}catch(r){}}function bt(t){const e=l.J(t.slice(1));9!==e.length&&12!==e.length&&at.throwArgumentError("invalid component count for transaction type: 2","payload",(0,s.Dv)(t));const n=ut(e[2]),r=ut(e[3]),i={type:2,chainId:ut(e[0]).toNumber(),nonce:ut(e[1]).toNumber(),maxPriorityFeePerGas:n,maxFeePerGas:r,gasPrice:null,gasLimit:ut(e[4]),to:ct(e[5]),value:ut(e[6]),data:e[7],accessList:mt(e[8])};return 9===e.length||(i.hash=(0,a.w)(t),xt(i,e.slice(9),vt)),i}function wt(t){const e=l.J(t.slice(1));8!==e.length&&11!==e.length&&at.throwArgumentError("invalid component count for transaction type: 1","payload",(0,s.Dv)(t));const n={type:1,chainId:ut(e[0]).toNumber(),nonce:ut(e[1]).toNumber(),gasPrice:ut(e[2]),gasLimit:ut(e[3]),to:ct(e[4]),value:ut(e[5]),data:e[6],accessList:mt(e[7])};return 8===e.length||(n.hash=(0,a.w)(t),xt(n,e.slice(8),yt)),n}function _t(t){const e=l.J(t);9!==e.length&&6!==e.length&&at.throwArgumentError("invalid raw transaction","rawTransaction",t);const n={nonce:ut(e[0]).toNumber(),gasPrice:ut(e[1]),gasLimit:ut(e[2]),to:ct(e[3]),value:ut(e[4]),data:e[5],chainId:0};if(6===e.length)return n;try{n.v=i.O$.from(e[6]).toNumber()}catch(r){return n}if(n.r=(0,s.$m)(e[7],32),n.s=(0,s.$m)(e[8],32),i.O$.from(n.r).isZero()&&i.O$.from(n.s).isZero())n.chainId=n.v,n.v=0;else{n.chainId=Math.floor((n.v-35)/2),n.chainId<0&&(n.chainId=0);let i=n.v-27;const o=e.slice(0,6);0!==n.chainId&&(o.push((0,s.Dv)(n.chainId)),o.push("0x"),o.push("0x"),i-=2*n.chainId+8);const c=(0,a.w)(l.c(o));try{n.from=dt(c,{r:(0,s.Dv)(n.r),s:(0,s.Dv)(n.s),recoveryParam:i})}catch(r){}n.hash=(0,a.w)(t)}return n.type=null,n}function Mt(t){const e=(0,s.lE)(t);if(e[0]>127)return _t(e);switch(e[0]){case 1:return wt(e);case 2:return bt(e);default:break}return at.throwError(`unsupported transaction type: ${e[0]}`,Q.Yd.errors.UNSUPPORTED_OPERATION,{operation:"parseTransaction",transactionType:e[0]})}},4870:function(t,e,n){"use strict";n.d(e,{Bj:function(){return s},Fl:function(){return Bt},IU:function(){return Ct},Jd:function(){return M},PG:function(){return At},Um:function(){return wt},WL:function(){return zt},X$:function(){return T},X3:function(){return Tt},Xl:function(){return Rt},dq:function(){return kt},j:function(){return S},lk:function(){return A},qj:function(){return bt},qq:function(){return x},yT:function(){return Et}});var r=n(7139);let i;class s{constructor(t=!1){this.active=!0,this.effects=[],this.cleanups=[],!t&&i&&(this.parent=i,this.index=(i.scopes||(i.scopes=[])).push(this)-1)}run(t){if(this.active){const e=i;try{return i=this,t()}finally{i=e}}else 0}on(){i=this}off(){i=this.parent}stop(t){if(this.active){let e,n;for(e=0,n=this.effects.length;e<n;e++)this.effects[e].stop();for(e=0,n=this.cleanups.length;e<n;e++)this.cleanups[e]();if(this.scopes)for(e=0,n=this.scopes.length;e<n;e++)this.scopes[e].stop(!0);if(this.parent&&!t){const t=this.parent.scopes.pop();t&&t!==this&&(this.parent.scopes[this.index]=t,t.index=this.index)}this.active=!1}}}function o(t,e=i){e&&e.active&&e.effects.push(t)}const a=t=>{const e=new Set(t);return e.w=0,e.n=0,e},l=t=>(t.w&p)>0,c=t=>(t.n&p)>0,u=({deps:t})=>{if(t.length)for(let e=0;e<t.length;e++)t[e].w|=p},h=t=>{const{deps:e}=t;if(e.length){let n=0;for(let r=0;r<e.length;r++){const i=e[r];l(i)&&!c(i)?i.delete(t):e[n++]=i,i.w&=~p,i.n&=~p}e.length=n}},d=new WeakMap;let f=0,p=1;const m=30;let g;const v=Symbol(""),y=Symbol("");class x{constructor(t,e=null,n){this.fn=t,this.scheduler=e,this.active=!0,this.deps=[],this.parent=void 0,o(this,n)}run(){if(!this.active)return this.fn();let t=g,e=w;while(t){if(t===this)return;t=t.parent}try{return this.parent=g,g=this,w=!0,p=1<<++f,f<=m?u(this):b(this),this.fn()}finally{f<=m&&h(this),p=1<<--f,g=this.parent,w=e,this.parent=void 0,this.deferStop&&this.stop()}}stop(){g===this?this.deferStop=!0:this.active&&(b(this),this.onStop&&this.onStop(),this.active=!1)}}function b(t){const{deps:e}=t;if(e.length){for(let n=0;n<e.length;n++)e[n].delete(t);e.length=0}}let w=!0;const _=[];function M(){_.push(w),w=!1}function A(){const t=_.pop();w=void 0===t||t}function S(t,e,n){if(w&&g){let e=d.get(t);e||d.set(t,e=new Map);let r=e.get(n);r||e.set(n,r=a());const i=void 0;E(r,i)}}function E(t,e){let n=!1;f<=m?c(t)||(t.n|=p,n=!l(t)):n=!t.has(g),n&&(t.add(g),g.deps.push(t))}function T(t,e,n,i,s,o){const l=d.get(t);if(!l)return;let c=[];if("clear"===e)c=[...l.values()];else if("length"===n&&(0,r.kJ)(t))l.forEach(((t,e)=>{("length"===e||e>=i)&&c.push(t)}));else switch(void 0!==n&&c.push(l.get(n)),e){case"add":(0,r.kJ)(t)?(0,r.S0)(n)&&c.push(l.get("length")):(c.push(l.get(v)),(0,r._N)(t)&&c.push(l.get(y)));break;case"delete":(0,r.kJ)(t)||(c.push(l.get(v)),(0,r._N)(t)&&c.push(l.get(y)));break;case"set":(0,r._N)(t)&&c.push(l.get(v));break}if(1===c.length)c[0]&&C(c[0]);else{const t=[];for(const e of c)e&&t.push(...e);C(a(t))}}function C(t,e){const n=(0,r.kJ)(t)?t:[...t];for(const r of n)r.computed&&R(r,e);for(const r of n)r.computed||R(r,e)}function R(t,e){(t!==g||t.allowRecurse)&&(t.scheduler?t.scheduler():t.run())}const I=(0,r.fY)("__proto__,__v_isRef,__isVue"),P=new Set(Object.getOwnPropertyNames(Symbol).filter((t=>"arguments"!==t&&"caller"!==t)).map((t=>Symbol[t])).filter(r.yk)),L=z(),N=z(!1,!0),k=z(!0),O=D();function D(){const t={};return["includes","indexOf","lastIndexOf"].forEach((e=>{t[e]=function(...t){const n=Ct(this);for(let e=0,i=this.length;e<i;e++)S(n,"get",e+"");const r=n[e](...t);return-1===r||!1===r?n[e](...t.map(Ct)):r}})),["push","pop","shift","unshift","splice"].forEach((e=>{t[e]=function(...t){M();const n=Ct(this)[e].apply(this,t);return A(),n}})),t}function z(t=!1,e=!1){return function(n,i,s){if("__v_isReactive"===i)return!t;if("__v_isReadonly"===i)return t;if("__v_isShallow"===i)return e;if("__v_raw"===i&&s===(t?e?vt:gt:e?mt:pt).get(n))return n;const o=(0,r.kJ)(n);if(!t&&o&&(0,r.RI)(O,i))return Reflect.get(O,i,s);const a=Reflect.get(n,i,s);return((0,r.yk)(i)?P.has(i):I(i))?a:(t||S(n,"get",i),e?a:kt(a)?o&&(0,r.S0)(i)?a:a.value:(0,r.Kn)(a)?t?_t(a):bt(a):a)}}const F=B(),U=B(!0);function B(t=!1){return function(e,n,i,s){let o=e[n];if(St(o)&&kt(o)&&!kt(i))return!1;if(!t&&(Et(i)||St(i)||(o=Ct(o),i=Ct(i)),!(0,r.kJ)(e)&&kt(o)&&!kt(i)))return o.value=i,!0;const a=(0,r.kJ)(e)&&(0,r.S0)(n)?Number(n)<e.length:(0,r.RI)(e,n),l=Reflect.set(e,n,i,s);return e===Ct(s)&&(a?(0,r.aU)(i,o)&&T(e,"set",n,i,o):T(e,"add",n,i)),l}}function G(t,e){const n=(0,r.RI)(t,e),i=t[e],s=Reflect.deleteProperty(t,e);return s&&n&&T(t,"delete",e,void 0,i),s}function H(t,e){const n=Reflect.has(t,e);return(0,r.yk)(e)&&P.has(e)||S(t,"has",e),n}function V(t){return S(t,"iterate",(0,r.kJ)(t)?"length":v),Reflect.ownKeys(t)}const j={get:L,set:F,deleteProperty:G,has:H,ownKeys:V},W={get:k,set(t,e){return!0},deleteProperty(t,e){return!0}},q=(0,r.l7)({},j,{get:N,set:U}),Y=t=>t,X=t=>Reflect.getPrototypeOf(t);function J(t,e,n=!1,r=!1){t=t["__v_raw"];const i=Ct(t),s=Ct(e);n||(e!==s&&S(i,"get",e),S(i,"get",s));const{has:o}=X(i),a=r?Y:n?Pt:It;return o.call(i,e)?a(t.get(e)):o.call(i,s)?a(t.get(s)):void(t!==i&&t.get(e))}function K(t,e=!1){const n=this["__v_raw"],r=Ct(n),i=Ct(t);return e||(t!==i&&S(r,"has",t),S(r,"has",i)),t===i?n.has(t):n.has(t)||n.has(i)}function Z(t,e=!1){return t=t["__v_raw"],!e&&S(Ct(t),"iterate",v),Reflect.get(t,"size",t)}function Q(t){t=Ct(t);const e=Ct(this),n=X(e),r=n.has.call(e,t);return r||(e.add(t),T(e,"add",t,t)),this}function $(t,e){e=Ct(e);const n=Ct(this),{has:i,get:s}=X(n);let o=i.call(n,t);o||(t=Ct(t),o=i.call(n,t));const a=s.call(n,t);return n.set(t,e),o?(0,r.aU)(e,a)&&T(n,"set",t,e,a):T(n,"add",t,e),this}function tt(t){const e=Ct(this),{has:n,get:r}=X(e);let i=n.call(e,t);i||(t=Ct(t),i=n.call(e,t));const s=r?r.call(e,t):void 0,o=e.delete(t);return i&&T(e,"delete",t,void 0,s),o}function et(){const t=Ct(this),e=0!==t.size,n=void 0,r=t.clear();return e&&T(t,"clear",void 0,void 0,n),r}function nt(t,e){return function(n,r){const i=this,s=i["__v_raw"],o=Ct(s),a=e?Y:t?Pt:It;return!t&&S(o,"iterate",v),s.forEach(((t,e)=>n.call(r,a(t),a(e),i)))}}function rt(t,e,n){return function(...i){const s=this["__v_raw"],o=Ct(s),a=(0,r._N)(o),l="entries"===t||t===Symbol.iterator&&a,c="keys"===t&&a,u=s[t](...i),h=n?Y:e?Pt:It;return!e&&S(o,"iterate",c?y:v),{next(){const{value:t,done:e}=u.next();return e?{value:t,done:e}:{value:l?[h(t[0]),h(t[1])]:h(t),done:e}},[Symbol.iterator](){return this}}}}function it(t){return function(...e){return"delete"!==t&&this}}function st(){const t={get(t){return J(this,t)},get size(){return Z(this)},has:K,add:Q,set:$,delete:tt,clear:et,forEach:nt(!1,!1)},e={get(t){return J(this,t,!1,!0)},get size(){return Z(this)},has:K,add:Q,set:$,delete:tt,clear:et,forEach:nt(!1,!0)},n={get(t){return J(this,t,!0)},get size(){return Z(this,!0)},has(t){return K.call(this,t,!0)},add:it("add"),set:it("set"),delete:it("delete"),clear:it("clear"),forEach:nt(!0,!1)},r={get(t){return J(this,t,!0,!0)},get size(){return Z(this,!0)},has(t){return K.call(this,t,!0)},add:it("add"),set:it("set"),delete:it("delete"),clear:it("clear"),forEach:nt(!0,!0)},i=["keys","values","entries",Symbol.iterator];return i.forEach((i=>{t[i]=rt(i,!1,!1),n[i]=rt(i,!0,!1),e[i]=rt(i,!1,!0),r[i]=rt(i,!0,!0)})),[t,n,e,r]}const[ot,at,lt,ct]=st();function ut(t,e){const n=e?t?ct:lt:t?at:ot;return(e,i,s)=>"__v_isReactive"===i?!t:"__v_isReadonly"===i?t:"__v_raw"===i?e:Reflect.get((0,r.RI)(n,i)&&i in e?n:e,i,s)}const ht={get:ut(!1,!1)},dt={get:ut(!1,!0)},ft={get:ut(!0,!1)};const pt=new WeakMap,mt=new WeakMap,gt=new WeakMap,vt=new WeakMap;function yt(t){switch(t){case"Object":case"Array":return 1;case"Map":case"Set":case"WeakMap":case"WeakSet":return 2;default:return 0}}function xt(t){return t["__v_skip"]||!Object.isExtensible(t)?0:yt((0,r.W7)(t))}function bt(t){return St(t)?t:Mt(t,!1,j,ht,pt)}function wt(t){return Mt(t,!1,q,dt,mt)}function _t(t){return Mt(t,!0,W,ft,gt)}function Mt(t,e,n,i,s){if(!(0,r.Kn)(t))return t;if(t["__v_raw"]&&(!e||!t["__v_isReactive"]))return t;const o=s.get(t);if(o)return o;const a=xt(t);if(0===a)return t;const l=new Proxy(t,2===a?i:n);return s.set(t,l),l}function At(t){return St(t)?At(t["__v_raw"]):!(!t||!t["__v_isReactive"])}function St(t){return!(!t||!t["__v_isReadonly"])}function Et(t){return!(!t||!t["__v_isShallow"])}function Tt(t){return At(t)||St(t)}function Ct(t){const e=t&&t["__v_raw"];return e?Ct(e):t}function Rt(t){return(0,r.Nj)(t,"__v_skip",!0),t}const It=t=>(0,r.Kn)(t)?bt(t):t,Pt=t=>(0,r.Kn)(t)?_t(t):t;function Lt(t){w&&g&&(t=Ct(t),E(t.dep||(t.dep=a())))}function Nt(t,e){t=Ct(t),t.dep&&C(t.dep)}function kt(t){return!(!t||!0!==t.__v_isRef)}function Ot(t){return kt(t)?t.value:t}const Dt={get:(t,e,n)=>Ot(Reflect.get(t,e,n)),set:(t,e,n,r)=>{const i=t[e];return kt(i)&&!kt(n)?(i.value=n,!0):Reflect.set(t,e,n,r)}};function zt(t){return At(t)?t:new Proxy(t,Dt)}var Ft;class Ut{constructor(t,e,n,r){this._setter=e,this.dep=void 0,this.__v_isRef=!0,this[Ft]=!1,this._dirty=!0,this.effect=new x(t,(()=>{this._dirty||(this._dirty=!0,Nt(this))})),this.effect.computed=this,this.effect.active=this._cacheable=!r,this["__v_isReadonly"]=n}get value(){const t=Ct(this);return Lt(t),!t._dirty&&t._cacheable||(t._dirty=!1,t._value=t.effect.run()),t._value}set value(t){this._setter(t)}}function Bt(t,e,n=!1){let i,s;const o=(0,r.mf)(t);o?(i=t,s=r.dG):(i=t.get,s=t.set);const a=new Ut(i,s,o||!s,n);return a}Ft="__v_isReadonly"},3396:function(t,e,n){"use strict";n.d(e,{$d:function(){return o},Cn:function(){return D},FN:function(){return fn},HY:function(){return Le},P$:function(){return rt},Q6:function(){return ct},U2:function(){return st},Uk:function(){return en},Us:function(){return Ee},WI:function(){return Ut},Wm:function(){return Ze},Y8:function(){return tt},_:function(){return Ke},aZ:function(){return ut},dD:function(){return O},h:function(){return In},iD:function(){return Ve},ic:function(){return St},j4:function(){return je},kq:function(){return nn},nK:function(){return lt},up:function(){return Ot},wg:function(){return Fe},wy:function(){return Lt}});n(1703);var r=n(4870),i=n(7139);function s(t,e,n,r){let i;try{i=r?t(...r):t()}catch(s){a(s,e,n)}return i}function o(t,e,n,r){if((0,i.mf)(t)){const o=s(t,e,n,r);return o&&(0,i.tI)(o)&&o.catch((t=>{a(t,e,n)})),o}const l=[];for(let i=0;i<t.length;i++)l.push(o(t[i],e,n,r));return l}function a(t,e,n,r=!0){const i=e?e.vnode:null;if(e){let r=e.parent;const i=e.proxy,o=n;while(r){const e=r.ec;if(e)for(let n=0;n<e.length;n++)if(!1===e[n](t,i,o))return;r=r.parent}const a=e.appContext.config.errorHandler;if(a)return void s(a,null,10,[t,i,o])}l(t,n,i,r)}function l(t,e,n,r=!0){console.error(t)}let c=!1,u=!1;const h=[];let d=0;const f=[];let p=null,m=0;const g=Promise.resolve();let v=null;function y(t){const e=v||g;return t?e.then(this?t.bind(this):t):e}function x(t){let e=d+1,n=h.length;while(e<n){const r=e+n>>>1,i=E(h[r]);i<t?e=r+1:n=r}return e}function b(t){h.length&&h.includes(t,c&&t.allowRecurse?d+1:d)||(null==t.id?h.push(t):h.splice(x(t.id),0,t),w())}function w(){c||u||(u=!0,v=g.then(C))}function _(t){const e=h.indexOf(t);e>d&&h.splice(e,1)}function M(t){(0,i.kJ)(t)?f.push(...t):p&&p.includes(t,t.allowRecurse?m+1:m)||f.push(t),w()}function A(t,e=d){for(0;e<h.length;e++){const t=h[e];t&&t.pre&&(h.splice(e,1),e--,t())}}function S(t){if(f.length){const t=[...new Set(f)];if(f.length=0,p)return void p.push(...t);for(p=t,p.sort(((t,e)=>E(t)-E(e))),m=0;m<p.length;m++)p[m]();p=null,m=0}}const E=t=>null==t.id?1/0:t.id,T=(t,e)=>{const n=E(t)-E(e);if(0===n){if(t.pre&&!e.pre)return-1;if(e.pre&&!t.pre)return 1}return n};function C(t){u=!1,c=!0,h.sort(T);i.dG;try{for(d=0;d<h.length;d++){const t=h[d];t&&!1!==t.active&&s(t,null,14)}}finally{d=0,h.length=0,S(t),c=!1,v=null,(h.length||f.length)&&C(t)}}new Set;new Map;function R(t,e,...n){if(t.isUnmounted)return;const r=t.vnode.props||i.kT;let s=n;const a=e.startsWith("update:"),l=a&&e.slice(7);if(l&&l in r){const t=`${"modelValue"===l?"model":l}Modifiers`,{number:e,trim:o}=r[t]||i.kT;o&&(s=n.map((t=>t.trim()))),e&&(s=n.map(i.He))}let c;let u=r[c=(0,i.hR)(e)]||r[c=(0,i.hR)((0,i._A)(e))];!u&&a&&(u=r[c=(0,i.hR)((0,i.rs)(e))]),u&&o(u,t,6,s);const h=r[c+"Once"];if(h){if(t.emitted){if(t.emitted[c])return}else t.emitted={};t.emitted[c]=!0,o(h,t,6,s)}}function I(t,e,n=!1){const r=e.emitsCache,s=r.get(t);if(void 0!==s)return s;const o=t.emits;let a={},l=!1;if(!(0,i.mf)(t)){const r=t=>{const n=I(t,e,!0);n&&(l=!0,(0,i.l7)(a,n))};!n&&e.mixins.length&&e.mixins.forEach(r),t.extends&&r(t.extends),t.mixins&&t.mixins.forEach(r)}return o||l?((0,i.kJ)(o)?o.forEach((t=>a[t]=null)):(0,i.l7)(a,o),(0,i.Kn)(t)&&r.set(t,a),a):((0,i.Kn)(t)&&r.set(t,null),null)}function P(t,e){return!(!t||!(0,i.F7)(e))&&(e=e.slice(2).replace(/Once$/,""),(0,i.RI)(t,e[0].toLowerCase()+e.slice(1))||(0,i.RI)(t,(0,i.rs)(e))||(0,i.RI)(t,e))}let L=null,N=null;function k(t){const e=L;return L=t,N=t&&t.type.__scopeId||null,e}function O(t){N=t}function D(){N=null}function z(t,e=L,n){if(!e)return t;if(t._n)return t;const r=(...n)=>{r._d&&Ge(-1);const i=k(e),s=t(...n);return k(i),r._d&&Ge(1),s};return r._n=!0,r._c=!0,r._d=!0,r}function F(t){const{type:e,vnode:n,proxy:r,withProxy:s,props:o,propsOptions:[l],slots:c,attrs:u,emit:h,render:d,renderCache:f,data:p,setupState:m,ctx:g,inheritAttrs:v}=t;let y,x;const b=k(t);try{if(4&n.shapeFlag){const t=s||r;y=rn(d.call(t,t,f,o,m,p,g)),x=u}else{const t=e;0,y=rn(t.length>1?t(o,{attrs:u,slots:c,emit:h}):t(o,null)),x=e.props?u:U(u)}}catch(_){De.length=0,a(_,t,1),y=Ze(ke)}let w=y;if(x&&!1!==v){const t=Object.keys(x),{shapeFlag:e}=w;t.length&&7&e&&(l&&t.some(i.tR)&&(x=B(x,l)),w=tn(w,x))}return n.dirs&&(w=tn(w),w.dirs=w.dirs?w.dirs.concat(n.dirs):n.dirs),n.transition&&(w.transition=n.transition),y=w,k(b),y}const U=t=>{let e;for(const n in t)("class"===n||"style"===n||(0,i.F7)(n))&&((e||(e={}))[n]=t[n]);return e},B=(t,e)=>{const n={};for(const r in t)(0,i.tR)(r)&&r.slice(9)in e||(n[r]=t[r]);return n};function G(t,e,n){const{props:r,children:i,component:s}=t,{props:o,children:a,patchFlag:l}=e,c=s.emitsOptions;if(e.dirs||e.transition)return!0;if(!(n&&l>=0))return!(!i&&!a||a&&a.$stable)||r!==o&&(r?!o||H(r,o,c):!!o);if(1024&l)return!0;if(16&l)return r?H(r,o,c):!!o;if(8&l){const t=e.dynamicProps;for(let e=0;e<t.length;e++){const n=t[e];if(o[n]!==r[n]&&!P(c,n))return!0}}return!1}function H(t,e,n){const r=Object.keys(e);if(r.length!==Object.keys(t).length)return!0;for(let i=0;i<r.length;i++){const s=r[i];if(e[s]!==t[s]&&!P(n,s))return!0}return!1}function V({vnode:t,parent:e},n){while(e&&e.subTree===t)(t=e.vnode).el=n,e=e.parent}const j=t=>t.__isSuspense;function W(t,e){e&&e.pendingBranch?(0,i.kJ)(t)?e.effects.push(...t):e.effects.push(t):M(t)}function q(t,e){if(dn){let n=dn.provides;const r=dn.parent&&dn.parent.provides;r===n&&(n=dn.provides=Object.create(r)),n[t]=e}else 0}function Y(t,e,n=!1){const r=dn||L;if(r){const s=null==r.parent?r.vnode.appContext&&r.vnode.appContext.provides:r.parent.provides;if(s&&t in s)return s[t];if(arguments.length>1)return n&&(0,i.mf)(e)?e.call(r.proxy):e}else 0}const X={};function J(t,e,n){return K(t,e,n)}function K(t,e,{immediate:n,deep:a,flush:l,onTrack:c,onTrigger:u}=i.kT){const h=dn;let d,f,p=!1,m=!1;if((0,r.dq)(t)?(d=()=>t.value,p=(0,r.yT)(t)):(0,r.PG)(t)?(d=()=>t,a=!0):(0,i.kJ)(t)?(m=!0,p=t.some((t=>(0,r.PG)(t)||(0,r.yT)(t))),d=()=>t.map((t=>(0,r.dq)(t)?t.value:(0,r.PG)(t)?$(t):(0,i.mf)(t)?s(t,h,2):void 0))):d=(0,i.mf)(t)?e?()=>s(t,h,2):()=>{if(!h||!h.isUnmounted)return f&&f(),o(t,h,3,[g])}:i.dG,e&&a){const t=d;d=()=>$(t())}let g=t=>{f=w.onStop=()=>{s(t,h,4)}};if(xn)return g=i.dG,e?n&&o(e,h,3,[d(),m?[]:void 0,g]):d(),i.dG;let v=m?[]:X;const y=()=>{if(w.active)if(e){const t=w.run();(a||p||(m?t.some(((t,e)=>(0,i.aU)(t,v[e]))):(0,i.aU)(t,v)))&&(f&&f(),o(e,h,3,[t,v===X?void 0:v,g]),v=t)}else w.run()};let x;y.allowRecurse=!!e,"sync"===l?x=y:"post"===l?x=()=>Se(y,h&&h.suspense):(y.pre=!0,h&&(y.id=h.uid),x=()=>b(y));const w=new r.qq(d,x);return e?n?y():v=w.run():"post"===l?Se(w.run.bind(w),h&&h.suspense):w.run(),()=>{w.stop(),h&&h.scope&&(0,i.Od)(h.scope.effects,w)}}function Z(t,e,n){const r=this.proxy,s=(0,i.HD)(t)?t.includes(".")?Q(r,t):()=>r[t]:t.bind(r,r);let o;(0,i.mf)(e)?o=e:(o=e.handler,n=e);const a=dn;pn(this);const l=K(s,o.bind(r),n);return a?pn(a):mn(),l}function Q(t,e){const n=e.split(".");return()=>{let e=t;for(let t=0;t<n.length&&e;t++)e=e[n[t]];return e}}function $(t,e){if(!(0,i.Kn)(t)||t["__v_skip"])return t;if(e=e||new Set,e.has(t))return t;if(e.add(t),(0,r.dq)(t))$(t.value,e);else if((0,i.kJ)(t))for(let n=0;n<t.length;n++)$(t[n],e);else if((0,i.DM)(t)||(0,i._N)(t))t.forEach((t=>{$(t,e)}));else if((0,i.PO)(t))for(const n in t)$(t[n],e);return t}function tt(){const t={isMounted:!1,isLeaving:!1,isUnmounting:!1,leavingVNodes:new Map};return Mt((()=>{t.isMounted=!0})),Et((()=>{t.isUnmounting=!0})),t}const et=[Function,Array],nt={name:"BaseTransition",props:{mode:String,appear:Boolean,persisted:Boolean,onBeforeEnter:et,onEnter:et,onAfterEnter:et,onEnterCancelled:et,onBeforeLeave:et,onLeave:et,onAfterLeave:et,onLeaveCancelled:et,onBeforeAppear:et,onAppear:et,onAfterAppear:et,onAppearCancelled:et},setup(t,{slots:e}){const n=fn(),i=tt();let s;return()=>{const o=e.default&&ct(e.default(),!0);if(!o||!o.length)return;let a=o[0];if(o.length>1){let t=!1;for(const e of o)if(e.type!==ke){0,a=e,t=!0;break}}const l=(0,r.IU)(t),{mode:c}=l;if(i.isLeaving)return ot(a);const u=at(a);if(!u)return ot(a);const h=st(u,l,i,n);lt(u,h);const d=n.subTree,f=d&&at(d);let p=!1;const{getTransitionKey:m}=u.type;if(m){const t=m();void 0===s?s=t:t!==s&&(s=t,p=!0)}if(f&&f.type!==ke&&(!qe(u,f)||p)){const t=st(f,l,i,n);if(lt(f,t),"out-in"===c)return i.isLeaving=!0,t.afterLeave=()=>{i.isLeaving=!1,n.update()},ot(a);"in-out"===c&&u.type!==ke&&(t.delayLeave=(t,e,n)=>{const r=it(i,f);r[String(f.key)]=f,t._leaveCb=()=>{e(),t._leaveCb=void 0,delete h.delayedLeave},h.delayedLeave=n})}return a}}},rt=nt;function it(t,e){const{leavingVNodes:n}=t;let r=n.get(e.type);return r||(r=Object.create(null),n.set(e.type,r)),r}function st(t,e,n,r){const{appear:s,mode:a,persisted:l=!1,onBeforeEnter:c,onEnter:u,onAfterEnter:h,onEnterCancelled:d,onBeforeLeave:f,onLeave:p,onAfterLeave:m,onLeaveCancelled:g,onBeforeAppear:v,onAppear:y,onAfterAppear:x,onAppearCancelled:b}=e,w=String(t.key),_=it(n,t),M=(t,e)=>{t&&o(t,r,9,e)},A=(t,e)=>{const n=e[1];M(t,e),(0,i.kJ)(t)?t.every((t=>t.length<=1))&&n():t.length<=1&&n()},S={mode:a,persisted:l,beforeEnter(e){let r=c;if(!n.isMounted){if(!s)return;r=v||c}e._leaveCb&&e._leaveCb(!0);const i=_[w];i&&qe(t,i)&&i.el._leaveCb&&i.el._leaveCb(),M(r,[e])},enter(t){let e=u,r=h,i=d;if(!n.isMounted){if(!s)return;e=y||u,r=x||h,i=b||d}let o=!1;const a=t._enterCb=e=>{o||(o=!0,M(e?i:r,[t]),S.delayedLeave&&S.delayedLeave(),t._enterCb=void 0)};e?A(e,[t,a]):a()},leave(e,r){const i=String(t.key);if(e._enterCb&&e._enterCb(!0),n.isUnmounting)return r();M(f,[e]);let s=!1;const o=e._leaveCb=n=>{s||(s=!0,r(),M(n?g:m,[e]),e._leaveCb=void 0,_[i]===t&&delete _[i])};_[i]=t,p?A(p,[e,o]):o()},clone(t){return st(t,e,n,r)}};return S}function ot(t){if(dt(t))return t=tn(t),t.children=null,t}function at(t){return dt(t)?t.children?t.children[0]:void 0:t}function lt(t,e){6&t.shapeFlag&&t.component?lt(t.component.subTree,e):128&t.shapeFlag?(t.ssContent.transition=e.clone(t.ssContent),t.ssFallback.transition=e.clone(t.ssFallback)):t.transition=e}function ct(t,e=!1,n){let r=[],i=0;for(let s=0;s<t.length;s++){let o=t[s];const a=null==n?o.key:String(n)+String(null!=o.key?o.key:s);o.type===Le?(128&o.patchFlag&&i++,r=r.concat(ct(o.children,e,a))):(e||o.type!==ke)&&r.push(null!=a?tn(o,{key:a}):o)}if(i>1)for(let s=0;s<r.length;s++)r[s].patchFlag=-2;return r}function ut(t){return(0,i.mf)(t)?{setup:t,name:t.name}:t}const ht=t=>!!t.type.__asyncLoader;const dt=t=>t.type.__isKeepAlive;RegExp,RegExp;function ft(t,e){return(0,i.kJ)(t)?t.some((t=>ft(t,e))):(0,i.HD)(t)?t.split(",").includes(e):!!t.test&&t.test(e)}function pt(t,e){gt(t,"a",e)}function mt(t,e){gt(t,"da",e)}function gt(t,e,n=dn){const r=t.__wdc||(t.__wdc=()=>{let e=n;while(e){if(e.isDeactivated)return;e=e.parent}return t()});if(bt(e,r,n),n){let t=n.parent;while(t&&t.parent)dt(t.parent.vnode)&&vt(r,e,n,t),t=t.parent}}function vt(t,e,n,r){const s=bt(e,t,r,!0);Tt((()=>{(0,i.Od)(r[e],s)}),n)}function yt(t){let e=t.shapeFlag;256&e&&(e-=256),512&e&&(e-=512),t.shapeFlag=e}function xt(t){return 128&t.shapeFlag?t.ssContent:t}function bt(t,e,n=dn,i=!1){if(n){const s=n[t]||(n[t]=[]),a=e.__weh||(e.__weh=(...i)=>{if(n.isUnmounted)return;(0,r.Jd)(),pn(n);const s=o(e,n,t,i);return mn(),(0,r.lk)(),s});return i?s.unshift(a):s.push(a),a}}const wt=t=>(e,n=dn)=>(!xn||"sp"===t)&&bt(t,e,n),_t=wt("bm"),Mt=wt("m"),At=wt("bu"),St=wt("u"),Et=wt("bum"),Tt=wt("um"),Ct=wt("sp"),Rt=wt("rtg"),It=wt("rtc");function Pt(t,e=dn){bt("ec",t,e)}function Lt(t,e){const n=L;if(null===n)return t;const r=En(n)||n.proxy,s=t.dirs||(t.dirs=[]);for(let o=0;o<e.length;o++){let[t,n,a,l=i.kT]=e[o];(0,i.mf)(t)&&(t={mounted:t,updated:t}),t.deep&&$(n),s.push({dir:t,instance:r,value:n,oldValue:void 0,arg:a,modifiers:l})}return t}function Nt(t,e,n,i){const s=t.dirs,a=e&&e.dirs;for(let l=0;l<s.length;l++){const c=s[l];a&&(c.oldValue=a[l].value);let u=c.dir[i];u&&((0,r.Jd)(),o(u,n,8,[t.el,c,t,e]),(0,r.lk)())}}const kt="components";function Ot(t,e){return zt(kt,t,!0,e)||t}const Dt=Symbol();function zt(t,e,n=!0,r=!1){const s=L||dn;if(s){const n=s.type;if(t===kt){const t=Tn(n,!1);if(t&&(t===e||t===(0,i._A)(e)||t===(0,i.kC)((0,i._A)(e))))return n}const o=Ft(s[t]||n[t],e)||Ft(s.appContext[t],e);return!o&&r?n:o}}function Ft(t,e){return t&&(t[e]||t[(0,i._A)(e)]||t[(0,i.kC)((0,i._A)(e))])}function Ut(t,e,n={},r,i){if(L.isCE||L.parent&&ht(L.parent)&&L.parent.isCE)return Ze("slot","default"===e?null:{name:e},r&&r());let s=t[e];s&&s._c&&(s._d=!1),Fe();const o=s&&Bt(s(n)),a=je(Le,{key:n.key||o&&o.key||`_${e}`},o||(r?r():[]),o&&1===t._?64:-2);return!i&&a.scopeId&&(a.slotScopeIds=[a.scopeId+"-s"]),s&&s._c&&(s._d=!0),a}function Bt(t){return t.some((t=>!We(t)||t.type!==ke&&!(t.type===Le&&!Bt(t.children))))?t:null}const Gt=t=>t?gn(t)?En(t)||t.proxy:Gt(t.parent):null,Ht=(0,i.l7)(Object.create(null),{$:t=>t,$el:t=>t.vnode.el,$data:t=>t.data,$props:t=>t.props,$attrs:t=>t.attrs,$slots:t=>t.slots,$refs:t=>t.refs,$parent:t=>Gt(t.parent),$root:t=>Gt(t.root),$emit:t=>t.emit,$options:t=>Jt(t),$forceUpdate:t=>t.f||(t.f=()=>b(t.update)),$nextTick:t=>t.n||(t.n=y.bind(t.proxy)),$watch:t=>Z.bind(t)}),Vt={get({_:t},e){const{ctx:n,setupState:s,data:o,props:a,accessCache:l,type:c,appContext:u}=t;let h;if("$"!==e[0]){const r=l[e];if(void 0!==r)switch(r){case 1:return s[e];case 2:return o[e];case 4:return n[e];case 3:return a[e]}else{if(s!==i.kT&&(0,i.RI)(s,e))return l[e]=1,s[e];if(o!==i.kT&&(0,i.RI)(o,e))return l[e]=2,o[e];if((h=t.propsOptions[0])&&(0,i.RI)(h,e))return l[e]=3,a[e];if(n!==i.kT&&(0,i.RI)(n,e))return l[e]=4,n[e];jt&&(l[e]=0)}}const d=Ht[e];let f,p;return d?("$attrs"===e&&(0,r.j)(t,"get",e),d(t)):(f=c.__cssModules)&&(f=f[e])?f:n!==i.kT&&(0,i.RI)(n,e)?(l[e]=4,n[e]):(p=u.config.globalProperties,(0,i.RI)(p,e)?p[e]:void 0)},set({_:t},e,n){const{data:r,setupState:s,ctx:o}=t;return s!==i.kT&&(0,i.RI)(s,e)?(s[e]=n,!0):r!==i.kT&&(0,i.RI)(r,e)?(r[e]=n,!0):!(0,i.RI)(t.props,e)&&(("$"!==e[0]||!(e.slice(1)in t))&&(o[e]=n,!0))},has({_:{data:t,setupState:e,accessCache:n,ctx:r,appContext:s,propsOptions:o}},a){let l;return!!n[a]||t!==i.kT&&(0,i.RI)(t,a)||e!==i.kT&&(0,i.RI)(e,a)||(l=o[0])&&(0,i.RI)(l,a)||(0,i.RI)(r,a)||(0,i.RI)(Ht,a)||(0,i.RI)(s.config.globalProperties,a)},defineProperty(t,e,n){return null!=n.get?t._.accessCache[e]=0:(0,i.RI)(n,"value")&&this.set(t,e,n.value,null),Reflect.defineProperty(t,e,n)}};let jt=!0;function Wt(t){const e=Jt(t),n=t.proxy,s=t.ctx;jt=!1,e.beforeCreate&&Yt(e.beforeCreate,t,"bc");const{data:o,computed:a,methods:l,watch:c,provide:u,inject:h,created:d,beforeMount:f,mounted:p,beforeUpdate:m,updated:g,activated:v,deactivated:y,beforeDestroy:x,beforeUnmount:b,destroyed:w,unmounted:_,render:M,renderTracked:A,renderTriggered:S,errorCaptured:E,serverPrefetch:T,expose:C,inheritAttrs:R,components:I,directives:P,filters:L}=e,N=null;if(h&&qt(h,s,N,t.appContext.config.unwrapInjectedRef),l)for(const r in l){const t=l[r];(0,i.mf)(t)&&(s[r]=t.bind(n))}if(o){0;const e=o.call(n,n);0,(0,i.Kn)(e)&&(t.data=(0,r.qj)(e))}if(jt=!0,a)for(const r in a){const t=a[r],e=(0,i.mf)(t)?t.bind(n,n):(0,i.mf)(t.get)?t.get.bind(n,n):i.dG;0;const o=!(0,i.mf)(t)&&(0,i.mf)(t.set)?t.set.bind(n):i.dG,l=Rn({get:e,set:o});Object.defineProperty(s,r,{enumerable:!0,configurable:!0,get:()=>l.value,set:t=>l.value=t})}if(c)for(const r in c)Xt(c[r],s,n,r);if(u){const t=(0,i.mf)(u)?u.call(n):u;Reflect.ownKeys(t).forEach((e=>{q(e,t[e])}))}function k(t,e){(0,i.kJ)(e)?e.forEach((e=>t(e.bind(n)))):e&&t(e.bind(n))}if(d&&Yt(d,t,"c"),k(_t,f),k(Mt,p),k(At,m),k(St,g),k(pt,v),k(mt,y),k(Pt,E),k(It,A),k(Rt,S),k(Et,b),k(Tt,_),k(Ct,T),(0,i.kJ)(C))if(C.length){const e=t.exposed||(t.exposed={});C.forEach((t=>{Object.defineProperty(e,t,{get:()=>n[t],set:e=>n[t]=e})}))}else t.exposed||(t.exposed={});M&&t.render===i.dG&&(t.render=M),null!=R&&(t.inheritAttrs=R),I&&(t.components=I),P&&(t.directives=P)}function qt(t,e,n=i.dG,s=!1){(0,i.kJ)(t)&&(t=te(t));for(const o in t){const n=t[o];let a;a=(0,i.Kn)(n)?"default"in n?Y(n.from||o,n.default,!0):Y(n.from||o):Y(n),(0,r.dq)(a)&&s?Object.defineProperty(e,o,{enumerable:!0,configurable:!0,get:()=>a.value,set:t=>a.value=t}):e[o]=a}}function Yt(t,e,n){o((0,i.kJ)(t)?t.map((t=>t.bind(e.proxy))):t.bind(e.proxy),e,n)}function Xt(t,e,n,r){const s=r.includes(".")?Q(n,r):()=>n[r];if((0,i.HD)(t)){const n=e[t];(0,i.mf)(n)&&J(s,n)}else if((0,i.mf)(t))J(s,t.bind(n));else if((0,i.Kn)(t))if((0,i.kJ)(t))t.forEach((t=>Xt(t,e,n,r)));else{const r=(0,i.mf)(t.handler)?t.handler.bind(n):e[t.handler];(0,i.mf)(r)&&J(s,r,t)}else 0}function Jt(t){const e=t.type,{mixins:n,extends:r}=e,{mixins:s,optionsCache:o,config:{optionMergeStrategies:a}}=t.appContext,l=o.get(e);let c;return l?c=l:s.length||n||r?(c={},s.length&&s.forEach((t=>Kt(c,t,a,!0))),Kt(c,e,a)):c=e,(0,i.Kn)(e)&&o.set(e,c),c}function Kt(t,e,n,r=!1){const{mixins:i,extends:s}=e;s&&Kt(t,s,n,!0),i&&i.forEach((e=>Kt(t,e,n,!0)));for(const o in e)if(r&&"expose"===o);else{const r=Zt[o]||n&&n[o];t[o]=r?r(t[o],e[o]):e[o]}return t}const Zt={data:Qt,props:ne,emits:ne,methods:ne,computed:ne,beforeCreate:ee,created:ee,beforeMount:ee,mounted:ee,beforeUpdate:ee,updated:ee,beforeDestroy:ee,beforeUnmount:ee,destroyed:ee,unmounted:ee,activated:ee,deactivated:ee,errorCaptured:ee,serverPrefetch:ee,components:ne,directives:ne,watch:re,provide:Qt,inject:$t};function Qt(t,e){return e?t?function(){return(0,i.l7)((0,i.mf)(t)?t.call(this,this):t,(0,i.mf)(e)?e.call(this,this):e)}:e:t}function $t(t,e){return ne(te(t),te(e))}function te(t){if((0,i.kJ)(t)){const e={};for(let n=0;n<t.length;n++)e[t[n]]=t[n];return e}return t}function ee(t,e){return t?[...new Set([].concat(t,e))]:e}function ne(t,e){return t?(0,i.l7)((0,i.l7)(Object.create(null),t),e):e}function re(t,e){if(!t)return e;if(!e)return t;const n=(0,i.l7)(Object.create(null),t);for(const r in e)n[r]=ee(t[r],e[r]);return n}function ie(t,e,n,s=!1){const o={},a={};(0,i.Nj)(a,Ye,1),t.propsDefaults=Object.create(null),oe(t,e,o,a);for(const r in t.propsOptions[0])r in o||(o[r]=void 0);n?t.props=s?o:(0,r.Um)(o):t.type.props?t.props=o:t.props=a,t.attrs=a}function se(t,e,n,s){const{props:o,attrs:a,vnode:{patchFlag:l}}=t,c=(0,r.IU)(o),[u]=t.propsOptions;let h=!1;if(!(s||l>0)||16&l){let r;oe(t,e,o,a)&&(h=!0);for(const s in c)e&&((0,i.RI)(e,s)||(r=(0,i.rs)(s))!==s&&(0,i.RI)(e,r))||(u?!n||void 0===n[s]&&void 0===n[r]||(o[s]=ae(u,c,s,void 0,t,!0)):delete o[s]);if(a!==c)for(const t in a)e&&(0,i.RI)(e,t)||(delete a[t],h=!0)}else if(8&l){const n=t.vnode.dynamicProps;for(let r=0;r<n.length;r++){let s=n[r];if(P(t.emitsOptions,s))continue;const l=e[s];if(u)if((0,i.RI)(a,s))l!==a[s]&&(a[s]=l,h=!0);else{const e=(0,i._A)(s);o[e]=ae(u,c,e,l,t,!1)}else l!==a[s]&&(a[s]=l,h=!0)}}h&&(0,r.X$)(t,"set","$attrs")}function oe(t,e,n,s){const[o,a]=t.propsOptions;let l,c=!1;if(e)for(let r in e){if((0,i.Gg)(r))continue;const u=e[r];let h;o&&(0,i.RI)(o,h=(0,i._A)(r))?a&&a.includes(h)?(l||(l={}))[h]=u:n[h]=u:P(t.emitsOptions,r)||r in s&&u===s[r]||(s[r]=u,c=!0)}if(a){const e=(0,r.IU)(n),s=l||i.kT;for(let r=0;r<a.length;r++){const l=a[r];n[l]=ae(o,e,l,s[l],t,!(0,i.RI)(s,l))}}return c}function ae(t,e,n,r,s,o){const a=t[n];if(null!=a){const t=(0,i.RI)(a,"default");if(t&&void 0===r){const t=a.default;if(a.type!==Function&&(0,i.mf)(t)){const{propsDefaults:i}=s;n in i?r=i[n]:(pn(s),r=i[n]=t.call(null,e),mn())}else r=t}a[0]&&(o&&!t?r=!1:!a[1]||""!==r&&r!==(0,i.rs)(n)||(r=!0))}return r}function le(t,e,n=!1){const r=e.propsCache,s=r.get(t);if(s)return s;const o=t.props,a={},l=[];let c=!1;if(!(0,i.mf)(t)){const r=t=>{c=!0;const[n,r]=le(t,e,!0);(0,i.l7)(a,n),r&&l.push(...r)};!n&&e.mixins.length&&e.mixins.forEach(r),t.extends&&r(t.extends),t.mixins&&t.mixins.forEach(r)}if(!o&&!c)return(0,i.Kn)(t)&&r.set(t,i.Z6),i.Z6;if((0,i.kJ)(o))for(let h=0;h<o.length;h++){0;const t=(0,i._A)(o[h]);ce(t)&&(a[t]=i.kT)}else if(o){0;for(const t in o){const e=(0,i._A)(t);if(ce(e)){const n=o[t],r=a[e]=(0,i.kJ)(n)||(0,i.mf)(n)?{type:n}:n;if(r){const t=de(Boolean,r.type),n=de(String,r.type);r[0]=t>-1,r[1]=n<0||t<n,(t>-1||(0,i.RI)(r,"default"))&&l.push(e)}}}}const u=[a,l];return(0,i.Kn)(t)&&r.set(t,u),u}function ce(t){return"$"!==t[0]}function ue(t){const e=t&&t.toString().match(/^\s*function (\w+)/);return e?e[1]:null===t?"null":""}function he(t,e){return ue(t)===ue(e)}function de(t,e){return(0,i.kJ)(e)?e.findIndex((e=>he(e,t))):(0,i.mf)(e)&&he(e,t)?0:-1}const fe=t=>"_"===t[0]||"$stable"===t,pe=t=>(0,i.kJ)(t)?t.map(rn):[rn(t)],me=(t,e,n)=>{if(e._n)return e;const r=z(((...t)=>pe(e(...t))),n);return r._c=!1,r},ge=(t,e,n)=>{const r=t._ctx;for(const s in t){if(fe(s))continue;const n=t[s];if((0,i.mf)(n))e[s]=me(s,n,r);else if(null!=n){0;const t=pe(n);e[s]=()=>t}}},ve=(t,e)=>{const n=pe(e);t.slots.default=()=>n},ye=(t,e)=>{if(32&t.vnode.shapeFlag){const n=e._;n?(t.slots=(0,r.IU)(e),(0,i.Nj)(e,"_",n)):ge(e,t.slots={})}else t.slots={},e&&ve(t,e);(0,i.Nj)(t.slots,Ye,1)},xe=(t,e,n)=>{const{vnode:r,slots:s}=t;let o=!0,a=i.kT;if(32&r.shapeFlag){const t=e._;t?n&&1===t?o=!1:((0,i.l7)(s,e),n||1!==t||delete s._):(o=!e.$stable,ge(e,s)),a=e}else e&&(ve(t,e),a={default:1});if(o)for(const i in s)fe(i)||i in a||delete s[i]};function be(){return{app:null,config:{isNativeTag:i.NO,performance:!1,globalProperties:{},optionMergeStrategies:{},errorHandler:void 0,warnHandler:void 0,compilerOptions:{}},mixins:[],components:{},directives:{},provides:Object.create(null),optionsCache:new WeakMap,propsCache:new WeakMap,emitsCache:new WeakMap}}let we=0;function _e(t,e){return function(n,r=null){(0,i.mf)(n)||(n=Object.assign({},n)),null==r||(0,i.Kn)(r)||(r=null);const s=be(),o=new Set;let a=!1;const l=s.app={_uid:we++,_component:n,_props:r,_container:null,_context:s,_instance:null,version:Pn,get config(){return s.config},set config(t){0},use(t,...e){return o.has(t)||(t&&(0,i.mf)(t.install)?(o.add(t),t.install(l,...e)):(0,i.mf)(t)&&(o.add(t),t(l,...e))),l},mixin(t){return s.mixins.includes(t)||s.mixins.push(t),l},component(t,e){return e?(s.components[t]=e,l):s.components[t]},directive(t,e){return e?(s.directives[t]=e,l):s.directives[t]},mount(i,o,c){if(!a){0;const u=Ze(n,r);return u.appContext=s,o&&e?e(u,i):t(u,i,c),a=!0,l._container=i,i.__vue_app__=l,En(u.component)||u.component.proxy}},unmount(){a&&(t(null,l._container),delete l._container.__vue_app__)},provide(t,e){return s.provides[t]=e,l}};return l}}function Me(t,e,n,o,a=!1){if((0,i.kJ)(t))return void t.forEach(((t,r)=>Me(t,e&&((0,i.kJ)(e)?e[r]:e),n,o,a)));if(ht(o)&&!a)return;const l=4&o.shapeFlag?En(o.component)||o.component.proxy:o.el,c=a?null:l,{i:u,r:h}=t;const d=e&&e.r,f=u.refs===i.kT?u.refs={}:u.refs,p=u.setupState;if(null!=d&&d!==h&&((0,i.HD)(d)?(f[d]=null,(0,i.RI)(p,d)&&(p[d]=null)):(0,r.dq)(d)&&(d.value=null)),(0,i.mf)(h))s(h,u,12,[c,f]);else{const e=(0,i.HD)(h),s=(0,r.dq)(h);if(e||s){const r=()=>{if(t.f){const n=e?f[h]:h.value;a?(0,i.kJ)(n)&&(0,i.Od)(n,l):(0,i.kJ)(n)?n.includes(l)||n.push(l):e?(f[h]=[l],(0,i.RI)(p,h)&&(p[h]=f[h])):(h.value=[l],t.k&&(f[t.k]=h.value))}else e?(f[h]=c,(0,i.RI)(p,h)&&(p[h]=c)):s&&(h.value=c,t.k&&(f[t.k]=c))};c?(r.id=-1,Se(r,n)):r()}else 0}}function Ae(){}const Se=W;function Ee(t){return Te(t)}function Te(t,e){Ae();const n=(0,i.E9)();n.__VUE__=!0;const{insert:s,remove:o,patchProp:a,createElement:l,createText:c,createComment:u,setText:h,setElementText:d,parentNode:f,nextSibling:p,setScopeId:m=i.dG,cloneNode:g,insertStaticContent:v}=t,y=(t,e,n,r=null,i=null,s=null,o=!1,a=null,l=!!e.dynamicChildren)=>{if(t===e)return;t&&!qe(t,e)&&(r=$(t),X(t,i,s,!0),t=null),-2===e.patchFlag&&(l=!1,e.dynamicChildren=null);const{type:c,ref:u,shapeFlag:h}=e;switch(c){case Ne:x(t,e,n,r);break;case ke:w(t,e,n,r);break;case Oe:null==t&&M(e,n,r,o);break;case Le:O(t,e,n,r,i,s,o,a,l);break;default:1&h?C(t,e,n,r,i,s,o,a,l):6&h?D(t,e,n,r,i,s,o,a,l):(64&h||128&h)&&c.process(t,e,n,r,i,s,o,a,l,et)}null!=u&&i&&Me(u,t&&t.ref,s,e||t,!e)},x=(t,e,n,r)=>{if(null==t)s(e.el=c(e.children),n,r);else{const n=e.el=t.el;e.children!==t.children&&h(n,e.children)}},w=(t,e,n,r)=>{null==t?s(e.el=u(e.children||""),n,r):e.el=t.el},M=(t,e,n,r)=>{[t.el,t.anchor]=v(t.children,e,n,r,t.el,t.anchor)},E=({el:t,anchor:e},n,r)=>{let i;while(t&&t!==e)i=p(t),s(t,n,r),t=i;s(e,n,r)},T=({el:t,anchor:e})=>{let n;while(t&&t!==e)n=p(t),o(t),t=n;o(e)},C=(t,e,n,r,i,s,o,a,l)=>{o=o||"svg"===e.type,null==t?R(e,n,r,i,s,o,a,l):L(t,e,i,s,o,a,l)},R=(t,e,n,r,o,c,u,h)=>{let f,p;const{type:m,props:v,shapeFlag:y,transition:x,patchFlag:b,dirs:w}=t;if(t.el&&void 0!==g&&-1===b)f=t.el=g(t.el);else{if(f=t.el=l(t.type,c,v&&v.is,v),8&y?d(f,t.children):16&y&&P(t.children,f,null,r,o,c&&"foreignObject"!==m,u,h),w&&Nt(t,null,r,"created"),v){for(const e in v)"value"===e||(0,i.Gg)(e)||a(f,e,null,v[e],c,t.children,r,o,Q);"value"in v&&a(f,"value",null,v.value),(p=v.onVnodeBeforeMount)&&ln(p,r,t)}I(f,t,t.scopeId,u,r)}w&&Nt(t,null,r,"beforeMount");const _=(!o||o&&!o.pendingBranch)&&x&&!x.persisted;_&&x.beforeEnter(f),s(f,e,n),((p=v&&v.onVnodeMounted)||_||w)&&Se((()=>{p&&ln(p,r,t),_&&x.enter(f),w&&Nt(t,null,r,"mounted")}),o)},I=(t,e,n,r,i)=>{if(n&&m(t,n),r)for(let s=0;s<r.length;s++)m(t,r[s]);if(i){let n=i.subTree;if(e===n){const e=i.vnode;I(t,e,e.scopeId,e.slotScopeIds,i.parent)}}},P=(t,e,n,r,i,s,o,a,l=0)=>{for(let c=l;c<t.length;c++){const l=t[c]=a?sn(t[c]):rn(t[c]);y(null,l,e,n,r,i,s,o,a)}},L=(t,e,n,r,s,o,l)=>{const c=e.el=t.el;let{patchFlag:u,dynamicChildren:h,dirs:f}=e;u|=16&t.patchFlag;const p=t.props||i.kT,m=e.props||i.kT;let g;n&&Ce(n,!1),(g=m.onVnodeBeforeUpdate)&&ln(g,n,e,t),f&&Nt(e,t,n,"beforeUpdate"),n&&Ce(n,!0);const v=s&&"foreignObject"!==e.type;if(h?N(t.dynamicChildren,h,c,n,r,v,o):l||j(t,e,c,null,n,r,v,o,!1),u>0){if(16&u)k(c,e,p,m,n,r,s);else if(2&u&&p.class!==m.class&&a(c,"class",null,m.class,s),4&u&&a(c,"style",p.style,m.style,s),8&u){const i=e.dynamicProps;for(let e=0;e<i.length;e++){const o=i[e],l=p[o],u=m[o];u===l&&"value"!==o||a(c,o,l,u,s,t.children,n,r,Q)}}1&u&&t.children!==e.children&&d(c,e.children)}else l||null!=h||k(c,e,p,m,n,r,s);((g=m.onVnodeUpdated)||f)&&Se((()=>{g&&ln(g,n,e,t),f&&Nt(e,t,n,"updated")}),r)},N=(t,e,n,r,i,s,o)=>{for(let a=0;a<e.length;a++){const l=t[a],c=e[a],u=l.el&&(l.type===Le||!qe(l,c)||70&l.shapeFlag)?f(l.el):n;y(l,c,u,null,r,i,s,o,!0)}},k=(t,e,n,r,s,o,l)=>{if(n!==r){for(const c in r){if((0,i.Gg)(c))continue;const u=r[c],h=n[c];u!==h&&"value"!==c&&a(t,c,h,u,l,e.children,s,o,Q)}if(n!==i.kT)for(const c in n)(0,i.Gg)(c)||c in r||a(t,c,n[c],null,l,e.children,s,o,Q);"value"in r&&a(t,"value",n.value,r.value)}},O=(t,e,n,r,i,o,a,l,u)=>{const h=e.el=t?t.el:c(""),d=e.anchor=t?t.anchor:c("");let{patchFlag:f,dynamicChildren:p,slotScopeIds:m}=e;m&&(l=l?l.concat(m):m),null==t?(s(h,n,r),s(d,n,r),P(e.children,n,d,i,o,a,l,u)):f>0&&64&f&&p&&t.dynamicChildren?(N(t.dynamicChildren,p,n,i,o,a,l),(null!=e.key||i&&e===i.subTree)&&Re(t,e,!0)):j(t,e,n,d,i,o,a,l,u)},D=(t,e,n,r,i,s,o,a,l)=>{e.slotScopeIds=a,null==t?512&e.shapeFlag?i.ctx.activate(e,n,r,o,l):z(e,n,r,i,s,o,l):U(t,e,l)},z=(t,e,n,r,i,s,o)=>{const a=t.component=hn(t,r,i);if(dt(t)&&(a.ctx.renderer=et),bn(a),a.asyncDep){if(i&&i.registerDep(a,B),!t.el){const t=a.subTree=Ze(ke);w(null,t,e,n)}}else B(a,t,e,n,i,s,o)},U=(t,e,n)=>{const r=e.component=t.component;if(G(t,e,n)){if(r.asyncDep&&!r.asyncResolved)return void H(r,e,n);r.next=e,_(r.update),r.update()}else e.el=t.el,r.vnode=e},B=(t,e,n,s,o,a,l)=>{const c=()=>{if(t.isMounted){let e,{next:n,bu:r,u:s,parent:c,vnode:u}=t,h=n;0,Ce(t,!1),n?(n.el=u.el,H(t,n,l)):n=u,r&&(0,i.ir)(r),(e=n.props&&n.props.onVnodeBeforeUpdate)&&ln(e,c,n,u),Ce(t,!0);const d=F(t);0;const p=t.subTree;t.subTree=d,y(p,d,f(p.el),$(p),t,o,a),n.el=d.el,null===h&&V(t,d.el),s&&Se(s,o),(e=n.props&&n.props.onVnodeUpdated)&&Se((()=>ln(e,c,n,u)),o)}else{let r;const{el:l,props:c}=e,{bm:u,m:h,parent:d}=t,f=ht(e);if(Ce(t,!1),u&&(0,i.ir)(u),!f&&(r=c&&c.onVnodeBeforeMount)&&ln(r,d,e),Ce(t,!0),l&&rt){const n=()=>{t.subTree=F(t),rt(l,t.subTree,t,o,null)};f?e.type.__asyncLoader().then((()=>!t.isUnmounted&&n())):n()}else{0;const r=t.subTree=F(t);0,y(null,r,n,s,t,o,a),e.el=r.el}if(h&&Se(h,o),!f&&(r=c&&c.onVnodeMounted)){const t=e;Se((()=>ln(r,d,t)),o)}(256&e.shapeFlag||d&&ht(d.vnode)&&256&d.vnode.shapeFlag)&&t.a&&Se(t.a,o),t.isMounted=!0,e=n=s=null}},u=t.effect=new r.qq(c,(()=>b(h)),t.scope),h=t.update=()=>u.run();h.id=t.uid,Ce(t,!0),h()},H=(t,e,n)=>{e.component=t;const i=t.vnode.props;t.vnode=e,t.next=null,se(t,e.props,i,n),xe(t,e.children,n),(0,r.Jd)(),A(),(0,r.lk)()},j=(t,e,n,r,i,s,o,a,l=!1)=>{const c=t&&t.children,u=t?t.shapeFlag:0,h=e.children,{patchFlag:f,shapeFlag:p}=e;if(f>0){if(128&f)return void q(c,h,n,r,i,s,o,a,l);if(256&f)return void W(c,h,n,r,i,s,o,a,l)}8&p?(16&u&&Q(c,i,s),h!==c&&d(n,h)):16&u?16&p?q(c,h,n,r,i,s,o,a,l):Q(c,i,s,!0):(8&u&&d(n,""),16&p&&P(h,n,r,i,s,o,a,l))},W=(t,e,n,r,s,o,a,l,c)=>{t=t||i.Z6,e=e||i.Z6;const u=t.length,h=e.length,d=Math.min(u,h);let f;for(f=0;f<d;f++){const r=e[f]=c?sn(e[f]):rn(e[f]);y(t[f],r,n,null,s,o,a,l,c)}u>h?Q(t,s,o,!0,!1,d):P(e,n,r,s,o,a,l,c,d)},q=(t,e,n,r,s,o,a,l,c)=>{let u=0;const h=e.length;let d=t.length-1,f=h-1;while(u<=d&&u<=f){const r=t[u],i=e[u]=c?sn(e[u]):rn(e[u]);if(!qe(r,i))break;y(r,i,n,null,s,o,a,l,c),u++}while(u<=d&&u<=f){const r=t[d],i=e[f]=c?sn(e[f]):rn(e[f]);if(!qe(r,i))break;y(r,i,n,null,s,o,a,l,c),d--,f--}if(u>d){if(u<=f){const t=f+1,i=t<h?e[t].el:r;while(u<=f)y(null,e[u]=c?sn(e[u]):rn(e[u]),n,i,s,o,a,l,c),u++}}else if(u>f)while(u<=d)X(t[u],s,o,!0),u++;else{const p=u,m=u,g=new Map;for(u=m;u<=f;u++){const t=e[u]=c?sn(e[u]):rn(e[u]);null!=t.key&&g.set(t.key,u)}let v,x=0;const b=f-m+1;let w=!1,_=0;const M=new Array(b);for(u=0;u<b;u++)M[u]=0;for(u=p;u<=d;u++){const r=t[u];if(x>=b){X(r,s,o,!0);continue}let i;if(null!=r.key)i=g.get(r.key);else for(v=m;v<=f;v++)if(0===M[v-m]&&qe(r,e[v])){i=v;break}void 0===i?X(r,s,o,!0):(M[i-m]=u+1,i>=_?_=i:w=!0,y(r,e[i],n,null,s,o,a,l,c),x++)}const A=w?Ie(M):i.Z6;for(v=A.length-1,u=b-1;u>=0;u--){const t=m+u,i=e[t],d=t+1<h?e[t+1].el:r;0===M[u]?y(null,i,n,d,s,o,a,l,c):w&&(v<0||u!==A[v]?Y(i,n,d,2):v--)}}},Y=(t,e,n,r,i=null)=>{const{el:o,type:a,transition:l,children:c,shapeFlag:u}=t;if(6&u)return void Y(t.component.subTree,e,n,r);if(128&u)return void t.suspense.move(e,n,r);if(64&u)return void a.move(t,e,n,et);if(a===Le){s(o,e,n);for(let t=0;t<c.length;t++)Y(c[t],e,n,r);return void s(t.anchor,e,n)}if(a===Oe)return void E(t,e,n);const h=2!==r&&1&u&&l;if(h)if(0===r)l.beforeEnter(o),s(o,e,n),Se((()=>l.enter(o)),i);else{const{leave:t,delayLeave:r,afterLeave:i}=l,a=()=>s(o,e,n),c=()=>{t(o,(()=>{a(),i&&i()}))};r?r(o,a,c):c()}else s(o,e,n)},X=(t,e,n,r=!1,i=!1)=>{const{type:s,props:o,ref:a,children:l,dynamicChildren:c,shapeFlag:u,patchFlag:h,dirs:d}=t;if(null!=a&&Me(a,null,n,t,!0),256&u)return void e.ctx.deactivate(t);const f=1&u&&d,p=!ht(t);let m;if(p&&(m=o&&o.onVnodeBeforeUnmount)&&ln(m,e,t),6&u)Z(t.component,n,r);else{if(128&u)return void t.suspense.unmount(n,r);f&&Nt(t,null,e,"beforeUnmount"),64&u?t.type.remove(t,e,n,i,et,r):c&&(s!==Le||h>0&&64&h)?Q(c,e,n,!1,!0):(s===Le&&384&h||!i&&16&u)&&Q(l,e,n),r&&J(t)}(p&&(m=o&&o.onVnodeUnmounted)||f)&&Se((()=>{m&&ln(m,e,t),f&&Nt(t,null,e,"unmounted")}),n)},J=t=>{const{type:e,el:n,anchor:r,transition:i}=t;if(e===Le)return void K(n,r);if(e===Oe)return void T(t);const s=()=>{o(n),i&&!i.persisted&&i.afterLeave&&i.afterLeave()};if(1&t.shapeFlag&&i&&!i.persisted){const{leave:e,delayLeave:r}=i,o=()=>e(n,s);r?r(t.el,s,o):o()}else s()},K=(t,e)=>{let n;while(t!==e)n=p(t),o(t),t=n;o(e)},Z=(t,e,n)=>{const{bum:r,scope:s,update:o,subTree:a,um:l}=t;r&&(0,i.ir)(r),s.stop(),o&&(o.active=!1,X(a,t,e,n)),l&&Se(l,e),Se((()=>{t.isUnmounted=!0}),e),e&&e.pendingBranch&&!e.isUnmounted&&t.asyncDep&&!t.asyncResolved&&t.suspenseId===e.pendingId&&(e.deps--,0===e.deps&&e.resolve())},Q=(t,e,n,r=!1,i=!1,s=0)=>{for(let o=s;o<t.length;o++)X(t[o],e,n,r,i)},$=t=>6&t.shapeFlag?$(t.component.subTree):128&t.shapeFlag?t.suspense.next():p(t.anchor||t.el),tt=(t,e,n)=>{null==t?e._vnode&&X(e._vnode,null,null,!0):y(e._vnode||null,t,e,null,null,null,n),A(),S(),e._vnode=t},et={p:y,um:X,m:Y,r:J,mt:z,mc:P,pc:j,pbc:N,n:$,o:t};let nt,rt;return e&&([nt,rt]=e(et)),{render:tt,hydrate:nt,createApp:_e(tt,nt)}}function Ce({effect:t,update:e},n){t.allowRecurse=e.allowRecurse=n}function Re(t,e,n=!1){const r=t.children,s=e.children;if((0,i.kJ)(r)&&(0,i.kJ)(s))for(let i=0;i<r.length;i++){const t=r[i];let e=s[i];1&e.shapeFlag&&!e.dynamicChildren&&((e.patchFlag<=0||32===e.patchFlag)&&(e=s[i]=sn(s[i]),e.el=t.el),n||Re(t,e))}}function Ie(t){const e=t.slice(),n=[0];let r,i,s,o,a;const l=t.length;for(r=0;r<l;r++){const l=t[r];if(0!==l){if(i=n[n.length-1],t[i]<l){e[r]=i,n.push(r);continue}s=0,o=n.length-1;while(s<o)a=s+o>>1,t[n[a]]<l?s=a+1:o=a;l<t[n[s]]&&(s>0&&(e[r]=n[s-1]),n[s]=r)}}s=n.length,o=n[s-1];while(s-- >0)n[s]=o,o=e[o];return n}const Pe=t=>t.__isTeleport;const Le=Symbol(void 0),Ne=Symbol(void 0),ke=Symbol(void 0),Oe=Symbol(void 0),De=[];let ze=null;function Fe(t=!1){De.push(ze=t?null:[])}function Ue(){De.pop(),ze=De[De.length-1]||null}let Be=1;function Ge(t){Be+=t}function He(t){return t.dynamicChildren=Be>0?ze||i.Z6:null,Ue(),Be>0&&ze&&ze.push(t),t}function Ve(t,e,n,r,i,s){return He(Ke(t,e,n,r,i,s,!0))}function je(t,e,n,r,i){return He(Ze(t,e,n,r,i,!0))}function We(t){return!!t&&!0===t.__v_isVNode}function qe(t,e){return t.type===e.type&&t.key===e.key}const Ye="__vInternal",Xe=({key:t})=>null!=t?t:null,Je=({ref:t,ref_key:e,ref_for:n})=>null!=t?(0,i.HD)(t)||(0,r.dq)(t)||(0,i.mf)(t)?{i:L,r:t,k:e,f:!!n}:t:null;function Ke(t,e=null,n=null,r=0,s=null,o=(t===Le?0:1),a=!1,l=!1){const c={__v_isVNode:!0,__v_skip:!0,type:t,props:e,key:e&&Xe(e),ref:e&&Je(e),scopeId:N,slotScopeIds:null,children:n,component:null,suspense:null,ssContent:null,ssFallback:null,dirs:null,transition:null,el:null,anchor:null,target:null,targetAnchor:null,staticCount:0,shapeFlag:o,patchFlag:r,dynamicProps:s,dynamicChildren:null,appContext:null};return l?(on(c,n),128&o&&t.normalize(c)):n&&(c.shapeFlag|=(0,i.HD)(n)?8:16),Be>0&&!a&&ze&&(c.patchFlag>0||6&o)&&32!==c.patchFlag&&ze.push(c),c}const Ze=Qe;function Qe(t,e=null,n=null,s=0,o=null,a=!1){if(t&&t!==Dt||(t=ke),We(t)){const r=tn(t,e,!0);return n&&on(r,n),Be>0&&!a&&ze&&(6&r.shapeFlag?ze[ze.indexOf(t)]=r:ze.push(r)),r.patchFlag|=-2,r}if(Cn(t)&&(t=t.__vccOpts),e){e=$e(e);let{class:t,style:n}=e;t&&!(0,i.HD)(t)&&(e.class=(0,i.C_)(t)),(0,i.Kn)(n)&&((0,r.X3)(n)&&!(0,i.kJ)(n)&&(n=(0,i.l7)({},n)),e.style=(0,i.j5)(n))}const l=(0,i.HD)(t)?1:j(t)?128:Pe(t)?64:(0,i.Kn)(t)?4:(0,i.mf)(t)?2:0;return Ke(t,e,n,s,o,l,a,!0)}function $e(t){return t?(0,r.X3)(t)||Ye in t?(0,i.l7)({},t):t:null}function tn(t,e,n=!1){const{props:r,ref:s,patchFlag:o,children:a}=t,l=e?an(r||{},e):r,c={__v_isVNode:!0,__v_skip:!0,type:t.type,props:l,key:l&&Xe(l),ref:e&&e.ref?n&&s?(0,i.kJ)(s)?s.concat(Je(e)):[s,Je(e)]:Je(e):s,scopeId:t.scopeId,slotScopeIds:t.slotScopeIds,children:a,target:t.target,targetAnchor:t.targetAnchor,staticCount:t.staticCount,shapeFlag:t.shapeFlag,patchFlag:e&&t.type!==Le?-1===o?16:16|o:o,dynamicProps:t.dynamicProps,dynamicChildren:t.dynamicChildren,appContext:t.appContext,dirs:t.dirs,transition:t.transition,component:t.component,suspense:t.suspense,ssContent:t.ssContent&&tn(t.ssContent),ssFallback:t.ssFallback&&tn(t.ssFallback),el:t.el,anchor:t.anchor};return c}function en(t=" ",e=0){return Ze(Ne,null,t,e)}function nn(t="",e=!1){return e?(Fe(),je(ke,null,t)):Ze(ke,null,t)}function rn(t){return null==t||"boolean"===typeof t?Ze(ke):(0,i.kJ)(t)?Ze(Le,null,t.slice()):"object"===typeof t?sn(t):Ze(Ne,null,String(t))}function sn(t){return null===t.el||t.memo?t:tn(t)}function on(t,e){let n=0;const{shapeFlag:r}=t;if(null==e)e=null;else if((0,i.kJ)(e))n=16;else if("object"===typeof e){if(65&r){const n=e.default;return void(n&&(n._c&&(n._d=!1),on(t,n()),n._c&&(n._d=!0)))}{n=32;const r=e._;r||Ye in e?3===r&&L&&(1===L.slots._?e._=1:(e._=2,t.patchFlag|=1024)):e._ctx=L}}else(0,i.mf)(e)?(e={default:e,_ctx:L},n=32):(e=String(e),64&r?(n=16,e=[en(e)]):n=8);t.children=e,t.shapeFlag|=n}function an(...t){const e={};for(let n=0;n<t.length;n++){const r=t[n];for(const t in r)if("class"===t)e.class!==r.class&&(e.class=(0,i.C_)([e.class,r.class]));else if("style"===t)e.style=(0,i.j5)([e.style,r.style]);else if((0,i.F7)(t)){const n=e[t],s=r[t];!s||n===s||(0,i.kJ)(n)&&n.includes(s)||(e[t]=n?[].concat(n,s):s)}else""!==t&&(e[t]=r[t])}return e}function ln(t,e,n,r=null){o(t,e,7,[n,r])}const cn=be();let un=0;function hn(t,e,n){const s=t.type,o=(e?e.appContext:t.appContext)||cn,a={uid:un++,vnode:t,type:s,parent:e,appContext:o,root:null,next:null,subTree:null,effect:null,update:null,scope:new r.Bj(!0),render:null,proxy:null,exposed:null,exposeProxy:null,withProxy:null,provides:e?e.provides:Object.create(o.provides),accessCache:null,renderCache:[],components:null,directives:null,propsOptions:le(s,o),emitsOptions:I(s,o),emit:null,emitted:null,propsDefaults:i.kT,inheritAttrs:s.inheritAttrs,ctx:i.kT,data:i.kT,props:i.kT,attrs:i.kT,slots:i.kT,refs:i.kT,setupState:i.kT,setupContext:null,suspense:n,suspenseId:n?n.pendingId:0,asyncDep:null,asyncResolved:!1,isMounted:!1,isUnmounted:!1,isDeactivated:!1,bc:null,c:null,bm:null,m:null,bu:null,u:null,um:null,bum:null,da:null,a:null,rtg:null,rtc:null,ec:null,sp:null};return a.ctx={_:a},a.root=e?e.root:a,a.emit=R.bind(null,a),t.ce&&t.ce(a),a}let dn=null;const fn=()=>dn||L,pn=t=>{dn=t,t.scope.on()},mn=()=>{dn&&dn.scope.off(),dn=null};function gn(t){return 4&t.vnode.shapeFlag}let vn,yn,xn=!1;function bn(t,e=!1){xn=e;const{props:n,children:r}=t.vnode,i=gn(t);ie(t,n,i,e),ye(t,r);const s=i?wn(t,e):void 0;return xn=!1,s}function wn(t,e){const n=t.type;t.accessCache=Object.create(null),t.proxy=(0,r.Xl)(new Proxy(t.ctx,Vt));const{setup:o}=n;if(o){const n=t.setupContext=o.length>1?Sn(t):null;pn(t),(0,r.Jd)();const l=s(o,t,0,[t.props,n]);if((0,r.lk)(),mn(),(0,i.tI)(l)){if(l.then(mn,mn),e)return l.then((n=>{_n(t,n,e)})).catch((e=>{a(e,t,0)}));t.asyncDep=l}else _n(t,l,e)}else Mn(t,e)}function _n(t,e,n){(0,i.mf)(e)?t.type.__ssrInlineRender?t.ssrRender=e:t.render=e:(0,i.Kn)(e)&&(t.setupState=(0,r.WL)(e)),Mn(t,n)}function Mn(t,e,n){const s=t.type;if(!t.render){if(!e&&vn&&!s.render){const e=s.template;if(e){0;const{isCustomElement:n,compilerOptions:r}=t.appContext.config,{delimiters:o,compilerOptions:a}=s,l=(0,i.l7)((0,i.l7)({isCustomElement:n,delimiters:o},r),a);s.render=vn(e,l)}}t.render=s.render||i.dG,yn&&yn(t)}pn(t),(0,r.Jd)(),Wt(t),(0,r.lk)(),mn()}function An(t){return new Proxy(t.attrs,{get(e,n){return(0,r.j)(t,"get","$attrs"),e[n]}})}function Sn(t){const e=e=>{t.exposed=e||{}};let n;return{get attrs(){return n||(n=An(t))},slots:t.slots,emit:t.emit,expose:e}}function En(t){if(t.exposed)return t.exposeProxy||(t.exposeProxy=new Proxy((0,r.WL)((0,r.Xl)(t.exposed)),{get(e,n){return n in e?e[n]:n in Ht?Ht[n](t):void 0}}))}function Tn(t,e=!0){return(0,i.mf)(t)?t.displayName||t.name:t.name||e&&t.__name}function Cn(t){return(0,i.mf)(t)&&"__vccOpts"in t}const Rn=(t,e)=>(0,r.Fl)(t,e,xn);function In(t,e,n){const r=arguments.length;return 2===r?(0,i.Kn)(e)&&!(0,i.kJ)(e)?We(e)?Ze(t,null,[e]):Ze(t,e):Ze(t,null,e):(r>3?n=Array.prototype.slice.call(arguments,2):3===r&&We(n)&&(n=[n]),Ze(t,e,n))}Symbol("");const Pn="3.2.38"},9242:function(t,e,n){"use strict";n.d(e,{nr:function(){return nt},ri:function(){return ot}});var r=n(7139),i=n(3396);n(4870);const s="http://www.w3.org/2000/svg",o="undefined"!==typeof document?document:null,a=o&&o.createElement("template"),l={insert:(t,e,n)=>{e.insertBefore(t,n||null)},remove:t=>{const e=t.parentNode;e&&e.removeChild(t)},createElement:(t,e,n,r)=>{const i=e?o.createElementNS(s,t):o.createElement(t,n?{is:n}:void 0);return"select"===t&&r&&null!=r.multiple&&i.setAttribute("multiple",r.multiple),i},createText:t=>o.createTextNode(t),createComment:t=>o.createComment(t),setText:(t,e)=>{t.nodeValue=e},setElementText:(t,e)=>{t.textContent=e},parentNode:t=>t.parentNode,nextSibling:t=>t.nextSibling,querySelector:t=>o.querySelector(t),setScopeId(t,e){t.setAttribute(e,"")},cloneNode(t){const e=t.cloneNode(!0);return"_value"in t&&(e._value=t._value),e},insertStaticContent(t,e,n,r,i,s){const o=n?n.previousSibling:e.lastChild;if(i&&(i===s||i.nextSibling)){while(1)if(e.insertBefore(i.cloneNode(!0),n),i===s||!(i=i.nextSibling))break}else{a.innerHTML=r?`<svg>${t}</svg>`:t;const i=a.content;if(r){const t=i.firstChild;while(t.firstChild)i.appendChild(t.firstChild);i.removeChild(t)}e.insertBefore(i,n)}return[o?o.nextSibling:e.firstChild,n?n.previousSibling:e.lastChild]}};function c(t,e,n){const r=t._vtc;r&&(e=(e?[e,...r]:[...r]).join(" ")),null==e?t.removeAttribute("class"):n?t.setAttribute("class",e):t.className=e}function u(t,e,n){const i=t.style,s=(0,r.HD)(n);if(n&&!s){for(const t in n)d(i,t,n[t]);if(e&&!(0,r.HD)(e))for(const t in e)null==n[t]&&d(i,t,"")}else{const r=i.display;s?e!==n&&(i.cssText=n):e&&t.removeAttribute("style"),"_vod"in t&&(i.display=r)}}const h=/\s*!important$/;function d(t,e,n){if((0,r.kJ)(n))n.forEach((n=>d(t,e,n)));else if(null==n&&(n=""),e.startsWith("--"))t.setProperty(e,n);else{const i=m(t,e);h.test(n)?t.setProperty((0,r.rs)(i),n.replace(h,""),"important"):t[i]=n}}const f=["Webkit","Moz","ms"],p={};function m(t,e){const n=p[e];if(n)return n;let i=(0,r._A)(e);if("filter"!==i&&i in t)return p[e]=i;i=(0,r.kC)(i);for(let r=0;r<f.length;r++){const n=f[r]+i;if(n in t)return p[e]=n}return e}const g="http://www.w3.org/1999/xlink";function v(t,e,n,i,s){if(i&&e.startsWith("xlink:"))null==n?t.removeAttributeNS(g,e.slice(6,e.length)):t.setAttributeNS(g,e,n);else{const i=(0,r.Pq)(e);null==n||i&&!(0,r.yA)(n)?t.removeAttribute(e):t.setAttribute(e,i?"":n)}}function y(t,e,n,i,s,o,a){if("innerHTML"===e||"textContent"===e)return i&&a(i,s,o),void(t[e]=null==n?"":n);if("value"===e&&"PROGRESS"!==t.tagName&&!t.tagName.includes("-")){t._value=n;const r=null==n?"":n;return t.value===r&&"OPTION"!==t.tagName||(t.value=r),void(null==n&&t.removeAttribute(e))}let l=!1;if(""===n||null==n){const i=typeof t[e];"boolean"===i?n=(0,r.yA)(n):null==n&&"string"===i?(n="",l=!0):"number"===i&&(n=0,l=!0)}try{t[e]=n}catch(c){0}l&&t.removeAttribute(e)}const[x,b]=(()=>{let t=Date.now,e=!1;if("undefined"!==typeof window){Date.now()>document.createEvent("Event").timeStamp&&(t=performance.now.bind(performance));const n=navigator.userAgent.match(/firefox\/(\d+)/i);e=!!(n&&Number(n[1])<=53)}return[t,e]})();let w=0;const _=Promise.resolve(),M=()=>{w=0},A=()=>w||(_.then(M),w=x());function S(t,e,n,r){t.addEventListener(e,n,r)}function E(t,e,n,r){t.removeEventListener(e,n,r)}function T(t,e,n,r,i=null){const s=t._vei||(t._vei={}),o=s[e];if(r&&o)o.value=r;else{const[n,a]=R(e);if(r){const o=s[e]=I(r,i);S(t,n,o,a)}else o&&(E(t,n,o,a),s[e]=void 0)}}const C=/(?:Once|Passive|Capture)$/;function R(t){let e;if(C.test(t)){let n;e={};while(n=t.match(C))t=t.slice(0,t.length-n[0].length),e[n[0].toLowerCase()]=!0}const n=":"===t[2]?t.slice(3):(0,r.rs)(t.slice(2));return[n,e]}function I(t,e){const n=t=>{const r=t.timeStamp||x();(b||r>=n.attached-1)&&(0,i.$d)(P(t,n.value),e,5,[t])};return n.value=t,n.attached=A(),n}function P(t,e){if((0,r.kJ)(e)){const n=t.stopImmediatePropagation;return t.stopImmediatePropagation=()=>{n.call(t),t._stopped=!0},e.map((t=>e=>!e._stopped&&t&&t(e)))}return e}const L=/^on[a-z]/,N=(t,e,n,i,s=!1,o,a,l,h)=>{"class"===e?c(t,i,s):"style"===e?u(t,n,i):(0,r.F7)(e)?(0,r.tR)(e)||T(t,e,n,i,a):("."===e[0]?(e=e.slice(1),1):"^"===e[0]?(e=e.slice(1),0):k(t,e,i,s))?y(t,e,i,o,a,l,h):("true-value"===e?t._trueValue=i:"false-value"===e&&(t._falseValue=i),v(t,e,i,s))};function k(t,e,n,i){return i?"innerHTML"===e||"textContent"===e||!!(e in t&&L.test(e)&&(0,r.mf)(n)):"spellcheck"!==e&&"draggable"!==e&&"translate"!==e&&("form"!==e&&(("list"!==e||"INPUT"!==t.tagName)&&(("type"!==e||"TEXTAREA"!==t.tagName)&&((!L.test(e)||!(0,r.HD)(n))&&e in t))))}"undefined"!==typeof HTMLElement&&HTMLElement;const O="transition",D="animation",z=(t,{slots:e})=>(0,i.h)(i.P$,G(t),e);z.displayName="Transition";const F={name:String,type:String,css:{type:Boolean,default:!0},duration:[String,Number,Object],enterFromClass:String,enterActiveClass:String,enterToClass:String,appearFromClass:String,appearActiveClass:String,appearToClass:String,leaveFromClass:String,leaveActiveClass:String,leaveToClass:String},U=(z.props=(0,r.l7)({},i.P$.props,F),(t,e=[])=>{(0,r.kJ)(t)?t.forEach((t=>t(...e))):t&&t(...e)}),B=t=>!!t&&((0,r.kJ)(t)?t.some((t=>t.length>1)):t.length>1);function G(t){const e={};for(const r in t)r in F||(e[r]=t[r]);if(!1===t.css)return e;const{name:n="v",type:i,duration:s,enterFromClass:o=`${n}-enter-from`,enterActiveClass:a=`${n}-enter-active`,enterToClass:l=`${n}-enter-to`,appearFromClass:c=o,appearActiveClass:u=a,appearToClass:h=l,leaveFromClass:d=`${n}-leave-from`,leaveActiveClass:f=`${n}-leave-active`,leaveToClass:p=`${n}-leave-to`}=t,m=H(s),g=m&&m[0],v=m&&m[1],{onBeforeEnter:y,onEnter:x,onEnterCancelled:b,onLeave:w,onLeaveCancelled:_,onBeforeAppear:M=y,onAppear:A=x,onAppearCancelled:S=b}=e,E=(t,e,n)=>{W(t,e?h:l),W(t,e?u:a),n&&n()},T=(t,e)=>{t._isLeaving=!1,W(t,d),W(t,p),W(t,f),e&&e()},C=t=>(e,n)=>{const r=t?A:x,s=()=>E(e,t,n);U(r,[e,s]),q((()=>{W(e,t?c:o),j(e,t?h:l),B(r)||X(e,i,g,s)}))};return(0,r.l7)(e,{onBeforeEnter(t){U(y,[t]),j(t,o),j(t,a)},onBeforeAppear(t){U(M,[t]),j(t,c),j(t,u)},onEnter:C(!1),onAppear:C(!0),onLeave(t,e){t._isLeaving=!0;const n=()=>T(t,e);j(t,d),Q(),j(t,f),q((()=>{t._isLeaving&&(W(t,d),j(t,p),B(w)||X(t,i,v,n))})),U(w,[t,n])},onEnterCancelled(t){E(t,!1),U(b,[t])},onAppearCancelled(t){E(t,!0),U(S,[t])},onLeaveCancelled(t){T(t),U(_,[t])}})}function H(t){if(null==t)return null;if((0,r.Kn)(t))return[V(t.enter),V(t.leave)];{const e=V(t);return[e,e]}}function V(t){const e=(0,r.He)(t);return e}function j(t,e){e.split(/\s+/).forEach((e=>e&&t.classList.add(e))),(t._vtc||(t._vtc=new Set)).add(e)}function W(t,e){e.split(/\s+/).forEach((e=>e&&t.classList.remove(e)));const{_vtc:n}=t;n&&(n.delete(e),n.size||(t._vtc=void 0))}function q(t){requestAnimationFrame((()=>{requestAnimationFrame(t)}))}let Y=0;function X(t,e,n,r){const i=t._endId=++Y,s=()=>{i===t._endId&&r()};if(n)return setTimeout(s,n);const{type:o,timeout:a,propCount:l}=J(t,e);if(!o)return r();const c=o+"end";let u=0;const h=()=>{t.removeEventListener(c,d),s()},d=e=>{e.target===t&&++u>=l&&h()};setTimeout((()=>{u<l&&h()}),a+1),t.addEventListener(c,d)}function J(t,e){const n=window.getComputedStyle(t),r=t=>(n[t]||"").split(", "),i=r(O+"Delay"),s=r(O+"Duration"),o=K(i,s),a=r(D+"Delay"),l=r(D+"Duration"),c=K(a,l);let u=null,h=0,d=0;e===O?o>0&&(u=O,h=o,d=s.length):e===D?c>0&&(u=D,h=c,d=l.length):(h=Math.max(o,c),u=h>0?o>c?O:D:null,d=u?u===O?s.length:l.length:0);const f=u===O&&/\b(transform|all)(,|$)/.test(n[O+"Property"]);return{type:u,timeout:h,propCount:d,hasTransform:f}}function K(t,e){while(t.length<e.length)t=t.concat(t);return Math.max(...e.map(((e,n)=>Z(e)+Z(t[n]))))}function Z(t){return 1e3*Number(t.slice(0,-1).replace(",","."))}function Q(){return document.body.offsetHeight}new WeakMap,new WeakMap;const $=t=>{const e=t.props["onUpdate:modelValue"]||!1;return(0,r.kJ)(e)?t=>(0,r.ir)(e,t):e};function tt(t){t.target.composing=!0}function et(t){const e=t.target;e.composing&&(e.composing=!1,e.dispatchEvent(new Event("input")))}const nt={created(t,{modifiers:{lazy:e,trim:n,number:i}},s){t._assign=$(s);const o=i||s.props&&"number"===s.props.type;S(t,e?"change":"input",(e=>{if(e.target.composing)return;let i=t.value;n&&(i=i.trim()),o&&(i=(0,r.He)(i)),t._assign(i)})),n&&S(t,"change",(()=>{t.value=t.value.trim()})),e||(S(t,"compositionstart",tt),S(t,"compositionend",et),S(t,"change",et))},mounted(t,{value:e}){t.value=null==e?"":e},beforeUpdate(t,{value:e,modifiers:{lazy:n,trim:i,number:s}},o){if(t._assign=$(o),t.composing)return;if(document.activeElement===t&&"range"!==t.type){if(n)return;if(i&&t.value.trim()===e)return;if((s||"number"===t.type)&&(0,r.He)(t.value)===e)return}const a=null==e?"":e;t.value!==a&&(t.value=a)}};const rt=(0,r.l7)({patchProp:N},l);let it;function st(){return it||(it=(0,i.Us)(rt))}const ot=(...t)=>{const e=st().createApp(...t);const{mount:n}=e;return e.mount=t=>{const i=at(t);if(!i)return;const s=e._component;(0,r.mf)(s)||s.render||s.template||(s.template=i.innerHTML),i.innerHTML="";const o=n(i,!1,i instanceof SVGElement);return i instanceof Element&&(i.removeAttribute("v-cloak"),i.setAttribute("data-v-app","")),o},e};function at(t){if((0,r.HD)(t)){const e=document.querySelector(t);return e}return t}},7139:function(t,e,n){"use strict";function r(t,e){const n=Object.create(null),r=t.split(",");for(let i=0;i<r.length;i++)n[r[i]]=!0;return e?t=>!!n[t.toLowerCase()]:t=>!!n[t]}n.d(e,{C_:function(){return f},DM:function(){return L},E9:function(){return rt},F7:function(){return A},Gg:function(){return j},HD:function(){return O},He:function(){return et},Kn:function(){return z},NO:function(){return _},Nj:function(){return tt},Od:function(){return T},PO:function(){return H},Pq:function(){return a},RI:function(){return R},S0:function(){return V},W7:function(){return G},WV:function(){return m},Z6:function(){return b},_A:function(){return Y},_N:function(){return P},aU:function(){return Q},dG:function(){return w},e1:function(){return s},fY:function(){return r},hR:function(){return Z},hq:function(){return g},ir:function(){return $},j5:function(){return c},kC:function(){return K},kJ:function(){return I},kT:function(){return x},l7:function(){return E},mf:function(){return k},rs:function(){return J},tI:function(){return F},tR:function(){return S},yA:function(){return l},yk:function(){return D},zw:function(){return v}});const i="Infinity,undefined,NaN,isFinite,isNaN,parseFloat,parseInt,decodeURI,decodeURIComponent,encodeURI,encodeURIComponent,Math,Number,Date,Array,Object,Boolean,String,RegExp,Map,Set,JSON,Intl,BigInt",s=r(i);const o="itemscope,allowfullscreen,formnovalidate,ismap,nomodule,novalidate,readonly",a=r(o);function l(t){return!!t||""===t}function c(t){if(I(t)){const e={};for(let n=0;n<t.length;n++){const r=t[n],i=O(r)?d(r):c(r);if(i)for(const t in i)e[t]=i[t]}return e}return O(t)||z(t)?t:void 0}const u=/;(?![^(]*\))/g,h=/:(.+)/;function d(t){const e={};return t.split(u).forEach((t=>{if(t){const n=t.split(h);n.length>1&&(e[n[0].trim()]=n[1].trim())}})),e}function f(t){let e="";if(O(t))e=t;else if(I(t))for(let n=0;n<t.length;n++){const r=f(t[n]);r&&(e+=r+" ")}else if(z(t))for(const n in t)t[n]&&(e+=n+" ");return e.trim()}function p(t,e){if(t.length!==e.length)return!1;let n=!0;for(let r=0;n&&r<t.length;r++)n=m(t[r],e[r]);return n}function m(t,e){if(t===e)return!0;let n=N(t),r=N(e);if(n||r)return!(!n||!r)&&t.getTime()===e.getTime();if(n=D(t),r=D(e),n||r)return t===e;if(n=I(t),r=I(e),n||r)return!(!n||!r)&&p(t,e);if(n=z(t),r=z(e),n||r){if(!n||!r)return!1;const i=Object.keys(t).length,s=Object.keys(e).length;if(i!==s)return!1;for(const n in t){const r=t.hasOwnProperty(n),i=e.hasOwnProperty(n);if(r&&!i||!r&&i||!m(t[n],e[n]))return!1}}return String(t)===String(e)}function g(t,e){return t.findIndex((t=>m(t,e)))}const v=t=>O(t)?t:null==t?"":I(t)||z(t)&&(t.toString===U||!k(t.toString))?JSON.stringify(t,y,2):String(t),y=(t,e)=>e&&e.__v_isRef?y(t,e.value):P(e)?{[`Map(${e.size})`]:[...e.entries()].reduce(((t,[e,n])=>(t[`${e} =>`]=n,t)),{})}:L(e)?{[`Set(${e.size})`]:[...e.values()]}:!z(e)||I(e)||H(e)?e:String(e),x={},b=[],w=()=>{},_=()=>!1,M=/^on[^a-z]/,A=t=>M.test(t),S=t=>t.startsWith("onUpdate:"),E=Object.assign,T=(t,e)=>{const n=t.indexOf(e);n>-1&&t.splice(n,1)},C=Object.prototype.hasOwnProperty,R=(t,e)=>C.call(t,e),I=Array.isArray,P=t=>"[object Map]"===B(t),L=t=>"[object Set]"===B(t),N=t=>"[object Date]"===B(t),k=t=>"function"===typeof t,O=t=>"string"===typeof t,D=t=>"symbol"===typeof t,z=t=>null!==t&&"object"===typeof t,F=t=>z(t)&&k(t.then)&&k(t.catch),U=Object.prototype.toString,B=t=>U.call(t),G=t=>B(t).slice(8,-1),H=t=>"[object Object]"===B(t),V=t=>O(t)&&"NaN"!==t&&"-"!==t[0]&&""+parseInt(t,10)===t,j=r(",key,ref,ref_for,ref_key,onVnodeBeforeMount,onVnodeMounted,onVnodeBeforeUpdate,onVnodeUpdated,onVnodeBeforeUnmount,onVnodeUnmounted"),W=t=>{const e=Object.create(null);return n=>{const r=e[n];return r||(e[n]=t(n))}},q=/-(\w)/g,Y=W((t=>t.replace(q,((t,e)=>e?e.toUpperCase():"")))),X=/\B([A-Z])/g,J=W((t=>t.replace(X,"-$1").toLowerCase())),K=W((t=>t.charAt(0).toUpperCase()+t.slice(1))),Z=W((t=>t?`on${K(t)}`:"")),Q=(t,e)=>!Object.is(t,e),$=(t,e)=>{for(let n=0;n<t.length;n++)t[n](e)},tt=(t,e,n)=>{Object.defineProperty(t,e,{configurable:!0,enumerable:!1,value:n})},et=t=>{const e=parseFloat(t);return isNaN(e)?t:e};let nt;const rt=()=>nt||(nt="undefined"!==typeof globalThis?globalThis:"undefined"!==typeof self?self:"undefined"!==typeof window?window:"undefined"!==typeof n.g?n.g:{})},1742:function(t,e,n){"use strict";n(1703);for(var r="qpzry9x8gf2tvdw0s3jn54khce6mua7l",i={},s=0;s<r.length;s++){var o=r.charAt(s);if(void 0!==i[o])throw new TypeError(o+" is ambiguous");i[o]=s}function a(t){var e=t>>25;return(33554431&t)<<5^996825010&-(e>>0&1)^642813549&-(e>>1&1)^513874426&-(e>>2&1)^1027748829&-(e>>3&1)^705979059&-(e>>4&1)}function l(t){for(var e=1,n=0;n<t.length;++n){var r=t.charCodeAt(n);if(r<33||r>126)return"Invalid prefix ("+t+")";e=a(e)^r>>5}for(e=a(e),n=0;n<t.length;++n){var i=t.charCodeAt(n);e=a(e)^31&i}return e}function c(t,e,n){if(n=n||90,t.length+7+e.length>n)throw new TypeError("Exceeds length limit");t=t.toLowerCase();var i=l(t);if("string"===typeof i)throw new Error(i);for(var s=t+"1",o=0;o<e.length;++o){var c=e[o];if(c>>5!==0)throw new Error("Non 5-bit word");i=a(i)^c,s+=r.charAt(c)}for(o=0;o<6;++o)i=a(i);for(i^=1,o=0;o<6;++o){var u=i>>5*(5-o)&31;s+=r.charAt(u)}return s}function u(t,e){if(e=e||90,t.length<8)return t+" too short";if(t.length>e)return"Exceeds length limit";var n=t.toLowerCase(),r=t.toUpperCase();if(t!==n&&t!==r)return"Mixed-case string "+t;t=n;var s=t.lastIndexOf("1");if(-1===s)return"No separator character for "+t;if(0===s)return"Missing prefix for "+t;var o=t.slice(0,s),c=t.slice(s+1);if(c.length<6)return"Data too short";var u=l(o);if("string"===typeof u)return u;for(var h=[],d=0;d<c.length;++d){var f=c.charAt(d),p=i[f];if(void 0===p)return"Unknown character "+f;u=a(u)^p,d+6>=c.length||h.push(p)}return 1!==u?"Invalid checksum for "+t:{prefix:o,words:h}}function h(){var t=u.apply(null,arguments);if("object"===typeof t)return t}function d(t){var e=u.apply(null,arguments);if("object"===typeof e)return e;throw new Error(e)}function f(t,e,n,r){for(var i=0,s=0,o=(1<<n)-1,a=[],l=0;l<t.length;++l){i=i<<e|t[l],s+=e;while(s>=n)s-=n,a.push(i>>s&o)}if(r)s>0&&a.push(i<<n-s&o);else{if(s>=e)return"Excess padding";if(i<<n-s&o)return"Non-zero padding"}return a}function p(t){var e=f(t,8,5,!0);if(Array.isArray(e))return e}function m(t){var e=f(t,8,5,!0);if(Array.isArray(e))return e;throw new Error(e)}function g(t){var e=f(t,5,8,!1);if(Array.isArray(e))return e}function v(t){var e=f(t,5,8,!1);if(Array.isArray(e))return e;throw new Error(e)}t.exports={decodeUnsafe:h,decode:d,encode:c,toWordsUnsafe:p,toWords:m,fromWordsUnsafe:g,fromWords:v}},2396:function(t,e,n){t=n.nmd(t),n(1703),function(t,e){"use strict";function r(t,e){if(!t)throw new Error(e||"Assertion failed")}function i(t,e){t.super_=e;var n=function(){};n.prototype=e.prototype,t.prototype=new n,t.prototype.constructor=t}function s(t,e,n){if(s.isBN(t))return t;this.negative=0,this.words=null,this.length=0,this.red=null,null!==t&&("le"!==e&&"be"!==e||(n=e,e=10),this._init(t||0,e||10,n||"be"))}var o;"object"===typeof t?t.exports=s:e.BN=s,s.BN=s,s.wordSize=26;try{o="undefined"!==typeof window&&"undefined"!==typeof window.Buffer?window.Buffer:n(6601).Buffer}catch(I){}function a(t,e){var n=t.charCodeAt(e);return n>=48&&n<=57?n-48:n>=65&&n<=70?n-55:n>=97&&n<=102?n-87:void r(!1,"Invalid character in "+t)}function l(t,e,n){var r=a(t,n);return n-1>=e&&(r|=a(t,n-1)<<4),r}function c(t,e,n,i){for(var s=0,o=0,a=Math.min(t.length,n),l=e;l<a;l++){var c=t.charCodeAt(l)-48;s*=i,o=c>=49?c-49+10:c>=17?c-17+10:c,r(c>=0&&o<i,"Invalid character"),s+=o}return s}function u(t,e){t.words=e.words,t.length=e.length,t.negative=e.negative,t.red=e.red}if(s.isBN=function(t){return t instanceof s||null!==t&&"object"===typeof t&&t.constructor.wordSize===s.wordSize&&Array.isArray(t.words)},s.max=function(t,e){return t.cmp(e)>0?t:e},s.min=function(t,e){return t.cmp(e)<0?t:e},s.prototype._init=function(t,e,n){if("number"===typeof t)return this._initNumber(t,e,n);if("object"===typeof t)return this._initArray(t,e,n);"hex"===e&&(e=16),r(e===(0|e)&&e>=2&&e<=36),t=t.toString().replace(/\s+/g,"");var i=0;"-"===t[0]&&(i++,this.negative=1),i<t.length&&(16===e?this._parseHex(t,i,n):(this._parseBase(t,e,i),"le"===n&&this._initArray(this.toArray(),e,n)))},s.prototype._initNumber=function(t,e,n){t<0&&(this.negative=1,t=-t),t<67108864?(this.words=[67108863&t],this.length=1):t<4503599627370496?(this.words=[67108863&t,t/67108864&67108863],this.length=2):(r(t<9007199254740992),this.words=[67108863&t,t/67108864&67108863,1],this.length=3),"le"===n&&this._initArray(this.toArray(),e,n)},s.prototype._initArray=function(t,e,n){if(r("number"===typeof t.length),t.length<=0)return this.words=[0],this.length=1,this;this.length=Math.ceil(t.length/3),this.words=new Array(this.length);for(var i=0;i<this.length;i++)this.words[i]=0;var s,o,a=0;if("be"===n)for(i=t.length-1,s=0;i>=0;i-=3)o=t[i]|t[i-1]<<8|t[i-2]<<16,this.words[s]|=o<<a&67108863,this.words[s+1]=o>>>26-a&67108863,a+=24,a>=26&&(a-=26,s++);else if("le"===n)for(i=0,s=0;i<t.length;i+=3)o=t[i]|t[i+1]<<8|t[i+2]<<16,this.words[s]|=o<<a&67108863,this.words[s+1]=o>>>26-a&67108863,a+=24,a>=26&&(a-=26,s++);return this._strip()},s.prototype._parseHex=function(t,e,n){this.length=Math.ceil((t.length-e)/6),this.words=new Array(this.length);for(var r=0;r<this.length;r++)this.words[r]=0;var i,s=0,o=0;if("be"===n)for(r=t.length-1;r>=e;r-=2)i=l(t,e,r)<<s,this.words[o]|=67108863&i,s>=18?(s-=18,o+=1,this.words[o]|=i>>>26):s+=8;else{var a=t.length-e;for(r=a%2===0?e+1:e;r<t.length;r+=2)i=l(t,e,r)<<s,this.words[o]|=67108863&i,s>=18?(s-=18,o+=1,this.words[o]|=i>>>26):s+=8}this._strip()},s.prototype._parseBase=function(t,e,n){this.words=[0],this.length=1;for(var r=0,i=1;i<=67108863;i*=e)r++;r--,i=i/e|0;for(var s=t.length-n,o=s%r,a=Math.min(s,s-o)+n,l=0,u=n;u<a;u+=r)l=c(t,u,u+r,e),this.imuln(i),this.words[0]+l<67108864?this.words[0]+=l:this._iaddn(l);if(0!==o){var h=1;for(l=c(t,u,t.length,e),u=0;u<o;u++)h*=e;this.imuln(h),this.words[0]+l<67108864?this.words[0]+=l:this._iaddn(l)}this._strip()},s.prototype.copy=function(t){t.words=new Array(this.length);for(var e=0;e<this.length;e++)t.words[e]=this.words[e];t.length=this.length,t.negative=this.negative,t.red=this.red},s.prototype._move=function(t){u(t,this)},s.prototype.clone=function(){var t=new s(null);return this.copy(t),t},s.prototype._expand=function(t){while(this.length<t)this.words[this.length++]=0;return this},s.prototype._strip=function(){while(this.length>1&&0===this.words[this.length-1])this.length--;return this._normSign()},s.prototype._normSign=function(){return 1===this.length&&0===this.words[0]&&(this.negative=0),this},"undefined"!==typeof Symbol&&"function"===typeof Symbol.for)try{s.prototype[Symbol.for("nodejs.util.inspect.custom")]=h}catch(I){s.prototype.inspect=h}else s.prototype.inspect=h;function h(){return(this.red?"<BN-R: ":"<BN: ")+this.toString(16)+">"}var d=["","0","00","000","0000","00000","000000","0000000","00000000","000000000","0000000000","00000000000","000000000000","0000000000000","00000000000000","000000000000000","0000000000000000","00000000000000000","000000000000000000","0000000000000000000","00000000000000000000","000000000000000000000","0000000000000000000000","00000000000000000000000","000000000000000000000000","0000000000000000000000000"],f=[0,0,25,16,12,11,10,9,8,8,7,7,7,7,6,6,6,6,6,6,6,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5],p=[0,0,33554432,43046721,16777216,48828125,60466176,40353607,16777216,43046721,1e7,19487171,35831808,62748517,7529536,11390625,16777216,24137569,34012224,47045881,64e6,4084101,5153632,6436343,7962624,9765625,11881376,14348907,17210368,20511149,243e5,28629151,33554432,39135393,45435424,52521875,60466176];s.prototype.toString=function(t,e){var n;if(t=t||10,e=0|e||1,16===t||"hex"===t){n="";for(var i=0,s=0,o=0;o<this.length;o++){var a=this.words[o],l=(16777215&(a<<i|s)).toString(16);s=a>>>24-i&16777215,i+=2,i>=26&&(i-=26,o--),n=0!==s||o!==this.length-1?d[6-l.length]+l+n:l+n}0!==s&&(n=s.toString(16)+n);while(n.length%e!==0)n="0"+n;return 0!==this.negative&&(n="-"+n),n}if(t===(0|t)&&t>=2&&t<=36){var c=f[t],u=p[t];n="";var h=this.clone();h.negative=0;while(!h.isZero()){var m=h.modrn(u).toString(t);h=h.idivn(u),n=h.isZero()?m+n:d[c-m.length]+m+n}this.isZero()&&(n="0"+n);while(n.length%e!==0)n="0"+n;return 0!==this.negative&&(n="-"+n),n}r(!1,"Base should be between 2 and 36")},s.prototype.toNumber=function(){var t=this.words[0];return 2===this.length?t+=67108864*this.words[1]:3===this.length&&1===this.words[2]?t+=4503599627370496+67108864*this.words[1]:this.length>2&&r(!1,"Number can only safely store up to 53 bits"),0!==this.negative?-t:t},s.prototype.toJSON=function(){return this.toString(16,2)},o&&(s.prototype.toBuffer=function(t,e){return this.toArrayLike(o,t,e)}),s.prototype.toArray=function(t,e){return this.toArrayLike(Array,t,e)};var m=function(t,e){return t.allocUnsafe?t.allocUnsafe(e):new t(e)};function g(t){for(var e=new Array(t.bitLength()),n=0;n<e.length;n++){var r=n/26|0,i=n%26;e[n]=t.words[r]>>>i&1}return e}function v(t,e,n){n.negative=e.negative^t.negative;var r=t.length+e.length|0;n.length=r,r=r-1|0;var i=0|t.words[0],s=0|e.words[0],o=i*s,a=67108863&o,l=o/67108864|0;n.words[0]=a;for(var c=1;c<r;c++){for(var u=l>>>26,h=67108863&l,d=Math.min(c,e.length-1),f=Math.max(0,c-t.length+1);f<=d;f++){var p=c-f|0;i=0|t.words[p],s=0|e.words[f],o=i*s+h,u+=o/67108864|0,h=67108863&o}n.words[c]=0|h,l=0|u}return 0!==l?n.words[c]=0|l:n.length--,n._strip()}s.prototype.toArrayLike=function(t,e,n){this._strip();var i=this.byteLength(),s=n||Math.max(1,i);r(i<=s,"byte array longer than desired length"),r(s>0,"Requested array length <= 0");var o=m(t,s),a="le"===e?"LE":"BE";return this["_toArrayLike"+a](o,i),o},s.prototype._toArrayLikeLE=function(t,e){for(var n=0,r=0,i=0,s=0;i<this.length;i++){var o=this.words[i]<<s|r;t[n++]=255&o,n<t.length&&(t[n++]=o>>8&255),n<t.length&&(t[n++]=o>>16&255),6===s?(n<t.length&&(t[n++]=o>>24&255),r=0,s=0):(r=o>>>24,s+=2)}if(n<t.length){t[n++]=r;while(n<t.length)t[n++]=0}},s.prototype._toArrayLikeBE=function(t,e){for(var n=t.length-1,r=0,i=0,s=0;i<this.length;i++){var o=this.words[i]<<s|r;t[n--]=255&o,n>=0&&(t[n--]=o>>8&255),n>=0&&(t[n--]=o>>16&255),6===s?(n>=0&&(t[n--]=o>>24&255),r=0,s=0):(r=o>>>24,s+=2)}if(n>=0){t[n--]=r;while(n>=0)t[n--]=0}},Math.clz32?s.prototype._countBits=function(t){return 32-Math.clz32(t)}:s.prototype._countBits=function(t){var e=t,n=0;return e>=4096&&(n+=13,e>>>=13),e>=64&&(n+=7,e>>>=7),e>=8&&(n+=4,e>>>=4),e>=2&&(n+=2,e>>>=2),n+e},s.prototype._zeroBits=function(t){if(0===t)return 26;var e=t,n=0;return 0===(8191&e)&&(n+=13,e>>>=13),0===(127&e)&&(n+=7,e>>>=7),0===(15&e)&&(n+=4,e>>>=4),0===(3&e)&&(n+=2,e>>>=2),0===(1&e)&&n++,n},s.prototype.bitLength=function(){var t=this.words[this.length-1],e=this._countBits(t);return 26*(this.length-1)+e},s.prototype.zeroBits=function(){if(this.isZero())return 0;for(var t=0,e=0;e<this.length;e++){var n=this._zeroBits(this.words[e]);if(t+=n,26!==n)break}return t},s.prototype.byteLength=function(){return Math.ceil(this.bitLength()/8)},s.prototype.toTwos=function(t){return 0!==this.negative?this.abs().inotn(t).iaddn(1):this.clone()},s.prototype.fromTwos=function(t){return this.testn(t-1)?this.notn(t).iaddn(1).ineg():this.clone()},s.prototype.isNeg=function(){return 0!==this.negative},s.prototype.neg=function(){return this.clone().ineg()},s.prototype.ineg=function(){return this.isZero()||(this.negative^=1),this},s.prototype.iuor=function(t){while(this.length<t.length)this.words[this.length++]=0;for(var e=0;e<t.length;e++)this.words[e]=this.words[e]|t.words[e];return this._strip()},s.prototype.ior=function(t){return r(0===(this.negative|t.negative)),this.iuor(t)},s.prototype.or=function(t){return this.length>t.length?this.clone().ior(t):t.clone().ior(this)},s.prototype.uor=function(t){return this.length>t.length?this.clone().iuor(t):t.clone().iuor(this)},s.prototype.iuand=function(t){var e;e=this.length>t.length?t:this;for(var n=0;n<e.length;n++)this.words[n]=this.words[n]&t.words[n];return this.length=e.length,this._strip()},s.prototype.iand=function(t){return r(0===(this.negative|t.negative)),this.iuand(t)},s.prototype.and=function(t){return this.length>t.length?this.clone().iand(t):t.clone().iand(this)},s.prototype.uand=function(t){return this.length>t.length?this.clone().iuand(t):t.clone().iuand(this)},s.prototype.iuxor=function(t){var e,n;this.length>t.length?(e=this,n=t):(e=t,n=this);for(var r=0;r<n.length;r++)this.words[r]=e.words[r]^n.words[r];if(this!==e)for(;r<e.length;r++)this.words[r]=e.words[r];return this.length=e.length,this._strip()},s.prototype.ixor=function(t){return r(0===(this.negative|t.negative)),this.iuxor(t)},s.prototype.xor=function(t){return this.length>t.length?this.clone().ixor(t):t.clone().ixor(this)},s.prototype.uxor=function(t){return this.length>t.length?this.clone().iuxor(t):t.clone().iuxor(this)},s.prototype.inotn=function(t){r("number"===typeof t&&t>=0);var e=0|Math.ceil(t/26),n=t%26;this._expand(e),n>0&&e--;for(var i=0;i<e;i++)this.words[i]=67108863&~this.words[i];return n>0&&(this.words[i]=~this.words[i]&67108863>>26-n),this._strip()},s.prototype.notn=function(t){return this.clone().inotn(t)},s.prototype.setn=function(t,e){r("number"===typeof t&&t>=0);var n=t/26|0,i=t%26;return this._expand(n+1),this.words[n]=e?this.words[n]|1<<i:this.words[n]&~(1<<i),this._strip()},s.prototype.iadd=function(t){var e,n,r;if(0!==this.negative&&0===t.negative)return this.negative=0,e=this.isub(t),this.negative^=1,this._normSign();if(0===this.negative&&0!==t.negative)return t.negative=0,e=this.isub(t),t.negative=1,e._normSign();this.length>t.length?(n=this,r=t):(n=t,r=this);for(var i=0,s=0;s<r.length;s++)e=(0|n.words[s])+(0|r.words[s])+i,this.words[s]=67108863&e,i=e>>>26;for(;0!==i&&s<n.length;s++)e=(0|n.words[s])+i,this.words[s]=67108863&e,i=e>>>26;if(this.length=n.length,0!==i)this.words[this.length]=i,this.length++;else if(n!==this)for(;s<n.length;s++)this.words[s]=n.words[s];return this},s.prototype.add=function(t){var e;return 0!==t.negative&&0===this.negative?(t.negative=0,e=this.sub(t),t.negative^=1,e):0===t.negative&&0!==this.negative?(this.negative=0,e=t.sub(this),this.negative=1,e):this.length>t.length?this.clone().iadd(t):t.clone().iadd(this)},s.prototype.isub=function(t){if(0!==t.negative){t.negative=0;var e=this.iadd(t);return t.negative=1,e._normSign()}if(0!==this.negative)return this.negative=0,this.iadd(t),this.negative=1,this._normSign();var n,r,i=this.cmp(t);if(0===i)return this.negative=0,this.length=1,this.words[0]=0,this;i>0?(n=this,r=t):(n=t,r=this);for(var s=0,o=0;o<r.length;o++)e=(0|n.words[o])-(0|r.words[o])+s,s=e>>26,this.words[o]=67108863&e;for(;0!==s&&o<n.length;o++)e=(0|n.words[o])+s,s=e>>26,this.words[o]=67108863&e;if(0===s&&o<n.length&&n!==this)for(;o<n.length;o++)this.words[o]=n.words[o];return this.length=Math.max(this.length,o),n!==this&&(this.negative=1),this._strip()},s.prototype.sub=function(t){return this.clone().isub(t)};var y=function(t,e,n){var r,i,s,o=t.words,a=e.words,l=n.words,c=0,u=0|o[0],h=8191&u,d=u>>>13,f=0|o[1],p=8191&f,m=f>>>13,g=0|o[2],v=8191&g,y=g>>>13,x=0|o[3],b=8191&x,w=x>>>13,_=0|o[4],M=8191&_,A=_>>>13,S=0|o[5],E=8191&S,T=S>>>13,C=0|o[6],R=8191&C,I=C>>>13,P=0|o[7],L=8191&P,N=P>>>13,k=0|o[8],O=8191&k,D=k>>>13,z=0|o[9],F=8191&z,U=z>>>13,B=0|a[0],G=8191&B,H=B>>>13,V=0|a[1],j=8191&V,W=V>>>13,q=0|a[2],Y=8191&q,X=q>>>13,J=0|a[3],K=8191&J,Z=J>>>13,Q=0|a[4],$=8191&Q,tt=Q>>>13,et=0|a[5],nt=8191&et,rt=et>>>13,it=0|a[6],st=8191&it,ot=it>>>13,at=0|a[7],lt=8191&at,ct=at>>>13,ut=0|a[8],ht=8191&ut,dt=ut>>>13,ft=0|a[9],pt=8191&ft,mt=ft>>>13;n.negative=t.negative^e.negative,n.length=19,r=Math.imul(h,G),i=Math.imul(h,H),i=i+Math.imul(d,G)|0,s=Math.imul(d,H);var gt=(c+r|0)+((8191&i)<<13)|0;c=(s+(i>>>13)|0)+(gt>>>26)|0,gt&=67108863,r=Math.imul(p,G),i=Math.imul(p,H),i=i+Math.imul(m,G)|0,s=Math.imul(m,H),r=r+Math.imul(h,j)|0,i=i+Math.imul(h,W)|0,i=i+Math.imul(d,j)|0,s=s+Math.imul(d,W)|0;var vt=(c+r|0)+((8191&i)<<13)|0;c=(s+(i>>>13)|0)+(vt>>>26)|0,vt&=67108863,r=Math.imul(v,G),i=Math.imul(v,H),i=i+Math.imul(y,G)|0,s=Math.imul(y,H),r=r+Math.imul(p,j)|0,i=i+Math.imul(p,W)|0,i=i+Math.imul(m,j)|0,s=s+Math.imul(m,W)|0,r=r+Math.imul(h,Y)|0,i=i+Math.imul(h,X)|0,i=i+Math.imul(d,Y)|0,s=s+Math.imul(d,X)|0;var yt=(c+r|0)+((8191&i)<<13)|0;c=(s+(i>>>13)|0)+(yt>>>26)|0,yt&=67108863,r=Math.imul(b,G),i=Math.imul(b,H),i=i+Math.imul(w,G)|0,s=Math.imul(w,H),r=r+Math.imul(v,j)|0,i=i+Math.imul(v,W)|0,i=i+Math.imul(y,j)|0,s=s+Math.imul(y,W)|0,r=r+Math.imul(p,Y)|0,i=i+Math.imul(p,X)|0,i=i+Math.imul(m,Y)|0,s=s+Math.imul(m,X)|0,r=r+Math.imul(h,K)|0,i=i+Math.imul(h,Z)|0,i=i+Math.imul(d,K)|0,s=s+Math.imul(d,Z)|0;var xt=(c+r|0)+((8191&i)<<13)|0;c=(s+(i>>>13)|0)+(xt>>>26)|0,xt&=67108863,r=Math.imul(M,G),i=Math.imul(M,H),i=i+Math.imul(A,G)|0,s=Math.imul(A,H),r=r+Math.imul(b,j)|0,i=i+Math.imul(b,W)|0,i=i+Math.imul(w,j)|0,s=s+Math.imul(w,W)|0,r=r+Math.imul(v,Y)|0,i=i+Math.imul(v,X)|0,i=i+Math.imul(y,Y)|0,s=s+Math.imul(y,X)|0,r=r+Math.imul(p,K)|0,i=i+Math.imul(p,Z)|0,i=i+Math.imul(m,K)|0,s=s+Math.imul(m,Z)|0,r=r+Math.imul(h,$)|0,i=i+Math.imul(h,tt)|0,i=i+Math.imul(d,$)|0,s=s+Math.imul(d,tt)|0;var bt=(c+r|0)+((8191&i)<<13)|0;c=(s+(i>>>13)|0)+(bt>>>26)|0,bt&=67108863,r=Math.imul(E,G),i=Math.imul(E,H),i=i+Math.imul(T,G)|0,s=Math.imul(T,H),r=r+Math.imul(M,j)|0,i=i+Math.imul(M,W)|0,i=i+Math.imul(A,j)|0,s=s+Math.imul(A,W)|0,r=r+Math.imul(b,Y)|0,i=i+Math.imul(b,X)|0,i=i+Math.imul(w,Y)|0,s=s+Math.imul(w,X)|0,r=r+Math.imul(v,K)|0,i=i+Math.imul(v,Z)|0,i=i+Math.imul(y,K)|0,s=s+Math.imul(y,Z)|0,r=r+Math.imul(p,$)|0,i=i+Math.imul(p,tt)|0,i=i+Math.imul(m,$)|0,s=s+Math.imul(m,tt)|0,r=r+Math.imul(h,nt)|0,i=i+Math.imul(h,rt)|0,i=i+Math.imul(d,nt)|0,s=s+Math.imul(d,rt)|0;var wt=(c+r|0)+((8191&i)<<13)|0;c=(s+(i>>>13)|0)+(wt>>>26)|0,wt&=67108863,r=Math.imul(R,G),i=Math.imul(R,H),i=i+Math.imul(I,G)|0,s=Math.imul(I,H),r=r+Math.imul(E,j)|0,i=i+Math.imul(E,W)|0,i=i+Math.imul(T,j)|0,s=s+Math.imul(T,W)|0,r=r+Math.imul(M,Y)|0,i=i+Math.imul(M,X)|0,i=i+Math.imul(A,Y)|0,s=s+Math.imul(A,X)|0,r=r+Math.imul(b,K)|0,i=i+Math.imul(b,Z)|0,i=i+Math.imul(w,K)|0,s=s+Math.imul(w,Z)|0,r=r+Math.imul(v,$)|0,i=i+Math.imul(v,tt)|0,i=i+Math.imul(y,$)|0,s=s+Math.imul(y,tt)|0,r=r+Math.imul(p,nt)|0,i=i+Math.imul(p,rt)|0,i=i+Math.imul(m,nt)|0,s=s+Math.imul(m,rt)|0,r=r+Math.imul(h,st)|0,i=i+Math.imul(h,ot)|0,i=i+Math.imul(d,st)|0,s=s+Math.imul(d,ot)|0;var _t=(c+r|0)+((8191&i)<<13)|0;c=(s+(i>>>13)|0)+(_t>>>26)|0,_t&=67108863,r=Math.imul(L,G),i=Math.imul(L,H),i=i+Math.imul(N,G)|0,s=Math.imul(N,H),r=r+Math.imul(R,j)|0,i=i+Math.imul(R,W)|0,i=i+Math.imul(I,j)|0,s=s+Math.imul(I,W)|0,r=r+Math.imul(E,Y)|0,i=i+Math.imul(E,X)|0,i=i+Math.imul(T,Y)|0,s=s+Math.imul(T,X)|0,r=r+Math.imul(M,K)|0,i=i+Math.imul(M,Z)|0,i=i+Math.imul(A,K)|0,s=s+Math.imul(A,Z)|0,r=r+Math.imul(b,$)|0,i=i+Math.imul(b,tt)|0,i=i+Math.imul(w,$)|0,s=s+Math.imul(w,tt)|0,r=r+Math.imul(v,nt)|0,i=i+Math.imul(v,rt)|0,i=i+Math.imul(y,nt)|0,s=s+Math.imul(y,rt)|0,r=r+Math.imul(p,st)|0,i=i+Math.imul(p,ot)|0,i=i+Math.imul(m,st)|0,s=s+Math.imul(m,ot)|0,r=r+Math.imul(h,lt)|0,i=i+Math.imul(h,ct)|0,i=i+Math.imul(d,lt)|0,s=s+Math.imul(d,ct)|0;var Mt=(c+r|0)+((8191&i)<<13)|0;c=(s+(i>>>13)|0)+(Mt>>>26)|0,Mt&=67108863,r=Math.imul(O,G),i=Math.imul(O,H),i=i+Math.imul(D,G)|0,s=Math.imul(D,H),r=r+Math.imul(L,j)|0,i=i+Math.imul(L,W)|0,i=i+Math.imul(N,j)|0,s=s+Math.imul(N,W)|0,r=r+Math.imul(R,Y)|0,i=i+Math.imul(R,X)|0,i=i+Math.imul(I,Y)|0,s=s+Math.imul(I,X)|0,r=r+Math.imul(E,K)|0,i=i+Math.imul(E,Z)|0,i=i+Math.imul(T,K)|0,s=s+Math.imul(T,Z)|0,r=r+Math.imul(M,$)|0,i=i+Math.imul(M,tt)|0,i=i+Math.imul(A,$)|0,s=s+Math.imul(A,tt)|0,r=r+Math.imul(b,nt)|0,i=i+Math.imul(b,rt)|0,i=i+Math.imul(w,nt)|0,s=s+Math.imul(w,rt)|0,r=r+Math.imul(v,st)|0,i=i+Math.imul(v,ot)|0,i=i+Math.imul(y,st)|0,s=s+Math.imul(y,ot)|0,r=r+Math.imul(p,lt)|0,i=i+Math.imul(p,ct)|0,i=i+Math.imul(m,lt)|0,s=s+Math.imul(m,ct)|0,r=r+Math.imul(h,ht)|0,i=i+Math.imul(h,dt)|0,i=i+Math.imul(d,ht)|0,s=s+Math.imul(d,dt)|0;var At=(c+r|0)+((8191&i)<<13)|0;c=(s+(i>>>13)|0)+(At>>>26)|0,At&=67108863,r=Math.imul(F,G),i=Math.imul(F,H),i=i+Math.imul(U,G)|0,s=Math.imul(U,H),r=r+Math.imul(O,j)|0,i=i+Math.imul(O,W)|0,i=i+Math.imul(D,j)|0,s=s+Math.imul(D,W)|0,r=r+Math.imul(L,Y)|0,i=i+Math.imul(L,X)|0,i=i+Math.imul(N,Y)|0,s=s+Math.imul(N,X)|0,r=r+Math.imul(R,K)|0,i=i+Math.imul(R,Z)|0,i=i+Math.imul(I,K)|0,s=s+Math.imul(I,Z)|0,r=r+Math.imul(E,$)|0,i=i+Math.imul(E,tt)|0,i=i+Math.imul(T,$)|0,s=s+Math.imul(T,tt)|0,r=r+Math.imul(M,nt)|0,i=i+Math.imul(M,rt)|0,i=i+Math.imul(A,nt)|0,s=s+Math.imul(A,rt)|0,r=r+Math.imul(b,st)|0,i=i+Math.imul(b,ot)|0,i=i+Math.imul(w,st)|0,s=s+Math.imul(w,ot)|0,r=r+Math.imul(v,lt)|0,i=i+Math.imul(v,ct)|0,i=i+Math.imul(y,lt)|0,s=s+Math.imul(y,ct)|0,r=r+Math.imul(p,ht)|0,i=i+Math.imul(p,dt)|0,i=i+Math.imul(m,ht)|0,s=s+Math.imul(m,dt)|0,r=r+Math.imul(h,pt)|0,i=i+Math.imul(h,mt)|0,i=i+Math.imul(d,pt)|0,s=s+Math.imul(d,mt)|0;var St=(c+r|0)+((8191&i)<<13)|0;c=(s+(i>>>13)|0)+(St>>>26)|0,St&=67108863,r=Math.imul(F,j),i=Math.imul(F,W),i=i+Math.imul(U,j)|0,s=Math.imul(U,W),r=r+Math.imul(O,Y)|0,i=i+Math.imul(O,X)|0,i=i+Math.imul(D,Y)|0,s=s+Math.imul(D,X)|0,r=r+Math.imul(L,K)|0,i=i+Math.imul(L,Z)|0,i=i+Math.imul(N,K)|0,s=s+Math.imul(N,Z)|0,r=r+Math.imul(R,$)|0,i=i+Math.imul(R,tt)|0,i=i+Math.imul(I,$)|0,s=s+Math.imul(I,tt)|0,r=r+Math.imul(E,nt)|0,i=i+Math.imul(E,rt)|0,i=i+Math.imul(T,nt)|0,s=s+Math.imul(T,rt)|0,r=r+Math.imul(M,st)|0,i=i+Math.imul(M,ot)|0,i=i+Math.imul(A,st)|0,s=s+Math.imul(A,ot)|0,r=r+Math.imul(b,lt)|0,i=i+Math.imul(b,ct)|0,i=i+Math.imul(w,lt)|0,s=s+Math.imul(w,ct)|0,r=r+Math.imul(v,ht)|0,i=i+Math.imul(v,dt)|0,i=i+Math.imul(y,ht)|0,s=s+Math.imul(y,dt)|0,r=r+Math.imul(p,pt)|0,i=i+Math.imul(p,mt)|0,i=i+Math.imul(m,pt)|0,s=s+Math.imul(m,mt)|0;var Et=(c+r|0)+((8191&i)<<13)|0;c=(s+(i>>>13)|0)+(Et>>>26)|0,Et&=67108863,r=Math.imul(F,Y),i=Math.imul(F,X),i=i+Math.imul(U,Y)|0,s=Math.imul(U,X),r=r+Math.imul(O,K)|0,i=i+Math.imul(O,Z)|0,i=i+Math.imul(D,K)|0,s=s+Math.imul(D,Z)|0,r=r+Math.imul(L,$)|0,i=i+Math.imul(L,tt)|0,i=i+Math.imul(N,$)|0,s=s+Math.imul(N,tt)|0,r=r+Math.imul(R,nt)|0,i=i+Math.imul(R,rt)|0,i=i+Math.imul(I,nt)|0,s=s+Math.imul(I,rt)|0,r=r+Math.imul(E,st)|0,i=i+Math.imul(E,ot)|0,i=i+Math.imul(T,st)|0,s=s+Math.imul(T,ot)|0,r=r+Math.imul(M,lt)|0,i=i+Math.imul(M,ct)|0,i=i+Math.imul(A,lt)|0,s=s+Math.imul(A,ct)|0,r=r+Math.imul(b,ht)|0,i=i+Math.imul(b,dt)|0,i=i+Math.imul(w,ht)|0,s=s+Math.imul(w,dt)|0,r=r+Math.imul(v,pt)|0,i=i+Math.imul(v,mt)|0,i=i+Math.imul(y,pt)|0,s=s+Math.imul(y,mt)|0;var Tt=(c+r|0)+((8191&i)<<13)|0;c=(s+(i>>>13)|0)+(Tt>>>26)|0,Tt&=67108863,r=Math.imul(F,K),i=Math.imul(F,Z),i=i+Math.imul(U,K)|0,s=Math.imul(U,Z),r=r+Math.imul(O,$)|0,i=i+Math.imul(O,tt)|0,i=i+Math.imul(D,$)|0,s=s+Math.imul(D,tt)|0,r=r+Math.imul(L,nt)|0,i=i+Math.imul(L,rt)|0,i=i+Math.imul(N,nt)|0,s=s+Math.imul(N,rt)|0,r=r+Math.imul(R,st)|0,i=i+Math.imul(R,ot)|0,i=i+Math.imul(I,st)|0,s=s+Math.imul(I,ot)|0,r=r+Math.imul(E,lt)|0,i=i+Math.imul(E,ct)|0,i=i+Math.imul(T,lt)|0,s=s+Math.imul(T,ct)|0,r=r+Math.imul(M,ht)|0,i=i+Math.imul(M,dt)|0,i=i+Math.imul(A,ht)|0,s=s+Math.imul(A,dt)|0,r=r+Math.imul(b,pt)|0,i=i+Math.imul(b,mt)|0,i=i+Math.imul(w,pt)|0,s=s+Math.imul(w,mt)|0;var Ct=(c+r|0)+((8191&i)<<13)|0;c=(s+(i>>>13)|0)+(Ct>>>26)|0,Ct&=67108863,r=Math.imul(F,$),i=Math.imul(F,tt),i=i+Math.imul(U,$)|0,s=Math.imul(U,tt),r=r+Math.imul(O,nt)|0,i=i+Math.imul(O,rt)|0,i=i+Math.imul(D,nt)|0,s=s+Math.imul(D,rt)|0,r=r+Math.imul(L,st)|0,i=i+Math.imul(L,ot)|0,i=i+Math.imul(N,st)|0,s=s+Math.imul(N,ot)|0,r=r+Math.imul(R,lt)|0,i=i+Math.imul(R,ct)|0,i=i+Math.imul(I,lt)|0,s=s+Math.imul(I,ct)|0,r=r+Math.imul(E,ht)|0,i=i+Math.imul(E,dt)|0,i=i+Math.imul(T,ht)|0,s=s+Math.imul(T,dt)|0,r=r+Math.imul(M,pt)|0,i=i+Math.imul(M,mt)|0,i=i+Math.imul(A,pt)|0,s=s+Math.imul(A,mt)|0;var Rt=(c+r|0)+((8191&i)<<13)|0;c=(s+(i>>>13)|0)+(Rt>>>26)|0,Rt&=67108863,r=Math.imul(F,nt),i=Math.imul(F,rt),i=i+Math.imul(U,nt)|0,s=Math.imul(U,rt),r=r+Math.imul(O,st)|0,i=i+Math.imul(O,ot)|0,i=i+Math.imul(D,st)|0,s=s+Math.imul(D,ot)|0,r=r+Math.imul(L,lt)|0,i=i+Math.imul(L,ct)|0,i=i+Math.imul(N,lt)|0,s=s+Math.imul(N,ct)|0,r=r+Math.imul(R,ht)|0,i=i+Math.imul(R,dt)|0,i=i+Math.imul(I,ht)|0,s=s+Math.imul(I,dt)|0,r=r+Math.imul(E,pt)|0,i=i+Math.imul(E,mt)|0,i=i+Math.imul(T,pt)|0,s=s+Math.imul(T,mt)|0;var It=(c+r|0)+((8191&i)<<13)|0;c=(s+(i>>>13)|0)+(It>>>26)|0,It&=67108863,r=Math.imul(F,st),i=Math.imul(F,ot),i=i+Math.imul(U,st)|0,s=Math.imul(U,ot),r=r+Math.imul(O,lt)|0,i=i+Math.imul(O,ct)|0,i=i+Math.imul(D,lt)|0,s=s+Math.imul(D,ct)|0,r=r+Math.imul(L,ht)|0,i=i+Math.imul(L,dt)|0,i=i+Math.imul(N,ht)|0,s=s+Math.imul(N,dt)|0,r=r+Math.imul(R,pt)|0,i=i+Math.imul(R,mt)|0,i=i+Math.imul(I,pt)|0,s=s+Math.imul(I,mt)|0;var Pt=(c+r|0)+((8191&i)<<13)|0;c=(s+(i>>>13)|0)+(Pt>>>26)|0,Pt&=67108863,r=Math.imul(F,lt),i=Math.imul(F,ct),i=i+Math.imul(U,lt)|0,s=Math.imul(U,ct),r=r+Math.imul(O,ht)|0,i=i+Math.imul(O,dt)|0,i=i+Math.imul(D,ht)|0,s=s+Math.imul(D,dt)|0,r=r+Math.imul(L,pt)|0,i=i+Math.imul(L,mt)|0,i=i+Math.imul(N,pt)|0,s=s+Math.imul(N,mt)|0;var Lt=(c+r|0)+((8191&i)<<13)|0;c=(s+(i>>>13)|0)+(Lt>>>26)|0,Lt&=67108863,r=Math.imul(F,ht),i=Math.imul(F,dt),i=i+Math.imul(U,ht)|0,s=Math.imul(U,dt),r=r+Math.imul(O,pt)|0,i=i+Math.imul(O,mt)|0,i=i+Math.imul(D,pt)|0,s=s+Math.imul(D,mt)|0;var Nt=(c+r|0)+((8191&i)<<13)|0;c=(s+(i>>>13)|0)+(Nt>>>26)|0,Nt&=67108863,r=Math.imul(F,pt),i=Math.imul(F,mt),i=i+Math.imul(U,pt)|0,s=Math.imul(U,mt);var kt=(c+r|0)+((8191&i)<<13)|0;return c=(s+(i>>>13)|0)+(kt>>>26)|0,kt&=67108863,l[0]=gt,l[1]=vt,l[2]=yt,l[3]=xt,l[4]=bt,l[5]=wt,l[6]=_t,l[7]=Mt,l[8]=At,l[9]=St,l[10]=Et,l[11]=Tt,l[12]=Ct,l[13]=Rt,l[14]=It,l[15]=Pt,l[16]=Lt,l[17]=Nt,l[18]=kt,0!==c&&(l[19]=c,n.length++),n};function x(t,e,n){n.negative=e.negative^t.negative,n.length=t.length+e.length;for(var r=0,i=0,s=0;s<n.length-1;s++){var o=i;i=0;for(var a=67108863&r,l=Math.min(s,e.length-1),c=Math.max(0,s-t.length+1);c<=l;c++){var u=s-c,h=0|t.words[u],d=0|e.words[c],f=h*d,p=67108863&f;o=o+(f/67108864|0)|0,p=p+a|0,a=67108863&p,o=o+(p>>>26)|0,i+=o>>>26,o&=67108863}n.words[s]=a,r=o,o=i}return 0!==r?n.words[s]=r:n.length--,n._strip()}function b(t,e,n){return x(t,e,n)}function w(t,e){this.x=t,this.y=e}Math.imul||(y=v),s.prototype.mulTo=function(t,e){var n,r=this.length+t.length;return n=10===this.length&&10===t.length?y(this,t,e):r<63?v(this,t,e):r<1024?x(this,t,e):b(this,t,e),n},w.prototype.makeRBT=function(t){for(var e=new Array(t),n=s.prototype._countBits(t)-1,r=0;r<t;r++)e[r]=this.revBin(r,n,t);return e},w.prototype.revBin=function(t,e,n){if(0===t||t===n-1)return t;for(var r=0,i=0;i<e;i++)r|=(1&t)<<e-i-1,t>>=1;return r},w.prototype.permute=function(t,e,n,r,i,s){for(var o=0;o<s;o++)r[o]=e[t[o]],i[o]=n[t[o]]},w.prototype.transform=function(t,e,n,r,i,s){this.permute(s,t,e,n,r,i);for(var o=1;o<i;o<<=1)for(var a=o<<1,l=Math.cos(2*Math.PI/a),c=Math.sin(2*Math.PI/a),u=0;u<i;u+=a)for(var h=l,d=c,f=0;f<o;f++){var p=n[u+f],m=r[u+f],g=n[u+f+o],v=r[u+f+o],y=h*g-d*v;v=h*v+d*g,g=y,n[u+f]=p+g,r[u+f]=m+v,n[u+f+o]=p-g,r[u+f+o]=m-v,f!==a&&(y=l*h-c*d,d=l*d+c*h,h=y)}},w.prototype.guessLen13b=function(t,e){var n=1|Math.max(e,t),r=1&n,i=0;for(n=n/2|0;n;n>>>=1)i++;return 1<<i+1+r},w.prototype.conjugate=function(t,e,n){if(!(n<=1))for(var r=0;r<n/2;r++){var i=t[r];t[r]=t[n-r-1],t[n-r-1]=i,i=e[r],e[r]=-e[n-r-1],e[n-r-1]=-i}},w.prototype.normalize13b=function(t,e){for(var n=0,r=0;r<e/2;r++){var i=8192*Math.round(t[2*r+1]/e)+Math.round(t[2*r]/e)+n;t[r]=67108863&i,n=i<67108864?0:i/67108864|0}return t},w.prototype.convert13b=function(t,e,n,i){for(var s=0,o=0;o<e;o++)s+=0|t[o],n[2*o]=8191&s,s>>>=13,n[2*o+1]=8191&s,s>>>=13;for(o=2*e;o<i;++o)n[o]=0;r(0===s),r(0===(-8192&s))},w.prototype.stub=function(t){for(var e=new Array(t),n=0;n<t;n++)e[n]=0;return e},w.prototype.mulp=function(t,e,n){var r=2*this.guessLen13b(t.length,e.length),i=this.makeRBT(r),s=this.stub(r),o=new Array(r),a=new Array(r),l=new Array(r),c=new Array(r),u=new Array(r),h=new Array(r),d=n.words;d.length=r,this.convert13b(t.words,t.length,o,r),this.convert13b(e.words,e.length,c,r),this.transform(o,s,a,l,r,i),this.transform(c,s,u,h,r,i);for(var f=0;f<r;f++){var p=a[f]*u[f]-l[f]*h[f];l[f]=a[f]*h[f]+l[f]*u[f],a[f]=p}return this.conjugate(a,l,r),this.transform(a,l,d,s,r,i),this.conjugate(d,s,r),this.normalize13b(d,r),n.negative=t.negative^e.negative,n.length=t.length+e.length,n._strip()},s.prototype.mul=function(t){var e=new s(null);return e.words=new Array(this.length+t.length),this.mulTo(t,e)},s.prototype.mulf=function(t){var e=new s(null);return e.words=new Array(this.length+t.length),b(this,t,e)},s.prototype.imul=function(t){return this.clone().mulTo(t,this)},s.prototype.imuln=function(t){var e=t<0;e&&(t=-t),r("number"===typeof t),r(t<67108864);for(var n=0,i=0;i<this.length;i++){var s=(0|this.words[i])*t,o=(67108863&s)+(67108863&n);n>>=26,n+=s/67108864|0,n+=o>>>26,this.words[i]=67108863&o}return 0!==n&&(this.words[i]=n,this.length++),e?this.ineg():this},s.prototype.muln=function(t){return this.clone().imuln(t)},s.prototype.sqr=function(){return this.mul(this)},s.prototype.isqr=function(){return this.imul(this.clone())},s.prototype.pow=function(t){var e=g(t);if(0===e.length)return new s(1);for(var n=this,r=0;r<e.length;r++,n=n.sqr())if(0!==e[r])break;if(++r<e.length)for(var i=n.sqr();r<e.length;r++,i=i.sqr())0!==e[r]&&(n=n.mul(i));return n},s.prototype.iushln=function(t){r("number"===typeof t&&t>=0);var e,n=t%26,i=(t-n)/26,s=67108863>>>26-n<<26-n;if(0!==n){var o=0;for(e=0;e<this.length;e++){var a=this.words[e]&s,l=(0|this.words[e])-a<<n;this.words[e]=l|o,o=a>>>26-n}o&&(this.words[e]=o,this.length++)}if(0!==i){for(e=this.length-1;e>=0;e--)this.words[e+i]=this.words[e];for(e=0;e<i;e++)this.words[e]=0;this.length+=i}return this._strip()},s.prototype.ishln=function(t){return r(0===this.negative),this.iushln(t)},s.prototype.iushrn=function(t,e,n){var i;r("number"===typeof t&&t>=0),i=e?(e-e%26)/26:0;var s=t%26,o=Math.min((t-s)/26,this.length),a=67108863^67108863>>>s<<s,l=n;if(i-=o,i=Math.max(0,i),l){for(var c=0;c<o;c++)l.words[c]=this.words[c];l.length=o}if(0===o);else if(this.length>o)for(this.length-=o,c=0;c<this.length;c++)this.words[c]=this.words[c+o];else this.words[0]=0,this.length=1;var u=0;for(c=this.length-1;c>=0&&(0!==u||c>=i);c--){var h=0|this.words[c];this.words[c]=u<<26-s|h>>>s,u=h&a}return l&&0!==u&&(l.words[l.length++]=u),0===this.length&&(this.words[0]=0,this.length=1),this._strip()},s.prototype.ishrn=function(t,e,n){return r(0===this.negative),this.iushrn(t,e,n)},s.prototype.shln=function(t){return this.clone().ishln(t)},s.prototype.ushln=function(t){return this.clone().iushln(t)},s.prototype.shrn=function(t){return this.clone().ishrn(t)},s.prototype.ushrn=function(t){return this.clone().iushrn(t)},s.prototype.testn=function(t){r("number"===typeof t&&t>=0);var e=t%26,n=(t-e)/26,i=1<<e;if(this.length<=n)return!1;var s=this.words[n];return!!(s&i)},s.prototype.imaskn=function(t){r("number"===typeof t&&t>=0);var e=t%26,n=(t-e)/26;if(r(0===this.negative,"imaskn works only with positive numbers"),this.length<=n)return this;if(0!==e&&n++,this.length=Math.min(n,this.length),0!==e){var i=67108863^67108863>>>e<<e;this.words[this.length-1]&=i}return this._strip()},s.prototype.maskn=function(t){return this.clone().imaskn(t)},s.prototype.iaddn=function(t){return r("number"===typeof t),r(t<67108864),t<0?this.isubn(-t):0!==this.negative?1===this.length&&(0|this.words[0])<=t?(this.words[0]=t-(0|this.words[0]),this.negative=0,this):(this.negative=0,this.isubn(t),this.negative=1,this):this._iaddn(t)},s.prototype._iaddn=function(t){this.words[0]+=t;for(var e=0;e<this.length&&this.words[e]>=67108864;e++)this.words[e]-=67108864,e===this.length-1?this.words[e+1]=1:this.words[e+1]++;return this.length=Math.max(this.length,e+1),this},s.prototype.isubn=function(t){if(r("number"===typeof t),r(t<67108864),t<0)return this.iaddn(-t);if(0!==this.negative)return this.negative=0,this.iaddn(t),this.negative=1,this;if(this.words[0]-=t,1===this.length&&this.words[0]<0)this.words[0]=-this.words[0],this.negative=1;else for(var e=0;e<this.length&&this.words[e]<0;e++)this.words[e]+=67108864,this.words[e+1]-=1;return this._strip()},s.prototype.addn=function(t){return this.clone().iaddn(t)},s.prototype.subn=function(t){return this.clone().isubn(t)},s.prototype.iabs=function(){return this.negative=0,this},s.prototype.abs=function(){return this.clone().iabs()},s.prototype._ishlnsubmul=function(t,e,n){var i,s,o=t.length+n;this._expand(o);var a=0;for(i=0;i<t.length;i++){s=(0|this.words[i+n])+a;var l=(0|t.words[i])*e;s-=67108863&l,a=(s>>26)-(l/67108864|0),this.words[i+n]=67108863&s}for(;i<this.length-n;i++)s=(0|this.words[i+n])+a,a=s>>26,this.words[i+n]=67108863&s;if(0===a)return this._strip();for(r(-1===a),a=0,i=0;i<this.length;i++)s=-(0|this.words[i])+a,a=s>>26,this.words[i]=67108863&s;return this.negative=1,this._strip()},s.prototype._wordDiv=function(t,e){var n=this.length-t.length,r=this.clone(),i=t,o=0|i.words[i.length-1],a=this._countBits(o);n=26-a,0!==n&&(i=i.ushln(n),r.iushln(n),o=0|i.words[i.length-1]);var l,c=r.length-i.length;if("mod"!==e){l=new s(null),l.length=c+1,l.words=new Array(l.length);for(var u=0;u<l.length;u++)l.words[u]=0}var h=r.clone()._ishlnsubmul(i,1,c);0===h.negative&&(r=h,l&&(l.words[c]=1));for(var d=c-1;d>=0;d--){var f=67108864*(0|r.words[i.length+d])+(0|r.words[i.length+d-1]);f=Math.min(f/o|0,67108863),r._ishlnsubmul(i,f,d);while(0!==r.negative)f--,r.negative=0,r._ishlnsubmul(i,1,d),r.isZero()||(r.negative^=1);l&&(l.words[d]=f)}return l&&l._strip(),r._strip(),"div"!==e&&0!==n&&r.iushrn(n),{div:l||null,mod:r}},s.prototype.divmod=function(t,e,n){return r(!t.isZero()),this.isZero()?{div:new s(0),mod:new s(0)}:0!==this.negative&&0===t.negative?(a=this.neg().divmod(t,e),"mod"!==e&&(i=a.div.neg()),"div"!==e&&(o=a.mod.neg(),n&&0!==o.negative&&o.iadd(t)),{div:i,mod:o}):0===this.negative&&0!==t.negative?(a=this.divmod(t.neg(),e),"mod"!==e&&(i=a.div.neg()),{div:i,mod:a.mod}):0!==(this.negative&t.negative)?(a=this.neg().divmod(t.neg(),e),"div"!==e&&(o=a.mod.neg(),n&&0!==o.negative&&o.isub(t)),{div:a.div,mod:o}):t.length>this.length||this.cmp(t)<0?{div:new s(0),mod:this}:1===t.length?"div"===e?{div:this.divn(t.words[0]),mod:null}:"mod"===e?{div:null,mod:new s(this.modrn(t.words[0]))}:{div:this.divn(t.words[0]),mod:new s(this.modrn(t.words[0]))}:this._wordDiv(t,e);var i,o,a},s.prototype.div=function(t){return this.divmod(t,"div",!1).div},s.prototype.mod=function(t){return this.divmod(t,"mod",!1).mod},s.prototype.umod=function(t){return this.divmod(t,"mod",!0).mod},s.prototype.divRound=function(t){var e=this.divmod(t);if(e.mod.isZero())return e.div;var n=0!==e.div.negative?e.mod.isub(t):e.mod,r=t.ushrn(1),i=t.andln(1),s=n.cmp(r);return s<0||1===i&&0===s?e.div:0!==e.div.negative?e.div.isubn(1):e.div.iaddn(1)},s.prototype.modrn=function(t){var e=t<0;e&&(t=-t),r(t<=67108863);for(var n=(1<<26)%t,i=0,s=this.length-1;s>=0;s--)i=(n*i+(0|this.words[s]))%t;return e?-i:i},s.prototype.modn=function(t){return this.modrn(t)},s.prototype.idivn=function(t){var e=t<0;e&&(t=-t),r(t<=67108863);for(var n=0,i=this.length-1;i>=0;i--){var s=(0|this.words[i])+67108864*n;this.words[i]=s/t|0,n=s%t}return this._strip(),e?this.ineg():this},s.prototype.divn=function(t){return this.clone().idivn(t)},s.prototype.egcd=function(t){r(0===t.negative),r(!t.isZero());var e=this,n=t.clone();e=0!==e.negative?e.umod(t):e.clone();var i=new s(1),o=new s(0),a=new s(0),l=new s(1),c=0;while(e.isEven()&&n.isEven())e.iushrn(1),n.iushrn(1),++c;var u=n.clone(),h=e.clone();while(!e.isZero()){for(var d=0,f=1;0===(e.words[0]&f)&&d<26;++d,f<<=1);if(d>0){e.iushrn(d);while(d-- >0)(i.isOdd()||o.isOdd())&&(i.iadd(u),o.isub(h)),i.iushrn(1),o.iushrn(1)}for(var p=0,m=1;0===(n.words[0]&m)&&p<26;++p,m<<=1);if(p>0){n.iushrn(p);while(p-- >0)(a.isOdd()||l.isOdd())&&(a.iadd(u),l.isub(h)),a.iushrn(1),l.iushrn(1)}e.cmp(n)>=0?(e.isub(n),i.isub(a),o.isub(l)):(n.isub(e),a.isub(i),l.isub(o))}return{a:a,b:l,gcd:n.iushln(c)}},s.prototype._invmp=function(t){r(0===t.negative),r(!t.isZero());var e=this,n=t.clone();e=0!==e.negative?e.umod(t):e.clone();var i,o=new s(1),a=new s(0),l=n.clone();while(e.cmpn(1)>0&&n.cmpn(1)>0){for(var c=0,u=1;0===(e.words[0]&u)&&c<26;++c,u<<=1);if(c>0){e.iushrn(c);while(c-- >0)o.isOdd()&&o.iadd(l),o.iushrn(1)}for(var h=0,d=1;0===(n.words[0]&d)&&h<26;++h,d<<=1);if(h>0){n.iushrn(h);while(h-- >0)a.isOdd()&&a.iadd(l),a.iushrn(1)}e.cmp(n)>=0?(e.isub(n),o.isub(a)):(n.isub(e),a.isub(o))}return i=0===e.cmpn(1)?o:a,i.cmpn(0)<0&&i.iadd(t),i},s.prototype.gcd=function(t){if(this.isZero())return t.abs();if(t.isZero())return this.abs();var e=this.clone(),n=t.clone();e.negative=0,n.negative=0;for(var r=0;e.isEven()&&n.isEven();r++)e.iushrn(1),n.iushrn(1);do{while(e.isEven())e.iushrn(1);while(n.isEven())n.iushrn(1);var i=e.cmp(n);if(i<0){var s=e;e=n,n=s}else if(0===i||0===n.cmpn(1))break;e.isub(n)}while(1);return n.iushln(r)},s.prototype.invm=function(t){return this.egcd(t).a.umod(t)},s.prototype.isEven=function(){return 0===(1&this.words[0])},s.prototype.isOdd=function(){return 1===(1&this.words[0])},s.prototype.andln=function(t){return this.words[0]&t},s.prototype.bincn=function(t){r("number"===typeof t);var e=t%26,n=(t-e)/26,i=1<<e;if(this.length<=n)return this._expand(n+1),this.words[n]|=i,this;for(var s=i,o=n;0!==s&&o<this.length;o++){var a=0|this.words[o];a+=s,s=a>>>26,a&=67108863,this.words[o]=a}return 0!==s&&(this.words[o]=s,this.length++),this},s.prototype.isZero=function(){return 1===this.length&&0===this.words[0]},s.prototype.cmpn=function(t){var e,n=t<0;if(0!==this.negative&&!n)return-1;if(0===this.negative&&n)return 1;if(this._strip(),this.length>1)e=1;else{n&&(t=-t),r(t<=67108863,"Number is too big");var i=0|this.words[0];e=i===t?0:i<t?-1:1}return 0!==this.negative?0|-e:e},s.prototype.cmp=function(t){if(0!==this.negative&&0===t.negative)return-1;if(0===this.negative&&0!==t.negative)return 1;var e=this.ucmp(t);return 0!==this.negative?0|-e:e},s.prototype.ucmp=function(t){if(this.length>t.length)return 1;if(this.length<t.length)return-1;for(var e=0,n=this.length-1;n>=0;n--){var r=0|this.words[n],i=0|t.words[n];if(r!==i){r<i?e=-1:r>i&&(e=1);break}}return e},s.prototype.gtn=function(t){return 1===this.cmpn(t)},s.prototype.gt=function(t){return 1===this.cmp(t)},s.prototype.gten=function(t){return this.cmpn(t)>=0},s.prototype.gte=function(t){return this.cmp(t)>=0},s.prototype.ltn=function(t){return-1===this.cmpn(t)},s.prototype.lt=function(t){return-1===this.cmp(t)},s.prototype.lten=function(t){return this.cmpn(t)<=0},s.prototype.lte=function(t){return this.cmp(t)<=0},s.prototype.eqn=function(t){return 0===this.cmpn(t)},s.prototype.eq=function(t){return 0===this.cmp(t)},s.red=function(t){return new C(t)},s.prototype.toRed=function(t){return r(!this.red,"Already a number in reduction context"),r(0===this.negative,"red works only with positives"),t.convertTo(this)._forceRed(t)},s.prototype.fromRed=function(){return r(this.red,"fromRed works only with numbers in reduction context"),this.red.convertFrom(this)},s.prototype._forceRed=function(t){return this.red=t,this},s.prototype.forceRed=function(t){return r(!this.red,"Already a number in reduction context"),this._forceRed(t)},s.prototype.redAdd=function(t){return r(this.red,"redAdd works only with red numbers"),this.red.add(this,t)},s.prototype.redIAdd=function(t){return r(this.red,"redIAdd works only with red numbers"),this.red.iadd(this,t)},s.prototype.redSub=function(t){return r(this.red,"redSub works only with red numbers"),this.red.sub(this,t)},s.prototype.redISub=function(t){return r(this.red,"redISub works only with red numbers"),this.red.isub(this,t)},s.prototype.redShl=function(t){return r(this.red,"redShl works only with red numbers"),this.red.shl(this,t)},s.prototype.redMul=function(t){return r(this.red,"redMul works only with red numbers"),this.red._verify2(this,t),this.red.mul(this,t)},s.prototype.redIMul=function(t){return r(this.red,"redMul works only with red numbers"),this.red._verify2(this,t),this.red.imul(this,t)},s.prototype.redSqr=function(){return r(this.red,"redSqr works only with red numbers"),this.red._verify1(this),this.red.sqr(this)},s.prototype.redISqr=function(){return r(this.red,"redISqr works only with red numbers"),this.red._verify1(this),this.red.isqr(this)},s.prototype.redSqrt=function(){return r(this.red,"redSqrt works only with red numbers"),this.red._verify1(this),this.red.sqrt(this)},s.prototype.redInvm=function(){return r(this.red,"redInvm works only with red numbers"),this.red._verify1(this),this.red.invm(this)},s.prototype.redNeg=function(){return r(this.red,"redNeg works only with red numbers"),this.red._verify1(this),this.red.neg(this)},s.prototype.redPow=function(t){return r(this.red&&!t.red,"redPow(normalNum)"),this.red._verify1(this),this.red.pow(this,t)};var _={k256:null,p224:null,p192:null,p25519:null};function M(t,e){this.name=t,this.p=new s(e,16),this.n=this.p.bitLength(),this.k=new s(1).iushln(this.n).isub(this.p),this.tmp=this._tmp()}function A(){M.call(this,"k256","ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffe fffffc2f")}function S(){M.call(this,"p224","ffffffff ffffffff ffffffff ffffffff 00000000 00000000 00000001")}function E(){M.call(this,"p192","ffffffff ffffffff ffffffff fffffffe ffffffff ffffffff")}function T(){M.call(this,"25519","7fffffffffffffff ffffffffffffffff ffffffffffffffff ffffffffffffffed")}function C(t){if("string"===typeof t){var e=s._prime(t);this.m=e.p,this.prime=e}else r(t.gtn(1),"modulus must be greater than 1"),this.m=t,this.prime=null}function R(t){C.call(this,t),this.shift=this.m.bitLength(),this.shift%26!==0&&(this.shift+=26-this.shift%26),this.r=new s(1).iushln(this.shift),this.r2=this.imod(this.r.sqr()),this.rinv=this.r._invmp(this.m),this.minv=this.rinv.mul(this.r).isubn(1).div(this.m),this.minv=this.minv.umod(this.r),this.minv=this.r.sub(this.minv)}M.prototype._tmp=function(){var t=new s(null);return t.words=new Array(Math.ceil(this.n/13)),t},M.prototype.ireduce=function(t){var e,n=t;do{this.split(n,this.tmp),n=this.imulK(n),n=n.iadd(this.tmp),e=n.bitLength()}while(e>this.n);var r=e<this.n?-1:n.ucmp(this.p);return 0===r?(n.words[0]=0,n.length=1):r>0?n.isub(this.p):void 0!==n.strip?n.strip():n._strip(),n},M.prototype.split=function(t,e){t.iushrn(this.n,0,e)},M.prototype.imulK=function(t){return t.imul(this.k)},i(A,M),A.prototype.split=function(t,e){for(var n=4194303,r=Math.min(t.length,9),i=0;i<r;i++)e.words[i]=t.words[i];if(e.length=r,t.length<=9)return t.words[0]=0,void(t.length=1);var s=t.words[9];for(e.words[e.length++]=s&n,i=10;i<t.length;i++){var o=0|t.words[i];t.words[i-10]=(o&n)<<4|s>>>22,s=o}s>>>=22,t.words[i-10]=s,0===s&&t.length>10?t.length-=10:t.length-=9},A.prototype.imulK=function(t){t.words[t.length]=0,t.words[t.length+1]=0,t.length+=2;for(var e=0,n=0;n<t.length;n++){var r=0|t.words[n];e+=977*r,t.words[n]=67108863&e,e=64*r+(e/67108864|0)}return 0===t.words[t.length-1]&&(t.length--,0===t.words[t.length-1]&&t.length--),t},i(S,M),i(E,M),i(T,M),T.prototype.imulK=function(t){for(var e=0,n=0;n<t.length;n++){var r=19*(0|t.words[n])+e,i=67108863&r;r>>>=26,t.words[n]=i,e=r}return 0!==e&&(t.words[t.length++]=e),t},s._prime=function(t){if(_[t])return _[t];var e;if("k256"===t)e=new A;else if("p224"===t)e=new S;else if("p192"===t)e=new E;else{if("p25519"!==t)throw new Error("Unknown prime "+t);e=new T}return _[t]=e,e},C.prototype._verify1=function(t){r(0===t.negative,"red works only with positives"),r(t.red,"red works only with red numbers")},C.prototype._verify2=function(t,e){r(0===(t.negative|e.negative),"red works only with positives"),r(t.red&&t.red===e.red,"red works only with red numbers")},C.prototype.imod=function(t){return this.prime?this.prime.ireduce(t)._forceRed(this):(u(t,t.umod(this.m)._forceRed(this)),t)},C.prototype.neg=function(t){return t.isZero()?t.clone():this.m.sub(t)._forceRed(this)},C.prototype.add=function(t,e){this._verify2(t,e);var n=t.add(e);return n.cmp(this.m)>=0&&n.isub(this.m),n._forceRed(this)},C.prototype.iadd=function(t,e){this._verify2(t,e);var n=t.iadd(e);return n.cmp(this.m)>=0&&n.isub(this.m),n},C.prototype.sub=function(t,e){this._verify2(t,e);var n=t.sub(e);return n.cmpn(0)<0&&n.iadd(this.m),n._forceRed(this)},C.prototype.isub=function(t,e){this._verify2(t,e);var n=t.isub(e);return n.cmpn(0)<0&&n.iadd(this.m),n},C.prototype.shl=function(t,e){return this._verify1(t),this.imod(t.ushln(e))},C.prototype.imul=function(t,e){return this._verify2(t,e),this.imod(t.imul(e))},C.prototype.mul=function(t,e){return this._verify2(t,e),this.imod(t.mul(e))},C.prototype.isqr=function(t){return this.imul(t,t.clone())},C.prototype.sqr=function(t){return this.mul(t,t)},C.prototype.sqrt=function(t){if(t.isZero())return t.clone();var e=this.m.andln(3);if(r(e%2===1),3===e){var n=this.m.add(new s(1)).iushrn(2);return this.pow(t,n)}var i=this.m.subn(1),o=0;while(!i.isZero()&&0===i.andln(1))o++,i.iushrn(1);r(!i.isZero());var a=new s(1).toRed(this),l=a.redNeg(),c=this.m.subn(1).iushrn(1),u=this.m.bitLength();u=new s(2*u*u).toRed(this);while(0!==this.pow(u,c).cmp(l))u.redIAdd(l);var h=this.pow(u,i),d=this.pow(t,i.addn(1).iushrn(1)),f=this.pow(t,i),p=o;while(0!==f.cmp(a)){for(var m=f,g=0;0!==m.cmp(a);g++)m=m.redSqr();r(g<p);var v=this.pow(h,new s(1).iushln(p-g-1));d=d.redMul(v),h=v.redSqr(),f=f.redMul(h),p=g}return d},C.prototype.invm=function(t){var e=t._invmp(this.m);return 0!==e.negative?(e.negative=0,this.imod(e).redNeg()):this.imod(e)},C.prototype.pow=function(t,e){if(e.isZero())return new s(1).toRed(this);if(0===e.cmpn(1))return t.clone();var n=4,r=new Array(1<<n);r[0]=new s(1).toRed(this),r[1]=t;for(var i=2;i<r.length;i++)r[i]=this.mul(r[i-1],t);var o=r[0],a=0,l=0,c=e.bitLength()%26;for(0===c&&(c=26),i=e.length-1;i>=0;i--){for(var u=e.words[i],h=c-1;h>=0;h--){var d=u>>h&1;o!==r[0]&&(o=this.sqr(o)),0!==d||0!==a?(a<<=1,a|=d,l++,(l===n||0===i&&0===h)&&(o=this.mul(o,r[a]),l=0,a=0)):l=0}c=26}return o},C.prototype.convertTo=function(t){var e=t.umod(this.m);return e===t?e.clone():e},C.prototype.convertFrom=function(t){var e=t.clone();return e.red=null,e},s.mont=function(t){return new R(t)},i(R,C),R.prototype.convertTo=function(t){return this.imod(t.ushln(this.shift))},R.prototype.convertFrom=function(t){var e=this.imod(t.mul(this.rinv));return e.red=null,e},R.prototype.imul=function(t,e){if(t.isZero()||e.isZero())return t.words[0]=0,t.length=1,t;var n=t.imul(e),r=n.maskn(this.shift).mul(this.minv).imaskn(this.shift).mul(this.m),i=n.isub(r).iushrn(this.shift),s=i;return i.cmp(this.m)>=0?s=i.isub(this.m):i.cmpn(0)<0&&(s=i.iadd(this.m)),s._forceRed(this)},R.prototype.mul=function(t,e){if(t.isZero()||e.isZero())return new s(0)._forceRed(this);var n=t.mul(e),r=n.maskn(this.shift).mul(this.minv).imaskn(this.shift).mul(this.m),i=n.isub(r).iushrn(this.shift),o=i;return i.cmp(this.m)>=0?o=i.isub(this.m):i.cmpn(0)<0&&(o=i.iadd(this.m)),o._forceRed(this)},R.prototype.invm=function(t){var e=this.imod(t._invmp(this.m).mul(this.r2));return e._forceRed(this)}}(t,this)},8730:function(t,e,n){var r=e;r.utils=n(3610),r.common=n(9291),r.sha=n(2762),r.ripemd=n(97),r.hmac=n(4133),r.sha1=r.sha.sha1,r.sha256=r.sha.sha256,r.sha224=r.sha.sha224,r.sha384=r.sha.sha384,r.sha512=r.sha.sha512,r.ripemd160=r.ripemd.ripemd160},9291:function(t,e,n){"use strict";var r=n(3610),i=n(4961);function s(){this.pending=null,this.pendingTotal=0,this.blockSize=this.constructor.blockSize,this.outSize=this.constructor.outSize,this.hmacStrength=this.constructor.hmacStrength,this.padLength=this.constructor.padLength/8,this.endian="big",this._delta8=this.blockSize/8,this._delta32=this.blockSize/32}e.BlockHash=s,s.prototype.update=function(t,e){if(t=r.toArray(t,e),this.pending?this.pending=this.pending.concat(t):this.pending=t,this.pendingTotal+=t.length,this.pending.length>=this._delta8){t=this.pending;var n=t.length%this._delta8;this.pending=t.slice(t.length-n,t.length),0===this.pending.length&&(this.pending=null),t=r.join32(t,0,t.length-n,this.endian);for(var i=0;i<t.length;i+=this._delta32)this._update(t,i,i+this._delta32)}return this},s.prototype.digest=function(t){return this.update(this._pad()),i(null===this.pending),this._digest(t)},s.prototype._pad=function(){var t=this.pendingTotal,e=this._delta8,n=e-(t+this.padLength)%e,r=new Array(n+this.padLength);r[0]=128;for(var i=1;i<n;i++)r[i]=0;if(t<<=3,"big"===this.endian){for(var s=8;s<this.padLength;s++)r[i++]=0;r[i++]=0,r[i++]=0,r[i++]=0,r[i++]=0,r[i++]=t>>>24&255,r[i++]=t>>>16&255,r[i++]=t>>>8&255,r[i++]=255&t}else for(r[i++]=255&t,r[i++]=t>>>8&255,r[i++]=t>>>16&255,r[i++]=t>>>24&255,r[i++]=0,r[i++]=0,r[i++]=0,r[i++]=0,s=8;s<this.padLength;s++)r[i++]=0;return r}},4133:function(t,e,n){"use strict";var r=n(3610),i=n(4961);function s(t,e,n){if(!(this instanceof s))return new s(t,e,n);this.Hash=t,this.blockSize=t.blockSize/8,this.outSize=t.outSize/8,this.inner=null,this.outer=null,this._init(r.toArray(e,n))}t.exports=s,s.prototype._init=function(t){t.length>this.blockSize&&(t=(new this.Hash).update(t).digest()),i(t.length<=this.blockSize);for(var e=t.length;e<this.blockSize;e++)t.push(0);for(e=0;e<t.length;e++)t[e]^=54;for(this.inner=(new this.Hash).update(t),e=0;e<t.length;e++)t[e]^=106;this.outer=(new this.Hash).update(t)},s.prototype.update=function(t,e){return this.inner.update(t,e),this},s.prototype.digest=function(t){return this.outer.update(this.inner.digest()),this.outer.digest(t)}},97:function(t,e,n){"use strict";var r=n(3610),i=n(9291),s=r.rotl32,o=r.sum32,a=r.sum32_3,l=r.sum32_4,c=i.BlockHash;function u(){if(!(this instanceof u))return new u;c.call(this),this.h=[1732584193,4023233417,2562383102,271733878,3285377520],this.endian="little"}function h(t,e,n,r){return t<=15?e^n^r:t<=31?e&n|~e&r:t<=47?(e|~n)^r:t<=63?e&r|n&~r:e^(n|~r)}function d(t){return t<=15?0:t<=31?1518500249:t<=47?1859775393:t<=63?2400959708:2840853838}function f(t){return t<=15?1352829926:t<=31?1548603684:t<=47?1836072691:t<=63?2053994217:0}r.inherits(u,c),e.ripemd160=u,u.blockSize=512,u.outSize=160,u.hmacStrength=192,u.padLength=64,u.prototype._update=function(t,e){for(var n=this.h[0],r=this.h[1],i=this.h[2],c=this.h[3],u=this.h[4],y=n,x=r,b=i,w=c,_=u,M=0;M<80;M++){var A=o(s(l(n,h(M,r,i,c),t[p[M]+e],d(M)),g[M]),u);n=u,u=c,c=s(i,10),i=r,r=A,A=o(s(l(y,h(79-M,x,b,w),t[m[M]+e],f(M)),v[M]),_),y=_,_=w,w=s(b,10),b=x,x=A}A=a(this.h[1],i,w),this.h[1]=a(this.h[2],c,_),this.h[2]=a(this.h[3],u,y),this.h[3]=a(this.h[4],n,x),this.h[4]=a(this.h[0],r,b),this.h[0]=A},u.prototype._digest=function(t){return"hex"===t?r.toHex32(this.h,"little"):r.split32(this.h,"little")};var p=[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,7,4,13,1,10,6,15,3,12,0,9,5,2,14,11,8,3,10,14,4,9,15,8,1,2,7,0,6,13,11,5,12,1,9,11,10,0,8,12,4,13,3,7,15,14,5,6,2,4,0,5,9,7,12,2,10,14,1,3,8,11,6,15,13],m=[5,14,7,0,9,2,11,4,13,6,15,8,1,10,3,12,6,11,3,7,0,13,5,10,14,15,8,12,4,9,1,2,15,5,1,3,7,14,6,9,11,8,12,2,10,0,4,13,8,6,4,1,3,11,15,0,5,12,2,13,9,7,10,14,12,15,10,4,1,5,8,7,6,2,13,14,0,3,9,11],g=[11,14,15,12,5,8,7,9,11,13,14,15,6,7,9,8,7,6,8,13,11,9,7,15,7,12,15,9,11,7,13,12,11,13,6,7,14,9,13,15,14,8,13,6,5,12,7,5,11,12,14,15,14,15,9,8,9,14,5,6,8,6,5,12,9,15,5,11,6,8,13,12,5,12,13,14,11,8,5,6],v=[8,9,9,11,13,15,15,5,7,7,8,11,14,14,12,6,9,13,15,7,12,8,9,11,7,7,12,7,6,15,13,11,9,7,15,11,8,6,6,14,12,13,5,14,13,13,7,5,15,5,8,11,14,14,6,14,6,9,12,9,12,5,15,8,8,5,12,9,12,5,14,6,8,13,6,5,15,13,11,11]},2762:function(t,e,n){"use strict";e.sha1=n(1070),e.sha224=n(7031),e.sha256=n(7875),e.sha384=n(9118),e.sha512=n(2067)},1070:function(t,e,n){"use strict";var r=n(3610),i=n(9291),s=n(5366),o=r.rotl32,a=r.sum32,l=r.sum32_5,c=s.ft_1,u=i.BlockHash,h=[1518500249,1859775393,2400959708,3395469782];function d(){if(!(this instanceof d))return new d;u.call(this),this.h=[1732584193,4023233417,2562383102,271733878,3285377520],this.W=new Array(80)}r.inherits(d,u),t.exports=d,d.blockSize=512,d.outSize=160,d.hmacStrength=80,d.padLength=64,d.prototype._update=function(t,e){for(var n=this.W,r=0;r<16;r++)n[r]=t[e+r];for(;r<n.length;r++)n[r]=o(n[r-3]^n[r-8]^n[r-14]^n[r-16],1);var i=this.h[0],s=this.h[1],u=this.h[2],d=this.h[3],f=this.h[4];for(r=0;r<n.length;r++){var p=~~(r/20),m=l(o(i,5),c(p,s,u,d),f,n[r],h[p]);f=d,d=u,u=o(s,30),s=i,i=m}this.h[0]=a(this.h[0],i),this.h[1]=a(this.h[1],s),this.h[2]=a(this.h[2],u),this.h[3]=a(this.h[3],d),this.h[4]=a(this.h[4],f)},d.prototype._digest=function(t){return"hex"===t?r.toHex32(this.h,"big"):r.split32(this.h,"big")}},7031:function(t,e,n){"use strict";var r=n(3610),i=n(7875);function s(){if(!(this instanceof s))return new s;i.call(this),this.h=[3238371032,914150663,812702999,4144912697,4290775857,1750603025,1694076839,3204075428]}r.inherits(s,i),t.exports=s,s.blockSize=512,s.outSize=224,s.hmacStrength=192,s.padLength=64,s.prototype._digest=function(t){return"hex"===t?r.toHex32(this.h.slice(0,7),"big"):r.split32(this.h.slice(0,7),"big")}},7875:function(t,e,n){"use strict";var r=n(3610),i=n(9291),s=n(5366),o=n(4961),a=r.sum32,l=r.sum32_4,c=r.sum32_5,u=s.ch32,h=s.maj32,d=s.s0_256,f=s.s1_256,p=s.g0_256,m=s.g1_256,g=i.BlockHash,v=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298];function y(){if(!(this instanceof y))return new y;g.call(this),this.h=[1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225],this.k=v,this.W=new Array(64)}r.inherits(y,g),t.exports=y,y.blockSize=512,y.outSize=256,y.hmacStrength=192,y.padLength=64,y.prototype._update=function(t,e){for(var n=this.W,r=0;r<16;r++)n[r]=t[e+r];for(;r<n.length;r++)n[r]=l(m(n[r-2]),n[r-7],p(n[r-15]),n[r-16]);var i=this.h[0],s=this.h[1],g=this.h[2],v=this.h[3],y=this.h[4],x=this.h[5],b=this.h[6],w=this.h[7];for(o(this.k.length===n.length),r=0;r<n.length;r++){var _=c(w,f(y),u(y,x,b),this.k[r],n[r]),M=a(d(i),h(i,s,g));w=b,b=x,x=y,y=a(v,_),v=g,g=s,s=i,i=a(_,M)}this.h[0]=a(this.h[0],i),this.h[1]=a(this.h[1],s),this.h[2]=a(this.h[2],g),this.h[3]=a(this.h[3],v),this.h[4]=a(this.h[4],y),this.h[5]=a(this.h[5],x),this.h[6]=a(this.h[6],b),this.h[7]=a(this.h[7],w)},y.prototype._digest=function(t){return"hex"===t?r.toHex32(this.h,"big"):r.split32(this.h,"big")}},9118:function(t,e,n){"use strict";var r=n(3610),i=n(2067);function s(){if(!(this instanceof s))return new s;i.call(this),this.h=[3418070365,3238371032,1654270250,914150663,2438529370,812702999,355462360,4144912697,1731405415,4290775857,2394180231,1750603025,3675008525,1694076839,1203062813,3204075428]}r.inherits(s,i),t.exports=s,s.blockSize=1024,s.outSize=384,s.hmacStrength=192,s.padLength=128,s.prototype._digest=function(t){return"hex"===t?r.toHex32(this.h.slice(0,12),"big"):r.split32(this.h.slice(0,12),"big")}},2067:function(t,e,n){"use strict";var r=n(3610),i=n(9291),s=n(4961),o=r.rotr64_hi,a=r.rotr64_lo,l=r.shr64_hi,c=r.shr64_lo,u=r.sum64,h=r.sum64_hi,d=r.sum64_lo,f=r.sum64_4_hi,p=r.sum64_4_lo,m=r.sum64_5_hi,g=r.sum64_5_lo,v=i.BlockHash,y=[1116352408,3609767458,1899447441,602891725,3049323471,3964484399,3921009573,2173295548,961987163,4081628472,1508970993,3053834265,2453635748,2937671579,2870763221,3664609560,3624381080,2734883394,310598401,1164996542,607225278,1323610764,1426881987,3590304994,1925078388,4068182383,2162078206,991336113,2614888103,633803317,3248222580,3479774868,3835390401,2666613458,4022224774,944711139,264347078,2341262773,604807628,2007800933,770255983,1495990901,1249150122,1856431235,1555081692,3175218132,1996064986,2198950837,2554220882,3999719339,2821834349,766784016,2952996808,2566594879,3210313671,3203337956,3336571891,1034457026,3584528711,2466948901,113926993,3758326383,338241895,168717936,666307205,1188179964,773529912,1546045734,1294757372,1522805485,1396182291,2643833823,1695183700,2343527390,1986661051,1014477480,2177026350,1206759142,2456956037,344077627,2730485921,1290863460,2820302411,3158454273,3259730800,3505952657,3345764771,106217008,3516065817,3606008344,3600352804,1432725776,4094571909,1467031594,275423344,851169720,430227734,3100823752,506948616,1363258195,659060556,3750685593,883997877,3785050280,958139571,3318307427,1322822218,3812723403,1537002063,2003034995,1747873779,3602036899,1955562222,1575990012,2024104815,1125592928,2227730452,2716904306,2361852424,442776044,2428436474,593698344,2756734187,3733110249,3204031479,2999351573,3329325298,3815920427,3391569614,3928383900,3515267271,566280711,3940187606,3454069534,4118630271,4000239992,116418474,1914138554,174292421,2731055270,289380356,3203993006,460393269,320620315,685471733,587496836,852142971,1086792851,1017036298,365543100,1126000580,2618297676,1288033470,3409855158,1501505948,4234509866,1607167915,987167468,1816402316,1246189591];function x(){if(!(this instanceof x))return new x;v.call(this),this.h=[1779033703,4089235720,3144134277,2227873595,1013904242,4271175723,2773480762,1595750129,1359893119,2917565137,2600822924,725511199,528734635,4215389547,1541459225,327033209],this.k=y,this.W=new Array(160)}function b(t,e,n,r,i){var s=t&n^~t&i;return s<0&&(s+=4294967296),s}function w(t,e,n,r,i,s){var o=e&r^~e&s;return o<0&&(o+=4294967296),o}function _(t,e,n,r,i){var s=t&n^t&i^n&i;return s<0&&(s+=4294967296),s}function M(t,e,n,r,i,s){var o=e&r^e&s^r&s;return o<0&&(o+=4294967296),o}function A(t,e){var n=o(t,e,28),r=o(e,t,2),i=o(e,t,7),s=n^r^i;return s<0&&(s+=4294967296),s}function S(t,e){var n=a(t,e,28),r=a(e,t,2),i=a(e,t,7),s=n^r^i;return s<0&&(s+=4294967296),s}function E(t,e){var n=o(t,e,14),r=o(t,e,18),i=o(e,t,9),s=n^r^i;return s<0&&(s+=4294967296),s}function T(t,e){var n=a(t,e,14),r=a(t,e,18),i=a(e,t,9),s=n^r^i;return s<0&&(s+=4294967296),s}function C(t,e){var n=o(t,e,1),r=o(t,e,8),i=l(t,e,7),s=n^r^i;return s<0&&(s+=4294967296),s}function R(t,e){var n=a(t,e,1),r=a(t,e,8),i=c(t,e,7),s=n^r^i;return s<0&&(s+=4294967296),s}function I(t,e){var n=o(t,e,19),r=o(e,t,29),i=l(t,e,6),s=n^r^i;return s<0&&(s+=4294967296),s}function P(t,e){var n=a(t,e,19),r=a(e,t,29),i=c(t,e,6),s=n^r^i;return s<0&&(s+=4294967296),s}r.inherits(x,v),t.exports=x,x.blockSize=1024,x.outSize=512,x.hmacStrength=192,x.padLength=128,x.prototype._prepareBlock=function(t,e){for(var n=this.W,r=0;r<32;r++)n[r]=t[e+r];for(;r<n.length;r+=2){var i=I(n[r-4],n[r-3]),s=P(n[r-4],n[r-3]),o=n[r-14],a=n[r-13],l=C(n[r-30],n[r-29]),c=R(n[r-30],n[r-29]),u=n[r-32],h=n[r-31];n[r]=f(i,s,o,a,l,c,u,h),n[r+1]=p(i,s,o,a,l,c,u,h)}},x.prototype._update=function(t,e){this._prepareBlock(t,e);var n=this.W,r=this.h[0],i=this.h[1],o=this.h[2],a=this.h[3],l=this.h[4],c=this.h[5],f=this.h[6],p=this.h[7],v=this.h[8],y=this.h[9],x=this.h[10],C=this.h[11],R=this.h[12],I=this.h[13],P=this.h[14],L=this.h[15];s(this.k.length===n.length);for(var N=0;N<n.length;N+=2){var k=P,O=L,D=E(v,y),z=T(v,y),F=b(v,y,x,C,R,I),U=w(v,y,x,C,R,I),B=this.k[N],G=this.k[N+1],H=n[N],V=n[N+1],j=m(k,O,D,z,F,U,B,G,H,V),W=g(k,O,D,z,F,U,B,G,H,V);k=A(r,i),O=S(r,i),D=_(r,i,o,a,l,c),z=M(r,i,o,a,l,c);var q=h(k,O,D,z),Y=d(k,O,D,z);P=R,L=I,R=x,I=C,x=v,C=y,v=h(f,p,j,W),y=d(p,p,j,W),f=l,p=c,l=o,c=a,o=r,a=i,r=h(j,W,q,Y),i=d(j,W,q,Y)}u(this.h,0,r,i),u(this.h,2,o,a),u(this.h,4,l,c),u(this.h,6,f,p),u(this.h,8,v,y),u(this.h,10,x,C),u(this.h,12,R,I),u(this.h,14,P,L)},x.prototype._digest=function(t){return"hex"===t?r.toHex32(this.h,"big"):r.split32(this.h,"big")}},5366:function(t,e,n){"use strict";var r=n(3610),i=r.rotr32;function s(t,e,n,r){return 0===t?o(e,n,r):1===t||3===t?l(e,n,r):2===t?a(e,n,r):void 0}function o(t,e,n){return t&e^~t&n}function a(t,e,n){return t&e^t&n^e&n}function l(t,e,n){return t^e^n}function c(t){return i(t,2)^i(t,13)^i(t,22)}function u(t){return i(t,6)^i(t,11)^i(t,25)}function h(t){return i(t,7)^i(t,18)^t>>>3}function d(t){return i(t,17)^i(t,19)^t>>>10}e.ft_1=s,e.ch32=o,e.maj32=a,e.p32=l,e.s0_256=c,e.s1_256=u,e.g0_256=h,e.g1_256=d},3610:function(t,e,n){"use strict";var r=n(4961),i=n(1923);function s(t,e){return 55296===(64512&t.charCodeAt(e))&&(!(e<0||e+1>=t.length)&&56320===(64512&t.charCodeAt(e+1)))}function o(t,e){if(Array.isArray(t))return t.slice();if(!t)return[];var n=[];if("string"===typeof t)if(e){if("hex"===e)for(t=t.replace(/[^a-z0-9]+/gi,""),t.length%2!==0&&(t="0"+t),i=0;i<t.length;i+=2)n.push(parseInt(t[i]+t[i+1],16))}else for(var r=0,i=0;i<t.length;i++){var o=t.charCodeAt(i);o<128?n[r++]=o:o<2048?(n[r++]=o>>6|192,n[r++]=63&o|128):s(t,i)?(o=65536+((1023&o)<<10)+(1023&t.charCodeAt(++i)),n[r++]=o>>18|240,n[r++]=o>>12&63|128,n[r++]=o>>6&63|128,n[r++]=63&o|128):(n[r++]=o>>12|224,n[r++]=o>>6&63|128,n[r++]=63&o|128)}else for(i=0;i<t.length;i++)n[i]=0|t[i];return n}function a(t){for(var e="",n=0;n<t.length;n++)e+=u(t[n].toString(16));return e}function l(t){var e=t>>>24|t>>>8&65280|t<<8&16711680|(255&t)<<24;return e>>>0}function c(t,e){for(var n="",r=0;r<t.length;r++){var i=t[r];"little"===e&&(i=l(i)),n+=h(i.toString(16))}return n}function u(t){return 1===t.length?"0"+t:t}function h(t){return 7===t.length?"0"+t:6===t.length?"00"+t:5===t.length?"000"+t:4===t.length?"0000"+t:3===t.length?"00000"+t:2===t.length?"000000"+t:1===t.length?"0000000"+t:t}function d(t,e,n,i){var s=n-e;r(s%4===0);for(var o=new Array(s/4),a=0,l=e;a<o.length;a++,l+=4){var c;c="big"===i?t[l]<<24|t[l+1]<<16|t[l+2]<<8|t[l+3]:t[l+3]<<24|t[l+2]<<16|t[l+1]<<8|t[l],o[a]=c>>>0}return o}function f(t,e){for(var n=new Array(4*t.length),r=0,i=0;r<t.length;r++,i+=4){var s=t[r];"big"===e?(n[i]=s>>>24,n[i+1]=s>>>16&255,n[i+2]=s>>>8&255,n[i+3]=255&s):(n[i+3]=s>>>24,n[i+2]=s>>>16&255,n[i+1]=s>>>8&255,n[i]=255&s)}return n}function p(t,e){return t>>>e|t<<32-e}function m(t,e){return t<<e|t>>>32-e}function g(t,e){return t+e>>>0}function v(t,e,n){return t+e+n>>>0}function y(t,e,n,r){return t+e+n+r>>>0}function x(t,e,n,r,i){return t+e+n+r+i>>>0}function b(t,e,n,r){var i=t[e],s=t[e+1],o=r+s>>>0,a=(o<r?1:0)+n+i;t[e]=a>>>0,t[e+1]=o}function w(t,e,n,r){var i=e+r>>>0,s=(i<e?1:0)+t+n;return s>>>0}function _(t,e,n,r){var i=e+r;return i>>>0}function M(t,e,n,r,i,s,o,a){var l=0,c=e;c=c+r>>>0,l+=c<e?1:0,c=c+s>>>0,l+=c<s?1:0,c=c+a>>>0,l+=c<a?1:0;var u=t+n+i+o+l;return u>>>0}function A(t,e,n,r,i,s,o,a){var l=e+r+s+a;return l>>>0}function S(t,e,n,r,i,s,o,a,l,c){var u=0,h=e;h=h+r>>>0,u+=h<e?1:0,h=h+s>>>0,u+=h<s?1:0,h=h+a>>>0,u+=h<a?1:0,h=h+c>>>0,u+=h<c?1:0;var d=t+n+i+o+l+u;return d>>>0}function E(t,e,n,r,i,s,o,a,l,c){var u=e+r+s+a+c;return u>>>0}function T(t,e,n){var r=e<<32-n|t>>>n;return r>>>0}function C(t,e,n){var r=t<<32-n|e>>>n;return r>>>0}function R(t,e,n){return t>>>n}function I(t,e,n){var r=t<<32-n|e>>>n;return r>>>0}e.inherits=i,e.toArray=o,e.toHex=a,e.htonl=l,e.toHex32=c,e.zero2=u,e.zero8=h,e.join32=d,e.split32=f,e.rotr32=p,e.rotl32=m,e.sum32=g,e.sum32_3=v,e.sum32_4=y,e.sum32_5=x,e.sum64=b,e.sum64_hi=w,e.sum64_lo=_,e.sum64_4_hi=M,e.sum64_4_lo=A,e.sum64_5_hi=S,e.sum64_5_lo=E,e.rotr64_hi=T,e.rotr64_lo=C,e.shr64_hi=R,e.shr64_lo=I},1923:function(t){"function"===typeof Object.create?t.exports=function(t,e){e&&(t.super_=e,t.prototype=Object.create(e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}))}:t.exports=function(t,e){if(e){t.super_=e;var n=function(){};n.prototype=e.prototype,t.prototype=new n,t.prototype.constructor=t}}},9893:function(t,e,n){var r;n(1703),n(8675),n(7380),n(1118),
/**
 * [js-sha3]{@link https://github.com/emn178/js-sha3}
 *
 * @version 0.8.0
 * @author Chen, Yi-Cyuan [emn178@gmail.com]
 * @copyright Chen, Yi-Cyuan 2015-2018
 * @license MIT
 */
function(){"use strict";var i="input is invalid type",s="finalize already called",o="object"===typeof window,a=o?window:{};a.JS_SHA3_NO_WINDOW&&(o=!1);var l=!o&&"object"===typeof self,c=!a.JS_SHA3_NO_NODE_JS&&"object"===typeof process&&process.versions&&process.versions.node;c?a=n.g:l&&(a=self);var u=!a.JS_SHA3_NO_COMMON_JS&&t.exports,h=n.amdO,d=!a.JS_SHA3_NO_ARRAY_BUFFER&&"undefined"!==typeof ArrayBuffer,f="0123456789abcdef".split(""),p=[31,7936,2031616,520093696],m=[4,1024,262144,67108864],g=[1,256,65536,16777216],v=[6,1536,393216,100663296],y=[0,8,16,24],x=[1,0,32898,0,32906,2147483648,2147516416,2147483648,32907,0,2147483649,0,2147516545,2147483648,32777,2147483648,138,0,136,0,2147516425,0,2147483658,0,2147516555,0,139,2147483648,32905,2147483648,32771,2147483648,32770,2147483648,128,2147483648,32778,0,2147483658,2147483648,2147516545,2147483648,32896,2147483648,2147483649,0,2147516424,2147483648],b=[224,256,384,512],w=[128,256],_=["hex","buffer","arrayBuffer","array","digest"],M={128:168,256:136};!a.JS_SHA3_NO_NODE_JS&&Array.isArray||(Array.isArray=function(t){return"[object Array]"===Object.prototype.toString.call(t)}),!d||!a.JS_SHA3_NO_ARRAY_BUFFER_IS_VIEW&&ArrayBuffer.isView||(ArrayBuffer.isView=function(t){return"object"===typeof t&&t.buffer&&t.buffer.constructor===ArrayBuffer});for(var A=function(t,e,n){return function(r){return new H(t,e,t).update(r)[n]()}},S=function(t,e,n){return function(r,i){return new H(t,e,i).update(r)[n]()}},E=function(t,e,n){return function(e,r,i,s){return k["cshake"+t].update(e,r,i,s)[n]()}},T=function(t,e,n){return function(e,r,i,s){return k["kmac"+t].update(e,r,i,s)[n]()}},C=function(t,e,n,r){for(var i=0;i<_.length;++i){var s=_[i];t[s]=e(n,r,s)}return t},R=function(t,e){var n=A(t,e,"hex");return n.create=function(){return new H(t,e,t)},n.update=function(t){return n.create().update(t)},C(n,A,t,e)},I=function(t,e){var n=S(t,e,"hex");return n.create=function(n){return new H(t,e,n)},n.update=function(t,e){return n.create(e).update(t)},C(n,S,t,e)},P=function(t,e){var n=M[t],r=E(t,e,"hex");return r.create=function(r,i,s){return i||s?new H(t,e,r).bytepad([i,s],n):k["shake"+t].create(r)},r.update=function(t,e,n,i){return r.create(e,n,i).update(t)},C(r,E,t,e)},L=function(t,e){var n=M[t],r=T(t,e,"hex");return r.create=function(r,i,s){return new V(t,e,i).bytepad(["KMAC",s],n).bytepad([r],n)},r.update=function(t,e,n,i){return r.create(t,n,i).update(e)},C(r,T,t,e)},N=[{name:"keccak",padding:g,bits:b,createMethod:R},{name:"sha3",padding:v,bits:b,createMethod:R},{name:"shake",padding:p,bits:w,createMethod:I},{name:"cshake",padding:m,bits:w,createMethod:P},{name:"kmac",padding:m,bits:w,createMethod:L}],k={},O=[],D=0;D<N.length;++D)for(var z=N[D],F=z.bits,U=0;U<F.length;++U){var B=z.name+"_"+F[U];if(O.push(B),k[B]=z.createMethod(F[U],z.padding),"sha3"!==z.name){var G=z.name+F[U];O.push(G),k[G]=k[B]}}function H(t,e,n){this.blocks=[],this.s=[],this.padding=e,this.outputBits=n,this.reset=!0,this.finalized=!1,this.block=0,this.start=0,this.blockCount=1600-(t<<1)>>5,this.byteCount=this.blockCount<<2,this.outputBlocks=n>>5,this.extraBytes=(31&n)>>3;for(var r=0;r<50;++r)this.s[r]=0}function V(t,e,n){H.call(this,t,e,n)}H.prototype.update=function(t){if(this.finalized)throw new Error(s);var e,n=typeof t;if("string"!==n){if("object"!==n)throw new Error(i);if(null===t)throw new Error(i);if(d&&t.constructor===ArrayBuffer)t=new Uint8Array(t);else if(!Array.isArray(t)&&(!d||!ArrayBuffer.isView(t)))throw new Error(i);e=!0}var r,o,a=this.blocks,l=this.byteCount,c=t.length,u=this.blockCount,h=0,f=this.s;while(h<c){if(this.reset)for(this.reset=!1,a[0]=this.block,r=1;r<u+1;++r)a[r]=0;if(e)for(r=this.start;h<c&&r<l;++h)a[r>>2]|=t[h]<<y[3&r++];else for(r=this.start;h<c&&r<l;++h)o=t.charCodeAt(h),o<128?a[r>>2]|=o<<y[3&r++]:o<2048?(a[r>>2]|=(192|o>>6)<<y[3&r++],a[r>>2]|=(128|63&o)<<y[3&r++]):o<55296||o>=57344?(a[r>>2]|=(224|o>>12)<<y[3&r++],a[r>>2]|=(128|o>>6&63)<<y[3&r++],a[r>>2]|=(128|63&o)<<y[3&r++]):(o=65536+((1023&o)<<10|1023&t.charCodeAt(++h)),a[r>>2]|=(240|o>>18)<<y[3&r++],a[r>>2]|=(128|o>>12&63)<<y[3&r++],a[r>>2]|=(128|o>>6&63)<<y[3&r++],a[r>>2]|=(128|63&o)<<y[3&r++]);if(this.lastByteIndex=r,r>=l){for(this.start=r-l,this.block=a[u],r=0;r<u;++r)f[r]^=a[r];j(f),this.reset=!0}else this.start=r}return this},H.prototype.encode=function(t,e){var n=255&t,r=1,i=[n];t>>=8,n=255&t;while(n>0)i.unshift(n),t>>=8,n=255&t,++r;return e?i.push(r):i.unshift(r),this.update(i),i.length},H.prototype.encodeString=function(t){var e,n=typeof t;if("string"!==n){if("object"!==n)throw new Error(i);if(null===t)throw new Error(i);if(d&&t.constructor===ArrayBuffer)t=new Uint8Array(t);else if(!Array.isArray(t)&&(!d||!ArrayBuffer.isView(t)))throw new Error(i);e=!0}var r=0,s=t.length;if(e)r=s;else for(var o=0;o<t.length;++o){var a=t.charCodeAt(o);a<128?r+=1:a<2048?r+=2:a<55296||a>=57344?r+=3:(a=65536+((1023&a)<<10|1023&t.charCodeAt(++o)),r+=4)}return r+=this.encode(8*r),this.update(t),r},H.prototype.bytepad=function(t,e){for(var n=this.encode(e),r=0;r<t.length;++r)n+=this.encodeString(t[r]);var i=e-n%e,s=[];return s.length=i,this.update(s),this},H.prototype.finalize=function(){if(!this.finalized){this.finalized=!0;var t=this.blocks,e=this.lastByteIndex,n=this.blockCount,r=this.s;if(t[e>>2]|=this.padding[3&e],this.lastByteIndex===this.byteCount)for(t[0]=t[n],e=1;e<n+1;++e)t[e]=0;for(t[n-1]|=2147483648,e=0;e<n;++e)r[e]^=t[e];j(r)}},H.prototype.toString=H.prototype.hex=function(){this.finalize();var t,e=this.blockCount,n=this.s,r=this.outputBlocks,i=this.extraBytes,s=0,o=0,a="";while(o<r){for(s=0;s<e&&o<r;++s,++o)t=n[s],a+=f[t>>4&15]+f[15&t]+f[t>>12&15]+f[t>>8&15]+f[t>>20&15]+f[t>>16&15]+f[t>>28&15]+f[t>>24&15];o%e===0&&(j(n),s=0)}return i&&(t=n[s],a+=f[t>>4&15]+f[15&t],i>1&&(a+=f[t>>12&15]+f[t>>8&15]),i>2&&(a+=f[t>>20&15]+f[t>>16&15])),a},H.prototype.arrayBuffer=function(){this.finalize();var t,e=this.blockCount,n=this.s,r=this.outputBlocks,i=this.extraBytes,s=0,o=0,a=this.outputBits>>3;t=i?new ArrayBuffer(r+1<<2):new ArrayBuffer(a);var l=new Uint32Array(t);while(o<r){for(s=0;s<e&&o<r;++s,++o)l[o]=n[s];o%e===0&&j(n)}return i&&(l[s]=n[s],t=t.slice(0,a)),t},H.prototype.buffer=H.prototype.arrayBuffer,H.prototype.digest=H.prototype.array=function(){this.finalize();var t,e,n=this.blockCount,r=this.s,i=this.outputBlocks,s=this.extraBytes,o=0,a=0,l=[];while(a<i){for(o=0;o<n&&a<i;++o,++a)t=a<<2,e=r[o],l[t]=255&e,l[t+1]=e>>8&255,l[t+2]=e>>16&255,l[t+3]=e>>24&255;a%n===0&&j(r)}return s&&(t=a<<2,e=r[o],l[t]=255&e,s>1&&(l[t+1]=e>>8&255),s>2&&(l[t+2]=e>>16&255)),l},V.prototype=new H,V.prototype.finalize=function(){return this.encode(this.outputBits,!0),H.prototype.finalize.call(this)};var j=function(t){var e,n,r,i,s,o,a,l,c,u,h,d,f,p,m,g,v,y,b,w,_,M,A,S,E,T,C,R,I,P,L,N,k,O,D,z,F,U,B,G,H,V,j,W,q,Y,X,J,K,Z,Q,$,tt,et,nt,rt,it,st,ot,at,lt,ct,ut;for(r=0;r<48;r+=2)i=t[0]^t[10]^t[20]^t[30]^t[40],s=t[1]^t[11]^t[21]^t[31]^t[41],o=t[2]^t[12]^t[22]^t[32]^t[42],a=t[3]^t[13]^t[23]^t[33]^t[43],l=t[4]^t[14]^t[24]^t[34]^t[44],c=t[5]^t[15]^t[25]^t[35]^t[45],u=t[6]^t[16]^t[26]^t[36]^t[46],h=t[7]^t[17]^t[27]^t[37]^t[47],d=t[8]^t[18]^t[28]^t[38]^t[48],f=t[9]^t[19]^t[29]^t[39]^t[49],e=d^(o<<1|a>>>31),n=f^(a<<1|o>>>31),t[0]^=e,t[1]^=n,t[10]^=e,t[11]^=n,t[20]^=e,t[21]^=n,t[30]^=e,t[31]^=n,t[40]^=e,t[41]^=n,e=i^(l<<1|c>>>31),n=s^(c<<1|l>>>31),t[2]^=e,t[3]^=n,t[12]^=e,t[13]^=n,t[22]^=e,t[23]^=n,t[32]^=e,t[33]^=n,t[42]^=e,t[43]^=n,e=o^(u<<1|h>>>31),n=a^(h<<1|u>>>31),t[4]^=e,t[5]^=n,t[14]^=e,t[15]^=n,t[24]^=e,t[25]^=n,t[34]^=e,t[35]^=n,t[44]^=e,t[45]^=n,e=l^(d<<1|f>>>31),n=c^(f<<1|d>>>31),t[6]^=e,t[7]^=n,t[16]^=e,t[17]^=n,t[26]^=e,t[27]^=n,t[36]^=e,t[37]^=n,t[46]^=e,t[47]^=n,e=u^(i<<1|s>>>31),n=h^(s<<1|i>>>31),t[8]^=e,t[9]^=n,t[18]^=e,t[19]^=n,t[28]^=e,t[29]^=n,t[38]^=e,t[39]^=n,t[48]^=e,t[49]^=n,p=t[0],m=t[1],Y=t[11]<<4|t[10]>>>28,X=t[10]<<4|t[11]>>>28,R=t[20]<<3|t[21]>>>29,I=t[21]<<3|t[20]>>>29,at=t[31]<<9|t[30]>>>23,lt=t[30]<<9|t[31]>>>23,V=t[40]<<18|t[41]>>>14,j=t[41]<<18|t[40]>>>14,O=t[2]<<1|t[3]>>>31,D=t[3]<<1|t[2]>>>31,g=t[13]<<12|t[12]>>>20,v=t[12]<<12|t[13]>>>20,J=t[22]<<10|t[23]>>>22,K=t[23]<<10|t[22]>>>22,P=t[33]<<13|t[32]>>>19,L=t[32]<<13|t[33]>>>19,ct=t[42]<<2|t[43]>>>30,ut=t[43]<<2|t[42]>>>30,et=t[5]<<30|t[4]>>>2,nt=t[4]<<30|t[5]>>>2,z=t[14]<<6|t[15]>>>26,F=t[15]<<6|t[14]>>>26,y=t[25]<<11|t[24]>>>21,b=t[24]<<11|t[25]>>>21,Z=t[34]<<15|t[35]>>>17,Q=t[35]<<15|t[34]>>>17,N=t[45]<<29|t[44]>>>3,k=t[44]<<29|t[45]>>>3,S=t[6]<<28|t[7]>>>4,E=t[7]<<28|t[6]>>>4,rt=t[17]<<23|t[16]>>>9,it=t[16]<<23|t[17]>>>9,U=t[26]<<25|t[27]>>>7,B=t[27]<<25|t[26]>>>7,w=t[36]<<21|t[37]>>>11,_=t[37]<<21|t[36]>>>11,$=t[47]<<24|t[46]>>>8,tt=t[46]<<24|t[47]>>>8,W=t[8]<<27|t[9]>>>5,q=t[9]<<27|t[8]>>>5,T=t[18]<<20|t[19]>>>12,C=t[19]<<20|t[18]>>>12,st=t[29]<<7|t[28]>>>25,ot=t[28]<<7|t[29]>>>25,G=t[38]<<8|t[39]>>>24,H=t[39]<<8|t[38]>>>24,M=t[48]<<14|t[49]>>>18,A=t[49]<<14|t[48]>>>18,t[0]=p^~g&y,t[1]=m^~v&b,t[10]=S^~T&R,t[11]=E^~C&I,t[20]=O^~z&U,t[21]=D^~F&B,t[30]=W^~Y&J,t[31]=q^~X&K,t[40]=et^~rt&st,t[41]=nt^~it&ot,t[2]=g^~y&w,t[3]=v^~b&_,t[12]=T^~R&P,t[13]=C^~I&L,t[22]=z^~U&G,t[23]=F^~B&H,t[32]=Y^~J&Z,t[33]=X^~K&Q,t[42]=rt^~st&at,t[43]=it^~ot&lt,t[4]=y^~w&M,t[5]=b^~_&A,t[14]=R^~P&N,t[15]=I^~L&k,t[24]=U^~G&V,t[25]=B^~H&j,t[34]=J^~Z&$,t[35]=K^~Q&tt,t[44]=st^~at&ct,t[45]=ot^~lt&ut,t[6]=w^~M&p,t[7]=_^~A&m,t[16]=P^~N&S,t[17]=L^~k&E,t[26]=G^~V&O,t[27]=H^~j&D,t[36]=Z^~$&W,t[37]=Q^~tt&q,t[46]=at^~ct&et,t[47]=lt^~ut&nt,t[8]=M^~p&g,t[9]=A^~m&v,t[18]=N^~S&T,t[19]=k^~E&C,t[28]=V^~O&z,t[29]=j^~D&F,t[38]=$^~W&Y,t[39]=tt^~q&X,t[48]=ct^~et&rt,t[49]=ut^~nt&it,t[0]^=x[r],t[1]^=x[r+1]};if(u)t.exports=k;else{for(D=0;D<O.length;++D)a[O[D]]=k[O[D]];h&&(r=function(){return k}.call(e,n,e,t),void 0===r||(t.exports=r))}}()},4961:function(t,e,n){function r(t,e){if(!t)throw new Error(e||"Assertion failed")}n(1703),t.exports=r,r.equal=function(t,e,n){if(t!=e)throw new Error(n||"Assertion failed: "+t+" != "+e)}},1262:function(t,e,n){"use strict";n.d(e,{zW:function(){return g_}});n(8675),n(7380),n(1118),n(1703),n(2262),n(4506),n(2087);var r=n(3396),i=n(7139);
/**
 * @license
 * Copyright 2010-2022 Three.js Authors
 * SPDX-License-Identifier: MIT
 */
const s="141",o={LEFT:0,MIDDLE:1,RIGHT:2,ROTATE:0,DOLLY:1,PAN:2},a={ROTATE:0,PAN:1,DOLLY_PAN:2,DOLLY_ROTATE:3},l=0,c=1,u=2,h=3,d=0,f=1,p=2,m=3,g=0,v=1,y=2,x=1,b=2,w=0,_=1,M=2,A=3,S=4,E=5,T=100,C=101,R=102,I=103,P=104,L=200,N=201,k=202,O=203,D=204,z=205,F=206,U=207,B=208,G=209,H=210,V=0,j=1,W=2,q=3,Y=4,X=5,J=6,K=7,Z=0,Q=1,$=2,tt=0,et=1,nt=2,rt=3,it=4,st=5,ot=300,at=301,lt=302,ct=303,ut=304,ht=306,dt=1e3,ft=1001,pt=1002,mt=1003,gt=1004,vt=1004,yt=1005,xt=1005,bt=1006,wt=1007,_t=1007,Mt=1008,At=1008,St=1009,Et=1010,Tt=1011,Ct=1012,Rt=1013,It=1014,Pt=1015,Lt=1016,Nt=1017,kt=1018,Ot=1020,Dt=1021,zt=1022,Ft=1023,Ut=1024,Bt=1025,Gt=1026,Ht=1027,Vt=1028,jt=1029,Wt=1030,qt=1031,Yt=1033,Xt=33776,Jt=33777,Kt=33778,Zt=33779,Qt=35840,$t=35841,te=35842,ee=35843,ne=36196,re=37492,ie=37496,se=37808,oe=37809,ae=37810,le=37811,ce=37812,ue=37813,he=37814,de=37815,fe=37816,pe=37817,me=37818,ge=37819,ve=37820,ye=37821,xe=36492,be=2200,we=2201,_e=2202,Me=2300,Ae=2301,Se=2302,Ee=2400,Te=2401,Ce=2402,Re=2500,Ie=2501,Pe=0,Le=1,Ne=2,ke=3e3,Oe=3001,De=3200,ze=3201,Fe=0,Ue=1,Be="",Ge="srgb",He="srgb-linear",Ve=0,je=7680,We=7681,qe=7682,Ye=7683,Xe=34055,Je=34056,Ke=5386,Ze=512,Qe=513,$e=514,tn=515,en=516,nn=517,rn=518,sn=519,on=35044,an=35048,ln=35040,cn=35045,un=35049,hn=35041,dn=35046,fn=35050,pn=35042,mn="100",gn="300 es",vn=1035;class yn{addEventListener(t,e){void 0===this._listeners&&(this._listeners={});const n=this._listeners;void 0===n[t]&&(n[t]=[]),-1===n[t].indexOf(e)&&n[t].push(e)}hasEventListener(t,e){if(void 0===this._listeners)return!1;const n=this._listeners;return void 0!==n[t]&&-1!==n[t].indexOf(e)}removeEventListener(t,e){if(void 0===this._listeners)return;const n=this._listeners,r=n[t];if(void 0!==r){const t=r.indexOf(e);-1!==t&&r.splice(t,1)}}dispatchEvent(t){if(void 0===this._listeners)return;const e=this._listeners,n=e[t.type];if(void 0!==n){t.target=this;const e=n.slice(0);for(let n=0,r=e.length;n<r;n++)e[n].call(this,t);t.target=null}}}const xn=[];for(let y_=0;y_<256;y_++)xn[y_]=(y_<16?"0":"")+y_.toString(16);let bn=1234567;const wn=Math.PI/180,_n=180/Math.PI;function Mn(){const t=4294967295*Math.random()|0,e=4294967295*Math.random()|0,n=4294967295*Math.random()|0,r=4294967295*Math.random()|0,i=xn[255&t]+xn[t>>8&255]+xn[t>>16&255]+xn[t>>24&255]+"-"+xn[255&e]+xn[e>>8&255]+"-"+xn[e>>16&15|64]+xn[e>>24&255]+"-"+xn[63&n|128]+xn[n>>8&255]+"-"+xn[n>>16&255]+xn[n>>24&255]+xn[255&r]+xn[r>>8&255]+xn[r>>16&255]+xn[r>>24&255];return i.toLowerCase()}function An(t,e,n){return Math.max(e,Math.min(n,t))}function Sn(t,e){return(t%e+e)%e}function En(t,e,n,r,i){return r+(t-e)*(i-r)/(n-e)}function Tn(t,e,n){return t!==e?(n-t)/(e-t):0}function Cn(t,e,n){return(1-n)*t+n*e}function Rn(t,e,n,r){return Cn(t,e,1-Math.exp(-n*r))}function In(t,e=1){return e-Math.abs(Sn(t,2*e)-e)}function Pn(t,e,n){return t<=e?0:t>=n?1:(t=(t-e)/(n-e),t*t*(3-2*t))}function Ln(t,e,n){return t<=e?0:t>=n?1:(t=(t-e)/(n-e),t*t*t*(t*(6*t-15)+10))}function Nn(t,e){return t+Math.floor(Math.random()*(e-t+1))}function kn(t,e){return t+Math.random()*(e-t)}function On(t){return t*(.5-Math.random())}function Dn(t){void 0!==t&&(bn=t);let e=bn+=1831565813;return e=Math.imul(e^e>>>15,1|e),e^=e+Math.imul(e^e>>>7,61|e),((e^e>>>14)>>>0)/4294967296}function zn(t){return t*wn}function Fn(t){return t*_n}function Un(t){return 0===(t&t-1)&&0!==t}function Bn(t){return Math.pow(2,Math.ceil(Math.log(t)/Math.LN2))}function Gn(t){return Math.pow(2,Math.floor(Math.log(t)/Math.LN2))}function Hn(t,e,n,r,i){const s=Math.cos,o=Math.sin,a=s(n/2),l=o(n/2),c=s((e+r)/2),u=o((e+r)/2),h=s((e-r)/2),d=o((e-r)/2),f=s((r-e)/2),p=o((r-e)/2);switch(i){case"XYX":t.set(a*u,l*h,l*d,a*c);break;case"YZY":t.set(l*d,a*u,l*h,a*c);break;case"ZXZ":t.set(l*h,l*d,a*u,a*c);break;case"XZX":t.set(a*u,l*p,l*f,a*c);break;case"YXY":t.set(l*f,a*u,l*p,a*c);break;case"ZYZ":t.set(l*p,l*f,a*u,a*c);break;default:console.warn("THREE.MathUtils: .setQuaternionFromProperEuler() encountered an unknown order: "+i)}}function Vn(t,e){switch(e.constructor){case Float32Array:return t;case Uint16Array:return t/65535;case Uint8Array:return t/255;case Int16Array:return Math.max(t/32767,-1);case Int8Array:return Math.max(t/127,-1);default:throw new Error("Invalid component type.")}}function jn(t,e){switch(e.constructor){case Float32Array:return t;case Uint16Array:return Math.round(65535*t);case Uint8Array:return Math.round(255*t);case Int16Array:return Math.round(32767*t);case Int8Array:return Math.round(127*t);default:throw new Error("Invalid component type.")}}var Wn=Object.freeze({__proto__:null,DEG2RAD:wn,RAD2DEG:_n,generateUUID:Mn,clamp:An,euclideanModulo:Sn,mapLinear:En,inverseLerp:Tn,lerp:Cn,damp:Rn,pingpong:In,smoothstep:Pn,smootherstep:Ln,randInt:Nn,randFloat:kn,randFloatSpread:On,seededRandom:Dn,degToRad:zn,radToDeg:Fn,isPowerOfTwo:Un,ceilPowerOfTwo:Bn,floorPowerOfTwo:Gn,setQuaternionFromProperEuler:Hn,normalize:jn,denormalize:Vn});class qn{constructor(t=0,e=0){this.isVector2=!0,this.x=t,this.y=e}get width(){return this.x}set width(t){this.x=t}get height(){return this.y}set height(t){this.y=t}set(t,e){return this.x=t,this.y=e,this}setScalar(t){return this.x=t,this.y=t,this}setX(t){return this.x=t,this}setY(t){return this.y=t,this}setComponent(t,e){switch(t){case 0:this.x=e;break;case 1:this.y=e;break;default:throw new Error("index is out of range: "+t)}return this}getComponent(t){switch(t){case 0:return this.x;case 1:return this.y;default:throw new Error("index is out of range: "+t)}}clone(){return new this.constructor(this.x,this.y)}copy(t){return this.x=t.x,this.y=t.y,this}add(t,e){return void 0!==e?(console.warn("THREE.Vector2: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(t,e)):(this.x+=t.x,this.y+=t.y,this)}addScalar(t){return this.x+=t,this.y+=t,this}addVectors(t,e){return this.x=t.x+e.x,this.y=t.y+e.y,this}addScaledVector(t,e){return this.x+=t.x*e,this.y+=t.y*e,this}sub(t,e){return void 0!==e?(console.warn("THREE.Vector2: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(t,e)):(this.x-=t.x,this.y-=t.y,this)}subScalar(t){return this.x-=t,this.y-=t,this}subVectors(t,e){return this.x=t.x-e.x,this.y=t.y-e.y,this}multiply(t){return this.x*=t.x,this.y*=t.y,this}multiplyScalar(t){return this.x*=t,this.y*=t,this}divide(t){return this.x/=t.x,this.y/=t.y,this}divideScalar(t){return this.multiplyScalar(1/t)}applyMatrix3(t){const e=this.x,n=this.y,r=t.elements;return this.x=r[0]*e+r[3]*n+r[6],this.y=r[1]*e+r[4]*n+r[7],this}min(t){return this.x=Math.min(this.x,t.x),this.y=Math.min(this.y,t.y),this}max(t){return this.x=Math.max(this.x,t.x),this.y=Math.max(this.y,t.y),this}clamp(t,e){return this.x=Math.max(t.x,Math.min(e.x,this.x)),this.y=Math.max(t.y,Math.min(e.y,this.y)),this}clampScalar(t,e){return this.x=Math.max(t,Math.min(e,this.x)),this.y=Math.max(t,Math.min(e,this.y)),this}clampLength(t,e){const n=this.length();return this.divideScalar(n||1).multiplyScalar(Math.max(t,Math.min(e,n)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}roundToZero(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this}negate(){return this.x=-this.x,this.y=-this.y,this}dot(t){return this.x*t.x+this.y*t.y}cross(t){return this.x*t.y-this.y*t.x}lengthSq(){return this.x*this.x+this.y*this.y}length(){return Math.sqrt(this.x*this.x+this.y*this.y)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)}normalize(){return this.divideScalar(this.length()||1)}angle(){const t=Math.atan2(-this.y,-this.x)+Math.PI;return t}distanceTo(t){return Math.sqrt(this.distanceToSquared(t))}distanceToSquared(t){const e=this.x-t.x,n=this.y-t.y;return e*e+n*n}manhattanDistanceTo(t){return Math.abs(this.x-t.x)+Math.abs(this.y-t.y)}setLength(t){return this.normalize().multiplyScalar(t)}lerp(t,e){return this.x+=(t.x-this.x)*e,this.y+=(t.y-this.y)*e,this}lerpVectors(t,e,n){return this.x=t.x+(e.x-t.x)*n,this.y=t.y+(e.y-t.y)*n,this}equals(t){return t.x===this.x&&t.y===this.y}fromArray(t,e=0){return this.x=t[e],this.y=t[e+1],this}toArray(t=[],e=0){return t[e]=this.x,t[e+1]=this.y,t}fromBufferAttribute(t,e,n){return void 0!==n&&console.warn("THREE.Vector2: offset has been removed from .fromBufferAttribute()."),this.x=t.getX(e),this.y=t.getY(e),this}rotateAround(t,e){const n=Math.cos(e),r=Math.sin(e),i=this.x-t.x,s=this.y-t.y;return this.x=i*n-s*r+t.x,this.y=i*r+s*n+t.y,this}random(){return this.x=Math.random(),this.y=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y}}class Yn{constructor(){this.isMatrix3=!0,this.elements=[1,0,0,0,1,0,0,0,1],arguments.length>0&&console.error("THREE.Matrix3: the constructor no longer reads arguments. use .set() instead.")}set(t,e,n,r,i,s,o,a,l){const c=this.elements;return c[0]=t,c[1]=r,c[2]=o,c[3]=e,c[4]=i,c[5]=a,c[6]=n,c[7]=s,c[8]=l,this}identity(){return this.set(1,0,0,0,1,0,0,0,1),this}copy(t){const e=this.elements,n=t.elements;return e[0]=n[0],e[1]=n[1],e[2]=n[2],e[3]=n[3],e[4]=n[4],e[5]=n[5],e[6]=n[6],e[7]=n[7],e[8]=n[8],this}extractBasis(t,e,n){return t.setFromMatrix3Column(this,0),e.setFromMatrix3Column(this,1),n.setFromMatrix3Column(this,2),this}setFromMatrix4(t){const e=t.elements;return this.set(e[0],e[4],e[8],e[1],e[5],e[9],e[2],e[6],e[10]),this}multiply(t){return this.multiplyMatrices(this,t)}premultiply(t){return this.multiplyMatrices(t,this)}multiplyMatrices(t,e){const n=t.elements,r=e.elements,i=this.elements,s=n[0],o=n[3],a=n[6],l=n[1],c=n[4],u=n[7],h=n[2],d=n[5],f=n[8],p=r[0],m=r[3],g=r[6],v=r[1],y=r[4],x=r[7],b=r[2],w=r[5],_=r[8];return i[0]=s*p+o*v+a*b,i[3]=s*m+o*y+a*w,i[6]=s*g+o*x+a*_,i[1]=l*p+c*v+u*b,i[4]=l*m+c*y+u*w,i[7]=l*g+c*x+u*_,i[2]=h*p+d*v+f*b,i[5]=h*m+d*y+f*w,i[8]=h*g+d*x+f*_,this}multiplyScalar(t){const e=this.elements;return e[0]*=t,e[3]*=t,e[6]*=t,e[1]*=t,e[4]*=t,e[7]*=t,e[2]*=t,e[5]*=t,e[8]*=t,this}determinant(){const t=this.elements,e=t[0],n=t[1],r=t[2],i=t[3],s=t[4],o=t[5],a=t[6],l=t[7],c=t[8];return e*s*c-e*o*l-n*i*c+n*o*a+r*i*l-r*s*a}invert(){const t=this.elements,e=t[0],n=t[1],r=t[2],i=t[3],s=t[4],o=t[5],a=t[6],l=t[7],c=t[8],u=c*s-o*l,h=o*a-c*i,d=l*i-s*a,f=e*u+n*h+r*d;if(0===f)return this.set(0,0,0,0,0,0,0,0,0);const p=1/f;return t[0]=u*p,t[1]=(r*l-c*n)*p,t[2]=(o*n-r*s)*p,t[3]=h*p,t[4]=(c*e-r*a)*p,t[5]=(r*i-o*e)*p,t[6]=d*p,t[7]=(n*a-l*e)*p,t[8]=(s*e-n*i)*p,this}transpose(){let t;const e=this.elements;return t=e[1],e[1]=e[3],e[3]=t,t=e[2],e[2]=e[6],e[6]=t,t=e[5],e[5]=e[7],e[7]=t,this}getNormalMatrix(t){return this.setFromMatrix4(t).invert().transpose()}transposeIntoArray(t){const e=this.elements;return t[0]=e[0],t[1]=e[3],t[2]=e[6],t[3]=e[1],t[4]=e[4],t[5]=e[7],t[6]=e[2],t[7]=e[5],t[8]=e[8],this}setUvTransform(t,e,n,r,i,s,o){const a=Math.cos(i),l=Math.sin(i);return this.set(n*a,n*l,-n*(a*s+l*o)+s+t,-r*l,r*a,-r*(-l*s+a*o)+o+e,0,0,1),this}scale(t,e){const n=this.elements;return n[0]*=t,n[3]*=t,n[6]*=t,n[1]*=e,n[4]*=e,n[7]*=e,this}rotate(t){const e=Math.cos(t),n=Math.sin(t),r=this.elements,i=r[0],s=r[3],o=r[6],a=r[1],l=r[4],c=r[7];return r[0]=e*i+n*a,r[3]=e*s+n*l,r[6]=e*o+n*c,r[1]=-n*i+e*a,r[4]=-n*s+e*l,r[7]=-n*o+e*c,this}translate(t,e){const n=this.elements;return n[0]+=t*n[2],n[3]+=t*n[5],n[6]+=t*n[8],n[1]+=e*n[2],n[4]+=e*n[5],n[7]+=e*n[8],this}equals(t){const e=this.elements,n=t.elements;for(let r=0;r<9;r++)if(e[r]!==n[r])return!1;return!0}fromArray(t,e=0){for(let n=0;n<9;n++)this.elements[n]=t[n+e];return this}toArray(t=[],e=0){const n=this.elements;return t[e]=n[0],t[e+1]=n[1],t[e+2]=n[2],t[e+3]=n[3],t[e+4]=n[4],t[e+5]=n[5],t[e+6]=n[6],t[e+7]=n[7],t[e+8]=n[8],t}clone(){return(new this.constructor).fromArray(this.elements)}}function Xn(t){for(let e=t.length-1;e>=0;--e)if(t[e]>65535)return!0;return!1}const Jn={Int8Array:Int8Array,Uint8Array:Uint8Array,Uint8ClampedArray:Uint8ClampedArray,Int16Array:Int16Array,Uint16Array:Uint16Array,Int32Array:Int32Array,Uint32Array:Uint32Array,Float32Array:Float32Array,Float64Array:Float64Array};function Kn(t,e){return new Jn[t](e)}function Zn(t){return document.createElementNS("http://www.w3.org/1999/xhtml",t)}function Qn(t){return t<.04045?.0773993808*t:Math.pow(.9478672986*t+.0521327014,2.4)}function $n(t){return t<.0031308?12.92*t:1.055*Math.pow(t,.41666)-.055}const tr={[Ge]:{[He]:Qn},[He]:{[Ge]:$n}},er={legacyMode:!0,get workingColorSpace(){return He},set workingColorSpace(t){console.warn("THREE.ColorManagement: .workingColorSpace is readonly.")},convert:function(t,e,n){if(this.legacyMode||e===n||!e||!n)return t;if(tr[e]&&void 0!==tr[e][n]){const r=tr[e][n];return t.r=r(t.r),t.g=r(t.g),t.b=r(t.b),t}throw new Error("Unsupported color space conversion.")},fromWorkingColorSpace:function(t,e){return this.convert(t,this.workingColorSpace,e)},toWorkingColorSpace:function(t,e){return this.convert(t,e,this.workingColorSpace)}},nr={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074},rr={r:0,g:0,b:0},ir={h:0,s:0,l:0},sr={h:0,s:0,l:0};function or(t,e,n){return n<0&&(n+=1),n>1&&(n-=1),n<1/6?t+6*(e-t)*n:n<.5?e:n<2/3?t+6*(e-t)*(2/3-n):t}function ar(t,e){return e.r=t.r,e.g=t.g,e.b=t.b,e}class lr{constructor(t,e,n){return this.isColor=!0,this.r=1,this.g=1,this.b=1,void 0===e&&void 0===n?this.set(t):this.setRGB(t,e,n)}set(t){return t&&t.isColor?this.copy(t):"number"===typeof t?this.setHex(t):"string"===typeof t&&this.setStyle(t),this}setScalar(t){return this.r=t,this.g=t,this.b=t,this}setHex(t,e=Ge){return t=Math.floor(t),this.r=(t>>16&255)/255,this.g=(t>>8&255)/255,this.b=(255&t)/255,er.toWorkingColorSpace(this,e),this}setRGB(t,e,n,r=He){return this.r=t,this.g=e,this.b=n,er.toWorkingColorSpace(this,r),this}setHSL(t,e,n,r=He){if(t=Sn(t,1),e=An(e,0,1),n=An(n,0,1),0===e)this.r=this.g=this.b=n;else{const r=n<=.5?n*(1+e):n+e-n*e,i=2*n-r;this.r=or(i,r,t+1/3),this.g=or(i,r,t),this.b=or(i,r,t-1/3)}return er.toWorkingColorSpace(this,r),this}setStyle(t,e=Ge){function n(e){void 0!==e&&parseFloat(e)<1&&console.warn("THREE.Color: Alpha component of "+t+" will be ignored.")}let r;if(r=/^((?:rgb|hsl)a?)\(([^\)]*)\)/.exec(t)){let t;const i=r[1],s=r[2];switch(i){case"rgb":case"rgba":if(t=/^\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(s))return this.r=Math.min(255,parseInt(t[1],10))/255,this.g=Math.min(255,parseInt(t[2],10))/255,this.b=Math.min(255,parseInt(t[3],10))/255,er.toWorkingColorSpace(this,e),n(t[4]),this;if(t=/^\s*(\d+)\%\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(s))return this.r=Math.min(100,parseInt(t[1],10))/100,this.g=Math.min(100,parseInt(t[2],10))/100,this.b=Math.min(100,parseInt(t[3],10))/100,er.toWorkingColorSpace(this,e),n(t[4]),this;break;case"hsl":case"hsla":if(t=/^\s*(\d*\.?\d+)\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(s)){const r=parseFloat(t[1])/360,i=parseInt(t[2],10)/100,s=parseInt(t[3],10)/100;return n(t[4]),this.setHSL(r,i,s,e)}break}}else if(r=/^\#([A-Fa-f\d]+)$/.exec(t)){const t=r[1],n=t.length;if(3===n)return this.r=parseInt(t.charAt(0)+t.charAt(0),16)/255,this.g=parseInt(t.charAt(1)+t.charAt(1),16)/255,this.b=parseInt(t.charAt(2)+t.charAt(2),16)/255,er.toWorkingColorSpace(this,e),this;if(6===n)return this.r=parseInt(t.charAt(0)+t.charAt(1),16)/255,this.g=parseInt(t.charAt(2)+t.charAt(3),16)/255,this.b=parseInt(t.charAt(4)+t.charAt(5),16)/255,er.toWorkingColorSpace(this,e),this}return t&&t.length>0?this.setColorName(t,e):this}setColorName(t,e=Ge){const n=nr[t.toLowerCase()];return void 0!==n?this.setHex(n,e):console.warn("THREE.Color: Unknown color "+t),this}clone(){return new this.constructor(this.r,this.g,this.b)}copy(t){return this.r=t.r,this.g=t.g,this.b=t.b,this}copySRGBToLinear(t){return this.r=Qn(t.r),this.g=Qn(t.g),this.b=Qn(t.b),this}copyLinearToSRGB(t){return this.r=$n(t.r),this.g=$n(t.g),this.b=$n(t.b),this}convertSRGBToLinear(){return this.copySRGBToLinear(this),this}convertLinearToSRGB(){return this.copyLinearToSRGB(this),this}getHex(t=Ge){return er.fromWorkingColorSpace(ar(this,rr),t),An(255*rr.r,0,255)<<16^An(255*rr.g,0,255)<<8^An(255*rr.b,0,255)<<0}getHexString(t=Ge){return("000000"+this.getHex(t).toString(16)).slice(-6)}getHSL(t,e=He){er.fromWorkingColorSpace(ar(this,rr),e);const n=rr.r,r=rr.g,i=rr.b,s=Math.max(n,r,i),o=Math.min(n,r,i);let a,l;const c=(o+s)/2;if(o===s)a=0,l=0;else{const t=s-o;switch(l=c<=.5?t/(s+o):t/(2-s-o),s){case n:a=(r-i)/t+(r<i?6:0);break;case r:a=(i-n)/t+2;break;case i:a=(n-r)/t+4;break}a/=6}return t.h=a,t.s=l,t.l=c,t}getRGB(t,e=He){return er.fromWorkingColorSpace(ar(this,rr),e),t.r=rr.r,t.g=rr.g,t.b=rr.b,t}getStyle(t=Ge){return er.fromWorkingColorSpace(ar(this,rr),t),t!==Ge?`color(${t} ${rr.r} ${rr.g} ${rr.b})`:`rgb(${255*rr.r|0},${255*rr.g|0},${255*rr.b|0})`}offsetHSL(t,e,n){return this.getHSL(ir),ir.h+=t,ir.s+=e,ir.l+=n,this.setHSL(ir.h,ir.s,ir.l),this}add(t){return this.r+=t.r,this.g+=t.g,this.b+=t.b,this}addColors(t,e){return this.r=t.r+e.r,this.g=t.g+e.g,this.b=t.b+e.b,this}addScalar(t){return this.r+=t,this.g+=t,this.b+=t,this}sub(t){return this.r=Math.max(0,this.r-t.r),this.g=Math.max(0,this.g-t.g),this.b=Math.max(0,this.b-t.b),this}multiply(t){return this.r*=t.r,this.g*=t.g,this.b*=t.b,this}multiplyScalar(t){return this.r*=t,this.g*=t,this.b*=t,this}lerp(t,e){return this.r+=(t.r-this.r)*e,this.g+=(t.g-this.g)*e,this.b+=(t.b-this.b)*e,this}lerpColors(t,e,n){return this.r=t.r+(e.r-t.r)*n,this.g=t.g+(e.g-t.g)*n,this.b=t.b+(e.b-t.b)*n,this}lerpHSL(t,e){this.getHSL(ir),t.getHSL(sr);const n=Cn(ir.h,sr.h,e),r=Cn(ir.s,sr.s,e),i=Cn(ir.l,sr.l,e);return this.setHSL(n,r,i),this}equals(t){return t.r===this.r&&t.g===this.g&&t.b===this.b}fromArray(t,e=0){return this.r=t[e],this.g=t[e+1],this.b=t[e+2],this}toArray(t=[],e=0){return t[e]=this.r,t[e+1]=this.g,t[e+2]=this.b,t}fromBufferAttribute(t,e){return this.r=t.getX(e),this.g=t.getY(e),this.b=t.getZ(e),!0===t.normalized&&(this.r/=255,this.g/=255,this.b/=255),this}toJSON(){return this.getHex()}*[Symbol.iterator](){yield this.r,yield this.g,yield this.b}}let cr;lr.NAMES=nr;class ur{static getDataURL(t){if(/^data:/i.test(t.src))return t.src;if("undefined"==typeof HTMLCanvasElement)return t.src;let e;if(t instanceof HTMLCanvasElement)e=t;else{void 0===cr&&(cr=Zn("canvas")),cr.width=t.width,cr.height=t.height;const n=cr.getContext("2d");t instanceof ImageData?n.putImageData(t,0,0):n.drawImage(t,0,0,t.width,t.height),e=cr}return e.width>2048||e.height>2048?(console.warn("THREE.ImageUtils.getDataURL: Image converted to jpg for performance reasons",t),e.toDataURL("image/jpeg",.6)):e.toDataURL("image/png")}static sRGBToLinear(t){if("undefined"!==typeof HTMLImageElement&&t instanceof HTMLImageElement||"undefined"!==typeof HTMLCanvasElement&&t instanceof HTMLCanvasElement||"undefined"!==typeof ImageBitmap&&t instanceof ImageBitmap){const e=Zn("canvas");e.width=t.width,e.height=t.height;const n=e.getContext("2d");n.drawImage(t,0,0,t.width,t.height);const r=n.getImageData(0,0,t.width,t.height),i=r.data;for(let t=0;t<i.length;t++)i[t]=255*Qn(i[t]/255);return n.putImageData(r,0,0),e}if(t.data){const e=t.data.slice(0);for(let t=0;t<e.length;t++)e instanceof Uint8Array||e instanceof Uint8ClampedArray?e[t]=Math.floor(255*Qn(e[t]/255)):e[t]=Qn(e[t]);return{data:e,width:t.width,height:t.height}}return console.warn("THREE.ImageUtils.sRGBToLinear(): Unsupported image type. No color space conversion applied."),t}}class hr{constructor(t=null){this.isSource=!0,this.uuid=Mn(),this.data=t,this.version=0}set needsUpdate(t){!0===t&&this.version++}toJSON(t){const e=void 0===t||"string"===typeof t;if(!e&&void 0!==t.images[this.uuid])return t.images[this.uuid];const n={uuid:this.uuid,url:""},r=this.data;if(null!==r){let t;if(Array.isArray(r)){t=[];for(let e=0,n=r.length;e<n;e++)r[e].isDataTexture?t.push(dr(r[e].image)):t.push(dr(r[e]))}else t=dr(r);n.url=t}return e||(t.images[this.uuid]=n),n}}function dr(t){return"undefined"!==typeof HTMLImageElement&&t instanceof HTMLImageElement||"undefined"!==typeof HTMLCanvasElement&&t instanceof HTMLCanvasElement||"undefined"!==typeof ImageBitmap&&t instanceof ImageBitmap?ur.getDataURL(t):t.data?{data:Array.prototype.slice.call(t.data),width:t.width,height:t.height,type:t.data.constructor.name}:(console.warn("THREE.Texture: Unable to serialize Texture."),{})}let fr=0;class pr extends yn{constructor(t=pr.DEFAULT_IMAGE,e=pr.DEFAULT_MAPPING,n=ft,r=ft,i=bt,s=Mt,o=Ft,a=St,l=1,c=ke){super(),this.isTexture=!0,Object.defineProperty(this,"id",{value:fr++}),this.uuid=Mn(),this.name="",this.source=new hr(t),this.mipmaps=[],this.mapping=e,this.wrapS=n,this.wrapT=r,this.magFilter=i,this.minFilter=s,this.anisotropy=l,this.format=o,this.internalFormat=null,this.type=a,this.offset=new qn(0,0),this.repeat=new qn(1,1),this.center=new qn(0,0),this.rotation=0,this.matrixAutoUpdate=!0,this.matrix=new Yn,this.generateMipmaps=!0,this.premultiplyAlpha=!1,this.flipY=!0,this.unpackAlignment=4,this.encoding=c,this.userData={},this.version=0,this.onUpdate=null,this.isRenderTargetTexture=!1,this.needsPMREMUpdate=!1}get image(){return this.source.data}set image(t){this.source.data=t}updateMatrix(){this.matrix.setUvTransform(this.offset.x,this.offset.y,this.repeat.x,this.repeat.y,this.rotation,this.center.x,this.center.y)}clone(){return(new this.constructor).copy(this)}copy(t){return this.name=t.name,this.source=t.source,this.mipmaps=t.mipmaps.slice(0),this.mapping=t.mapping,this.wrapS=t.wrapS,this.wrapT=t.wrapT,this.magFilter=t.magFilter,this.minFilter=t.minFilter,this.anisotropy=t.anisotropy,this.format=t.format,this.internalFormat=t.internalFormat,this.type=t.type,this.offset.copy(t.offset),this.repeat.copy(t.repeat),this.center.copy(t.center),this.rotation=t.rotation,this.matrixAutoUpdate=t.matrixAutoUpdate,this.matrix.copy(t.matrix),this.generateMipmaps=t.generateMipmaps,this.premultiplyAlpha=t.premultiplyAlpha,this.flipY=t.flipY,this.unpackAlignment=t.unpackAlignment,this.encoding=t.encoding,this.userData=JSON.parse(JSON.stringify(t.userData)),this.needsUpdate=!0,this}toJSON(t){const e=void 0===t||"string"===typeof t;if(!e&&void 0!==t.textures[this.uuid])return t.textures[this.uuid];const n={metadata:{version:4.5,type:"Texture",generator:"Texture.toJSON"},uuid:this.uuid,name:this.name,image:this.source.toJSON(t).uuid,mapping:this.mapping,repeat:[this.repeat.x,this.repeat.y],offset:[this.offset.x,this.offset.y],center:[this.center.x,this.center.y],rotation:this.rotation,wrap:[this.wrapS,this.wrapT],format:this.format,type:this.type,encoding:this.encoding,minFilter:this.minFilter,magFilter:this.magFilter,anisotropy:this.anisotropy,flipY:this.flipY,premultiplyAlpha:this.premultiplyAlpha,unpackAlignment:this.unpackAlignment};return"{}"!==JSON.stringify(this.userData)&&(n.userData=this.userData),e||(t.textures[this.uuid]=n),n}dispose(){this.dispatchEvent({type:"dispose"})}transformUv(t){if(this.mapping!==ot)return t;if(t.applyMatrix3(this.matrix),t.x<0||t.x>1)switch(this.wrapS){case dt:t.x=t.x-Math.floor(t.x);break;case ft:t.x=t.x<0?0:1;break;case pt:1===Math.abs(Math.floor(t.x)%2)?t.x=Math.ceil(t.x)-t.x:t.x=t.x-Math.floor(t.x);break}if(t.y<0||t.y>1)switch(this.wrapT){case dt:t.y=t.y-Math.floor(t.y);break;case ft:t.y=t.y<0?0:1;break;case pt:1===Math.abs(Math.floor(t.y)%2)?t.y=Math.ceil(t.y)-t.y:t.y=t.y-Math.floor(t.y);break}return this.flipY&&(t.y=1-t.y),t}set needsUpdate(t){!0===t&&(this.version++,this.source.needsUpdate=!0)}}pr.DEFAULT_IMAGE=null,pr.DEFAULT_MAPPING=ot;class mr{constructor(t=0,e=0,n=0,r=1){this.isVector4=!0,this.x=t,this.y=e,this.z=n,this.w=r}get width(){return this.z}set width(t){this.z=t}get height(){return this.w}set height(t){this.w=t}set(t,e,n,r){return this.x=t,this.y=e,this.z=n,this.w=r,this}setScalar(t){return this.x=t,this.y=t,this.z=t,this.w=t,this}setX(t){return this.x=t,this}setY(t){return this.y=t,this}setZ(t){return this.z=t,this}setW(t){return this.w=t,this}setComponent(t,e){switch(t){case 0:this.x=e;break;case 1:this.y=e;break;case 2:this.z=e;break;case 3:this.w=e;break;default:throw new Error("index is out of range: "+t)}return this}getComponent(t){switch(t){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw new Error("index is out of range: "+t)}}clone(){return new this.constructor(this.x,this.y,this.z,this.w)}copy(t){return this.x=t.x,this.y=t.y,this.z=t.z,this.w=void 0!==t.w?t.w:1,this}add(t,e){return void 0!==e?(console.warn("THREE.Vector4: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(t,e)):(this.x+=t.x,this.y+=t.y,this.z+=t.z,this.w+=t.w,this)}addScalar(t){return this.x+=t,this.y+=t,this.z+=t,this.w+=t,this}addVectors(t,e){return this.x=t.x+e.x,this.y=t.y+e.y,this.z=t.z+e.z,this.w=t.w+e.w,this}addScaledVector(t,e){return this.x+=t.x*e,this.y+=t.y*e,this.z+=t.z*e,this.w+=t.w*e,this}sub(t,e){return void 0!==e?(console.warn("THREE.Vector4: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(t,e)):(this.x-=t.x,this.y-=t.y,this.z-=t.z,this.w-=t.w,this)}subScalar(t){return this.x-=t,this.y-=t,this.z-=t,this.w-=t,this}subVectors(t,e){return this.x=t.x-e.x,this.y=t.y-e.y,this.z=t.z-e.z,this.w=t.w-e.w,this}multiply(t){return this.x*=t.x,this.y*=t.y,this.z*=t.z,this.w*=t.w,this}multiplyScalar(t){return this.x*=t,this.y*=t,this.z*=t,this.w*=t,this}applyMatrix4(t){const e=this.x,n=this.y,r=this.z,i=this.w,s=t.elements;return this.x=s[0]*e+s[4]*n+s[8]*r+s[12]*i,this.y=s[1]*e+s[5]*n+s[9]*r+s[13]*i,this.z=s[2]*e+s[6]*n+s[10]*r+s[14]*i,this.w=s[3]*e+s[7]*n+s[11]*r+s[15]*i,this}divideScalar(t){return this.multiplyScalar(1/t)}setAxisAngleFromQuaternion(t){this.w=2*Math.acos(t.w);const e=Math.sqrt(1-t.w*t.w);return e<1e-4?(this.x=1,this.y=0,this.z=0):(this.x=t.x/e,this.y=t.y/e,this.z=t.z/e),this}setAxisAngleFromRotationMatrix(t){let e,n,r,i;const s=.01,o=.1,a=t.elements,l=a[0],c=a[4],u=a[8],h=a[1],d=a[5],f=a[9],p=a[2],m=a[6],g=a[10];if(Math.abs(c-h)<s&&Math.abs(u-p)<s&&Math.abs(f-m)<s){if(Math.abs(c+h)<o&&Math.abs(u+p)<o&&Math.abs(f+m)<o&&Math.abs(l+d+g-3)<o)return this.set(1,0,0,0),this;e=Math.PI;const t=(l+1)/2,a=(d+1)/2,v=(g+1)/2,y=(c+h)/4,x=(u+p)/4,b=(f+m)/4;return t>a&&t>v?t<s?(n=0,r=.707106781,i=.707106781):(n=Math.sqrt(t),r=y/n,i=x/n):a>v?a<s?(n=.707106781,r=0,i=.707106781):(r=Math.sqrt(a),n=y/r,i=b/r):v<s?(n=.707106781,r=.707106781,i=0):(i=Math.sqrt(v),n=x/i,r=b/i),this.set(n,r,i,e),this}let v=Math.sqrt((m-f)*(m-f)+(u-p)*(u-p)+(h-c)*(h-c));return Math.abs(v)<.001&&(v=1),this.x=(m-f)/v,this.y=(u-p)/v,this.z=(h-c)/v,this.w=Math.acos((l+d+g-1)/2),this}min(t){return this.x=Math.min(this.x,t.x),this.y=Math.min(this.y,t.y),this.z=Math.min(this.z,t.z),this.w=Math.min(this.w,t.w),this}max(t){return this.x=Math.max(this.x,t.x),this.y=Math.max(this.y,t.y),this.z=Math.max(this.z,t.z),this.w=Math.max(this.w,t.w),this}clamp(t,e){return this.x=Math.max(t.x,Math.min(e.x,this.x)),this.y=Math.max(t.y,Math.min(e.y,this.y)),this.z=Math.max(t.z,Math.min(e.z,this.z)),this.w=Math.max(t.w,Math.min(e.w,this.w)),this}clampScalar(t,e){return this.x=Math.max(t,Math.min(e,this.x)),this.y=Math.max(t,Math.min(e,this.y)),this.z=Math.max(t,Math.min(e,this.z)),this.w=Math.max(t,Math.min(e,this.w)),this}clampLength(t,e){const n=this.length();return this.divideScalar(n||1).multiplyScalar(Math.max(t,Math.min(e,n)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this.w=Math.floor(this.w),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this.w=Math.ceil(this.w),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this.w=Math.round(this.w),this}roundToZero(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this.w=this.w<0?Math.ceil(this.w):Math.floor(this.w),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w,this}dot(t){return this.x*t.x+this.y*t.y+this.z*t.z+this.w*t.w}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)}normalize(){return this.divideScalar(this.length()||1)}setLength(t){return this.normalize().multiplyScalar(t)}lerp(t,e){return this.x+=(t.x-this.x)*e,this.y+=(t.y-this.y)*e,this.z+=(t.z-this.z)*e,this.w+=(t.w-this.w)*e,this}lerpVectors(t,e,n){return this.x=t.x+(e.x-t.x)*n,this.y=t.y+(e.y-t.y)*n,this.z=t.z+(e.z-t.z)*n,this.w=t.w+(e.w-t.w)*n,this}equals(t){return t.x===this.x&&t.y===this.y&&t.z===this.z&&t.w===this.w}fromArray(t,e=0){return this.x=t[e],this.y=t[e+1],this.z=t[e+2],this.w=t[e+3],this}toArray(t=[],e=0){return t[e]=this.x,t[e+1]=this.y,t[e+2]=this.z,t[e+3]=this.w,t}fromBufferAttribute(t,e,n){return void 0!==n&&console.warn("THREE.Vector4: offset has been removed from .fromBufferAttribute()."),this.x=t.getX(e),this.y=t.getY(e),this.z=t.getZ(e),this.w=t.getW(e),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this.w=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z,yield this.w}}class gr extends yn{constructor(t,e,n={}){super(),this.isWebGLRenderTarget=!0,this.width=t,this.height=e,this.depth=1,this.scissor=new mr(0,0,t,e),this.scissorTest=!1,this.viewport=new mr(0,0,t,e);const r={width:t,height:e,depth:1};this.texture=new pr(r,n.mapping,n.wrapS,n.wrapT,n.magFilter,n.minFilter,n.format,n.type,n.anisotropy,n.encoding),this.texture.isRenderTargetTexture=!0,this.texture.flipY=!1,this.texture.generateMipmaps=void 0!==n.generateMipmaps&&n.generateMipmaps,this.texture.internalFormat=void 0!==n.internalFormat?n.internalFormat:null,this.texture.minFilter=void 0!==n.minFilter?n.minFilter:bt,this.depthBuffer=void 0===n.depthBuffer||n.depthBuffer,this.stencilBuffer=void 0!==n.stencilBuffer&&n.stencilBuffer,this.depthTexture=void 0!==n.depthTexture?n.depthTexture:null,this.samples=void 0!==n.samples?n.samples:0}setSize(t,e,n=1){this.width===t&&this.height===e&&this.depth===n||(this.width=t,this.height=e,this.depth=n,this.texture.image.width=t,this.texture.image.height=e,this.texture.image.depth=n,this.dispose()),this.viewport.set(0,0,t,e),this.scissor.set(0,0,t,e)}clone(){return(new this.constructor).copy(this)}copy(t){this.width=t.width,this.height=t.height,this.depth=t.depth,this.viewport.copy(t.viewport),this.texture=t.texture.clone(),this.texture.isRenderTargetTexture=!0;const e=Object.assign({},t.texture.image);return this.texture.source=new hr(e),this.depthBuffer=t.depthBuffer,this.stencilBuffer=t.stencilBuffer,null!==t.depthTexture&&(this.depthTexture=t.depthTexture.clone()),this.samples=t.samples,this}dispose(){this.dispatchEvent({type:"dispose"})}}class vr extends pr{constructor(t=null,e=1,n=1,r=1){super(null),this.isDataArrayTexture=!0,this.image={data:t,width:e,height:n,depth:r},this.magFilter=mt,this.minFilter=mt,this.wrapR=ft,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}class yr extends gr{constructor(t,e,n){super(t,e),this.isWebGLArrayRenderTarget=!0,this.depth=n,this.texture=new vr(null,t,e,n),this.texture.isRenderTargetTexture=!0}}class xr extends pr{constructor(t=null,e=1,n=1,r=1){super(null),this.isData3DTexture=!0,this.image={data:t,width:e,height:n,depth:r},this.magFilter=mt,this.minFilter=mt,this.wrapR=ft,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}class br extends gr{constructor(t,e,n){super(t,e),this.isWebGL3DRenderTarget=!0,this.depth=n,this.texture=new xr(null,t,e,n),this.texture.isRenderTargetTexture=!0}}class wr extends gr{constructor(t,e,n,r={}){super(t,e,r),this.isWebGLMultipleRenderTargets=!0;const i=this.texture;this.texture=[];for(let s=0;s<n;s++)this.texture[s]=i.clone(),this.texture[s].isRenderTargetTexture=!0}setSize(t,e,n=1){if(this.width!==t||this.height!==e||this.depth!==n){this.width=t,this.height=e,this.depth=n;for(let r=0,i=this.texture.length;r<i;r++)this.texture[r].image.width=t,this.texture[r].image.height=e,this.texture[r].image.depth=n;this.dispose()}return this.viewport.set(0,0,t,e),this.scissor.set(0,0,t,e),this}copy(t){this.dispose(),this.width=t.width,this.height=t.height,this.depth=t.depth,this.viewport.set(0,0,this.width,this.height),this.scissor.set(0,0,this.width,this.height),this.depthBuffer=t.depthBuffer,this.stencilBuffer=t.stencilBuffer,null!==t.depthTexture&&(this.depthTexture=t.depthTexture.clone()),this.texture.length=0;for(let e=0,n=t.texture.length;e<n;e++)this.texture[e]=t.texture[e].clone(),this.texture[e].isRenderTargetTexture=!0;return this}}class _r{constructor(t=0,e=0,n=0,r=1){this.isQuaternion=!0,this._x=t,this._y=e,this._z=n,this._w=r}static slerp(t,e,n,r){return console.warn("THREE.Quaternion: Static .slerp() has been deprecated. Use qm.slerpQuaternions( qa, qb, t ) instead."),n.slerpQuaternions(t,e,r)}static slerpFlat(t,e,n,r,i,s,o){let a=n[r+0],l=n[r+1],c=n[r+2],u=n[r+3];const h=i[s+0],d=i[s+1],f=i[s+2],p=i[s+3];if(0===o)return t[e+0]=a,t[e+1]=l,t[e+2]=c,void(t[e+3]=u);if(1===o)return t[e+0]=h,t[e+1]=d,t[e+2]=f,void(t[e+3]=p);if(u!==p||a!==h||l!==d||c!==f){let t=1-o;const e=a*h+l*d+c*f+u*p,n=e>=0?1:-1,r=1-e*e;if(r>Number.EPSILON){const i=Math.sqrt(r),s=Math.atan2(i,e*n);t=Math.sin(t*s)/i,o=Math.sin(o*s)/i}const i=o*n;if(a=a*t+h*i,l=l*t+d*i,c=c*t+f*i,u=u*t+p*i,t===1-o){const t=1/Math.sqrt(a*a+l*l+c*c+u*u);a*=t,l*=t,c*=t,u*=t}}t[e]=a,t[e+1]=l,t[e+2]=c,t[e+3]=u}static multiplyQuaternionsFlat(t,e,n,r,i,s){const o=n[r],a=n[r+1],l=n[r+2],c=n[r+3],u=i[s],h=i[s+1],d=i[s+2],f=i[s+3];return t[e]=o*f+c*u+a*d-l*h,t[e+1]=a*f+c*h+l*u-o*d,t[e+2]=l*f+c*d+o*h-a*u,t[e+3]=c*f-o*u-a*h-l*d,t}get x(){return this._x}set x(t){this._x=t,this._onChangeCallback()}get y(){return this._y}set y(t){this._y=t,this._onChangeCallback()}get z(){return this._z}set z(t){this._z=t,this._onChangeCallback()}get w(){return this._w}set w(t){this._w=t,this._onChangeCallback()}set(t,e,n,r){return this._x=t,this._y=e,this._z=n,this._w=r,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._w)}copy(t){return this._x=t.x,this._y=t.y,this._z=t.z,this._w=t.w,this._onChangeCallback(),this}setFromEuler(t,e){if(!t||!t.isEuler)throw new Error("THREE.Quaternion: .setFromEuler() now expects an Euler rotation rather than a Vector3 and order.");const n=t._x,r=t._y,i=t._z,s=t._order,o=Math.cos,a=Math.sin,l=o(n/2),c=o(r/2),u=o(i/2),h=a(n/2),d=a(r/2),f=a(i/2);switch(s){case"XYZ":this._x=h*c*u+l*d*f,this._y=l*d*u-h*c*f,this._z=l*c*f+h*d*u,this._w=l*c*u-h*d*f;break;case"YXZ":this._x=h*c*u+l*d*f,this._y=l*d*u-h*c*f,this._z=l*c*f-h*d*u,this._w=l*c*u+h*d*f;break;case"ZXY":this._x=h*c*u-l*d*f,this._y=l*d*u+h*c*f,this._z=l*c*f+h*d*u,this._w=l*c*u-h*d*f;break;case"ZYX":this._x=h*c*u-l*d*f,this._y=l*d*u+h*c*f,this._z=l*c*f-h*d*u,this._w=l*c*u+h*d*f;break;case"YZX":this._x=h*c*u+l*d*f,this._y=l*d*u+h*c*f,this._z=l*c*f-h*d*u,this._w=l*c*u-h*d*f;break;case"XZY":this._x=h*c*u-l*d*f,this._y=l*d*u-h*c*f,this._z=l*c*f+h*d*u,this._w=l*c*u+h*d*f;break;default:console.warn("THREE.Quaternion: .setFromEuler() encountered an unknown order: "+s)}return!1!==e&&this._onChangeCallback(),this}setFromAxisAngle(t,e){const n=e/2,r=Math.sin(n);return this._x=t.x*r,this._y=t.y*r,this._z=t.z*r,this._w=Math.cos(n),this._onChangeCallback(),this}setFromRotationMatrix(t){const e=t.elements,n=e[0],r=e[4],i=e[8],s=e[1],o=e[5],a=e[9],l=e[2],c=e[6],u=e[10],h=n+o+u;if(h>0){const t=.5/Math.sqrt(h+1);this._w=.25/t,this._x=(c-a)*t,this._y=(i-l)*t,this._z=(s-r)*t}else if(n>o&&n>u){const t=2*Math.sqrt(1+n-o-u);this._w=(c-a)/t,this._x=.25*t,this._y=(r+s)/t,this._z=(i+l)/t}else if(o>u){const t=2*Math.sqrt(1+o-n-u);this._w=(i-l)/t,this._x=(r+s)/t,this._y=.25*t,this._z=(a+c)/t}else{const t=2*Math.sqrt(1+u-n-o);this._w=(s-r)/t,this._x=(i+l)/t,this._y=(a+c)/t,this._z=.25*t}return this._onChangeCallback(),this}setFromUnitVectors(t,e){let n=t.dot(e)+1;return n<Number.EPSILON?(n=0,Math.abs(t.x)>Math.abs(t.z)?(this._x=-t.y,this._y=t.x,this._z=0,this._w=n):(this._x=0,this._y=-t.z,this._z=t.y,this._w=n)):(this._x=t.y*e.z-t.z*e.y,this._y=t.z*e.x-t.x*e.z,this._z=t.x*e.y-t.y*e.x,this._w=n),this.normalize()}angleTo(t){return 2*Math.acos(Math.abs(An(this.dot(t),-1,1)))}rotateTowards(t,e){const n=this.angleTo(t);if(0===n)return this;const r=Math.min(1,e/n);return this.slerp(t,r),this}identity(){return this.set(0,0,0,1)}invert(){return this.conjugate()}conjugate(){return this._x*=-1,this._y*=-1,this._z*=-1,this._onChangeCallback(),this}dot(t){return this._x*t._x+this._y*t._y+this._z*t._z+this._w*t._w}lengthSq(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w}length(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)}normalize(){let t=this.length();return 0===t?(this._x=0,this._y=0,this._z=0,this._w=1):(t=1/t,this._x=this._x*t,this._y=this._y*t,this._z=this._z*t,this._w=this._w*t),this._onChangeCallback(),this}multiply(t,e){return void 0!==e?(console.warn("THREE.Quaternion: .multiply() now only accepts one argument. Use .multiplyQuaternions( a, b ) instead."),this.multiplyQuaternions(t,e)):this.multiplyQuaternions(this,t)}premultiply(t){return this.multiplyQuaternions(t,this)}multiplyQuaternions(t,e){const n=t._x,r=t._y,i=t._z,s=t._w,o=e._x,a=e._y,l=e._z,c=e._w;return this._x=n*c+s*o+r*l-i*a,this._y=r*c+s*a+i*o-n*l,this._z=i*c+s*l+n*a-r*o,this._w=s*c-n*o-r*a-i*l,this._onChangeCallback(),this}slerp(t,e){if(0===e)return this;if(1===e)return this.copy(t);const n=this._x,r=this._y,i=this._z,s=this._w;let o=s*t._w+n*t._x+r*t._y+i*t._z;if(o<0?(this._w=-t._w,this._x=-t._x,this._y=-t._y,this._z=-t._z,o=-o):this.copy(t),o>=1)return this._w=s,this._x=n,this._y=r,this._z=i,this;const a=1-o*o;if(a<=Number.EPSILON){const t=1-e;return this._w=t*s+e*this._w,this._x=t*n+e*this._x,this._y=t*r+e*this._y,this._z=t*i+e*this._z,this.normalize(),this._onChangeCallback(),this}const l=Math.sqrt(a),c=Math.atan2(l,o),u=Math.sin((1-e)*c)/l,h=Math.sin(e*c)/l;return this._w=s*u+this._w*h,this._x=n*u+this._x*h,this._y=r*u+this._y*h,this._z=i*u+this._z*h,this._onChangeCallback(),this}slerpQuaternions(t,e,n){return this.copy(t).slerp(e,n)}random(){const t=Math.random(),e=Math.sqrt(1-t),n=Math.sqrt(t),r=2*Math.PI*Math.random(),i=2*Math.PI*Math.random();return this.set(e*Math.cos(r),n*Math.sin(i),n*Math.cos(i),e*Math.sin(r))}equals(t){return t._x===this._x&&t._y===this._y&&t._z===this._z&&t._w===this._w}fromArray(t,e=0){return this._x=t[e],this._y=t[e+1],this._z=t[e+2],this._w=t[e+3],this._onChangeCallback(),this}toArray(t=[],e=0){return t[e]=this._x,t[e+1]=this._y,t[e+2]=this._z,t[e+3]=this._w,t}fromBufferAttribute(t,e){return this._x=t.getX(e),this._y=t.getY(e),this._z=t.getZ(e),this._w=t.getW(e),this}_onChange(t){return this._onChangeCallback=t,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._w}}class Mr{constructor(t=0,e=0,n=0){this.isVector3=!0,this.x=t,this.y=e,this.z=n}set(t,e,n){return void 0===n&&(n=this.z),this.x=t,this.y=e,this.z=n,this}setScalar(t){return this.x=t,this.y=t,this.z=t,this}setX(t){return this.x=t,this}setY(t){return this.y=t,this}setZ(t){return this.z=t,this}setComponent(t,e){switch(t){case 0:this.x=e;break;case 1:this.y=e;break;case 2:this.z=e;break;default:throw new Error("index is out of range: "+t)}return this}getComponent(t){switch(t){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw new Error("index is out of range: "+t)}}clone(){return new this.constructor(this.x,this.y,this.z)}copy(t){return this.x=t.x,this.y=t.y,this.z=t.z,this}add(t,e){return void 0!==e?(console.warn("THREE.Vector3: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(t,e)):(this.x+=t.x,this.y+=t.y,this.z+=t.z,this)}addScalar(t){return this.x+=t,this.y+=t,this.z+=t,this}addVectors(t,e){return this.x=t.x+e.x,this.y=t.y+e.y,this.z=t.z+e.z,this}addScaledVector(t,e){return this.x+=t.x*e,this.y+=t.y*e,this.z+=t.z*e,this}sub(t,e){return void 0!==e?(console.warn("THREE.Vector3: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(t,e)):(this.x-=t.x,this.y-=t.y,this.z-=t.z,this)}subScalar(t){return this.x-=t,this.y-=t,this.z-=t,this}subVectors(t,e){return this.x=t.x-e.x,this.y=t.y-e.y,this.z=t.z-e.z,this}multiply(t,e){return void 0!==e?(console.warn("THREE.Vector3: .multiply() now only accepts one argument. Use .multiplyVectors( a, b ) instead."),this.multiplyVectors(t,e)):(this.x*=t.x,this.y*=t.y,this.z*=t.z,this)}multiplyScalar(t){return this.x*=t,this.y*=t,this.z*=t,this}multiplyVectors(t,e){return this.x=t.x*e.x,this.y=t.y*e.y,this.z=t.z*e.z,this}applyEuler(t){return t&&t.isEuler||console.error("THREE.Vector3: .applyEuler() now expects an Euler rotation rather than a Vector3 and order."),this.applyQuaternion(Sr.setFromEuler(t))}applyAxisAngle(t,e){return this.applyQuaternion(Sr.setFromAxisAngle(t,e))}applyMatrix3(t){const e=this.x,n=this.y,r=this.z,i=t.elements;return this.x=i[0]*e+i[3]*n+i[6]*r,this.y=i[1]*e+i[4]*n+i[7]*r,this.z=i[2]*e+i[5]*n+i[8]*r,this}applyNormalMatrix(t){return this.applyMatrix3(t).normalize()}applyMatrix4(t){const e=this.x,n=this.y,r=this.z,i=t.elements,s=1/(i[3]*e+i[7]*n+i[11]*r+i[15]);return this.x=(i[0]*e+i[4]*n+i[8]*r+i[12])*s,this.y=(i[1]*e+i[5]*n+i[9]*r+i[13])*s,this.z=(i[2]*e+i[6]*n+i[10]*r+i[14])*s,this}applyQuaternion(t){const e=this.x,n=this.y,r=this.z,i=t.x,s=t.y,o=t.z,a=t.w,l=a*e+s*r-o*n,c=a*n+o*e-i*r,u=a*r+i*n-s*e,h=-i*e-s*n-o*r;return this.x=l*a+h*-i+c*-o-u*-s,this.y=c*a+h*-s+u*-i-l*-o,this.z=u*a+h*-o+l*-s-c*-i,this}project(t){return this.applyMatrix4(t.matrixWorldInverse).applyMatrix4(t.projectionMatrix)}unproject(t){return this.applyMatrix4(t.projectionMatrixInverse).applyMatrix4(t.matrixWorld)}transformDirection(t){const e=this.x,n=this.y,r=this.z,i=t.elements;return this.x=i[0]*e+i[4]*n+i[8]*r,this.y=i[1]*e+i[5]*n+i[9]*r,this.z=i[2]*e+i[6]*n+i[10]*r,this.normalize()}divide(t){return this.x/=t.x,this.y/=t.y,this.z/=t.z,this}divideScalar(t){return this.multiplyScalar(1/t)}min(t){return this.x=Math.min(this.x,t.x),this.y=Math.min(this.y,t.y),this.z=Math.min(this.z,t.z),this}max(t){return this.x=Math.max(this.x,t.x),this.y=Math.max(this.y,t.y),this.z=Math.max(this.z,t.z),this}clamp(t,e){return this.x=Math.max(t.x,Math.min(e.x,this.x)),this.y=Math.max(t.y,Math.min(e.y,this.y)),this.z=Math.max(t.z,Math.min(e.z,this.z)),this}clampScalar(t,e){return this.x=Math.max(t,Math.min(e,this.x)),this.y=Math.max(t,Math.min(e,this.y)),this.z=Math.max(t,Math.min(e,this.z)),this}clampLength(t,e){const n=this.length();return this.divideScalar(n||1).multiplyScalar(Math.max(t,Math.min(e,n)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this}roundToZero(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this}dot(t){return this.x*t.x+this.y*t.y+this.z*t.z}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)}normalize(){return this.divideScalar(this.length()||1)}setLength(t){return this.normalize().multiplyScalar(t)}lerp(t,e){return this.x+=(t.x-this.x)*e,this.y+=(t.y-this.y)*e,this.z+=(t.z-this.z)*e,this}lerpVectors(t,e,n){return this.x=t.x+(e.x-t.x)*n,this.y=t.y+(e.y-t.y)*n,this.z=t.z+(e.z-t.z)*n,this}cross(t,e){return void 0!==e?(console.warn("THREE.Vector3: .cross() now only accepts one argument. Use .crossVectors( a, b ) instead."),this.crossVectors(t,e)):this.crossVectors(this,t)}crossVectors(t,e){const n=t.x,r=t.y,i=t.z,s=e.x,o=e.y,a=e.z;return this.x=r*a-i*o,this.y=i*s-n*a,this.z=n*o-r*s,this}projectOnVector(t){const e=t.lengthSq();if(0===e)return this.set(0,0,0);const n=t.dot(this)/e;return this.copy(t).multiplyScalar(n)}projectOnPlane(t){return Ar.copy(this).projectOnVector(t),this.sub(Ar)}reflect(t){return this.sub(Ar.copy(t).multiplyScalar(2*this.dot(t)))}angleTo(t){const e=Math.sqrt(this.lengthSq()*t.lengthSq());if(0===e)return Math.PI/2;const n=this.dot(t)/e;return Math.acos(An(n,-1,1))}distanceTo(t){return Math.sqrt(this.distanceToSquared(t))}distanceToSquared(t){const e=this.x-t.x,n=this.y-t.y,r=this.z-t.z;return e*e+n*n+r*r}manhattanDistanceTo(t){return Math.abs(this.x-t.x)+Math.abs(this.y-t.y)+Math.abs(this.z-t.z)}setFromSpherical(t){return this.setFromSphericalCoords(t.radius,t.phi,t.theta)}setFromSphericalCoords(t,e,n){const r=Math.sin(e)*t;return this.x=r*Math.sin(n),this.y=Math.cos(e)*t,this.z=r*Math.cos(n),this}setFromCylindrical(t){return this.setFromCylindricalCoords(t.radius,t.theta,t.y)}setFromCylindricalCoords(t,e,n){return this.x=t*Math.sin(e),this.y=n,this.z=t*Math.cos(e),this}setFromMatrixPosition(t){const e=t.elements;return this.x=e[12],this.y=e[13],this.z=e[14],this}setFromMatrixScale(t){const e=this.setFromMatrixColumn(t,0).length(),n=this.setFromMatrixColumn(t,1).length(),r=this.setFromMatrixColumn(t,2).length();return this.x=e,this.y=n,this.z=r,this}setFromMatrixColumn(t,e){return this.fromArray(t.elements,4*e)}setFromMatrix3Column(t,e){return this.fromArray(t.elements,3*e)}setFromEuler(t){return this.x=t._x,this.y=t._y,this.z=t._z,this}equals(t){return t.x===this.x&&t.y===this.y&&t.z===this.z}fromArray(t,e=0){return this.x=t[e],this.y=t[e+1],this.z=t[e+2],this}toArray(t=[],e=0){return t[e]=this.x,t[e+1]=this.y,t[e+2]=this.z,t}fromBufferAttribute(t,e,n){return void 0!==n&&console.warn("THREE.Vector3: offset has been removed from .fromBufferAttribute()."),this.x=t.getX(e),this.y=t.getY(e),this.z=t.getZ(e),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this}randomDirection(){const t=2*(Math.random()-.5),e=Math.random()*Math.PI*2,n=Math.sqrt(1-t**2);return this.x=n*Math.cos(e),this.y=n*Math.sin(e),this.z=t,this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z}}const Ar=new Mr,Sr=new _r;class Er{constructor(t=new Mr(1/0,1/0,1/0),e=new Mr(-1/0,-1/0,-1/0)){this.isBox3=!0,this.min=t,this.max=e}set(t,e){return this.min.copy(t),this.max.copy(e),this}setFromArray(t){let e=1/0,n=1/0,r=1/0,i=-1/0,s=-1/0,o=-1/0;for(let a=0,l=t.length;a<l;a+=3){const l=t[a],c=t[a+1],u=t[a+2];l<e&&(e=l),c<n&&(n=c),u<r&&(r=u),l>i&&(i=l),c>s&&(s=c),u>o&&(o=u)}return this.min.set(e,n,r),this.max.set(i,s,o),this}setFromBufferAttribute(t){let e=1/0,n=1/0,r=1/0,i=-1/0,s=-1/0,o=-1/0;for(let a=0,l=t.count;a<l;a++){const l=t.getX(a),c=t.getY(a),u=t.getZ(a);l<e&&(e=l),c<n&&(n=c),u<r&&(r=u),l>i&&(i=l),c>s&&(s=c),u>o&&(o=u)}return this.min.set(e,n,r),this.max.set(i,s,o),this}setFromPoints(t){this.makeEmpty();for(let e=0,n=t.length;e<n;e++)this.expandByPoint(t[e]);return this}setFromCenterAndSize(t,e){const n=Cr.copy(e).multiplyScalar(.5);return this.min.copy(t).sub(n),this.max.copy(t).add(n),this}setFromObject(t,e=!1){return this.makeEmpty(),this.expandByObject(t,e)}clone(){return(new this.constructor).copy(this)}copy(t){return this.min.copy(t.min),this.max.copy(t.max),this}makeEmpty(){return this.min.x=this.min.y=this.min.z=1/0,this.max.x=this.max.y=this.max.z=-1/0,this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z}getCenter(t){return this.isEmpty()?t.set(0,0,0):t.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(t){return this.isEmpty()?t.set(0,0,0):t.subVectors(this.max,this.min)}expandByPoint(t){return this.min.min(t),this.max.max(t),this}expandByVector(t){return this.min.sub(t),this.max.add(t),this}expandByScalar(t){return this.min.addScalar(-t),this.max.addScalar(t),this}expandByObject(t,e=!1){t.updateWorldMatrix(!1,!1);const n=t.geometry;if(void 0!==n)if(e&&void 0!=n.attributes&&void 0!==n.attributes.position){const e=n.attributes.position;for(let n=0,r=e.count;n<r;n++)Cr.fromBufferAttribute(e,n).applyMatrix4(t.matrixWorld),this.expandByPoint(Cr)}else null===n.boundingBox&&n.computeBoundingBox(),Rr.copy(n.boundingBox),Rr.applyMatrix4(t.matrixWorld),this.union(Rr);const r=t.children;for(let i=0,s=r.length;i<s;i++)this.expandByObject(r[i],e);return this}containsPoint(t){return!(t.x<this.min.x||t.x>this.max.x||t.y<this.min.y||t.y>this.max.y||t.z<this.min.z||t.z>this.max.z)}containsBox(t){return this.min.x<=t.min.x&&t.max.x<=this.max.x&&this.min.y<=t.min.y&&t.max.y<=this.max.y&&this.min.z<=t.min.z&&t.max.z<=this.max.z}getParameter(t,e){return e.set((t.x-this.min.x)/(this.max.x-this.min.x),(t.y-this.min.y)/(this.max.y-this.min.y),(t.z-this.min.z)/(this.max.z-this.min.z))}intersectsBox(t){return!(t.max.x<this.min.x||t.min.x>this.max.x||t.max.y<this.min.y||t.min.y>this.max.y||t.max.z<this.min.z||t.min.z>this.max.z)}intersectsSphere(t){return this.clampPoint(t.center,Cr),Cr.distanceToSquared(t.center)<=t.radius*t.radius}intersectsPlane(t){let e,n;return t.normal.x>0?(e=t.normal.x*this.min.x,n=t.normal.x*this.max.x):(e=t.normal.x*this.max.x,n=t.normal.x*this.min.x),t.normal.y>0?(e+=t.normal.y*this.min.y,n+=t.normal.y*this.max.y):(e+=t.normal.y*this.max.y,n+=t.normal.y*this.min.y),t.normal.z>0?(e+=t.normal.z*this.min.z,n+=t.normal.z*this.max.z):(e+=t.normal.z*this.max.z,n+=t.normal.z*this.min.z),e<=-t.constant&&n>=-t.constant}intersectsTriangle(t){if(this.isEmpty())return!1;this.getCenter(Dr),zr.subVectors(this.max,Dr),Ir.subVectors(t.a,Dr),Pr.subVectors(t.b,Dr),Lr.subVectors(t.c,Dr),Nr.subVectors(Pr,Ir),kr.subVectors(Lr,Pr),Or.subVectors(Ir,Lr);let e=[0,-Nr.z,Nr.y,0,-kr.z,kr.y,0,-Or.z,Or.y,Nr.z,0,-Nr.x,kr.z,0,-kr.x,Or.z,0,-Or.x,-Nr.y,Nr.x,0,-kr.y,kr.x,0,-Or.y,Or.x,0];return!!Br(e,Ir,Pr,Lr,zr)&&(e=[1,0,0,0,1,0,0,0,1],!!Br(e,Ir,Pr,Lr,zr)&&(Fr.crossVectors(Nr,kr),e=[Fr.x,Fr.y,Fr.z],Br(e,Ir,Pr,Lr,zr)))}clampPoint(t,e){return e.copy(t).clamp(this.min,this.max)}distanceToPoint(t){const e=Cr.copy(t).clamp(this.min,this.max);return e.sub(t).length()}getBoundingSphere(t){return this.getCenter(t.center),t.radius=.5*this.getSize(Cr).length(),t}intersect(t){return this.min.max(t.min),this.max.min(t.max),this.isEmpty()&&this.makeEmpty(),this}union(t){return this.min.min(t.min),this.max.max(t.max),this}applyMatrix4(t){return this.isEmpty()||(Tr[0].set(this.min.x,this.min.y,this.min.z).applyMatrix4(t),Tr[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(t),Tr[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(t),Tr[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(t),Tr[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(t),Tr[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(t),Tr[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(t),Tr[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(t),this.setFromPoints(Tr)),this}translate(t){return this.min.add(t),this.max.add(t),this}equals(t){return t.min.equals(this.min)&&t.max.equals(this.max)}}const Tr=[new Mr,new Mr,new Mr,new Mr,new Mr,new Mr,new Mr,new Mr],Cr=new Mr,Rr=new Er,Ir=new Mr,Pr=new Mr,Lr=new Mr,Nr=new Mr,kr=new Mr,Or=new Mr,Dr=new Mr,zr=new Mr,Fr=new Mr,Ur=new Mr;function Br(t,e,n,r,i){for(let s=0,o=t.length-3;s<=o;s+=3){Ur.fromArray(t,s);const o=i.x*Math.abs(Ur.x)+i.y*Math.abs(Ur.y)+i.z*Math.abs(Ur.z),a=e.dot(Ur),l=n.dot(Ur),c=r.dot(Ur);if(Math.max(-Math.max(a,l,c),Math.min(a,l,c))>o)return!1}return!0}const Gr=new Er,Hr=new Mr,Vr=new Mr,jr=new Mr;class Wr{constructor(t=new Mr,e=-1){this.center=t,this.radius=e}set(t,e){return this.center.copy(t),this.radius=e,this}setFromPoints(t,e){const n=this.center;void 0!==e?n.copy(e):Gr.setFromPoints(t).getCenter(n);let r=0;for(let i=0,s=t.length;i<s;i++)r=Math.max(r,n.distanceToSquared(t[i]));return this.radius=Math.sqrt(r),this}copy(t){return this.center.copy(t.center),this.radius=t.radius,this}isEmpty(){return this.radius<0}makeEmpty(){return this.center.set(0,0,0),this.radius=-1,this}containsPoint(t){return t.distanceToSquared(this.center)<=this.radius*this.radius}distanceToPoint(t){return t.distanceTo(this.center)-this.radius}intersectsSphere(t){const e=this.radius+t.radius;return t.center.distanceToSquared(this.center)<=e*e}intersectsBox(t){return t.intersectsSphere(this)}intersectsPlane(t){return Math.abs(t.distanceToPoint(this.center))<=this.radius}clampPoint(t,e){const n=this.center.distanceToSquared(t);return e.copy(t),n>this.radius*this.radius&&(e.sub(this.center).normalize(),e.multiplyScalar(this.radius).add(this.center)),e}getBoundingBox(t){return this.isEmpty()?(t.makeEmpty(),t):(t.set(this.center,this.center),t.expandByScalar(this.radius),t)}applyMatrix4(t){return this.center.applyMatrix4(t),this.radius=this.radius*t.getMaxScaleOnAxis(),this}translate(t){return this.center.add(t),this}expandByPoint(t){jr.subVectors(t,this.center);const e=jr.lengthSq();if(e>this.radius*this.radius){const t=Math.sqrt(e),n=.5*(t-this.radius);this.center.add(jr.multiplyScalar(n/t)),this.radius+=n}return this}union(t){return!0===this.center.equals(t.center)?Vr.set(0,0,1).multiplyScalar(t.radius):Vr.subVectors(t.center,this.center).normalize().multiplyScalar(t.radius),this.expandByPoint(Hr.copy(t.center).add(Vr)),this.expandByPoint(Hr.copy(t.center).sub(Vr)),this}equals(t){return t.center.equals(this.center)&&t.radius===this.radius}clone(){return(new this.constructor).copy(this)}}const qr=new Mr,Yr=new Mr,Xr=new Mr,Jr=new Mr,Kr=new Mr,Zr=new Mr,Qr=new Mr;class $r{constructor(t=new Mr,e=new Mr(0,0,-1)){this.origin=t,this.direction=e}set(t,e){return this.origin.copy(t),this.direction.copy(e),this}copy(t){return this.origin.copy(t.origin),this.direction.copy(t.direction),this}at(t,e){return e.copy(this.direction).multiplyScalar(t).add(this.origin)}lookAt(t){return this.direction.copy(t).sub(this.origin).normalize(),this}recast(t){return this.origin.copy(this.at(t,qr)),this}closestPointToPoint(t,e){e.subVectors(t,this.origin);const n=e.dot(this.direction);return n<0?e.copy(this.origin):e.copy(this.direction).multiplyScalar(n).add(this.origin)}distanceToPoint(t){return Math.sqrt(this.distanceSqToPoint(t))}distanceSqToPoint(t){const e=qr.subVectors(t,this.origin).dot(this.direction);return e<0?this.origin.distanceToSquared(t):(qr.copy(this.direction).multiplyScalar(e).add(this.origin),qr.distanceToSquared(t))}distanceSqToSegment(t,e,n,r){Yr.copy(t).add(e).multiplyScalar(.5),Xr.copy(e).sub(t).normalize(),Jr.copy(this.origin).sub(Yr);const i=.5*t.distanceTo(e),s=-this.direction.dot(Xr),o=Jr.dot(this.direction),a=-Jr.dot(Xr),l=Jr.lengthSq(),c=Math.abs(1-s*s);let u,h,d,f;if(c>0)if(u=s*a-o,h=s*o-a,f=i*c,u>=0)if(h>=-f)if(h<=f){const t=1/c;u*=t,h*=t,d=u*(u+s*h+2*o)+h*(s*u+h+2*a)+l}else h=i,u=Math.max(0,-(s*h+o)),d=-u*u+h*(h+2*a)+l;else h=-i,u=Math.max(0,-(s*h+o)),d=-u*u+h*(h+2*a)+l;else h<=-f?(u=Math.max(0,-(-s*i+o)),h=u>0?-i:Math.min(Math.max(-i,-a),i),d=-u*u+h*(h+2*a)+l):h<=f?(u=0,h=Math.min(Math.max(-i,-a),i),d=h*(h+2*a)+l):(u=Math.max(0,-(s*i+o)),h=u>0?i:Math.min(Math.max(-i,-a),i),d=-u*u+h*(h+2*a)+l);else h=s>0?-i:i,u=Math.max(0,-(s*h+o)),d=-u*u+h*(h+2*a)+l;return n&&n.copy(this.direction).multiplyScalar(u).add(this.origin),r&&r.copy(Xr).multiplyScalar(h).add(Yr),d}intersectSphere(t,e){qr.subVectors(t.center,this.origin);const n=qr.dot(this.direction),r=qr.dot(qr)-n*n,i=t.radius*t.radius;if(r>i)return null;const s=Math.sqrt(i-r),o=n-s,a=n+s;return o<0&&a<0?null:o<0?this.at(a,e):this.at(o,e)}intersectsSphere(t){return this.distanceSqToPoint(t.center)<=t.radius*t.radius}distanceToPlane(t){const e=t.normal.dot(this.direction);if(0===e)return 0===t.distanceToPoint(this.origin)?0:null;const n=-(this.origin.dot(t.normal)+t.constant)/e;return n>=0?n:null}intersectPlane(t,e){const n=this.distanceToPlane(t);return null===n?null:this.at(n,e)}intersectsPlane(t){const e=t.distanceToPoint(this.origin);if(0===e)return!0;const n=t.normal.dot(this.direction);return n*e<0}intersectBox(t,e){let n,r,i,s,o,a;const l=1/this.direction.x,c=1/this.direction.y,u=1/this.direction.z,h=this.origin;return l>=0?(n=(t.min.x-h.x)*l,r=(t.max.x-h.x)*l):(n=(t.max.x-h.x)*l,r=(t.min.x-h.x)*l),c>=0?(i=(t.min.y-h.y)*c,s=(t.max.y-h.y)*c):(i=(t.max.y-h.y)*c,s=(t.min.y-h.y)*c),n>s||i>r?null:((i>n||n!==n)&&(n=i),(s<r||r!==r)&&(r=s),u>=0?(o=(t.min.z-h.z)*u,a=(t.max.z-h.z)*u):(o=(t.max.z-h.z)*u,a=(t.min.z-h.z)*u),n>a||o>r?null:((o>n||n!==n)&&(n=o),(a<r||r!==r)&&(r=a),r<0?null:this.at(n>=0?n:r,e)))}intersectsBox(t){return null!==this.intersectBox(t,qr)}intersectTriangle(t,e,n,r,i){Kr.subVectors(e,t),Zr.subVectors(n,t),Qr.crossVectors(Kr,Zr);let s,o=this.direction.dot(Qr);if(o>0){if(r)return null;s=1}else{if(!(o<0))return null;s=-1,o=-o}Jr.subVectors(this.origin,t);const a=s*this.direction.dot(Zr.crossVectors(Jr,Zr));if(a<0)return null;const l=s*this.direction.dot(Kr.cross(Jr));if(l<0)return null;if(a+l>o)return null;const c=-s*Jr.dot(Qr);return c<0?null:this.at(c/o,i)}applyMatrix4(t){return this.origin.applyMatrix4(t),this.direction.transformDirection(t),this}equals(t){return t.origin.equals(this.origin)&&t.direction.equals(this.direction)}clone(){return(new this.constructor).copy(this)}}class ti{constructor(){this.isMatrix4=!0,this.elements=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],arguments.length>0&&console.error("THREE.Matrix4: the constructor no longer reads arguments. use .set() instead.")}set(t,e,n,r,i,s,o,a,l,c,u,h,d,f,p,m){const g=this.elements;return g[0]=t,g[4]=e,g[8]=n,g[12]=r,g[1]=i,g[5]=s,g[9]=o,g[13]=a,g[2]=l,g[6]=c,g[10]=u,g[14]=h,g[3]=d,g[7]=f,g[11]=p,g[15]=m,this}identity(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this}clone(){return(new ti).fromArray(this.elements)}copy(t){const e=this.elements,n=t.elements;return e[0]=n[0],e[1]=n[1],e[2]=n[2],e[3]=n[3],e[4]=n[4],e[5]=n[5],e[6]=n[6],e[7]=n[7],e[8]=n[8],e[9]=n[9],e[10]=n[10],e[11]=n[11],e[12]=n[12],e[13]=n[13],e[14]=n[14],e[15]=n[15],this}copyPosition(t){const e=this.elements,n=t.elements;return e[12]=n[12],e[13]=n[13],e[14]=n[14],this}setFromMatrix3(t){const e=t.elements;return this.set(e[0],e[3],e[6],0,e[1],e[4],e[7],0,e[2],e[5],e[8],0,0,0,0,1),this}extractBasis(t,e,n){return t.setFromMatrixColumn(this,0),e.setFromMatrixColumn(this,1),n.setFromMatrixColumn(this,2),this}makeBasis(t,e,n){return this.set(t.x,e.x,n.x,0,t.y,e.y,n.y,0,t.z,e.z,n.z,0,0,0,0,1),this}extractRotation(t){const e=this.elements,n=t.elements,r=1/ei.setFromMatrixColumn(t,0).length(),i=1/ei.setFromMatrixColumn(t,1).length(),s=1/ei.setFromMatrixColumn(t,2).length();return e[0]=n[0]*r,e[1]=n[1]*r,e[2]=n[2]*r,e[3]=0,e[4]=n[4]*i,e[5]=n[5]*i,e[6]=n[6]*i,e[7]=0,e[8]=n[8]*s,e[9]=n[9]*s,e[10]=n[10]*s,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,this}makeRotationFromEuler(t){t&&t.isEuler||console.error("THREE.Matrix4: .makeRotationFromEuler() now expects a Euler rotation rather than a Vector3 and order.");const e=this.elements,n=t.x,r=t.y,i=t.z,s=Math.cos(n),o=Math.sin(n),a=Math.cos(r),l=Math.sin(r),c=Math.cos(i),u=Math.sin(i);if("XYZ"===t.order){const t=s*c,n=s*u,r=o*c,i=o*u;e[0]=a*c,e[4]=-a*u,e[8]=l,e[1]=n+r*l,e[5]=t-i*l,e[9]=-o*a,e[2]=i-t*l,e[6]=r+n*l,e[10]=s*a}else if("YXZ"===t.order){const t=a*c,n=a*u,r=l*c,i=l*u;e[0]=t+i*o,e[4]=r*o-n,e[8]=s*l,e[1]=s*u,e[5]=s*c,e[9]=-o,e[2]=n*o-r,e[6]=i+t*o,e[10]=s*a}else if("ZXY"===t.order){const t=a*c,n=a*u,r=l*c,i=l*u;e[0]=t-i*o,e[4]=-s*u,e[8]=r+n*o,e[1]=n+r*o,e[5]=s*c,e[9]=i-t*o,e[2]=-s*l,e[6]=o,e[10]=s*a}else if("ZYX"===t.order){const t=s*c,n=s*u,r=o*c,i=o*u;e[0]=a*c,e[4]=r*l-n,e[8]=t*l+i,e[1]=a*u,e[5]=i*l+t,e[9]=n*l-r,e[2]=-l,e[6]=o*a,e[10]=s*a}else if("YZX"===t.order){const t=s*a,n=s*l,r=o*a,i=o*l;e[0]=a*c,e[4]=i-t*u,e[8]=r*u+n,e[1]=u,e[5]=s*c,e[9]=-o*c,e[2]=-l*c,e[6]=n*u+r,e[10]=t-i*u}else if("XZY"===t.order){const t=s*a,n=s*l,r=o*a,i=o*l;e[0]=a*c,e[4]=-u,e[8]=l*c,e[1]=t*u+i,e[5]=s*c,e[9]=n*u-r,e[2]=r*u-n,e[6]=o*c,e[10]=i*u+t}return e[3]=0,e[7]=0,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,this}makeRotationFromQuaternion(t){return this.compose(ri,t,ii)}lookAt(t,e,n){const r=this.elements;return ai.subVectors(t,e),0===ai.lengthSq()&&(ai.z=1),ai.normalize(),si.crossVectors(n,ai),0===si.lengthSq()&&(1===Math.abs(n.z)?ai.x+=1e-4:ai.z+=1e-4,ai.normalize(),si.crossVectors(n,ai)),si.normalize(),oi.crossVectors(ai,si),r[0]=si.x,r[4]=oi.x,r[8]=ai.x,r[1]=si.y,r[5]=oi.y,r[9]=ai.y,r[2]=si.z,r[6]=oi.z,r[10]=ai.z,this}multiply(t,e){return void 0!==e?(console.warn("THREE.Matrix4: .multiply() now only accepts one argument. Use .multiplyMatrices( a, b ) instead."),this.multiplyMatrices(t,e)):this.multiplyMatrices(this,t)}premultiply(t){return this.multiplyMatrices(t,this)}multiplyMatrices(t,e){const n=t.elements,r=e.elements,i=this.elements,s=n[0],o=n[4],a=n[8],l=n[12],c=n[1],u=n[5],h=n[9],d=n[13],f=n[2],p=n[6],m=n[10],g=n[14],v=n[3],y=n[7],x=n[11],b=n[15],w=r[0],_=r[4],M=r[8],A=r[12],S=r[1],E=r[5],T=r[9],C=r[13],R=r[2],I=r[6],P=r[10],L=r[14],N=r[3],k=r[7],O=r[11],D=r[15];return i[0]=s*w+o*S+a*R+l*N,i[4]=s*_+o*E+a*I+l*k,i[8]=s*M+o*T+a*P+l*O,i[12]=s*A+o*C+a*L+l*D,i[1]=c*w+u*S+h*R+d*N,i[5]=c*_+u*E+h*I+d*k,i[9]=c*M+u*T+h*P+d*O,i[13]=c*A+u*C+h*L+d*D,i[2]=f*w+p*S+m*R+g*N,i[6]=f*_+p*E+m*I+g*k,i[10]=f*M+p*T+m*P+g*O,i[14]=f*A+p*C+m*L+g*D,i[3]=v*w+y*S+x*R+b*N,i[7]=v*_+y*E+x*I+b*k,i[11]=v*M+y*T+x*P+b*O,i[15]=v*A+y*C+x*L+b*D,this}multiplyScalar(t){const e=this.elements;return e[0]*=t,e[4]*=t,e[8]*=t,e[12]*=t,e[1]*=t,e[5]*=t,e[9]*=t,e[13]*=t,e[2]*=t,e[6]*=t,e[10]*=t,e[14]*=t,e[3]*=t,e[7]*=t,e[11]*=t,e[15]*=t,this}determinant(){const t=this.elements,e=t[0],n=t[4],r=t[8],i=t[12],s=t[1],o=t[5],a=t[9],l=t[13],c=t[2],u=t[6],h=t[10],d=t[14],f=t[3],p=t[7],m=t[11],g=t[15];return f*(+i*a*u-r*l*u-i*o*h+n*l*h+r*o*d-n*a*d)+p*(+e*a*d-e*l*h+i*s*h-r*s*d+r*l*c-i*a*c)+m*(+e*l*u-e*o*d-i*s*u+n*s*d+i*o*c-n*l*c)+g*(-r*o*c-e*a*u+e*o*h+r*s*u-n*s*h+n*a*c)}transpose(){const t=this.elements;let e;return e=t[1],t[1]=t[4],t[4]=e,e=t[2],t[2]=t[8],t[8]=e,e=t[6],t[6]=t[9],t[9]=e,e=t[3],t[3]=t[12],t[12]=e,e=t[7],t[7]=t[13],t[13]=e,e=t[11],t[11]=t[14],t[14]=e,this}setPosition(t,e,n){const r=this.elements;return t.isVector3?(r[12]=t.x,r[13]=t.y,r[14]=t.z):(r[12]=t,r[13]=e,r[14]=n),this}invert(){const t=this.elements,e=t[0],n=t[1],r=t[2],i=t[3],s=t[4],o=t[5],a=t[6],l=t[7],c=t[8],u=t[9],h=t[10],d=t[11],f=t[12],p=t[13],m=t[14],g=t[15],v=u*m*l-p*h*l+p*a*d-o*m*d-u*a*g+o*h*g,y=f*h*l-c*m*l-f*a*d+s*m*d+c*a*g-s*h*g,x=c*p*l-f*u*l+f*o*d-s*p*d-c*o*g+s*u*g,b=f*u*a-c*p*a-f*o*h+s*p*h+c*o*m-s*u*m,w=e*v+n*y+r*x+i*b;if(0===w)return this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0);const _=1/w;return t[0]=v*_,t[1]=(p*h*i-u*m*i-p*r*d+n*m*d+u*r*g-n*h*g)*_,t[2]=(o*m*i-p*a*i+p*r*l-n*m*l-o*r*g+n*a*g)*_,t[3]=(u*a*i-o*h*i-u*r*l+n*h*l+o*r*d-n*a*d)*_,t[4]=y*_,t[5]=(c*m*i-f*h*i+f*r*d-e*m*d-c*r*g+e*h*g)*_,t[6]=(f*a*i-s*m*i-f*r*l+e*m*l+s*r*g-e*a*g)*_,t[7]=(s*h*i-c*a*i+c*r*l-e*h*l-s*r*d+e*a*d)*_,t[8]=x*_,t[9]=(f*u*i-c*p*i-f*n*d+e*p*d+c*n*g-e*u*g)*_,t[10]=(s*p*i-f*o*i+f*n*l-e*p*l-s*n*g+e*o*g)*_,t[11]=(c*o*i-s*u*i-c*n*l+e*u*l+s*n*d-e*o*d)*_,t[12]=b*_,t[13]=(c*p*r-f*u*r+f*n*h-e*p*h-c*n*m+e*u*m)*_,t[14]=(f*o*r-s*p*r-f*n*a+e*p*a+s*n*m-e*o*m)*_,t[15]=(s*u*r-c*o*r+c*n*a-e*u*a-s*n*h+e*o*h)*_,this}scale(t){const e=this.elements,n=t.x,r=t.y,i=t.z;return e[0]*=n,e[4]*=r,e[8]*=i,e[1]*=n,e[5]*=r,e[9]*=i,e[2]*=n,e[6]*=r,e[10]*=i,e[3]*=n,e[7]*=r,e[11]*=i,this}getMaxScaleOnAxis(){const t=this.elements,e=t[0]*t[0]+t[1]*t[1]+t[2]*t[2],n=t[4]*t[4]+t[5]*t[5]+t[6]*t[6],r=t[8]*t[8]+t[9]*t[9]+t[10]*t[10];return Math.sqrt(Math.max(e,n,r))}makeTranslation(t,e,n){return this.set(1,0,0,t,0,1,0,e,0,0,1,n,0,0,0,1),this}makeRotationX(t){const e=Math.cos(t),n=Math.sin(t);return this.set(1,0,0,0,0,e,-n,0,0,n,e,0,0,0,0,1),this}makeRotationY(t){const e=Math.cos(t),n=Math.sin(t);return this.set(e,0,n,0,0,1,0,0,-n,0,e,0,0,0,0,1),this}makeRotationZ(t){const e=Math.cos(t),n=Math.sin(t);return this.set(e,-n,0,0,n,e,0,0,0,0,1,0,0,0,0,1),this}makeRotationAxis(t,e){const n=Math.cos(e),r=Math.sin(e),i=1-n,s=t.x,o=t.y,a=t.z,l=i*s,c=i*o;return this.set(l*s+n,l*o-r*a,l*a+r*o,0,l*o+r*a,c*o+n,c*a-r*s,0,l*a-r*o,c*a+r*s,i*a*a+n,0,0,0,0,1),this}makeScale(t,e,n){return this.set(t,0,0,0,0,e,0,0,0,0,n,0,0,0,0,1),this}makeShear(t,e,n,r,i,s){return this.set(1,n,i,0,t,1,s,0,e,r,1,0,0,0,0,1),this}compose(t,e,n){const r=this.elements,i=e._x,s=e._y,o=e._z,a=e._w,l=i+i,c=s+s,u=o+o,h=i*l,d=i*c,f=i*u,p=s*c,m=s*u,g=o*u,v=a*l,y=a*c,x=a*u,b=n.x,w=n.y,_=n.z;return r[0]=(1-(p+g))*b,r[1]=(d+x)*b,r[2]=(f-y)*b,r[3]=0,r[4]=(d-x)*w,r[5]=(1-(h+g))*w,r[6]=(m+v)*w,r[7]=0,r[8]=(f+y)*_,r[9]=(m-v)*_,r[10]=(1-(h+p))*_,r[11]=0,r[12]=t.x,r[13]=t.y,r[14]=t.z,r[15]=1,this}decompose(t,e,n){const r=this.elements;let i=ei.set(r[0],r[1],r[2]).length();const s=ei.set(r[4],r[5],r[6]).length(),o=ei.set(r[8],r[9],r[10]).length(),a=this.determinant();a<0&&(i=-i),t.x=r[12],t.y=r[13],t.z=r[14],ni.copy(this);const l=1/i,c=1/s,u=1/o;return ni.elements[0]*=l,ni.elements[1]*=l,ni.elements[2]*=l,ni.elements[4]*=c,ni.elements[5]*=c,ni.elements[6]*=c,ni.elements[8]*=u,ni.elements[9]*=u,ni.elements[10]*=u,e.setFromRotationMatrix(ni),n.x=i,n.y=s,n.z=o,this}makePerspective(t,e,n,r,i,s){void 0===s&&console.warn("THREE.Matrix4: .makePerspective() has been redefined and has a new signature. Please check the docs.");const o=this.elements,a=2*i/(e-t),l=2*i/(n-r),c=(e+t)/(e-t),u=(n+r)/(n-r),h=-(s+i)/(s-i),d=-2*s*i/(s-i);return o[0]=a,o[4]=0,o[8]=c,o[12]=0,o[1]=0,o[5]=l,o[9]=u,o[13]=0,o[2]=0,o[6]=0,o[10]=h,o[14]=d,o[3]=0,o[7]=0,o[11]=-1,o[15]=0,this}makeOrthographic(t,e,n,r,i,s){const o=this.elements,a=1/(e-t),l=1/(n-r),c=1/(s-i),u=(e+t)*a,h=(n+r)*l,d=(s+i)*c;return o[0]=2*a,o[4]=0,o[8]=0,o[12]=-u,o[1]=0,o[5]=2*l,o[9]=0,o[13]=-h,o[2]=0,o[6]=0,o[10]=-2*c,o[14]=-d,o[3]=0,o[7]=0,o[11]=0,o[15]=1,this}equals(t){const e=this.elements,n=t.elements;for(let r=0;r<16;r++)if(e[r]!==n[r])return!1;return!0}fromArray(t,e=0){for(let n=0;n<16;n++)this.elements[n]=t[n+e];return this}toArray(t=[],e=0){const n=this.elements;return t[e]=n[0],t[e+1]=n[1],t[e+2]=n[2],t[e+3]=n[3],t[e+4]=n[4],t[e+5]=n[5],t[e+6]=n[6],t[e+7]=n[7],t[e+8]=n[8],t[e+9]=n[9],t[e+10]=n[10],t[e+11]=n[11],t[e+12]=n[12],t[e+13]=n[13],t[e+14]=n[14],t[e+15]=n[15],t}}const ei=new Mr,ni=new ti,ri=new Mr(0,0,0),ii=new Mr(1,1,1),si=new Mr,oi=new Mr,ai=new Mr,li=new ti,ci=new _r;class ui{constructor(t=0,e=0,n=0,r=ui.DefaultOrder){this.isEuler=!0,this._x=t,this._y=e,this._z=n,this._order=r}get x(){return this._x}set x(t){this._x=t,this._onChangeCallback()}get y(){return this._y}set y(t){this._y=t,this._onChangeCallback()}get z(){return this._z}set z(t){this._z=t,this._onChangeCallback()}get order(){return this._order}set order(t){this._order=t,this._onChangeCallback()}set(t,e,n,r=this._order){return this._x=t,this._y=e,this._z=n,this._order=r,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._order)}copy(t){return this._x=t._x,this._y=t._y,this._z=t._z,this._order=t._order,this._onChangeCallback(),this}setFromRotationMatrix(t,e=this._order,n=!0){const r=t.elements,i=r[0],s=r[4],o=r[8],a=r[1],l=r[5],c=r[9],u=r[2],h=r[6],d=r[10];switch(e){case"XYZ":this._y=Math.asin(An(o,-1,1)),Math.abs(o)<.9999999?(this._x=Math.atan2(-c,d),this._z=Math.atan2(-s,i)):(this._x=Math.atan2(h,l),this._z=0);break;case"YXZ":this._x=Math.asin(-An(c,-1,1)),Math.abs(c)<.9999999?(this._y=Math.atan2(o,d),this._z=Math.atan2(a,l)):(this._y=Math.atan2(-u,i),this._z=0);break;case"ZXY":this._x=Math.asin(An(h,-1,1)),Math.abs(h)<.9999999?(this._y=Math.atan2(-u,d),this._z=Math.atan2(-s,l)):(this._y=0,this._z=Math.atan2(a,i));break;case"ZYX":this._y=Math.asin(-An(u,-1,1)),Math.abs(u)<.9999999?(this._x=Math.atan2(h,d),this._z=Math.atan2(a,i)):(this._x=0,this._z=Math.atan2(-s,l));break;case"YZX":this._z=Math.asin(An(a,-1,1)),Math.abs(a)<.9999999?(this._x=Math.atan2(-c,l),this._y=Math.atan2(-u,i)):(this._x=0,this._y=Math.atan2(o,d));break;case"XZY":this._z=Math.asin(-An(s,-1,1)),Math.abs(s)<.9999999?(this._x=Math.atan2(h,l),this._y=Math.atan2(o,i)):(this._x=Math.atan2(-c,d),this._y=0);break;default:console.warn("THREE.Euler: .setFromRotationMatrix() encountered an unknown order: "+e)}return this._order=e,!0===n&&this._onChangeCallback(),this}setFromQuaternion(t,e,n){return li.makeRotationFromQuaternion(t),this.setFromRotationMatrix(li,e,n)}setFromVector3(t,e=this._order){return this.set(t.x,t.y,t.z,e)}reorder(t){return ci.setFromEuler(this),this.setFromQuaternion(ci,t)}equals(t){return t._x===this._x&&t._y===this._y&&t._z===this._z&&t._order===this._order}fromArray(t){return this._x=t[0],this._y=t[1],this._z=t[2],void 0!==t[3]&&(this._order=t[3]),this._onChangeCallback(),this}toArray(t=[],e=0){return t[e]=this._x,t[e+1]=this._y,t[e+2]=this._z,t[e+3]=this._order,t}_onChange(t){return this._onChangeCallback=t,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._order}toVector3(){console.error("THREE.Euler: .toVector3() has been removed. Use Vector3.setFromEuler() instead")}}ui.DefaultOrder="XYZ",ui.RotationOrders=["XYZ","YZX","ZXY","XZY","YXZ","ZYX"];class hi{constructor(){this.mask=1}set(t){this.mask=(1<<t|0)>>>0}enable(t){this.mask|=1<<t|0}enableAll(){this.mask=-1}toggle(t){this.mask^=1<<t|0}disable(t){this.mask&=~(1<<t|0)}disableAll(){this.mask=0}test(t){return 0!==(this.mask&t.mask)}isEnabled(t){return 0!==(this.mask&(1<<t|0))}}let di=0;const fi=new Mr,pi=new _r,mi=new ti,gi=new Mr,vi=new Mr,yi=new Mr,xi=new _r,bi=new Mr(1,0,0),wi=new Mr(0,1,0),_i=new Mr(0,0,1),Mi={type:"added"},Ai={type:"removed"};class Si extends yn{constructor(){super(),this.isObject3D=!0,Object.defineProperty(this,"id",{value:di++}),this.uuid=Mn(),this.name="",this.type="Object3D",this.parent=null,this.children=[],this.up=Si.DefaultUp.clone();const t=new Mr,e=new ui,n=new _r,r=new Mr(1,1,1);function i(){n.setFromEuler(e,!1)}function s(){e.setFromQuaternion(n,void 0,!1)}e._onChange(i),n._onChange(s),Object.defineProperties(this,{position:{configurable:!0,enumerable:!0,value:t},rotation:{configurable:!0,enumerable:!0,value:e},quaternion:{configurable:!0,enumerable:!0,value:n},scale:{configurable:!0,enumerable:!0,value:r},modelViewMatrix:{value:new ti},normalMatrix:{value:new Yn}}),this.matrix=new ti,this.matrixWorld=new ti,this.matrixAutoUpdate=Si.DefaultMatrixAutoUpdate,this.matrixWorldNeedsUpdate=!1,this.layers=new hi,this.visible=!0,this.castShadow=!1,this.receiveShadow=!1,this.frustumCulled=!0,this.renderOrder=0,this.animations=[],this.userData={}}onBeforeRender(){}onAfterRender(){}applyMatrix4(t){this.matrixAutoUpdate&&this.updateMatrix(),this.matrix.premultiply(t),this.matrix.decompose(this.position,this.quaternion,this.scale)}applyQuaternion(t){return this.quaternion.premultiply(t),this}setRotationFromAxisAngle(t,e){this.quaternion.setFromAxisAngle(t,e)}setRotationFromEuler(t){this.quaternion.setFromEuler(t,!0)}setRotationFromMatrix(t){this.quaternion.setFromRotationMatrix(t)}setRotationFromQuaternion(t){this.quaternion.copy(t)}rotateOnAxis(t,e){return pi.setFromAxisAngle(t,e),this.quaternion.multiply(pi),this}rotateOnWorldAxis(t,e){return pi.setFromAxisAngle(t,e),this.quaternion.premultiply(pi),this}rotateX(t){return this.rotateOnAxis(bi,t)}rotateY(t){return this.rotateOnAxis(wi,t)}rotateZ(t){return this.rotateOnAxis(_i,t)}translateOnAxis(t,e){return fi.copy(t).applyQuaternion(this.quaternion),this.position.add(fi.multiplyScalar(e)),this}translateX(t){return this.translateOnAxis(bi,t)}translateY(t){return this.translateOnAxis(wi,t)}translateZ(t){return this.translateOnAxis(_i,t)}localToWorld(t){return t.applyMatrix4(this.matrixWorld)}worldToLocal(t){return t.applyMatrix4(mi.copy(this.matrixWorld).invert())}lookAt(t,e,n){t.isVector3?gi.copy(t):gi.set(t,e,n);const r=this.parent;this.updateWorldMatrix(!0,!1),vi.setFromMatrixPosition(this.matrixWorld),this.isCamera||this.isLight?mi.lookAt(vi,gi,this.up):mi.lookAt(gi,vi,this.up),this.quaternion.setFromRotationMatrix(mi),r&&(mi.extractRotation(r.matrixWorld),pi.setFromRotationMatrix(mi),this.quaternion.premultiply(pi.invert()))}add(t){if(arguments.length>1){for(let t=0;t<arguments.length;t++)this.add(arguments[t]);return this}return t===this?(console.error("THREE.Object3D.add: object can't be added as a child of itself.",t),this):(t&&t.isObject3D?(null!==t.parent&&t.parent.remove(t),t.parent=this,this.children.push(t),t.dispatchEvent(Mi)):console.error("THREE.Object3D.add: object not an instance of THREE.Object3D.",t),this)}remove(t){if(arguments.length>1){for(let t=0;t<arguments.length;t++)this.remove(arguments[t]);return this}const e=this.children.indexOf(t);return-1!==e&&(t.parent=null,this.children.splice(e,1),t.dispatchEvent(Ai)),this}removeFromParent(){const t=this.parent;return null!==t&&t.remove(this),this}clear(){for(let t=0;t<this.children.length;t++){const e=this.children[t];e.parent=null,e.dispatchEvent(Ai)}return this.children.length=0,this}attach(t){return this.updateWorldMatrix(!0,!1),mi.copy(this.matrixWorld).invert(),null!==t.parent&&(t.parent.updateWorldMatrix(!0,!1),mi.multiply(t.parent.matrixWorld)),t.applyMatrix4(mi),this.add(t),t.updateWorldMatrix(!1,!0),this}getObjectById(t){return this.getObjectByProperty("id",t)}getObjectByName(t){return this.getObjectByProperty("name",t)}getObjectByProperty(t,e){if(this[t]===e)return this;for(let n=0,r=this.children.length;n<r;n++){const r=this.children[n],i=r.getObjectByProperty(t,e);if(void 0!==i)return i}}getWorldPosition(t){return this.updateWorldMatrix(!0,!1),t.setFromMatrixPosition(this.matrixWorld)}getWorldQuaternion(t){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(vi,t,yi),t}getWorldScale(t){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(vi,xi,t),t}getWorldDirection(t){this.updateWorldMatrix(!0,!1);const e=this.matrixWorld.elements;return t.set(e[8],e[9],e[10]).normalize()}raycast(){}traverse(t){t(this);const e=this.children;for(let n=0,r=e.length;n<r;n++)e[n].traverse(t)}traverseVisible(t){if(!1===this.visible)return;t(this);const e=this.children;for(let n=0,r=e.length;n<r;n++)e[n].traverseVisible(t)}traverseAncestors(t){const e=this.parent;null!==e&&(t(e),e.traverseAncestors(t))}updateMatrix(){this.matrix.compose(this.position,this.quaternion,this.scale),this.matrixWorldNeedsUpdate=!0}updateMatrixWorld(t){this.matrixAutoUpdate&&this.updateMatrix(),(this.matrixWorldNeedsUpdate||t)&&(null===this.parent?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),this.matrixWorldNeedsUpdate=!1,t=!0);const e=this.children;for(let n=0,r=e.length;n<r;n++)e[n].updateMatrixWorld(t)}updateWorldMatrix(t,e){const n=this.parent;if(!0===t&&null!==n&&n.updateWorldMatrix(!0,!1),this.matrixAutoUpdate&&this.updateMatrix(),null===this.parent?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),!0===e){const t=this.children;for(let e=0,n=t.length;e<n;e++)t[e].updateWorldMatrix(!1,!0)}}toJSON(t){const e=void 0===t||"string"===typeof t,n={};e&&(t={geometries:{},materials:{},textures:{},images:{},shapes:{},skeletons:{},animations:{},nodes:{}},n.metadata={version:4.5,type:"Object",generator:"Object3D.toJSON"});const r={};function i(e,n){return void 0===e[n.uuid]&&(e[n.uuid]=n.toJSON(t)),n.uuid}if(r.uuid=this.uuid,r.type=this.type,""!==this.name&&(r.name=this.name),!0===this.castShadow&&(r.castShadow=!0),!0===this.receiveShadow&&(r.receiveShadow=!0),!1===this.visible&&(r.visible=!1),!1===this.frustumCulled&&(r.frustumCulled=!1),0!==this.renderOrder&&(r.renderOrder=this.renderOrder),"{}"!==JSON.stringify(this.userData)&&(r.userData=this.userData),r.layers=this.layers.mask,r.matrix=this.matrix.toArray(),!1===this.matrixAutoUpdate&&(r.matrixAutoUpdate=!1),this.isInstancedMesh&&(r.type="InstancedMesh",r.count=this.count,r.instanceMatrix=this.instanceMatrix.toJSON(),null!==this.instanceColor&&(r.instanceColor=this.instanceColor.toJSON())),this.isScene)this.background&&(this.background.isColor?r.background=this.background.toJSON():this.background.isTexture&&(r.background=this.background.toJSON(t).uuid)),this.environment&&this.environment.isTexture&&(r.environment=this.environment.toJSON(t).uuid);else if(this.isMesh||this.isLine||this.isPoints){r.geometry=i(t.geometries,this.geometry);const e=this.geometry.parameters;if(void 0!==e&&void 0!==e.shapes){const n=e.shapes;if(Array.isArray(n))for(let e=0,r=n.length;e<r;e++){const r=n[e];i(t.shapes,r)}else i(t.shapes,n)}}if(this.isSkinnedMesh&&(r.bindMode=this.bindMode,r.bindMatrix=this.bindMatrix.toArray(),void 0!==this.skeleton&&(i(t.skeletons,this.skeleton),r.skeleton=this.skeleton.uuid)),void 0!==this.material)if(Array.isArray(this.material)){const e=[];for(let n=0,r=this.material.length;n<r;n++)e.push(i(t.materials,this.material[n]));r.material=e}else r.material=i(t.materials,this.material);if(this.children.length>0){r.children=[];for(let e=0;e<this.children.length;e++)r.children.push(this.children[e].toJSON(t).object)}if(this.animations.length>0){r.animations=[];for(let e=0;e<this.animations.length;e++){const n=this.animations[e];r.animations.push(i(t.animations,n))}}if(e){const e=s(t.geometries),r=s(t.materials),i=s(t.textures),o=s(t.images),a=s(t.shapes),l=s(t.skeletons),c=s(t.animations),u=s(t.nodes);e.length>0&&(n.geometries=e),r.length>0&&(n.materials=r),i.length>0&&(n.textures=i),o.length>0&&(n.images=o),a.length>0&&(n.shapes=a),l.length>0&&(n.skeletons=l),c.length>0&&(n.animations=c),u.length>0&&(n.nodes=u)}return n.object=r,n;function s(t){const e=[];for(const n in t){const r=t[n];delete r.metadata,e.push(r)}return e}}clone(t){return(new this.constructor).copy(this,t)}copy(t,e=!0){if(this.name=t.name,this.up.copy(t.up),this.position.copy(t.position),this.rotation.order=t.rotation.order,this.quaternion.copy(t.quaternion),this.scale.copy(t.scale),this.matrix.copy(t.matrix),this.matrixWorld.copy(t.matrixWorld),this.matrixAutoUpdate=t.matrixAutoUpdate,this.matrixWorldNeedsUpdate=t.matrixWorldNeedsUpdate,this.layers.mask=t.layers.mask,this.visible=t.visible,this.castShadow=t.castShadow,this.receiveShadow=t.receiveShadow,this.frustumCulled=t.frustumCulled,this.renderOrder=t.renderOrder,this.userData=JSON.parse(JSON.stringify(t.userData)),!0===e)for(let n=0;n<t.children.length;n++){const e=t.children[n];this.add(e.clone())}return this}}Si.DefaultUp=new Mr(0,1,0),Si.DefaultMatrixAutoUpdate=!0;const Ei=new Mr,Ti=new Mr,Ci=new Mr,Ri=new Mr,Ii=new Mr,Pi=new Mr,Li=new Mr,Ni=new Mr,ki=new Mr,Oi=new Mr;class Di{constructor(t=new Mr,e=new Mr,n=new Mr){this.a=t,this.b=e,this.c=n}static getNormal(t,e,n,r){r.subVectors(n,e),Ei.subVectors(t,e),r.cross(Ei);const i=r.lengthSq();return i>0?r.multiplyScalar(1/Math.sqrt(i)):r.set(0,0,0)}static getBarycoord(t,e,n,r,i){Ei.subVectors(r,e),Ti.subVectors(n,e),Ci.subVectors(t,e);const s=Ei.dot(Ei),o=Ei.dot(Ti),a=Ei.dot(Ci),l=Ti.dot(Ti),c=Ti.dot(Ci),u=s*l-o*o;if(0===u)return i.set(-2,-1,-1);const h=1/u,d=(l*a-o*c)*h,f=(s*c-o*a)*h;return i.set(1-d-f,f,d)}static containsPoint(t,e,n,r){return this.getBarycoord(t,e,n,r,Ri),Ri.x>=0&&Ri.y>=0&&Ri.x+Ri.y<=1}static getUV(t,e,n,r,i,s,o,a){return this.getBarycoord(t,e,n,r,Ri),a.set(0,0),a.addScaledVector(i,Ri.x),a.addScaledVector(s,Ri.y),a.addScaledVector(o,Ri.z),a}static isFrontFacing(t,e,n,r){return Ei.subVectors(n,e),Ti.subVectors(t,e),Ei.cross(Ti).dot(r)<0}set(t,e,n){return this.a.copy(t),this.b.copy(e),this.c.copy(n),this}setFromPointsAndIndices(t,e,n,r){return this.a.copy(t[e]),this.b.copy(t[n]),this.c.copy(t[r]),this}setFromAttributeAndIndices(t,e,n,r){return this.a.fromBufferAttribute(t,e),this.b.fromBufferAttribute(t,n),this.c.fromBufferAttribute(t,r),this}clone(){return(new this.constructor).copy(this)}copy(t){return this.a.copy(t.a),this.b.copy(t.b),this.c.copy(t.c),this}getArea(){return Ei.subVectors(this.c,this.b),Ti.subVectors(this.a,this.b),.5*Ei.cross(Ti).length()}getMidpoint(t){return t.addVectors(this.a,this.b).add(this.c).multiplyScalar(1/3)}getNormal(t){return Di.getNormal(this.a,this.b,this.c,t)}getPlane(t){return t.setFromCoplanarPoints(this.a,this.b,this.c)}getBarycoord(t,e){return Di.getBarycoord(t,this.a,this.b,this.c,e)}getUV(t,e,n,r,i){return Di.getUV(t,this.a,this.b,this.c,e,n,r,i)}containsPoint(t){return Di.containsPoint(t,this.a,this.b,this.c)}isFrontFacing(t){return Di.isFrontFacing(this.a,this.b,this.c,t)}intersectsBox(t){return t.intersectsTriangle(this)}closestPointToPoint(t,e){const n=this.a,r=this.b,i=this.c;let s,o;Ii.subVectors(r,n),Pi.subVectors(i,n),Ni.subVectors(t,n);const a=Ii.dot(Ni),l=Pi.dot(Ni);if(a<=0&&l<=0)return e.copy(n);ki.subVectors(t,r);const c=Ii.dot(ki),u=Pi.dot(ki);if(c>=0&&u<=c)return e.copy(r);const h=a*u-c*l;if(h<=0&&a>=0&&c<=0)return s=a/(a-c),e.copy(n).addScaledVector(Ii,s);Oi.subVectors(t,i);const d=Ii.dot(Oi),f=Pi.dot(Oi);if(f>=0&&d<=f)return e.copy(i);const p=d*l-a*f;if(p<=0&&l>=0&&f<=0)return o=l/(l-f),e.copy(n).addScaledVector(Pi,o);const m=c*f-d*u;if(m<=0&&u-c>=0&&d-f>=0)return Li.subVectors(i,r),o=(u-c)/(u-c+(d-f)),e.copy(r).addScaledVector(Li,o);const g=1/(m+p+h);return s=p*g,o=h*g,e.copy(n).addScaledVector(Ii,s).addScaledVector(Pi,o)}equals(t){return t.a.equals(this.a)&&t.b.equals(this.b)&&t.c.equals(this.c)}}let zi=0;class Fi extends yn{constructor(){super(),this.isMaterial=!0,Object.defineProperty(this,"id",{value:zi++}),this.uuid=Mn(),this.name="",this.type="Material",this.blending=_,this.side=g,this.vertexColors=!1,this.opacity=1,this.transparent=!1,this.blendSrc=D,this.blendDst=z,this.blendEquation=T,this.blendSrcAlpha=null,this.blendDstAlpha=null,this.blendEquationAlpha=null,this.depthFunc=q,this.depthTest=!0,this.depthWrite=!0,this.stencilWriteMask=255,this.stencilFunc=sn,this.stencilRef=0,this.stencilFuncMask=255,this.stencilFail=je,this.stencilZFail=je,this.stencilZPass=je,this.stencilWrite=!1,this.clippingPlanes=null,this.clipIntersection=!1,this.clipShadows=!1,this.shadowSide=null,this.colorWrite=!0,this.precision=null,this.polygonOffset=!1,this.polygonOffsetFactor=0,this.polygonOffsetUnits=0,this.dithering=!1,this.alphaToCoverage=!1,this.premultipliedAlpha=!1,this.visible=!0,this.toneMapped=!0,this.userData={},this.version=0,this._alphaTest=0}get alphaTest(){return this._alphaTest}set alphaTest(t){this._alphaTest>0!==t>0&&this.version++,this._alphaTest=t}onBuild(){}onBeforeRender(){}onBeforeCompile(){}customProgramCacheKey(){return this.onBeforeCompile.toString()}setValues(t){if(void 0!==t)for(const e in t){const n=t[e];if(void 0===n){console.warn("THREE.Material: '"+e+"' parameter is undefined.");continue}if("shading"===e){console.warn("THREE."+this.type+": .shading has been removed. Use the boolean .flatShading instead."),this.flatShading=n===x;continue}const r=this[e];void 0!==r?r&&r.isColor?r.set(n):r&&r.isVector3&&n&&n.isVector3?r.copy(n):this[e]=n:console.warn("THREE."+this.type+": '"+e+"' is not a property of this material.")}}toJSON(t){const e=void 0===t||"string"===typeof t;e&&(t={textures:{},images:{}});const n={metadata:{version:4.5,type:"Material",generator:"Material.toJSON"}};function r(t){const e=[];for(const n in t){const r=t[n];delete r.metadata,e.push(r)}return e}if(n.uuid=this.uuid,n.type=this.type,""!==this.name&&(n.name=this.name),this.color&&this.color.isColor&&(n.color=this.color.getHex()),void 0!==this.roughness&&(n.roughness=this.roughness),void 0!==this.metalness&&(n.metalness=this.metalness),void 0!==this.sheen&&(n.sheen=this.sheen),this.sheenColor&&this.sheenColor.isColor&&(n.sheenColor=this.sheenColor.getHex()),void 0!==this.sheenRoughness&&(n.sheenRoughness=this.sheenRoughness),this.emissive&&this.emissive.isColor&&(n.emissive=this.emissive.getHex()),this.emissiveIntensity&&1!==this.emissiveIntensity&&(n.emissiveIntensity=this.emissiveIntensity),this.specular&&this.specular.isColor&&(n.specular=this.specular.getHex()),void 0!==this.specularIntensity&&(n.specularIntensity=this.specularIntensity),this.specularColor&&this.specularColor.isColor&&(n.specularColor=this.specularColor.getHex()),void 0!==this.shininess&&(n.shininess=this.shininess),void 0!==this.clearcoat&&(n.clearcoat=this.clearcoat),void 0!==this.clearcoatRoughness&&(n.clearcoatRoughness=this.clearcoatRoughness),this.clearcoatMap&&this.clearcoatMap.isTexture&&(n.clearcoatMap=this.clearcoatMap.toJSON(t).uuid),this.clearcoatRoughnessMap&&this.clearcoatRoughnessMap.isTexture&&(n.clearcoatRoughnessMap=this.clearcoatRoughnessMap.toJSON(t).uuid),this.clearcoatNormalMap&&this.clearcoatNormalMap.isTexture&&(n.clearcoatNormalMap=this.clearcoatNormalMap.toJSON(t).uuid,n.clearcoatNormalScale=this.clearcoatNormalScale.toArray()),void 0!==this.iridescence&&(n.iridescence=this.iridescence),void 0!==this.iridescenceIOR&&(n.iridescenceIOR=this.iridescenceIOR),void 0!==this.iridescenceThicknessRange&&(n.iridescenceThicknessRange=this.iridescenceThicknessRange),this.iridescenceMap&&this.iridescenceMap.isTexture&&(n.iridescenceMap=this.iridescenceMap.toJSON(t).uuid),this.iridescenceThicknessMap&&this.iridescenceThicknessMap.isTexture&&(n.iridescenceThicknessMap=this.iridescenceThicknessMap.toJSON(t).uuid),this.map&&this.map.isTexture&&(n.map=this.map.toJSON(t).uuid),this.matcap&&this.matcap.isTexture&&(n.matcap=this.matcap.toJSON(t).uuid),this.alphaMap&&this.alphaMap.isTexture&&(n.alphaMap=this.alphaMap.toJSON(t).uuid),this.lightMap&&this.lightMap.isTexture&&(n.lightMap=this.lightMap.toJSON(t).uuid,n.lightMapIntensity=this.lightMapIntensity),this.aoMap&&this.aoMap.isTexture&&(n.aoMap=this.aoMap.toJSON(t).uuid,n.aoMapIntensity=this.aoMapIntensity),this.bumpMap&&this.bumpMap.isTexture&&(n.bumpMap=this.bumpMap.toJSON(t).uuid,n.bumpScale=this.bumpScale),this.normalMap&&this.normalMap.isTexture&&(n.normalMap=this.normalMap.toJSON(t).uuid,n.normalMapType=this.normalMapType,n.normalScale=this.normalScale.toArray()),this.displacementMap&&this.displacementMap.isTexture&&(n.displacementMap=this.displacementMap.toJSON(t).uuid,n.displacementScale=this.displacementScale,n.displacementBias=this.displacementBias),this.roughnessMap&&this.roughnessMap.isTexture&&(n.roughnessMap=this.roughnessMap.toJSON(t).uuid),this.metalnessMap&&this.metalnessMap.isTexture&&(n.metalnessMap=this.metalnessMap.toJSON(t).uuid),this.emissiveMap&&this.emissiveMap.isTexture&&(n.emissiveMap=this.emissiveMap.toJSON(t).uuid),this.specularMap&&this.specularMap.isTexture&&(n.specularMap=this.specularMap.toJSON(t).uuid),this.specularIntensityMap&&this.specularIntensityMap.isTexture&&(n.specularIntensityMap=this.specularIntensityMap.toJSON(t).uuid),this.specularColorMap&&this.specularColorMap.isTexture&&(n.specularColorMap=this.specularColorMap.toJSON(t).uuid),this.envMap&&this.envMap.isTexture&&(n.envMap=this.envMap.toJSON(t).uuid,void 0!==this.combine&&(n.combine=this.combine)),void 0!==this.envMapIntensity&&(n.envMapIntensity=this.envMapIntensity),void 0!==this.reflectivity&&(n.reflectivity=this.reflectivity),void 0!==this.refractionRatio&&(n.refractionRatio=this.refractionRatio),this.gradientMap&&this.gradientMap.isTexture&&(n.gradientMap=this.gradientMap.toJSON(t).uuid),void 0!==this.transmission&&(n.transmission=this.transmission),this.transmissionMap&&this.transmissionMap.isTexture&&(n.transmissionMap=this.transmissionMap.toJSON(t).uuid),void 0!==this.thickness&&(n.thickness=this.thickness),this.thicknessMap&&this.thicknessMap.isTexture&&(n.thicknessMap=this.thicknessMap.toJSON(t).uuid),void 0!==this.attenuationDistance&&(n.attenuationDistance=this.attenuationDistance),void 0!==this.attenuationColor&&(n.attenuationColor=this.attenuationColor.getHex()),void 0!==this.size&&(n.size=this.size),null!==this.shadowSide&&(n.shadowSide=this.shadowSide),void 0!==this.sizeAttenuation&&(n.sizeAttenuation=this.sizeAttenuation),this.blending!==_&&(n.blending=this.blending),this.side!==g&&(n.side=this.side),this.vertexColors&&(n.vertexColors=!0),this.opacity<1&&(n.opacity=this.opacity),!0===this.transparent&&(n.transparent=this.transparent),n.depthFunc=this.depthFunc,n.depthTest=this.depthTest,n.depthWrite=this.depthWrite,n.colorWrite=this.colorWrite,n.stencilWrite=this.stencilWrite,n.stencilWriteMask=this.stencilWriteMask,n.stencilFunc=this.stencilFunc,n.stencilRef=this.stencilRef,n.stencilFuncMask=this.stencilFuncMask,n.stencilFail=this.stencilFail,n.stencilZFail=this.stencilZFail,n.stencilZPass=this.stencilZPass,void 0!==this.rotation&&0!==this.rotation&&(n.rotation=this.rotation),!0===this.polygonOffset&&(n.polygonOffset=!0),0!==this.polygonOffsetFactor&&(n.polygonOffsetFactor=this.polygonOffsetFactor),0!==this.polygonOffsetUnits&&(n.polygonOffsetUnits=this.polygonOffsetUnits),void 0!==this.linewidth&&1!==this.linewidth&&(n.linewidth=this.linewidth),void 0!==this.dashSize&&(n.dashSize=this.dashSize),void 0!==this.gapSize&&(n.gapSize=this.gapSize),void 0!==this.scale&&(n.scale=this.scale),!0===this.dithering&&(n.dithering=!0),this.alphaTest>0&&(n.alphaTest=this.alphaTest),!0===this.alphaToCoverage&&(n.alphaToCoverage=this.alphaToCoverage),!0===this.premultipliedAlpha&&(n.premultipliedAlpha=this.premultipliedAlpha),!0===this.wireframe&&(n.wireframe=this.wireframe),this.wireframeLinewidth>1&&(n.wireframeLinewidth=this.wireframeLinewidth),"round"!==this.wireframeLinecap&&(n.wireframeLinecap=this.wireframeLinecap),"round"!==this.wireframeLinejoin&&(n.wireframeLinejoin=this.wireframeLinejoin),!0===this.flatShading&&(n.flatShading=this.flatShading),!1===this.visible&&(n.visible=!1),!1===this.toneMapped&&(n.toneMapped=!1),!1===this.fog&&(n.fog=!1),"{}"!==JSON.stringify(this.userData)&&(n.userData=this.userData),e){const e=r(t.textures),i=r(t.images);e.length>0&&(n.textures=e),i.length>0&&(n.images=i)}return n}clone(){return(new this.constructor).copy(this)}copy(t){this.name=t.name,this.blending=t.blending,this.side=t.side,this.vertexColors=t.vertexColors,this.opacity=t.opacity,this.transparent=t.transparent,this.blendSrc=t.blendSrc,this.blendDst=t.blendDst,this.blendEquation=t.blendEquation,this.blendSrcAlpha=t.blendSrcAlpha,this.blendDstAlpha=t.blendDstAlpha,this.blendEquationAlpha=t.blendEquationAlpha,this.depthFunc=t.depthFunc,this.depthTest=t.depthTest,this.depthWrite=t.depthWrite,this.stencilWriteMask=t.stencilWriteMask,this.stencilFunc=t.stencilFunc,this.stencilRef=t.stencilRef,this.stencilFuncMask=t.stencilFuncMask,this.stencilFail=t.stencilFail,this.stencilZFail=t.stencilZFail,this.stencilZPass=t.stencilZPass,this.stencilWrite=t.stencilWrite;const e=t.clippingPlanes;let n=null;if(null!==e){const t=e.length;n=new Array(t);for(let r=0;r!==t;++r)n[r]=e[r].clone()}return this.clippingPlanes=n,this.clipIntersection=t.clipIntersection,this.clipShadows=t.clipShadows,this.shadowSide=t.shadowSide,this.colorWrite=t.colorWrite,this.precision=t.precision,this.polygonOffset=t.polygonOffset,this.polygonOffsetFactor=t.polygonOffsetFactor,this.polygonOffsetUnits=t.polygonOffsetUnits,this.dithering=t.dithering,this.alphaTest=t.alphaTest,this.alphaToCoverage=t.alphaToCoverage,this.premultipliedAlpha=t.premultipliedAlpha,this.visible=t.visible,this.toneMapped=t.toneMapped,this.userData=JSON.parse(JSON.stringify(t.userData)),this}dispose(){this.dispatchEvent({type:"dispose"})}set needsUpdate(t){!0===t&&this.version++}get vertexTangents(){return console.warn("THREE."+this.type+": .vertexTangents has been removed."),!1}set vertexTangents(t){console.warn("THREE."+this.type+": .vertexTangents has been removed.")}}Fi.fromType=function(){return null};class Ui extends Fi{constructor(t){super(),this.isMeshBasicMaterial=!0,this.type="MeshBasicMaterial",this.color=new lr(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=Z,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.fog=!0,this.setValues(t)}copy(t){return super.copy(t),this.color.copy(t.color),this.map=t.map,this.lightMap=t.lightMap,this.lightMapIntensity=t.lightMapIntensity,this.aoMap=t.aoMap,this.aoMapIntensity=t.aoMapIntensity,this.specularMap=t.specularMap,this.alphaMap=t.alphaMap,this.envMap=t.envMap,this.combine=t.combine,this.reflectivity=t.reflectivity,this.refractionRatio=t.refractionRatio,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.wireframeLinecap=t.wireframeLinecap,this.wireframeLinejoin=t.wireframeLinejoin,this.fog=t.fog,this}}const Bi=new Mr,Gi=new qn;class Hi{constructor(t,e,n){if(Array.isArray(t))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");this.isBufferAttribute=!0,this.name="",this.array=t,this.itemSize=e,this.count=void 0!==t?t.length/e:0,this.normalized=!0===n,this.usage=on,this.updateRange={offset:0,count:-1},this.version=0}onUploadCallback(){}set needsUpdate(t){!0===t&&this.version++}setUsage(t){return this.usage=t,this}copy(t){return this.name=t.name,this.array=new t.array.constructor(t.array),this.itemSize=t.itemSize,this.count=t.count,this.normalized=t.normalized,this.usage=t.usage,this}copyAt(t,e,n){t*=this.itemSize,n*=e.itemSize;for(let r=0,i=this.itemSize;r<i;r++)this.array[t+r]=e.array[n+r];return this}copyArray(t){return this.array.set(t),this}copyColorsArray(t){const e=this.array;let n=0;for(let r=0,i=t.length;r<i;r++){let i=t[r];void 0===i&&(console.warn("THREE.BufferAttribute.copyColorsArray(): color is undefined",r),i=new lr),e[n++]=i.r,e[n++]=i.g,e[n++]=i.b}return this}copyVector2sArray(t){const e=this.array;let n=0;for(let r=0,i=t.length;r<i;r++){let i=t[r];void 0===i&&(console.warn("THREE.BufferAttribute.copyVector2sArray(): vector is undefined",r),i=new qn),e[n++]=i.x,e[n++]=i.y}return this}copyVector3sArray(t){const e=this.array;let n=0;for(let r=0,i=t.length;r<i;r++){let i=t[r];void 0===i&&(console.warn("THREE.BufferAttribute.copyVector3sArray(): vector is undefined",r),i=new Mr),e[n++]=i.x,e[n++]=i.y,e[n++]=i.z}return this}copyVector4sArray(t){const e=this.array;let n=0;for(let r=0,i=t.length;r<i;r++){let i=t[r];void 0===i&&(console.warn("THREE.BufferAttribute.copyVector4sArray(): vector is undefined",r),i=new mr),e[n++]=i.x,e[n++]=i.y,e[n++]=i.z,e[n++]=i.w}return this}applyMatrix3(t){if(2===this.itemSize)for(let e=0,n=this.count;e<n;e++)Gi.fromBufferAttribute(this,e),Gi.applyMatrix3(t),this.setXY(e,Gi.x,Gi.y);else if(3===this.itemSize)for(let e=0,n=this.count;e<n;e++)Bi.fromBufferAttribute(this,e),Bi.applyMatrix3(t),this.setXYZ(e,Bi.x,Bi.y,Bi.z);return this}applyMatrix4(t){for(let e=0,n=this.count;e<n;e++)Bi.fromBufferAttribute(this,e),Bi.applyMatrix4(t),this.setXYZ(e,Bi.x,Bi.y,Bi.z);return this}applyNormalMatrix(t){for(let e=0,n=this.count;e<n;e++)Bi.fromBufferAttribute(this,e),Bi.applyNormalMatrix(t),this.setXYZ(e,Bi.x,Bi.y,Bi.z);return this}transformDirection(t){for(let e=0,n=this.count;e<n;e++)Bi.fromBufferAttribute(this,e),Bi.transformDirection(t),this.setXYZ(e,Bi.x,Bi.y,Bi.z);return this}set(t,e=0){return this.array.set(t,e),this}getX(t){return this.array[t*this.itemSize]}setX(t,e){return this.array[t*this.itemSize]=e,this}getY(t){return this.array[t*this.itemSize+1]}setY(t,e){return this.array[t*this.itemSize+1]=e,this}getZ(t){return this.array[t*this.itemSize+2]}setZ(t,e){return this.array[t*this.itemSize+2]=e,this}getW(t){return this.array[t*this.itemSize+3]}setW(t,e){return this.array[t*this.itemSize+3]=e,this}setXY(t,e,n){return t*=this.itemSize,this.array[t+0]=e,this.array[t+1]=n,this}setXYZ(t,e,n,r){return t*=this.itemSize,this.array[t+0]=e,this.array[t+1]=n,this.array[t+2]=r,this}setXYZW(t,e,n,r,i){return t*=this.itemSize,this.array[t+0]=e,this.array[t+1]=n,this.array[t+2]=r,this.array[t+3]=i,this}onUpload(t){return this.onUploadCallback=t,this}clone(){return new this.constructor(this.array,this.itemSize).copy(this)}toJSON(){const t={itemSize:this.itemSize,type:this.array.constructor.name,array:Array.prototype.slice.call(this.array),normalized:this.normalized};return""!==this.name&&(t.name=this.name),this.usage!==on&&(t.usage=this.usage),0===this.updateRange.offset&&-1===this.updateRange.count||(t.updateRange=this.updateRange),t}}class Vi extends Hi{constructor(t,e,n){super(new Int8Array(t),e,n)}}class ji extends Hi{constructor(t,e,n){super(new Uint8Array(t),e,n)}}class Wi extends Hi{constructor(t,e,n){super(new Uint8ClampedArray(t),e,n)}}class qi extends Hi{constructor(t,e,n){super(new Int16Array(t),e,n)}}class Yi extends Hi{constructor(t,e,n){super(new Uint16Array(t),e,n)}}class Xi extends Hi{constructor(t,e,n){super(new Int32Array(t),e,n)}}class Ji extends Hi{constructor(t,e,n){super(new Uint32Array(t),e,n)}}class Ki extends Hi{constructor(t,e,n){super(new Uint16Array(t),e,n),this.isFloat16BufferAttribute=!0}}class Zi extends Hi{constructor(t,e,n){super(new Float32Array(t),e,n)}}class Qi extends Hi{constructor(t,e,n){super(new Float64Array(t),e,n)}}let $i=0;const ts=new ti,es=new Si,ns=new Mr,rs=new Er,is=new Er,ss=new Mr;class os extends yn{constructor(){super(),this.isBufferGeometry=!0,Object.defineProperty(this,"id",{value:$i++}),this.uuid=Mn(),this.name="",this.type="BufferGeometry",this.index=null,this.attributes={},this.morphAttributes={},this.morphTargetsRelative=!1,this.groups=[],this.boundingBox=null,this.boundingSphere=null,this.drawRange={start:0,count:1/0},this.userData={}}getIndex(){return this.index}setIndex(t){return Array.isArray(t)?this.index=new(Xn(t)?Ji:Yi)(t,1):this.index=t,this}getAttribute(t){return this.attributes[t]}setAttribute(t,e){return this.attributes[t]=e,this}deleteAttribute(t){return delete this.attributes[t],this}hasAttribute(t){return void 0!==this.attributes[t]}addGroup(t,e,n=0){this.groups.push({start:t,count:e,materialIndex:n})}clearGroups(){this.groups=[]}setDrawRange(t,e){this.drawRange.start=t,this.drawRange.count=e}applyMatrix4(t){const e=this.attributes.position;void 0!==e&&(e.applyMatrix4(t),e.needsUpdate=!0);const n=this.attributes.normal;if(void 0!==n){const e=(new Yn).getNormalMatrix(t);n.applyNormalMatrix(e),n.needsUpdate=!0}const r=this.attributes.tangent;return void 0!==r&&(r.transformDirection(t),r.needsUpdate=!0),null!==this.boundingBox&&this.computeBoundingBox(),null!==this.boundingSphere&&this.computeBoundingSphere(),this}applyQuaternion(t){return ts.makeRotationFromQuaternion(t),this.applyMatrix4(ts),this}rotateX(t){return ts.makeRotationX(t),this.applyMatrix4(ts),this}rotateY(t){return ts.makeRotationY(t),this.applyMatrix4(ts),this}rotateZ(t){return ts.makeRotationZ(t),this.applyMatrix4(ts),this}translate(t,e,n){return ts.makeTranslation(t,e,n),this.applyMatrix4(ts),this}scale(t,e,n){return ts.makeScale(t,e,n),this.applyMatrix4(ts),this}lookAt(t){return es.lookAt(t),es.updateMatrix(),this.applyMatrix4(es.matrix),this}center(){return this.computeBoundingBox(),this.boundingBox.getCenter(ns).negate(),this.translate(ns.x,ns.y,ns.z),this}setFromPoints(t){const e=[];for(let n=0,r=t.length;n<r;n++){const r=t[n];e.push(r.x,r.y,r.z||0)}return this.setAttribute("position",new Zi(e,3)),this}computeBoundingBox(){null===this.boundingBox&&(this.boundingBox=new Er);const t=this.attributes.position,e=this.morphAttributes.position;if(t&&t.isGLBufferAttribute)return console.error('THREE.BufferGeometry.computeBoundingBox(): GLBufferAttribute requires a manual bounding box. Alternatively set "mesh.frustumCulled" to "false".',this),void this.boundingBox.set(new Mr(-1/0,-1/0,-1/0),new Mr(1/0,1/0,1/0));if(void 0!==t){if(this.boundingBox.setFromBufferAttribute(t),e)for(let n=0,r=e.length;n<r;n++){const t=e[n];rs.setFromBufferAttribute(t),this.morphTargetsRelative?(ss.addVectors(this.boundingBox.min,rs.min),this.boundingBox.expandByPoint(ss),ss.addVectors(this.boundingBox.max,rs.max),this.boundingBox.expandByPoint(ss)):(this.boundingBox.expandByPoint(rs.min),this.boundingBox.expandByPoint(rs.max))}}else this.boundingBox.makeEmpty();(isNaN(this.boundingBox.min.x)||isNaN(this.boundingBox.min.y)||isNaN(this.boundingBox.min.z))&&console.error('THREE.BufferGeometry.computeBoundingBox(): Computed min/max have NaN values. The "position" attribute is likely to have NaN values.',this)}computeBoundingSphere(){null===this.boundingSphere&&(this.boundingSphere=new Wr);const t=this.attributes.position,e=this.morphAttributes.position;if(t&&t.isGLBufferAttribute)return console.error('THREE.BufferGeometry.computeBoundingSphere(): GLBufferAttribute requires a manual bounding sphere. Alternatively set "mesh.frustumCulled" to "false".',this),void this.boundingSphere.set(new Mr,1/0);if(t){const n=this.boundingSphere.center;if(rs.setFromBufferAttribute(t),e)for(let t=0,i=e.length;t<i;t++){const n=e[t];is.setFromBufferAttribute(n),this.morphTargetsRelative?(ss.addVectors(rs.min,is.min),rs.expandByPoint(ss),ss.addVectors(rs.max,is.max),rs.expandByPoint(ss)):(rs.expandByPoint(is.min),rs.expandByPoint(is.max))}rs.getCenter(n);let r=0;for(let e=0,i=t.count;e<i;e++)ss.fromBufferAttribute(t,e),r=Math.max(r,n.distanceToSquared(ss));if(e)for(let i=0,s=e.length;i<s;i++){const s=e[i],o=this.morphTargetsRelative;for(let e=0,i=s.count;e<i;e++)ss.fromBufferAttribute(s,e),o&&(ns.fromBufferAttribute(t,e),ss.add(ns)),r=Math.max(r,n.distanceToSquared(ss))}this.boundingSphere.radius=Math.sqrt(r),isNaN(this.boundingSphere.radius)&&console.error('THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.',this)}}computeTangents(){const t=this.index,e=this.attributes;if(null===t||void 0===e.position||void 0===e.normal||void 0===e.uv)return void console.error("THREE.BufferGeometry: .computeTangents() failed. Missing required attributes (index, position, normal or uv)");const n=t.array,r=e.position.array,i=e.normal.array,s=e.uv.array,o=r.length/3;!1===this.hasAttribute("tangent")&&this.setAttribute("tangent",new Hi(new Float32Array(4*o),4));const a=this.getAttribute("tangent").array,l=[],c=[];for(let S=0;S<o;S++)l[S]=new Mr,c[S]=new Mr;const u=new Mr,h=new Mr,d=new Mr,f=new qn,p=new qn,m=new qn,g=new Mr,v=new Mr;function y(t,e,n){u.fromArray(r,3*t),h.fromArray(r,3*e),d.fromArray(r,3*n),f.fromArray(s,2*t),p.fromArray(s,2*e),m.fromArray(s,2*n),h.sub(u),d.sub(u),p.sub(f),m.sub(f);const i=1/(p.x*m.y-m.x*p.y);isFinite(i)&&(g.copy(h).multiplyScalar(m.y).addScaledVector(d,-p.y).multiplyScalar(i),v.copy(d).multiplyScalar(p.x).addScaledVector(h,-m.x).multiplyScalar(i),l[t].add(g),l[e].add(g),l[n].add(g),c[t].add(v),c[e].add(v),c[n].add(v))}let x=this.groups;0===x.length&&(x=[{start:0,count:n.length}]);for(let S=0,E=x.length;S<E;++S){const t=x[S],e=t.start,r=t.count;for(let i=e,s=e+r;i<s;i+=3)y(n[i+0],n[i+1],n[i+2])}const b=new Mr,w=new Mr,_=new Mr,M=new Mr;function A(t){_.fromArray(i,3*t),M.copy(_);const e=l[t];b.copy(e),b.sub(_.multiplyScalar(_.dot(e))).normalize(),w.crossVectors(M,e);const n=w.dot(c[t]),r=n<0?-1:1;a[4*t]=b.x,a[4*t+1]=b.y,a[4*t+2]=b.z,a[4*t+3]=r}for(let S=0,E=x.length;S<E;++S){const t=x[S],e=t.start,r=t.count;for(let i=e,s=e+r;i<s;i+=3)A(n[i+0]),A(n[i+1]),A(n[i+2])}}computeVertexNormals(){const t=this.index,e=this.getAttribute("position");if(void 0!==e){let n=this.getAttribute("normal");if(void 0===n)n=new Hi(new Float32Array(3*e.count),3),this.setAttribute("normal",n);else for(let t=0,e=n.count;t<e;t++)n.setXYZ(t,0,0,0);const r=new Mr,i=new Mr,s=new Mr,o=new Mr,a=new Mr,l=new Mr,c=new Mr,u=new Mr;if(t)for(let h=0,d=t.count;h<d;h+=3){const d=t.getX(h+0),f=t.getX(h+1),p=t.getX(h+2);r.fromBufferAttribute(e,d),i.fromBufferAttribute(e,f),s.fromBufferAttribute(e,p),c.subVectors(s,i),u.subVectors(r,i),c.cross(u),o.fromBufferAttribute(n,d),a.fromBufferAttribute(n,f),l.fromBufferAttribute(n,p),o.add(c),a.add(c),l.add(c),n.setXYZ(d,o.x,o.y,o.z),n.setXYZ(f,a.x,a.y,a.z),n.setXYZ(p,l.x,l.y,l.z)}else for(let t=0,h=e.count;t<h;t+=3)r.fromBufferAttribute(e,t+0),i.fromBufferAttribute(e,t+1),s.fromBufferAttribute(e,t+2),c.subVectors(s,i),u.subVectors(r,i),c.cross(u),n.setXYZ(t+0,c.x,c.y,c.z),n.setXYZ(t+1,c.x,c.y,c.z),n.setXYZ(t+2,c.x,c.y,c.z);this.normalizeNormals(),n.needsUpdate=!0}}merge(t,e){if(!t||!t.isBufferGeometry)return void console.error("THREE.BufferGeometry.merge(): geometry not an instance of THREE.BufferGeometry.",t);void 0===e&&(e=0,console.warn("THREE.BufferGeometry.merge(): Overwriting original geometry, starting at offset=0. Use BufferGeometryUtils.mergeBufferGeometries() for lossless merge."));const n=this.attributes;for(const r in n){if(void 0===t.attributes[r])continue;const i=n[r],s=i.array,o=t.attributes[r],a=o.array,l=o.itemSize*e,c=Math.min(a.length,s.length-l);for(let t=0,e=l;t<c;t++,e++)s[e]=a[t]}return this}normalizeNormals(){const t=this.attributes.normal;for(let e=0,n=t.count;e<n;e++)ss.fromBufferAttribute(t,e),ss.normalize(),t.setXYZ(e,ss.x,ss.y,ss.z)}toNonIndexed(){function t(t,e){const n=t.array,r=t.itemSize,i=t.normalized,s=new n.constructor(e.length*r);let o=0,a=0;for(let l=0,c=e.length;l<c;l++){o=t.isInterleavedBufferAttribute?e[l]*t.data.stride+t.offset:e[l]*r;for(let t=0;t<r;t++)s[a++]=n[o++]}return new Hi(s,r,i)}if(null===this.index)return console.warn("THREE.BufferGeometry.toNonIndexed(): BufferGeometry is already non-indexed."),this;const e=new os,n=this.index.array,r=this.attributes;for(const o in r){const i=r[o],s=t(i,n);e.setAttribute(o,s)}const i=this.morphAttributes;for(const o in i){const r=[],s=i[o];for(let e=0,i=s.length;e<i;e++){const i=s[e],o=t(i,n);r.push(o)}e.morphAttributes[o]=r}e.morphTargetsRelative=this.morphTargetsRelative;const s=this.groups;for(let o=0,a=s.length;o<a;o++){const t=s[o];e.addGroup(t.start,t.count,t.materialIndex)}return e}toJSON(){const t={metadata:{version:4.5,type:"BufferGeometry",generator:"BufferGeometry.toJSON"}};if(t.uuid=this.uuid,t.type=this.type,""!==this.name&&(t.name=this.name),Object.keys(this.userData).length>0&&(t.userData=this.userData),void 0!==this.parameters){const e=this.parameters;for(const n in e)void 0!==e[n]&&(t[n]=e[n]);return t}t.data={attributes:{}};const e=this.index;null!==e&&(t.data.index={type:e.array.constructor.name,array:Array.prototype.slice.call(e.array)});const n=this.attributes;for(const a in n){const e=n[a];t.data.attributes[a]=e.toJSON(t.data)}const r={};let i=!1;for(const a in this.morphAttributes){const e=this.morphAttributes[a],n=[];for(let r=0,i=e.length;r<i;r++){const i=e[r];n.push(i.toJSON(t.data))}n.length>0&&(r[a]=n,i=!0)}i&&(t.data.morphAttributes=r,t.data.morphTargetsRelative=this.morphTargetsRelative);const s=this.groups;s.length>0&&(t.data.groups=JSON.parse(JSON.stringify(s)));const o=this.boundingSphere;return null!==o&&(t.data.boundingSphere={center:o.center.toArray(),radius:o.radius}),t}clone(){return(new this.constructor).copy(this)}copy(t){this.index=null,this.attributes={},this.morphAttributes={},this.groups=[],this.boundingBox=null,this.boundingSphere=null;const e={};this.name=t.name;const n=t.index;null!==n&&this.setIndex(n.clone(e));const r=t.attributes;for(const l in r){const t=r[l];this.setAttribute(l,t.clone(e))}const i=t.morphAttributes;for(const l in i){const t=[],n=i[l];for(let r=0,i=n.length;r<i;r++)t.push(n[r].clone(e));this.morphAttributes[l]=t}this.morphTargetsRelative=t.morphTargetsRelative;const s=t.groups;for(let l=0,c=s.length;l<c;l++){const t=s[l];this.addGroup(t.start,t.count,t.materialIndex)}const o=t.boundingBox;null!==o&&(this.boundingBox=o.clone());const a=t.boundingSphere;return null!==a&&(this.boundingSphere=a.clone()),this.drawRange.start=t.drawRange.start,this.drawRange.count=t.drawRange.count,this.userData=t.userData,void 0!==t.parameters&&(this.parameters=Object.assign({},t.parameters)),this}dispose(){this.dispatchEvent({type:"dispose"})}}const as=new ti,ls=new $r,cs=new Wr,us=new Mr,hs=new Mr,ds=new Mr,fs=new Mr,ps=new Mr,ms=new Mr,gs=new Mr,vs=new Mr,ys=new Mr,xs=new qn,bs=new qn,ws=new qn,_s=new Mr,Ms=new Mr;class As extends Si{constructor(t=new os,e=new Ui){super(),this.isMesh=!0,this.type="Mesh",this.geometry=t,this.material=e,this.updateMorphTargets()}copy(t,e){return super.copy(t,e),void 0!==t.morphTargetInfluences&&(this.morphTargetInfluences=t.morphTargetInfluences.slice()),void 0!==t.morphTargetDictionary&&(this.morphTargetDictionary=Object.assign({},t.morphTargetDictionary)),this.material=t.material,this.geometry=t.geometry,this}updateMorphTargets(){const t=this.geometry,e=t.morphAttributes,n=Object.keys(e);if(n.length>0){const t=e[n[0]];if(void 0!==t){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let e=0,n=t.length;e<n;e++){const n=t[e].name||String(e);this.morphTargetInfluences.push(0),this.morphTargetDictionary[n]=e}}}}raycast(t,e){const n=this.geometry,r=this.material,i=this.matrixWorld;if(void 0===r)return;if(null===n.boundingSphere&&n.computeBoundingSphere(),cs.copy(n.boundingSphere),cs.applyMatrix4(i),!1===t.ray.intersectsSphere(cs))return;if(as.copy(i).invert(),ls.copy(t.ray).applyMatrix4(as),null!==n.boundingBox&&!1===ls.intersectsBox(n.boundingBox))return;let s;const o=n.index,a=n.attributes.position,l=n.morphAttributes.position,c=n.morphTargetsRelative,u=n.attributes.uv,h=n.attributes.uv2,d=n.groups,f=n.drawRange;if(null!==o)if(Array.isArray(r))for(let p=0,m=d.length;p<m;p++){const n=d[p],i=r[n.materialIndex],m=Math.max(n.start,f.start),g=Math.min(o.count,Math.min(n.start+n.count,f.start+f.count));for(let r=m,d=g;r<d;r+=3){const d=o.getX(r),f=o.getX(r+1),p=o.getX(r+2);s=Es(this,i,t,ls,a,l,c,u,h,d,f,p),s&&(s.faceIndex=Math.floor(r/3),s.face.materialIndex=n.materialIndex,e.push(s))}}else{const n=Math.max(0,f.start),i=Math.min(o.count,f.start+f.count);for(let d=n,f=i;d<f;d+=3){const n=o.getX(d),i=o.getX(d+1),f=o.getX(d+2);s=Es(this,r,t,ls,a,l,c,u,h,n,i,f),s&&(s.faceIndex=Math.floor(d/3),e.push(s))}}else if(void 0!==a)if(Array.isArray(r))for(let p=0,m=d.length;p<m;p++){const n=d[p],i=r[n.materialIndex],o=Math.max(n.start,f.start),m=Math.min(a.count,Math.min(n.start+n.count,f.start+f.count));for(let r=o,d=m;r<d;r+=3){const o=r,d=r+1,f=r+2;s=Es(this,i,t,ls,a,l,c,u,h,o,d,f),s&&(s.faceIndex=Math.floor(r/3),s.face.materialIndex=n.materialIndex,e.push(s))}}else{const n=Math.max(0,f.start),i=Math.min(a.count,f.start+f.count);for(let o=n,d=i;o<d;o+=3){const n=o,i=o+1,d=o+2;s=Es(this,r,t,ls,a,l,c,u,h,n,i,d),s&&(s.faceIndex=Math.floor(o/3),e.push(s))}}}}function Ss(t,e,n,r,i,s,o,a){let l;if(l=e.side===v?r.intersectTriangle(o,s,i,!0,a):r.intersectTriangle(i,s,o,e.side!==y,a),null===l)return null;Ms.copy(a),Ms.applyMatrix4(t.matrixWorld);const c=n.ray.origin.distanceTo(Ms);return c<n.near||c>n.far?null:{distance:c,point:Ms.clone(),object:t}}function Es(t,e,n,r,i,s,o,a,l,c,u,h){us.fromBufferAttribute(i,c),hs.fromBufferAttribute(i,u),ds.fromBufferAttribute(i,h);const d=t.morphTargetInfluences;if(s&&d){gs.set(0,0,0),vs.set(0,0,0),ys.set(0,0,0);for(let t=0,e=s.length;t<e;t++){const e=d[t],n=s[t];0!==e&&(fs.fromBufferAttribute(n,c),ps.fromBufferAttribute(n,u),ms.fromBufferAttribute(n,h),o?(gs.addScaledVector(fs,e),vs.addScaledVector(ps,e),ys.addScaledVector(ms,e)):(gs.addScaledVector(fs.sub(us),e),vs.addScaledVector(ps.sub(hs),e),ys.addScaledVector(ms.sub(ds),e)))}us.add(gs),hs.add(vs),ds.add(ys)}t.isSkinnedMesh&&(t.boneTransform(c,us),t.boneTransform(u,hs),t.boneTransform(h,ds));const f=Ss(t,e,n,r,us,hs,ds,_s);if(f){a&&(xs.fromBufferAttribute(a,c),bs.fromBufferAttribute(a,u),ws.fromBufferAttribute(a,h),f.uv=Di.getUV(_s,us,hs,ds,xs,bs,ws,new qn)),l&&(xs.fromBufferAttribute(l,c),bs.fromBufferAttribute(l,u),ws.fromBufferAttribute(l,h),f.uv2=Di.getUV(_s,us,hs,ds,xs,bs,ws,new qn));const t={a:c,b:u,c:h,normal:new Mr,materialIndex:0};Di.getNormal(us,hs,ds,t.normal),f.face=t}return f}class Ts extends os{constructor(t=1,e=1,n=1,r=1,i=1,s=1){super(),this.type="BoxGeometry",this.parameters={width:t,height:e,depth:n,widthSegments:r,heightSegments:i,depthSegments:s};const o=this;r=Math.floor(r),i=Math.floor(i),s=Math.floor(s);const a=[],l=[],c=[],u=[];let h=0,d=0;function f(t,e,n,r,i,s,f,p,m,g,v){const y=s/m,x=f/g,b=s/2,w=f/2,_=p/2,M=m+1,A=g+1;let S=0,E=0;const T=new Mr;for(let o=0;o<A;o++){const s=o*x-w;for(let a=0;a<M;a++){const h=a*y-b;T[t]=h*r,T[e]=s*i,T[n]=_,l.push(T.x,T.y,T.z),T[t]=0,T[e]=0,T[n]=p>0?1:-1,c.push(T.x,T.y,T.z),u.push(a/m),u.push(1-o/g),S+=1}}for(let o=0;o<g;o++)for(let t=0;t<m;t++){const e=h+t+M*o,n=h+t+M*(o+1),r=h+(t+1)+M*(o+1),i=h+(t+1)+M*o;a.push(e,n,i),a.push(n,r,i),E+=6}o.addGroup(d,E,v),d+=E,h+=S}f("z","y","x",-1,-1,n,e,t,s,i,0),f("z","y","x",1,-1,n,e,-t,s,i,1),f("x","z","y",1,1,t,n,e,r,s,2),f("x","z","y",1,-1,t,n,-e,r,s,3),f("x","y","z",1,-1,t,e,n,r,i,4),f("x","y","z",-1,-1,t,e,-n,r,i,5),this.setIndex(a),this.setAttribute("position",new Zi(l,3)),this.setAttribute("normal",new Zi(c,3)),this.setAttribute("uv",new Zi(u,2))}static fromJSON(t){return new Ts(t.width,t.height,t.depth,t.widthSegments,t.heightSegments,t.depthSegments)}}function Cs(t){const e={};for(const n in t){e[n]={};for(const r in t[n]){const i=t[n][r];i&&(i.isColor||i.isMatrix3||i.isMatrix4||i.isVector2||i.isVector3||i.isVector4||i.isTexture||i.isQuaternion)?e[n][r]=i.clone():Array.isArray(i)?e[n][r]=i.slice():e[n][r]=i}}return e}function Rs(t){const e={};for(let n=0;n<t.length;n++){const r=Cs(t[n]);for(const t in r)e[t]=r[t]}return e}const Is={clone:Cs,merge:Rs};var Ps="void main() {\n\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n}",Ls="void main() {\n\tgl_FragColor = vec4( 1.0, 0.0, 0.0, 1.0 );\n}";class Ns extends Fi{constructor(t){super(),this.isShaderMaterial=!0,this.type="ShaderMaterial",this.defines={},this.uniforms={},this.vertexShader=Ps,this.fragmentShader=Ls,this.linewidth=1,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.lights=!1,this.clipping=!1,this.extensions={derivatives:!1,fragDepth:!1,drawBuffers:!1,shaderTextureLOD:!1},this.defaultAttributeValues={color:[1,1,1],uv:[0,0],uv2:[0,0]},this.index0AttributeName=void 0,this.uniformsNeedUpdate=!1,this.glslVersion=null,void 0!==t&&(void 0!==t.attributes&&console.error("THREE.ShaderMaterial: attributes should now be defined in THREE.BufferGeometry instead."),this.setValues(t))}copy(t){return super.copy(t),this.fragmentShader=t.fragmentShader,this.vertexShader=t.vertexShader,this.uniforms=Cs(t.uniforms),this.defines=Object.assign({},t.defines),this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.fog=t.fog,this.lights=t.lights,this.clipping=t.clipping,this.extensions=Object.assign({},t.extensions),this.glslVersion=t.glslVersion,this}toJSON(t){const e=super.toJSON(t);e.glslVersion=this.glslVersion,e.uniforms={};for(const r in this.uniforms){const n=this.uniforms[r],i=n.value;i&&i.isTexture?e.uniforms[r]={type:"t",value:i.toJSON(t).uuid}:i&&i.isColor?e.uniforms[r]={type:"c",value:i.getHex()}:i&&i.isVector2?e.uniforms[r]={type:"v2",value:i.toArray()}:i&&i.isVector3?e.uniforms[r]={type:"v3",value:i.toArray()}:i&&i.isVector4?e.uniforms[r]={type:"v4",value:i.toArray()}:i&&i.isMatrix3?e.uniforms[r]={type:"m3",value:i.toArray()}:i&&i.isMatrix4?e.uniforms[r]={type:"m4",value:i.toArray()}:e.uniforms[r]={value:i}}Object.keys(this.defines).length>0&&(e.defines=this.defines),e.vertexShader=this.vertexShader,e.fragmentShader=this.fragmentShader;const n={};for(const r in this.extensions)!0===this.extensions[r]&&(n[r]=!0);return Object.keys(n).length>0&&(e.extensions=n),e}}class ks extends Si{constructor(){super(),this.isCamera=!0,this.type="Camera",this.matrixWorldInverse=new ti,this.projectionMatrix=new ti,this.projectionMatrixInverse=new ti}copy(t,e){return super.copy(t,e),this.matrixWorldInverse.copy(t.matrixWorldInverse),this.projectionMatrix.copy(t.projectionMatrix),this.projectionMatrixInverse.copy(t.projectionMatrixInverse),this}getWorldDirection(t){this.updateWorldMatrix(!0,!1);const e=this.matrixWorld.elements;return t.set(-e[8],-e[9],-e[10]).normalize()}updateMatrixWorld(t){super.updateMatrixWorld(t),this.matrixWorldInverse.copy(this.matrixWorld).invert()}updateWorldMatrix(t,e){super.updateWorldMatrix(t,e),this.matrixWorldInverse.copy(this.matrixWorld).invert()}clone(){return(new this.constructor).copy(this)}}class Os extends ks{constructor(t=50,e=1,n=.1,r=2e3){super(),this.isPerspectiveCamera=!0,this.type="PerspectiveCamera",this.fov=t,this.zoom=1,this.near=n,this.far=r,this.focus=10,this.aspect=e,this.view=null,this.filmGauge=35,this.filmOffset=0,this.updateProjectionMatrix()}copy(t,e){return super.copy(t,e),this.fov=t.fov,this.zoom=t.zoom,this.near=t.near,this.far=t.far,this.focus=t.focus,this.aspect=t.aspect,this.view=null===t.view?null:Object.assign({},t.view),this.filmGauge=t.filmGauge,this.filmOffset=t.filmOffset,this}setFocalLength(t){const e=.5*this.getFilmHeight()/t;this.fov=2*_n*Math.atan(e),this.updateProjectionMatrix()}getFocalLength(){const t=Math.tan(.5*wn*this.fov);return.5*this.getFilmHeight()/t}getEffectiveFOV(){return 2*_n*Math.atan(Math.tan(.5*wn*this.fov)/this.zoom)}getFilmWidth(){return this.filmGauge*Math.min(this.aspect,1)}getFilmHeight(){return this.filmGauge/Math.max(this.aspect,1)}setViewOffset(t,e,n,r,i,s){this.aspect=t/e,null===this.view&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=t,this.view.fullHeight=e,this.view.offsetX=n,this.view.offsetY=r,this.view.width=i,this.view.height=s,this.updateProjectionMatrix()}clearViewOffset(){null!==this.view&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){const t=this.near;let e=t*Math.tan(.5*wn*this.fov)/this.zoom,n=2*e,r=this.aspect*n,i=-.5*r;const s=this.view;if(null!==this.view&&this.view.enabled){const t=s.fullWidth,o=s.fullHeight;i+=s.offsetX*r/t,e-=s.offsetY*n/o,r*=s.width/t,n*=s.height/o}const o=this.filmOffset;0!==o&&(i+=t*o/this.getFilmWidth()),this.projectionMatrix.makePerspective(i,i+r,e,e-n,t,this.far),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(t){const e=super.toJSON(t);return e.object.fov=this.fov,e.object.zoom=this.zoom,e.object.near=this.near,e.object.far=this.far,e.object.focus=this.focus,e.object.aspect=this.aspect,null!==this.view&&(e.object.view=Object.assign({},this.view)),e.object.filmGauge=this.filmGauge,e.object.filmOffset=this.filmOffset,e}}const Ds=90,zs=1;class Fs extends Si{constructor(t,e,n){if(super(),this.type="CubeCamera",!0!==n.isWebGLCubeRenderTarget)return void console.error("THREE.CubeCamera: The constructor now expects an instance of WebGLCubeRenderTarget as third parameter.");this.renderTarget=n;const r=new Os(Ds,zs,t,e);r.layers=this.layers,r.up.set(0,-1,0),r.lookAt(new Mr(1,0,0)),this.add(r);const i=new Os(Ds,zs,t,e);i.layers=this.layers,i.up.set(0,-1,0),i.lookAt(new Mr(-1,0,0)),this.add(i);const s=new Os(Ds,zs,t,e);s.layers=this.layers,s.up.set(0,0,1),s.lookAt(new Mr(0,1,0)),this.add(s);const o=new Os(Ds,zs,t,e);o.layers=this.layers,o.up.set(0,0,-1),o.lookAt(new Mr(0,-1,0)),this.add(o);const a=new Os(Ds,zs,t,e);a.layers=this.layers,a.up.set(0,-1,0),a.lookAt(new Mr(0,0,1)),this.add(a);const l=new Os(Ds,zs,t,e);l.layers=this.layers,l.up.set(0,-1,0),l.lookAt(new Mr(0,0,-1)),this.add(l)}update(t,e){null===this.parent&&this.updateMatrixWorld();const n=this.renderTarget,[r,i,s,o,a,l]=this.children,c=t.getRenderTarget(),u=t.toneMapping,h=t.xr.enabled;t.toneMapping=tt,t.xr.enabled=!1;const d=n.texture.generateMipmaps;n.texture.generateMipmaps=!1,t.setRenderTarget(n,0),t.render(e,r),t.setRenderTarget(n,1),t.render(e,i),t.setRenderTarget(n,2),t.render(e,s),t.setRenderTarget(n,3),t.render(e,o),t.setRenderTarget(n,4),t.render(e,a),n.texture.generateMipmaps=d,t.setRenderTarget(n,5),t.render(e,l),t.setRenderTarget(c),t.toneMapping=u,t.xr.enabled=h,n.texture.needsPMREMUpdate=!0}}class Us extends pr{constructor(t,e,n,r,i,s,o,a,l,c){t=void 0!==t?t:[],e=void 0!==e?e:at,super(t,e,n,r,i,s,o,a,l,c),this.isCubeTexture=!0,this.flipY=!1}get images(){return this.image}set images(t){this.image=t}}class Bs extends gr{constructor(t,e={}){super(t,t,e),this.isWebGLCubeRenderTarget=!0;const n={width:t,height:t,depth:1},r=[n,n,n,n,n,n];this.texture=new Us(r,e.mapping,e.wrapS,e.wrapT,e.magFilter,e.minFilter,e.format,e.type,e.anisotropy,e.encoding),this.texture.isRenderTargetTexture=!0,this.texture.generateMipmaps=void 0!==e.generateMipmaps&&e.generateMipmaps,this.texture.minFilter=void 0!==e.minFilter?e.minFilter:bt}fromEquirectangularTexture(t,e){this.texture.type=e.type,this.texture.encoding=e.encoding,this.texture.generateMipmaps=e.generateMipmaps,this.texture.minFilter=e.minFilter,this.texture.magFilter=e.magFilter;const n={uniforms:{tEquirect:{value:null}},vertexShader:"\n\n\t\t\t\tvarying vec3 vWorldDirection;\n\n\t\t\t\tvec3 transformDirection( in vec3 dir, in mat4 matrix ) {\n\n\t\t\t\t\treturn normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );\n\n\t\t\t\t}\n\n\t\t\t\tvoid main() {\n\n\t\t\t\t\tvWorldDirection = transformDirection( position, modelMatrix );\n\n\t\t\t\t\t#include <begin_vertex>\n\t\t\t\t\t#include <project_vertex>\n\n\t\t\t\t}\n\t\t\t",fragmentShader:"\n\n\t\t\t\tuniform sampler2D tEquirect;\n\n\t\t\t\tvarying vec3 vWorldDirection;\n\n\t\t\t\t#include <common>\n\n\t\t\t\tvoid main() {\n\n\t\t\t\t\tvec3 direction = normalize( vWorldDirection );\n\n\t\t\t\t\tvec2 sampleUV = equirectUv( direction );\n\n\t\t\t\t\tgl_FragColor = texture2D( tEquirect, sampleUV );\n\n\t\t\t\t}\n\t\t\t"},r=new Ts(5,5,5),i=new Ns({name:"CubemapFromEquirect",uniforms:Cs(n.uniforms),vertexShader:n.vertexShader,fragmentShader:n.fragmentShader,side:v,blending:w});i.uniforms.tEquirect.value=e;const s=new As(r,i),o=e.minFilter;e.minFilter===Mt&&(e.minFilter=bt);const a=new Fs(1,10,this);return a.update(t,s),e.minFilter=o,s.geometry.dispose(),s.material.dispose(),this}clear(t,e,n,r){const i=t.getRenderTarget();for(let s=0;s<6;s++)t.setRenderTarget(this,s),t.clear(e,n,r);t.setRenderTarget(i)}}const Gs=new Mr,Hs=new Mr,Vs=new Yn;class js{constructor(t=new Mr(1,0,0),e=0){this.isPlane=!0,this.normal=t,this.constant=e}set(t,e){return this.normal.copy(t),this.constant=e,this}setComponents(t,e,n,r){return this.normal.set(t,e,n),this.constant=r,this}setFromNormalAndCoplanarPoint(t,e){return this.normal.copy(t),this.constant=-e.dot(this.normal),this}setFromCoplanarPoints(t,e,n){const r=Gs.subVectors(n,e).cross(Hs.subVectors(t,e)).normalize();return this.setFromNormalAndCoplanarPoint(r,t),this}copy(t){return this.normal.copy(t.normal),this.constant=t.constant,this}normalize(){const t=1/this.normal.length();return this.normal.multiplyScalar(t),this.constant*=t,this}negate(){return this.constant*=-1,this.normal.negate(),this}distanceToPoint(t){return this.normal.dot(t)+this.constant}distanceToSphere(t){return this.distanceToPoint(t.center)-t.radius}projectPoint(t,e){return e.copy(this.normal).multiplyScalar(-this.distanceToPoint(t)).add(t)}intersectLine(t,e){const n=t.delta(Gs),r=this.normal.dot(n);if(0===r)return 0===this.distanceToPoint(t.start)?e.copy(t.start):null;const i=-(t.start.dot(this.normal)+this.constant)/r;return i<0||i>1?null:e.copy(n).multiplyScalar(i).add(t.start)}intersectsLine(t){const e=this.distanceToPoint(t.start),n=this.distanceToPoint(t.end);return e<0&&n>0||n<0&&e>0}intersectsBox(t){return t.intersectsPlane(this)}intersectsSphere(t){return t.intersectsPlane(this)}coplanarPoint(t){return t.copy(this.normal).multiplyScalar(-this.constant)}applyMatrix4(t,e){const n=e||Vs.getNormalMatrix(t),r=this.coplanarPoint(Gs).applyMatrix4(t),i=this.normal.applyMatrix3(n).normalize();return this.constant=-r.dot(i),this}translate(t){return this.constant-=t.dot(this.normal),this}equals(t){return t.normal.equals(this.normal)&&t.constant===this.constant}clone(){return(new this.constructor).copy(this)}}const Ws=new Wr,qs=new Mr;class Ys{constructor(t=new js,e=new js,n=new js,r=new js,i=new js,s=new js){this.planes=[t,e,n,r,i,s]}set(t,e,n,r,i,s){const o=this.planes;return o[0].copy(t),o[1].copy(e),o[2].copy(n),o[3].copy(r),o[4].copy(i),o[5].copy(s),this}copy(t){const e=this.planes;for(let n=0;n<6;n++)e[n].copy(t.planes[n]);return this}setFromProjectionMatrix(t){const e=this.planes,n=t.elements,r=n[0],i=n[1],s=n[2],o=n[3],a=n[4],l=n[5],c=n[6],u=n[7],h=n[8],d=n[9],f=n[10],p=n[11],m=n[12],g=n[13],v=n[14],y=n[15];return e[0].setComponents(o-r,u-a,p-h,y-m).normalize(),e[1].setComponents(o+r,u+a,p+h,y+m).normalize(),e[2].setComponents(o+i,u+l,p+d,y+g).normalize(),e[3].setComponents(o-i,u-l,p-d,y-g).normalize(),e[4].setComponents(o-s,u-c,p-f,y-v).normalize(),e[5].setComponents(o+s,u+c,p+f,y+v).normalize(),this}intersectsObject(t){const e=t.geometry;return null===e.boundingSphere&&e.computeBoundingSphere(),Ws.copy(e.boundingSphere).applyMatrix4(t.matrixWorld),this.intersectsSphere(Ws)}intersectsSprite(t){return Ws.center.set(0,0,0),Ws.radius=.7071067811865476,Ws.applyMatrix4(t.matrixWorld),this.intersectsSphere(Ws)}intersectsSphere(t){const e=this.planes,n=t.center,r=-t.radius;for(let i=0;i<6;i++){const t=e[i].distanceToPoint(n);if(t<r)return!1}return!0}intersectsBox(t){const e=this.planes;for(let n=0;n<6;n++){const r=e[n];if(qs.x=r.normal.x>0?t.max.x:t.min.x,qs.y=r.normal.y>0?t.max.y:t.min.y,qs.z=r.normal.z>0?t.max.z:t.min.z,r.distanceToPoint(qs)<0)return!1}return!0}containsPoint(t){const e=this.planes;for(let n=0;n<6;n++)if(e[n].distanceToPoint(t)<0)return!1;return!0}clone(){return(new this.constructor).copy(this)}}function Xs(){let t=null,e=!1,n=null,r=null;function i(e,s){n(e,s),r=t.requestAnimationFrame(i)}return{start:function(){!0!==e&&null!==n&&(r=t.requestAnimationFrame(i),e=!0)},stop:function(){t.cancelAnimationFrame(r),e=!1},setAnimationLoop:function(t){n=t},setContext:function(e){t=e}}}function Js(t,e){const n=e.isWebGL2,r=new WeakMap;function i(e,r){const i=e.array,s=e.usage,o=t.createBuffer();let a;if(t.bindBuffer(r,o),t.bufferData(r,i,s),e.onUploadCallback(),i instanceof Float32Array)a=5126;else if(i instanceof Uint16Array)if(e.isFloat16BufferAttribute){if(!n)throw new Error("THREE.WebGLAttributes: Usage of Float16BufferAttribute requires WebGL2.");a=5131}else a=5123;else if(i instanceof Int16Array)a=5122;else if(i instanceof Uint32Array)a=5125;else if(i instanceof Int32Array)a=5124;else if(i instanceof Int8Array)a=5120;else if(i instanceof Uint8Array)a=5121;else{if(!(i instanceof Uint8ClampedArray))throw new Error("THREE.WebGLAttributes: Unsupported buffer data format: "+i);a=5121}return{buffer:o,type:a,bytesPerElement:i.BYTES_PER_ELEMENT,version:e.version}}function s(e,r,i){const s=r.array,o=r.updateRange;t.bindBuffer(i,e),-1===o.count?t.bufferSubData(i,0,s):(n?t.bufferSubData(i,o.offset*s.BYTES_PER_ELEMENT,s,o.offset,o.count):t.bufferSubData(i,o.offset*s.BYTES_PER_ELEMENT,s.subarray(o.offset,o.offset+o.count)),o.count=-1)}function o(t){return t.isInterleavedBufferAttribute&&(t=t.data),r.get(t)}function a(e){e.isInterleavedBufferAttribute&&(e=e.data);const n=r.get(e);n&&(t.deleteBuffer(n.buffer),r.delete(e))}function l(t,e){if(t.isGLBufferAttribute){const e=r.get(t);return void((!e||e.version<t.version)&&r.set(t,{buffer:t.buffer,type:t.type,bytesPerElement:t.elementSize,version:t.version}))}t.isInterleavedBufferAttribute&&(t=t.data);const n=r.get(t);void 0===n?r.set(t,i(t,e)):n.version<t.version&&(s(n.buffer,t,e),n.version=t.version)}return{get:o,remove:a,update:l}}class Ks extends os{constructor(t=1,e=1,n=1,r=1){super(),this.type="PlaneGeometry",this.parameters={width:t,height:e,widthSegments:n,heightSegments:r};const i=t/2,s=e/2,o=Math.floor(n),a=Math.floor(r),l=o+1,c=a+1,u=t/o,h=e/a,d=[],f=[],p=[],m=[];for(let g=0;g<c;g++){const t=g*h-s;for(let e=0;e<l;e++){const n=e*u-i;f.push(n,-t,0),p.push(0,0,1),m.push(e/o),m.push(1-g/a)}}for(let g=0;g<a;g++)for(let t=0;t<o;t++){const e=t+l*g,n=t+l*(g+1),r=t+1+l*(g+1),i=t+1+l*g;d.push(e,n,i),d.push(n,r,i)}this.setIndex(d),this.setAttribute("position",new Zi(f,3)),this.setAttribute("normal",new Zi(p,3)),this.setAttribute("uv",new Zi(m,2))}static fromJSON(t){return new Ks(t.width,t.height,t.widthSegments,t.heightSegments)}}var Zs="#ifdef USE_ALPHAMAP\n\tdiffuseColor.a *= texture2D( alphaMap, vUv ).g;\n#endif",Qs="#ifdef USE_ALPHAMAP\n\tuniform sampler2D alphaMap;\n#endif",$s="#ifdef USE_ALPHATEST\n\tif ( diffuseColor.a < alphaTest ) discard;\n#endif",to="#ifdef USE_ALPHATEST\n\tuniform float alphaTest;\n#endif",eo="#ifdef USE_AOMAP\n\tfloat ambientOcclusion = ( texture2D( aoMap, vUv2 ).r - 1.0 ) * aoMapIntensity + 1.0;\n\treflectedLight.indirectDiffuse *= ambientOcclusion;\n\t#if defined( USE_ENVMAP ) && defined( STANDARD )\n\t\tfloat dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );\n\t\treflectedLight.indirectSpecular *= computeSpecularOcclusion( dotNV, ambientOcclusion, material.roughness );\n\t#endif\n#endif",no="#ifdef USE_AOMAP\n\tuniform sampler2D aoMap;\n\tuniform float aoMapIntensity;\n#endif",ro="vec3 transformed = vec3( position );",io="vec3 objectNormal = vec3( normal );\n#ifdef USE_TANGENT\n\tvec3 objectTangent = vec3( tangent.xyz );\n#endif",so="vec3 BRDF_Lambert( const in vec3 diffuseColor ) {\n\treturn RECIPROCAL_PI * diffuseColor;\n}\nvec3 F_Schlick( const in vec3 f0, const in float f90, const in float dotVH ) {\n\tfloat fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );\n\treturn f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );\n}\nfloat F_Schlick( const in float f0, const in float f90, const in float dotVH ) {\n\tfloat fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );\n\treturn f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );\n}\nvec3 Schlick_to_F0( const in vec3 f, const in float f90, const in float dotVH ) {\n    float x = clamp( 1.0 - dotVH, 0.0, 1.0 );\n    float x2 = x * x;\n    float x5 = clamp( x * x2 * x2, 0.0, 0.9999 );\n    return ( f - vec3( f90 ) * x5 ) / ( 1.0 - x5 );\n}\nfloat V_GGX_SmithCorrelated( const in float alpha, const in float dotNL, const in float dotNV ) {\n\tfloat a2 = pow2( alpha );\n\tfloat gv = dotNL * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );\n\tfloat gl = dotNV * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );\n\treturn 0.5 / max( gv + gl, EPSILON );\n}\nfloat D_GGX( const in float alpha, const in float dotNH ) {\n\tfloat a2 = pow2( alpha );\n\tfloat denom = pow2( dotNH ) * ( a2 - 1.0 ) + 1.0;\n\treturn RECIPROCAL_PI * a2 / pow2( denom );\n}\nvec3 BRDF_GGX( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in vec3 f0, const in float f90, const in float roughness ) {\n\tfloat alpha = pow2( roughness );\n\tvec3 halfDir = normalize( lightDir + viewDir );\n\tfloat dotNL = saturate( dot( normal, lightDir ) );\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tfloat dotNH = saturate( dot( normal, halfDir ) );\n\tfloat dotVH = saturate( dot( viewDir, halfDir ) );\n\tvec3 F = F_Schlick( f0, f90, dotVH );\n\tfloat V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );\n\tfloat D = D_GGX( alpha, dotNH );\n\treturn F * ( V * D );\n}\n#ifdef USE_IRIDESCENCE\nvec3 BRDF_GGX_Iridescence( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in vec3 f0, const in float f90, const in float iridescence, const in vec3 iridescenceFresnel, const in float roughness ) {\n\tfloat alpha = pow2( roughness );\n\tvec3 halfDir = normalize( lightDir + viewDir );\n\tfloat dotNL = saturate( dot( normal, lightDir ) );\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tfloat dotNH = saturate( dot( normal, halfDir ) );\n\tfloat dotVH = saturate( dot( viewDir, halfDir ) );\n\tvec3 F = mix(F_Schlick( f0, f90, dotVH ), iridescenceFresnel, iridescence);\n\tfloat V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );\n\tfloat D = D_GGX( alpha, dotNH );\n\treturn F * ( V * D );\n}\n#endif\nvec2 LTC_Uv( const in vec3 N, const in vec3 V, const in float roughness ) {\n\tconst float LUT_SIZE = 64.0;\n\tconst float LUT_SCALE = ( LUT_SIZE - 1.0 ) / LUT_SIZE;\n\tconst float LUT_BIAS = 0.5 / LUT_SIZE;\n\tfloat dotNV = saturate( dot( N, V ) );\n\tvec2 uv = vec2( roughness, sqrt( 1.0 - dotNV ) );\n\tuv = uv * LUT_SCALE + LUT_BIAS;\n\treturn uv;\n}\nfloat LTC_ClippedSphereFormFactor( const in vec3 f ) {\n\tfloat l = length( f );\n\treturn max( ( l * l + f.z ) / ( l + 1.0 ), 0.0 );\n}\nvec3 LTC_EdgeVectorFormFactor( const in vec3 v1, const in vec3 v2 ) {\n\tfloat x = dot( v1, v2 );\n\tfloat y = abs( x );\n\tfloat a = 0.8543985 + ( 0.4965155 + 0.0145206 * y ) * y;\n\tfloat b = 3.4175940 + ( 4.1616724 + y ) * y;\n\tfloat v = a / b;\n\tfloat theta_sintheta = ( x > 0.0 ) ? v : 0.5 * inversesqrt( max( 1.0 - x * x, 1e-7 ) ) - v;\n\treturn cross( v1, v2 ) * theta_sintheta;\n}\nvec3 LTC_Evaluate( const in vec3 N, const in vec3 V, const in vec3 P, const in mat3 mInv, const in vec3 rectCoords[ 4 ] ) {\n\tvec3 v1 = rectCoords[ 1 ] - rectCoords[ 0 ];\n\tvec3 v2 = rectCoords[ 3 ] - rectCoords[ 0 ];\n\tvec3 lightNormal = cross( v1, v2 );\n\tif( dot( lightNormal, P - rectCoords[ 0 ] ) < 0.0 ) return vec3( 0.0 );\n\tvec3 T1, T2;\n\tT1 = normalize( V - N * dot( V, N ) );\n\tT2 = - cross( N, T1 );\n\tmat3 mat = mInv * transposeMat3( mat3( T1, T2, N ) );\n\tvec3 coords[ 4 ];\n\tcoords[ 0 ] = mat * ( rectCoords[ 0 ] - P );\n\tcoords[ 1 ] = mat * ( rectCoords[ 1 ] - P );\n\tcoords[ 2 ] = mat * ( rectCoords[ 2 ] - P );\n\tcoords[ 3 ] = mat * ( rectCoords[ 3 ] - P );\n\tcoords[ 0 ] = normalize( coords[ 0 ] );\n\tcoords[ 1 ] = normalize( coords[ 1 ] );\n\tcoords[ 2 ] = normalize( coords[ 2 ] );\n\tcoords[ 3 ] = normalize( coords[ 3 ] );\n\tvec3 vectorFormFactor = vec3( 0.0 );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 0 ], coords[ 1 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 1 ], coords[ 2 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 2 ], coords[ 3 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 3 ], coords[ 0 ] );\n\tfloat result = LTC_ClippedSphereFormFactor( vectorFormFactor );\n\treturn vec3( result );\n}\nfloat G_BlinnPhong_Implicit( ) {\n\treturn 0.25;\n}\nfloat D_BlinnPhong( const in float shininess, const in float dotNH ) {\n\treturn RECIPROCAL_PI * ( shininess * 0.5 + 1.0 ) * pow( dotNH, shininess );\n}\nvec3 BRDF_BlinnPhong( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in vec3 specularColor, const in float shininess ) {\n\tvec3 halfDir = normalize( lightDir + viewDir );\n\tfloat dotNH = saturate( dot( normal, halfDir ) );\n\tfloat dotVH = saturate( dot( viewDir, halfDir ) );\n\tvec3 F = F_Schlick( specularColor, 1.0, dotVH );\n\tfloat G = G_BlinnPhong_Implicit( );\n\tfloat D = D_BlinnPhong( shininess, dotNH );\n\treturn F * ( G * D );\n}\n#if defined( USE_SHEEN )\nfloat D_Charlie( float roughness, float dotNH ) {\n\tfloat alpha = pow2( roughness );\n\tfloat invAlpha = 1.0 / alpha;\n\tfloat cos2h = dotNH * dotNH;\n\tfloat sin2h = max( 1.0 - cos2h, 0.0078125 );\n\treturn ( 2.0 + invAlpha ) * pow( sin2h, invAlpha * 0.5 ) / ( 2.0 * PI );\n}\nfloat V_Neubelt( float dotNV, float dotNL ) {\n\treturn saturate( 1.0 / ( 4.0 * ( dotNL + dotNV - dotNL * dotNV ) ) );\n}\nvec3 BRDF_Sheen( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, vec3 sheenColor, const in float sheenRoughness ) {\n\tvec3 halfDir = normalize( lightDir + viewDir );\n\tfloat dotNL = saturate( dot( normal, lightDir ) );\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tfloat dotNH = saturate( dot( normal, halfDir ) );\n\tfloat D = D_Charlie( sheenRoughness, dotNH );\n\tfloat V = V_Neubelt( dotNV, dotNL );\n\treturn sheenColor * ( D * V );\n}\n#endif",oo="#ifdef USE_IRIDESCENCE\nconst mat3 XYZ_TO_REC709 = mat3(\n    3.2404542, -0.9692660,  0.0556434,\n   -1.5371385,  1.8760108, -0.2040259,\n   -0.4985314,  0.0415560,  1.0572252\n);\nvec3 Fresnel0ToIor( vec3 fresnel0 ) {\n   vec3 sqrtF0 = sqrt( fresnel0 );\n   return ( vec3( 1.0 ) + sqrtF0 ) / ( vec3( 1.0 ) - sqrtF0 );\n}\nvec3 IorToFresnel0( vec3 transmittedIor, float incidentIor ) {\n   return pow2( ( transmittedIor - vec3( incidentIor ) ) / ( transmittedIor + vec3( incidentIor ) ) );\n}\nfloat IorToFresnel0( float transmittedIor, float incidentIor ) {\n   return pow2( ( transmittedIor - incidentIor ) / ( transmittedIor + incidentIor ));\n}\nvec3 evalSensitivity( float OPD, vec3 shift ) {\n   float phase = 2.0 * PI * OPD * 1.0e-9;\n   vec3 val = vec3( 5.4856e-13, 4.4201e-13, 5.2481e-13 );\n   vec3 pos = vec3( 1.6810e+06, 1.7953e+06, 2.2084e+06 );\n   vec3 var = vec3( 4.3278e+09, 9.3046e+09, 6.6121e+09 );\n   vec3 xyz = val * sqrt( 2.0 * PI * var ) * cos( pos * phase + shift ) * exp( -pow2( phase ) * var );\n   xyz.x += 9.7470e-14 * sqrt( 2.0 * PI * 4.5282e+09 ) * cos( 2.2399e+06 * phase + shift[0] ) * exp( -4.5282e+09 * pow2( phase ) );\n   xyz /= 1.0685e-7;\n   vec3 srgb = XYZ_TO_REC709 * xyz;\n   return srgb;\n}\nvec3 evalIridescence( float outsideIOR, float eta2, float cosTheta1, float thinFilmThickness, vec3 baseF0 ) {\n   vec3 I;\n   float iridescenceIOR = mix( outsideIOR, eta2, smoothstep( 0.0, 0.03, thinFilmThickness ) );\n   float sinTheta2Sq = pow2( outsideIOR / iridescenceIOR ) * ( 1.0 - pow2( cosTheta1 ) );\n   float cosTheta2Sq = 1.0 - sinTheta2Sq;\n   if ( cosTheta2Sq < 0.0 ) {\n       return vec3( 1.0 );\n   }\n   float cosTheta2 = sqrt( cosTheta2Sq );\n   float R0 = IorToFresnel0( iridescenceIOR, outsideIOR );\n   float R12 = F_Schlick( R0, 1.0, cosTheta1 );\n   float R21 = R12;\n   float T121 = 1.0 - R12;\n   float phi12 = 0.0;\n   if ( iridescenceIOR < outsideIOR ) phi12 = PI;\n   float phi21 = PI - phi12;\n   vec3 baseIOR = Fresnel0ToIor( clamp( baseF0, 0.0, 0.9999 ) );   vec3 R1 = IorToFresnel0( baseIOR, iridescenceIOR );\n   vec3 R23 = F_Schlick( R1, 1.0, cosTheta2 );\n   vec3 phi23 = vec3( 0.0 );\n   if ( baseIOR[0] < iridescenceIOR ) phi23[0] = PI;\n   if ( baseIOR[1] < iridescenceIOR ) phi23[1] = PI;\n   if ( baseIOR[2] < iridescenceIOR ) phi23[2] = PI;\n   float OPD = 2.0 * iridescenceIOR * thinFilmThickness * cosTheta2;\n   vec3 phi = vec3( phi21 ) + phi23;\n   vec3 R123 = clamp( R12 * R23, 1e-5, 0.9999 );\n   vec3 r123 = sqrt( R123 );\n   vec3 Rs = pow2( T121 ) * R23 / ( vec3( 1.0 ) - R123 );\n   vec3 C0 = R12 + Rs;\n   I = C0;\n   vec3 Cm = Rs - T121;\n   for ( int m = 1; m <= 2; ++m ) {\n       Cm *= r123;\n       vec3 Sm = 2.0 * evalSensitivity( float( m ) * OPD, float( m ) * phi );\n       I += Cm * Sm;\n   }\n   return max( I, vec3( 0.0 ) );\n}\n#endif",ao="#ifdef USE_BUMPMAP\n\tuniform sampler2D bumpMap;\n\tuniform float bumpScale;\n\tvec2 dHdxy_fwd() {\n\t\tvec2 dSTdx = dFdx( vUv );\n\t\tvec2 dSTdy = dFdy( vUv );\n\t\tfloat Hll = bumpScale * texture2D( bumpMap, vUv ).x;\n\t\tfloat dBx = bumpScale * texture2D( bumpMap, vUv + dSTdx ).x - Hll;\n\t\tfloat dBy = bumpScale * texture2D( bumpMap, vUv + dSTdy ).x - Hll;\n\t\treturn vec2( dBx, dBy );\n\t}\n\tvec3 perturbNormalArb( vec3 surf_pos, vec3 surf_norm, vec2 dHdxy, float faceDirection ) {\n\t\tvec3 vSigmaX = vec3( dFdx( surf_pos.x ), dFdx( surf_pos.y ), dFdx( surf_pos.z ) );\n\t\tvec3 vSigmaY = vec3( dFdy( surf_pos.x ), dFdy( surf_pos.y ), dFdy( surf_pos.z ) );\n\t\tvec3 vN = surf_norm;\n\t\tvec3 R1 = cross( vSigmaY, vN );\n\t\tvec3 R2 = cross( vN, vSigmaX );\n\t\tfloat fDet = dot( vSigmaX, R1 ) * faceDirection;\n\t\tvec3 vGrad = sign( fDet ) * ( dHdxy.x * R1 + dHdxy.y * R2 );\n\t\treturn normalize( abs( fDet ) * surf_norm - vGrad );\n\t}\n#endif",lo="#if NUM_CLIPPING_PLANES > 0\n\tvec4 plane;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < UNION_CLIPPING_PLANES; i ++ ) {\n\t\tplane = clippingPlanes[ i ];\n\t\tif ( dot( vClipPosition, plane.xyz ) > plane.w ) discard;\n\t}\n\t#pragma unroll_loop_end\n\t#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES\n\t\tbool clipped = true;\n\t\t#pragma unroll_loop_start\n\t\tfor ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {\n\t\t\tplane = clippingPlanes[ i ];\n\t\t\tclipped = ( dot( vClipPosition, plane.xyz ) > plane.w ) && clipped;\n\t\t}\n\t\t#pragma unroll_loop_end\n\t\tif ( clipped ) discard;\n\t#endif\n#endif",co="#if NUM_CLIPPING_PLANES > 0\n\tvarying vec3 vClipPosition;\n\tuniform vec4 clippingPlanes[ NUM_CLIPPING_PLANES ];\n#endif",uo="#if NUM_CLIPPING_PLANES > 0\n\tvarying vec3 vClipPosition;\n#endif",ho="#if NUM_CLIPPING_PLANES > 0\n\tvClipPosition = - mvPosition.xyz;\n#endif",fo="#if defined( USE_COLOR_ALPHA )\n\tdiffuseColor *= vColor;\n#elif defined( USE_COLOR )\n\tdiffuseColor.rgb *= vColor;\n#endif",po="#if defined( USE_COLOR_ALPHA )\n\tvarying vec4 vColor;\n#elif defined( USE_COLOR )\n\tvarying vec3 vColor;\n#endif",mo="#if defined( USE_COLOR_ALPHA )\n\tvarying vec4 vColor;\n#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR )\n\tvarying vec3 vColor;\n#endif",go="#if defined( USE_COLOR_ALPHA )\n\tvColor = vec4( 1.0 );\n#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR )\n\tvColor = vec3( 1.0 );\n#endif\n#ifdef USE_COLOR\n\tvColor *= color;\n#endif\n#ifdef USE_INSTANCING_COLOR\n\tvColor.xyz *= instanceColor.xyz;\n#endif",vo="#define PI 3.141592653589793\n#define PI2 6.283185307179586\n#define PI_HALF 1.5707963267948966\n#define RECIPROCAL_PI 0.3183098861837907\n#define RECIPROCAL_PI2 0.15915494309189535\n#define EPSILON 1e-6\n#ifndef saturate\n#define saturate( a ) clamp( a, 0.0, 1.0 )\n#endif\n#define whiteComplement( a ) ( 1.0 - saturate( a ) )\nfloat pow2( const in float x ) { return x*x; }\nvec3 pow2( const in vec3 x ) { return x*x; }\nfloat pow3( const in float x ) { return x*x*x; }\nfloat pow4( const in float x ) { float x2 = x*x; return x2*x2; }\nfloat max3( const in vec3 v ) { return max( max( v.x, v.y ), v.z ); }\nfloat average( const in vec3 color ) { return dot( color, vec3( 0.3333 ) ); }\nhighp float rand( const in vec2 uv ) {\n\tconst highp float a = 12.9898, b = 78.233, c = 43758.5453;\n\thighp float dt = dot( uv.xy, vec2( a,b ) ), sn = mod( dt, PI );\n\treturn fract( sin( sn ) * c );\n}\n#ifdef HIGH_PRECISION\n\tfloat precisionSafeLength( vec3 v ) { return length( v ); }\n#else\n\tfloat precisionSafeLength( vec3 v ) {\n\t\tfloat maxComponent = max3( abs( v ) );\n\t\treturn length( v / maxComponent ) * maxComponent;\n\t}\n#endif\nstruct IncidentLight {\n\tvec3 color;\n\tvec3 direction;\n\tbool visible;\n};\nstruct ReflectedLight {\n\tvec3 directDiffuse;\n\tvec3 directSpecular;\n\tvec3 indirectDiffuse;\n\tvec3 indirectSpecular;\n};\nstruct GeometricContext {\n\tvec3 position;\n\tvec3 normal;\n\tvec3 viewDir;\n#ifdef USE_CLEARCOAT\n\tvec3 clearcoatNormal;\n#endif\n};\nvec3 transformDirection( in vec3 dir, in mat4 matrix ) {\n\treturn normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );\n}\nvec3 inverseTransformDirection( in vec3 dir, in mat4 matrix ) {\n\treturn normalize( ( vec4( dir, 0.0 ) * matrix ).xyz );\n}\nmat3 transposeMat3( const in mat3 m ) {\n\tmat3 tmp;\n\ttmp[ 0 ] = vec3( m[ 0 ].x, m[ 1 ].x, m[ 2 ].x );\n\ttmp[ 1 ] = vec3( m[ 0 ].y, m[ 1 ].y, m[ 2 ].y );\n\ttmp[ 2 ] = vec3( m[ 0 ].z, m[ 1 ].z, m[ 2 ].z );\n\treturn tmp;\n}\nfloat linearToRelativeLuminance( const in vec3 color ) {\n\tvec3 weights = vec3( 0.2126, 0.7152, 0.0722 );\n\treturn dot( weights, color.rgb );\n}\nbool isPerspectiveMatrix( mat4 m ) {\n\treturn m[ 2 ][ 3 ] == - 1.0;\n}\nvec2 equirectUv( in vec3 dir ) {\n\tfloat u = atan( dir.z, dir.x ) * RECIPROCAL_PI2 + 0.5;\n\tfloat v = asin( clamp( dir.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;\n\treturn vec2( u, v );\n}",yo="#ifdef ENVMAP_TYPE_CUBE_UV\n\t#define cubeUV_minMipLevel 4.0\n\t#define cubeUV_minTileSize 16.0\n\tfloat getFace( vec3 direction ) {\n\t\tvec3 absDirection = abs( direction );\n\t\tfloat face = - 1.0;\n\t\tif ( absDirection.x > absDirection.z ) {\n\t\t\tif ( absDirection.x > absDirection.y )\n\t\t\t\tface = direction.x > 0.0 ? 0.0 : 3.0;\n\t\t\telse\n\t\t\t\tface = direction.y > 0.0 ? 1.0 : 4.0;\n\t\t} else {\n\t\t\tif ( absDirection.z > absDirection.y )\n\t\t\t\tface = direction.z > 0.0 ? 2.0 : 5.0;\n\t\t\telse\n\t\t\t\tface = direction.y > 0.0 ? 1.0 : 4.0;\n\t\t}\n\t\treturn face;\n\t}\n\tvec2 getUV( vec3 direction, float face ) {\n\t\tvec2 uv;\n\t\tif ( face == 0.0 ) {\n\t\t\tuv = vec2( direction.z, direction.y ) / abs( direction.x );\n\t\t} else if ( face == 1.0 ) {\n\t\t\tuv = vec2( - direction.x, - direction.z ) / abs( direction.y );\n\t\t} else if ( face == 2.0 ) {\n\t\t\tuv = vec2( - direction.x, direction.y ) / abs( direction.z );\n\t\t} else if ( face == 3.0 ) {\n\t\t\tuv = vec2( - direction.z, direction.y ) / abs( direction.x );\n\t\t} else if ( face == 4.0 ) {\n\t\t\tuv = vec2( - direction.x, direction.z ) / abs( direction.y );\n\t\t} else {\n\t\t\tuv = vec2( direction.x, direction.y ) / abs( direction.z );\n\t\t}\n\t\treturn 0.5 * ( uv + 1.0 );\n\t}\n\tvec3 bilinearCubeUV( sampler2D envMap, vec3 direction, float mipInt ) {\n\t\tfloat face = getFace( direction );\n\t\tfloat filterInt = max( cubeUV_minMipLevel - mipInt, 0.0 );\n\t\tmipInt = max( mipInt, cubeUV_minMipLevel );\n\t\tfloat faceSize = exp2( mipInt );\n\t\tvec2 uv = getUV( direction, face ) * ( faceSize - 2.0 ) + 1.0;\n\t\tif ( face > 2.0 ) {\n\t\t\tuv.y += faceSize;\n\t\t\tface -= 3.0;\n\t\t}\n\t\tuv.x += face * faceSize;\n\t\tuv.x += filterInt * 3.0 * cubeUV_minTileSize;\n\t\tuv.y += 4.0 * ( exp2( CUBEUV_MAX_MIP ) - faceSize );\n\t\tuv.x *= CUBEUV_TEXEL_WIDTH;\n\t\tuv.y *= CUBEUV_TEXEL_HEIGHT;\n\t\t#ifdef texture2DGradEXT\n\t\t\treturn texture2DGradEXT( envMap, uv, vec2( 0.0 ), vec2( 0.0 ) ).rgb;\n\t\t#else\n\t\t\treturn texture2D( envMap, uv ).rgb;\n\t\t#endif\n\t}\n\t#define r0 1.0\n\t#define v0 0.339\n\t#define m0 - 2.0\n\t#define r1 0.8\n\t#define v1 0.276\n\t#define m1 - 1.0\n\t#define r4 0.4\n\t#define v4 0.046\n\t#define m4 2.0\n\t#define r5 0.305\n\t#define v5 0.016\n\t#define m5 3.0\n\t#define r6 0.21\n\t#define v6 0.0038\n\t#define m6 4.0\n\tfloat roughnessToMip( float roughness ) {\n\t\tfloat mip = 0.0;\n\t\tif ( roughness >= r1 ) {\n\t\t\tmip = ( r0 - roughness ) * ( m1 - m0 ) / ( r0 - r1 ) + m0;\n\t\t} else if ( roughness >= r4 ) {\n\t\t\tmip = ( r1 - roughness ) * ( m4 - m1 ) / ( r1 - r4 ) + m1;\n\t\t} else if ( roughness >= r5 ) {\n\t\t\tmip = ( r4 - roughness ) * ( m5 - m4 ) / ( r4 - r5 ) + m4;\n\t\t} else if ( roughness >= r6 ) {\n\t\t\tmip = ( r5 - roughness ) * ( m6 - m5 ) / ( r5 - r6 ) + m5;\n\t\t} else {\n\t\t\tmip = - 2.0 * log2( 1.16 * roughness );\t\t}\n\t\treturn mip;\n\t}\n\tvec4 textureCubeUV( sampler2D envMap, vec3 sampleDir, float roughness ) {\n\t\tfloat mip = clamp( roughnessToMip( roughness ), m0, CUBEUV_MAX_MIP );\n\t\tfloat mipF = fract( mip );\n\t\tfloat mipInt = floor( mip );\n\t\tvec3 color0 = bilinearCubeUV( envMap, sampleDir, mipInt );\n\t\tif ( mipF == 0.0 ) {\n\t\t\treturn vec4( color0, 1.0 );\n\t\t} else {\n\t\t\tvec3 color1 = bilinearCubeUV( envMap, sampleDir, mipInt + 1.0 );\n\t\t\treturn vec4( mix( color0, color1, mipF ), 1.0 );\n\t\t}\n\t}\n#endif",xo="vec3 transformedNormal = objectNormal;\n#ifdef USE_INSTANCING\n\tmat3 m = mat3( instanceMatrix );\n\ttransformedNormal /= vec3( dot( m[ 0 ], m[ 0 ] ), dot( m[ 1 ], m[ 1 ] ), dot( m[ 2 ], m[ 2 ] ) );\n\ttransformedNormal = m * transformedNormal;\n#endif\ntransformedNormal = normalMatrix * transformedNormal;\n#ifdef FLIP_SIDED\n\ttransformedNormal = - transformedNormal;\n#endif\n#ifdef USE_TANGENT\n\tvec3 transformedTangent = ( modelViewMatrix * vec4( objectTangent, 0.0 ) ).xyz;\n\t#ifdef FLIP_SIDED\n\t\ttransformedTangent = - transformedTangent;\n\t#endif\n#endif",bo="#ifdef USE_DISPLACEMENTMAP\n\tuniform sampler2D displacementMap;\n\tuniform float displacementScale;\n\tuniform float displacementBias;\n#endif",wo="#ifdef USE_DISPLACEMENTMAP\n\ttransformed += normalize( objectNormal ) * ( texture2D( displacementMap, vUv ).x * displacementScale + displacementBias );\n#endif",_o="#ifdef USE_EMISSIVEMAP\n\tvec4 emissiveColor = texture2D( emissiveMap, vUv );\n\ttotalEmissiveRadiance *= emissiveColor.rgb;\n#endif",Mo="#ifdef USE_EMISSIVEMAP\n\tuniform sampler2D emissiveMap;\n#endif",Ao="gl_FragColor = linearToOutputTexel( gl_FragColor );",So="vec4 LinearToLinear( in vec4 value ) {\n\treturn value;\n}\nvec4 LinearTosRGB( in vec4 value ) {\n\treturn vec4( mix( pow( value.rgb, vec3( 0.41666 ) ) * 1.055 - vec3( 0.055 ), value.rgb * 12.92, vec3( lessThanEqual( value.rgb, vec3( 0.0031308 ) ) ) ), value.a );\n}",Eo="#ifdef USE_ENVMAP\n\t#ifdef ENV_WORLDPOS\n\t\tvec3 cameraToFrag;\n\t\tif ( isOrthographic ) {\n\t\t\tcameraToFrag = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );\n\t\t} else {\n\t\t\tcameraToFrag = normalize( vWorldPosition - cameraPosition );\n\t\t}\n\t\tvec3 worldNormal = inverseTransformDirection( normal, viewMatrix );\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t\tvec3 reflectVec = reflect( cameraToFrag, worldNormal );\n\t\t#else\n\t\t\tvec3 reflectVec = refract( cameraToFrag, worldNormal, refractionRatio );\n\t\t#endif\n\t#else\n\t\tvec3 reflectVec = vReflect;\n\t#endif\n\t#ifdef ENVMAP_TYPE_CUBE\n\t\tvec4 envColor = textureCube( envMap, vec3( flipEnvMap * reflectVec.x, reflectVec.yz ) );\n\t#elif defined( ENVMAP_TYPE_CUBE_UV )\n\t\tvec4 envColor = textureCubeUV( envMap, reflectVec, 0.0 );\n\t#else\n\t\tvec4 envColor = vec4( 0.0 );\n\t#endif\n\t#ifdef ENVMAP_BLENDING_MULTIPLY\n\t\toutgoingLight = mix( outgoingLight, outgoingLight * envColor.xyz, specularStrength * reflectivity );\n\t#elif defined( ENVMAP_BLENDING_MIX )\n\t\toutgoingLight = mix( outgoingLight, envColor.xyz, specularStrength * reflectivity );\n\t#elif defined( ENVMAP_BLENDING_ADD )\n\t\toutgoingLight += envColor.xyz * specularStrength * reflectivity;\n\t#endif\n#endif",To="#ifdef USE_ENVMAP\n\tuniform float envMapIntensity;\n\tuniform float flipEnvMap;\n\t#ifdef ENVMAP_TYPE_CUBE\n\t\tuniform samplerCube envMap;\n\t#else\n\t\tuniform sampler2D envMap;\n\t#endif\n\t\n#endif",Co="#ifdef USE_ENVMAP\n\tuniform float reflectivity;\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG )\n\t\t#define ENV_WORLDPOS\n\t#endif\n\t#ifdef ENV_WORLDPOS\n\t\tvarying vec3 vWorldPosition;\n\t\tuniform float refractionRatio;\n\t#else\n\t\tvarying vec3 vReflect;\n\t#endif\n#endif",Ro="#ifdef USE_ENVMAP\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) ||defined( PHONG )\n\t\t#define ENV_WORLDPOS\n\t#endif\n\t#ifdef ENV_WORLDPOS\n\t\t\n\t\tvarying vec3 vWorldPosition;\n\t#else\n\t\tvarying vec3 vReflect;\n\t\tuniform float refractionRatio;\n\t#endif\n#endif",Io="#ifdef USE_ENVMAP\n\t#ifdef ENV_WORLDPOS\n\t\tvWorldPosition = worldPosition.xyz;\n\t#else\n\t\tvec3 cameraToVertex;\n\t\tif ( isOrthographic ) {\n\t\t\tcameraToVertex = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );\n\t\t} else {\n\t\t\tcameraToVertex = normalize( worldPosition.xyz - cameraPosition );\n\t\t}\n\t\tvec3 worldNormal = inverseTransformDirection( transformedNormal, viewMatrix );\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t\tvReflect = reflect( cameraToVertex, worldNormal );\n\t\t#else\n\t\t\tvReflect = refract( cameraToVertex, worldNormal, refractionRatio );\n\t\t#endif\n\t#endif\n#endif",Po="#ifdef USE_FOG\n\tvFogDepth = - mvPosition.z;\n#endif",Lo="#ifdef USE_FOG\n\tvarying float vFogDepth;\n#endif",No="#ifdef USE_FOG\n\t#ifdef FOG_EXP2\n\t\tfloat fogFactor = 1.0 - exp( - fogDensity * fogDensity * vFogDepth * vFogDepth );\n\t#else\n\t\tfloat fogFactor = smoothstep( fogNear, fogFar, vFogDepth );\n\t#endif\n\tgl_FragColor.rgb = mix( gl_FragColor.rgb, fogColor, fogFactor );\n#endif",ko="#ifdef USE_FOG\n\tuniform vec3 fogColor;\n\tvarying float vFogDepth;\n\t#ifdef FOG_EXP2\n\t\tuniform float fogDensity;\n\t#else\n\t\tuniform float fogNear;\n\t\tuniform float fogFar;\n\t#endif\n#endif",Oo="#ifdef USE_GRADIENTMAP\n\tuniform sampler2D gradientMap;\n#endif\nvec3 getGradientIrradiance( vec3 normal, vec3 lightDirection ) {\n\tfloat dotNL = dot( normal, lightDirection );\n\tvec2 coord = vec2( dotNL * 0.5 + 0.5, 0.0 );\n\t#ifdef USE_GRADIENTMAP\n\t\treturn vec3( texture2D( gradientMap, coord ).r );\n\t#else\n\t\treturn ( coord.x < 0.7 ) ? vec3( 0.7 ) : vec3( 1.0 );\n\t#endif\n}",Do="#ifdef USE_LIGHTMAP\n\tvec4 lightMapTexel = texture2D( lightMap, vUv2 );\n\tvec3 lightMapIrradiance = lightMapTexel.rgb * lightMapIntensity;\n\treflectedLight.indirectDiffuse += lightMapIrradiance;\n#endif",zo="#ifdef USE_LIGHTMAP\n\tuniform sampler2D lightMap;\n\tuniform float lightMapIntensity;\n#endif",Fo="vec3 diffuse = vec3( 1.0 );\nGeometricContext geometry;\ngeometry.position = mvPosition.xyz;\ngeometry.normal = normalize( transformedNormal );\ngeometry.viewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( -mvPosition.xyz );\nGeometricContext backGeometry;\nbackGeometry.position = geometry.position;\nbackGeometry.normal = -geometry.normal;\nbackGeometry.viewDir = geometry.viewDir;\nvLightFront = vec3( 0.0 );\nvIndirectFront = vec3( 0.0 );\n#ifdef DOUBLE_SIDED\n\tvLightBack = vec3( 0.0 );\n\tvIndirectBack = vec3( 0.0 );\n#endif\nIncidentLight directLight;\nfloat dotNL;\nvec3 directLightColor_Diffuse;\nvIndirectFront += getAmbientLightIrradiance( ambientLightColor );\nvIndirectFront += getLightProbeIrradiance( lightProbe, geometry.normal );\n#ifdef DOUBLE_SIDED\n\tvIndirectBack += getAmbientLightIrradiance( ambientLightColor );\n\tvIndirectBack += getLightProbeIrradiance( lightProbe, backGeometry.normal );\n#endif\n#if NUM_POINT_LIGHTS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\n\t\tgetPointLightInfo( pointLights[ i ], geometry, directLight );\n\t\tdotNL = dot( geometry.normal, directLight.direction );\n\t\tdirectLightColor_Diffuse = directLight.color;\n\t\tvLightFront += saturate( dotNL ) * directLightColor_Diffuse;\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvLightBack += saturate( - dotNL ) * directLightColor_Diffuse;\n\t\t#endif\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if NUM_SPOT_LIGHTS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\n\t\tgetSpotLightInfo( spotLights[ i ], geometry, directLight );\n\t\tdotNL = dot( geometry.normal, directLight.direction );\n\t\tdirectLightColor_Diffuse = directLight.color;\n\t\tvLightFront += saturate( dotNL ) * directLightColor_Diffuse;\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvLightBack += saturate( - dotNL ) * directLightColor_Diffuse;\n\t\t#endif\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if NUM_DIR_LIGHTS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\n\t\tgetDirectionalLightInfo( directionalLights[ i ], geometry, directLight );\n\t\tdotNL = dot( geometry.normal, directLight.direction );\n\t\tdirectLightColor_Diffuse = directLight.color;\n\t\tvLightFront += saturate( dotNL ) * directLightColor_Diffuse;\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvLightBack += saturate( - dotNL ) * directLightColor_Diffuse;\n\t\t#endif\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if NUM_HEMI_LIGHTS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {\n\t\tvIndirectFront += getHemisphereLightIrradiance( hemisphereLights[ i ], geometry.normal );\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvIndirectBack += getHemisphereLightIrradiance( hemisphereLights[ i ], backGeometry.normal );\n\t\t#endif\n\t}\n\t#pragma unroll_loop_end\n#endif",Uo="uniform bool receiveShadow;\nuniform vec3 ambientLightColor;\nuniform vec3 lightProbe[ 9 ];\nvec3 shGetIrradianceAt( in vec3 normal, in vec3 shCoefficients[ 9 ] ) {\n\tfloat x = normal.x, y = normal.y, z = normal.z;\n\tvec3 result = shCoefficients[ 0 ] * 0.886227;\n\tresult += shCoefficients[ 1 ] * 2.0 * 0.511664 * y;\n\tresult += shCoefficients[ 2 ] * 2.0 * 0.511664 * z;\n\tresult += shCoefficients[ 3 ] * 2.0 * 0.511664 * x;\n\tresult += shCoefficients[ 4 ] * 2.0 * 0.429043 * x * y;\n\tresult += shCoefficients[ 5 ] * 2.0 * 0.429043 * y * z;\n\tresult += shCoefficients[ 6 ] * ( 0.743125 * z * z - 0.247708 );\n\tresult += shCoefficients[ 7 ] * 2.0 * 0.429043 * x * z;\n\tresult += shCoefficients[ 8 ] * 0.429043 * ( x * x - y * y );\n\treturn result;\n}\nvec3 getLightProbeIrradiance( const in vec3 lightProbe[ 9 ], const in vec3 normal ) {\n\tvec3 worldNormal = inverseTransformDirection( normal, viewMatrix );\n\tvec3 irradiance = shGetIrradianceAt( worldNormal, lightProbe );\n\treturn irradiance;\n}\nvec3 getAmbientLightIrradiance( const in vec3 ambientLightColor ) {\n\tvec3 irradiance = ambientLightColor;\n\treturn irradiance;\n}\nfloat getDistanceAttenuation( const in float lightDistance, const in float cutoffDistance, const in float decayExponent ) {\n\t#if defined ( PHYSICALLY_CORRECT_LIGHTS )\n\t\tfloat distanceFalloff = 1.0 / max( pow( lightDistance, decayExponent ), 0.01 );\n\t\tif ( cutoffDistance > 0.0 ) {\n\t\t\tdistanceFalloff *= pow2( saturate( 1.0 - pow4( lightDistance / cutoffDistance ) ) );\n\t\t}\n\t\treturn distanceFalloff;\n\t#else\n\t\tif ( cutoffDistance > 0.0 && decayExponent > 0.0 ) {\n\t\t\treturn pow( saturate( - lightDistance / cutoffDistance + 1.0 ), decayExponent );\n\t\t}\n\t\treturn 1.0;\n\t#endif\n}\nfloat getSpotAttenuation( const in float coneCosine, const in float penumbraCosine, const in float angleCosine ) {\n\treturn smoothstep( coneCosine, penumbraCosine, angleCosine );\n}\n#if NUM_DIR_LIGHTS > 0\n\tstruct DirectionalLight {\n\t\tvec3 direction;\n\t\tvec3 color;\n\t};\n\tuniform DirectionalLight directionalLights[ NUM_DIR_LIGHTS ];\n\tvoid getDirectionalLightInfo( const in DirectionalLight directionalLight, const in GeometricContext geometry, out IncidentLight light ) {\n\t\tlight.color = directionalLight.color;\n\t\tlight.direction = directionalLight.direction;\n\t\tlight.visible = true;\n\t}\n#endif\n#if NUM_POINT_LIGHTS > 0\n\tstruct PointLight {\n\t\tvec3 position;\n\t\tvec3 color;\n\t\tfloat distance;\n\t\tfloat decay;\n\t};\n\tuniform PointLight pointLights[ NUM_POINT_LIGHTS ];\n\tvoid getPointLightInfo( const in PointLight pointLight, const in GeometricContext geometry, out IncidentLight light ) {\n\t\tvec3 lVector = pointLight.position - geometry.position;\n\t\tlight.direction = normalize( lVector );\n\t\tfloat lightDistance = length( lVector );\n\t\tlight.color = pointLight.color;\n\t\tlight.color *= getDistanceAttenuation( lightDistance, pointLight.distance, pointLight.decay );\n\t\tlight.visible = ( light.color != vec3( 0.0 ) );\n\t}\n#endif\n#if NUM_SPOT_LIGHTS > 0\n\tstruct SpotLight {\n\t\tvec3 position;\n\t\tvec3 direction;\n\t\tvec3 color;\n\t\tfloat distance;\n\t\tfloat decay;\n\t\tfloat coneCos;\n\t\tfloat penumbraCos;\n\t};\n\tuniform SpotLight spotLights[ NUM_SPOT_LIGHTS ];\n\tvoid getSpotLightInfo( const in SpotLight spotLight, const in GeometricContext geometry, out IncidentLight light ) {\n\t\tvec3 lVector = spotLight.position - geometry.position;\n\t\tlight.direction = normalize( lVector );\n\t\tfloat angleCos = dot( light.direction, spotLight.direction );\n\t\tfloat spotAttenuation = getSpotAttenuation( spotLight.coneCos, spotLight.penumbraCos, angleCos );\n\t\tif ( spotAttenuation > 0.0 ) {\n\t\t\tfloat lightDistance = length( lVector );\n\t\t\tlight.color = spotLight.color * spotAttenuation;\n\t\t\tlight.color *= getDistanceAttenuation( lightDistance, spotLight.distance, spotLight.decay );\n\t\t\tlight.visible = ( light.color != vec3( 0.0 ) );\n\t\t} else {\n\t\t\tlight.color = vec3( 0.0 );\n\t\t\tlight.visible = false;\n\t\t}\n\t}\n#endif\n#if NUM_RECT_AREA_LIGHTS > 0\n\tstruct RectAreaLight {\n\t\tvec3 color;\n\t\tvec3 position;\n\t\tvec3 halfWidth;\n\t\tvec3 halfHeight;\n\t};\n\tuniform sampler2D ltc_1;\tuniform sampler2D ltc_2;\n\tuniform RectAreaLight rectAreaLights[ NUM_RECT_AREA_LIGHTS ];\n#endif\n#if NUM_HEMI_LIGHTS > 0\n\tstruct HemisphereLight {\n\t\tvec3 direction;\n\t\tvec3 skyColor;\n\t\tvec3 groundColor;\n\t};\n\tuniform HemisphereLight hemisphereLights[ NUM_HEMI_LIGHTS ];\n\tvec3 getHemisphereLightIrradiance( const in HemisphereLight hemiLight, const in vec3 normal ) {\n\t\tfloat dotNL = dot( normal, hemiLight.direction );\n\t\tfloat hemiDiffuseWeight = 0.5 * dotNL + 0.5;\n\t\tvec3 irradiance = mix( hemiLight.groundColor, hemiLight.skyColor, hemiDiffuseWeight );\n\t\treturn irradiance;\n\t}\n#endif",Bo="#if defined( USE_ENVMAP )\n\tvec3 getIBLIrradiance( const in vec3 normal ) {\n\t\t#if defined( ENVMAP_TYPE_CUBE_UV )\n\t\t\tvec3 worldNormal = inverseTransformDirection( normal, viewMatrix );\n\t\t\tvec4 envMapColor = textureCubeUV( envMap, worldNormal, 1.0 );\n\t\t\treturn PI * envMapColor.rgb * envMapIntensity;\n\t\t#else\n\t\t\treturn vec3( 0.0 );\n\t\t#endif\n\t}\n\tvec3 getIBLRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness ) {\n\t\t#if defined( ENVMAP_TYPE_CUBE_UV )\n\t\t\tvec3 reflectVec = reflect( - viewDir, normal );\n\t\t\treflectVec = normalize( mix( reflectVec, normal, roughness * roughness) );\n\t\t\treflectVec = inverseTransformDirection( reflectVec, viewMatrix );\n\t\t\tvec4 envMapColor = textureCubeUV( envMap, reflectVec, roughness );\n\t\t\treturn envMapColor.rgb * envMapIntensity;\n\t\t#else\n\t\t\treturn vec3( 0.0 );\n\t\t#endif\n\t}\n#endif",Go="ToonMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb;",Ho="varying vec3 vViewPosition;\nstruct ToonMaterial {\n\tvec3 diffuseColor;\n};\nvoid RE_Direct_Toon( const in IncidentLight directLight, const in GeometricContext geometry, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {\n\tvec3 irradiance = getGradientIrradiance( geometry.normal, directLight.direction ) * directLight.color;\n\treflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectDiffuse_Toon( const in vec3 irradiance, const in GeometricContext geometry, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\n#define RE_Direct\t\t\t\tRE_Direct_Toon\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_Toon\n#define Material_LightProbeLOD( material )\t(0)",Vo="BlinnPhongMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb;\nmaterial.specularColor = specular;\nmaterial.specularShininess = shininess;\nmaterial.specularStrength = specularStrength;",jo="varying vec3 vViewPosition;\nstruct BlinnPhongMaterial {\n\tvec3 diffuseColor;\n\tvec3 specularColor;\n\tfloat specularShininess;\n\tfloat specularStrength;\n};\nvoid RE_Direct_BlinnPhong( const in IncidentLight directLight, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {\n\tfloat dotNL = saturate( dot( geometry.normal, directLight.direction ) );\n\tvec3 irradiance = dotNL * directLight.color;\n\treflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n\treflectedLight.directSpecular += irradiance * BRDF_BlinnPhong( directLight.direction, geometry.viewDir, geometry.normal, material.specularColor, material.specularShininess ) * material.specularStrength;\n}\nvoid RE_IndirectDiffuse_BlinnPhong( const in vec3 irradiance, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\n#define RE_Direct\t\t\t\tRE_Direct_BlinnPhong\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_BlinnPhong\n#define Material_LightProbeLOD( material )\t(0)",Wo="PhysicalMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb * ( 1.0 - metalnessFactor );\nvec3 dxy = max( abs( dFdx( geometryNormal ) ), abs( dFdy( geometryNormal ) ) );\nfloat geometryRoughness = max( max( dxy.x, dxy.y ), dxy.z );\nmaterial.roughness = max( roughnessFactor, 0.0525 );material.roughness += geometryRoughness;\nmaterial.roughness = min( material.roughness, 1.0 );\n#ifdef IOR\n\t#ifdef SPECULAR\n\t\tfloat specularIntensityFactor = specularIntensity;\n\t\tvec3 specularColorFactor = specularColor;\n\t\t#ifdef USE_SPECULARINTENSITYMAP\n\t\t\tspecularIntensityFactor *= texture2D( specularIntensityMap, vUv ).a;\n\t\t#endif\n\t\t#ifdef USE_SPECULARCOLORMAP\n\t\t\tspecularColorFactor *= texture2D( specularColorMap, vUv ).rgb;\n\t\t#endif\n\t\tmaterial.specularF90 = mix( specularIntensityFactor, 1.0, metalnessFactor );\n\t#else\n\t\tfloat specularIntensityFactor = 1.0;\n\t\tvec3 specularColorFactor = vec3( 1.0 );\n\t\tmaterial.specularF90 = 1.0;\n\t#endif\n\tmaterial.specularColor = mix( min( pow2( ( ior - 1.0 ) / ( ior + 1.0 ) ) * specularColorFactor, vec3( 1.0 ) ) * specularIntensityFactor, diffuseColor.rgb, metalnessFactor );\n#else\n\tmaterial.specularColor = mix( vec3( 0.04 ), diffuseColor.rgb, metalnessFactor );\n\tmaterial.specularF90 = 1.0;\n#endif\n#ifdef USE_CLEARCOAT\n\tmaterial.clearcoat = clearcoat;\n\tmaterial.clearcoatRoughness = clearcoatRoughness;\n\tmaterial.clearcoatF0 = vec3( 0.04 );\n\tmaterial.clearcoatF90 = 1.0;\n\t#ifdef USE_CLEARCOATMAP\n\t\tmaterial.clearcoat *= texture2D( clearcoatMap, vUv ).x;\n\t#endif\n\t#ifdef USE_CLEARCOAT_ROUGHNESSMAP\n\t\tmaterial.clearcoatRoughness *= texture2D( clearcoatRoughnessMap, vUv ).y;\n\t#endif\n\tmaterial.clearcoat = saturate( material.clearcoat );\tmaterial.clearcoatRoughness = max( material.clearcoatRoughness, 0.0525 );\n\tmaterial.clearcoatRoughness += geometryRoughness;\n\tmaterial.clearcoatRoughness = min( material.clearcoatRoughness, 1.0 );\n#endif\n#ifdef USE_IRIDESCENCE\n\tmaterial.iridescence = iridescence;\n\tmaterial.iridescenceIOR = iridescenceIOR;\n\t#ifdef USE_IRIDESCENCEMAP\n\t\tmaterial.iridescence *= texture2D( iridescenceMap, vUv ).r;\n\t#endif\n\t#ifdef USE_IRIDESCENCE_THICKNESSMAP\n\t\tmaterial.iridescenceThickness = (iridescenceThicknessMaximum - iridescenceThicknessMinimum) * texture2D( iridescenceThicknessMap, vUv ).g + iridescenceThicknessMinimum;\n\t#else\n\t\tmaterial.iridescenceThickness = iridescenceThicknessMaximum;\n\t#endif\n#endif\n#ifdef USE_SHEEN\n\tmaterial.sheenColor = sheenColor;\n\t#ifdef USE_SHEENCOLORMAP\n\t\tmaterial.sheenColor *= texture2D( sheenColorMap, vUv ).rgb;\n\t#endif\n\tmaterial.sheenRoughness = clamp( sheenRoughness, 0.07, 1.0 );\n\t#ifdef USE_SHEENROUGHNESSMAP\n\t\tmaterial.sheenRoughness *= texture2D( sheenRoughnessMap, vUv ).a;\n\t#endif\n#endif",qo="struct PhysicalMaterial {\n\tvec3 diffuseColor;\n\tfloat roughness;\n\tvec3 specularColor;\n\tfloat specularF90;\n\t#ifdef USE_CLEARCOAT\n\t\tfloat clearcoat;\n\t\tfloat clearcoatRoughness;\n\t\tvec3 clearcoatF0;\n\t\tfloat clearcoatF90;\n\t#endif\n\t#ifdef USE_IRIDESCENCE\n\t\tfloat iridescence;\n\t\tfloat iridescenceIOR;\n\t\tfloat iridescenceThickness;\n\t\tvec3 iridescenceFresnel;\n\t\tvec3 iridescenceF0;\n\t#endif\n\t#ifdef USE_SHEEN\n\t\tvec3 sheenColor;\n\t\tfloat sheenRoughness;\n\t#endif\n};\nvec3 clearcoatSpecular = vec3( 0.0 );\nvec3 sheenSpecular = vec3( 0.0 );\nfloat IBLSheenBRDF( const in vec3 normal, const in vec3 viewDir, const in float roughness) {\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tfloat r2 = roughness * roughness;\n\tfloat a = roughness < 0.25 ? -339.2 * r2 + 161.4 * roughness - 25.9 : -8.48 * r2 + 14.3 * roughness - 9.95;\n\tfloat b = roughness < 0.25 ? 44.0 * r2 - 23.7 * roughness + 3.26 : 1.97 * r2 - 3.27 * roughness + 0.72;\n\tfloat DG = exp( a * dotNV + b ) + ( roughness < 0.25 ? 0.0 : 0.1 * ( roughness - 0.25 ) );\n\treturn saturate( DG * RECIPROCAL_PI );\n}\nvec2 DFGApprox( const in vec3 normal, const in vec3 viewDir, const in float roughness ) {\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tconst vec4 c0 = vec4( - 1, - 0.0275, - 0.572, 0.022 );\n\tconst vec4 c1 = vec4( 1, 0.0425, 1.04, - 0.04 );\n\tvec4 r = roughness * c0 + c1;\n\tfloat a004 = min( r.x * r.x, exp2( - 9.28 * dotNV ) ) * r.x + r.y;\n\tvec2 fab = vec2( - 1.04, 1.04 ) * a004 + r.zw;\n\treturn fab;\n}\nvec3 EnvironmentBRDF( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness ) {\n\tvec2 fab = DFGApprox( normal, viewDir, roughness );\n\treturn specularColor * fab.x + specularF90 * fab.y;\n}\n#ifdef USE_IRIDESCENCE\nvoid computeMultiscatteringIridescence( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float iridescence, const in vec3 iridescenceF0, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {\n#else\nvoid computeMultiscattering( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {\n#endif\n\tvec2 fab = DFGApprox( normal, viewDir, roughness );\n\t#ifdef USE_IRIDESCENCE\n\t\tvec3 Fr = mix( specularColor, iridescenceF0, iridescence );\n\t#else\n\t\tvec3 Fr = specularColor;\n\t#endif\n\tvec3 FssEss = Fr * fab.x + specularF90 * fab.y;\n\tfloat Ess = fab.x + fab.y;\n\tfloat Ems = 1.0 - Ess;\n\tvec3 Favg = Fr + ( 1.0 - Fr ) * 0.047619;\tvec3 Fms = FssEss * Favg / ( 1.0 - Ems * Favg );\n\tsingleScatter += FssEss;\n\tmultiScatter += Fms * Ems;\n}\n#if NUM_RECT_AREA_LIGHTS > 0\n\tvoid RE_Direct_RectArea_Physical( const in RectAreaLight rectAreaLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\t\tvec3 normal = geometry.normal;\n\t\tvec3 viewDir = geometry.viewDir;\n\t\tvec3 position = geometry.position;\n\t\tvec3 lightPos = rectAreaLight.position;\n\t\tvec3 halfWidth = rectAreaLight.halfWidth;\n\t\tvec3 halfHeight = rectAreaLight.halfHeight;\n\t\tvec3 lightColor = rectAreaLight.color;\n\t\tfloat roughness = material.roughness;\n\t\tvec3 rectCoords[ 4 ];\n\t\trectCoords[ 0 ] = lightPos + halfWidth - halfHeight;\t\trectCoords[ 1 ] = lightPos - halfWidth - halfHeight;\n\t\trectCoords[ 2 ] = lightPos - halfWidth + halfHeight;\n\t\trectCoords[ 3 ] = lightPos + halfWidth + halfHeight;\n\t\tvec2 uv = LTC_Uv( normal, viewDir, roughness );\n\t\tvec4 t1 = texture2D( ltc_1, uv );\n\t\tvec4 t2 = texture2D( ltc_2, uv );\n\t\tmat3 mInv = mat3(\n\t\t\tvec3( t1.x, 0, t1.y ),\n\t\t\tvec3(    0, 1,    0 ),\n\t\t\tvec3( t1.z, 0, t1.w )\n\t\t);\n\t\tvec3 fresnel = ( material.specularColor * t2.x + ( vec3( 1.0 ) - material.specularColor ) * t2.y );\n\t\treflectedLight.directSpecular += lightColor * fresnel * LTC_Evaluate( normal, viewDir, position, mInv, rectCoords );\n\t\treflectedLight.directDiffuse += lightColor * material.diffuseColor * LTC_Evaluate( normal, viewDir, position, mat3( 1.0 ), rectCoords );\n\t}\n#endif\nvoid RE_Direct_Physical( const in IncidentLight directLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\tfloat dotNL = saturate( dot( geometry.normal, directLight.direction ) );\n\tvec3 irradiance = dotNL * directLight.color;\n\t#ifdef USE_CLEARCOAT\n\t\tfloat dotNLcc = saturate( dot( geometry.clearcoatNormal, directLight.direction ) );\n\t\tvec3 ccIrradiance = dotNLcc * directLight.color;\n\t\tclearcoatSpecular += ccIrradiance * BRDF_GGX( directLight.direction, geometry.viewDir, geometry.clearcoatNormal, material.clearcoatF0, material.clearcoatF90, material.clearcoatRoughness );\n\t#endif\n\t#ifdef USE_SHEEN\n\t\tsheenSpecular += irradiance * BRDF_Sheen( directLight.direction, geometry.viewDir, geometry.normal, material.sheenColor, material.sheenRoughness );\n\t#endif\n\t#ifdef USE_IRIDESCENCE\n\t\treflectedLight.directSpecular += irradiance * BRDF_GGX_Iridescence( directLight.direction, geometry.viewDir, geometry.normal, material.specularColor, material.specularF90, material.iridescence, material.iridescenceFresnel, material.roughness );\n\t#else\n\t\treflectedLight.directSpecular += irradiance * BRDF_GGX( directLight.direction, geometry.viewDir, geometry.normal, material.specularColor, material.specularF90, material.roughness );\n\t#endif\n\treflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectDiffuse_Physical( const in vec3 irradiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectSpecular_Physical( const in vec3 radiance, const in vec3 irradiance, const in vec3 clearcoatRadiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight) {\n\t#ifdef USE_CLEARCOAT\n\t\tclearcoatSpecular += clearcoatRadiance * EnvironmentBRDF( geometry.clearcoatNormal, geometry.viewDir, material.clearcoatF0, material.clearcoatF90, material.clearcoatRoughness );\n\t#endif\n\t#ifdef USE_SHEEN\n\t\tsheenSpecular += irradiance * material.sheenColor * IBLSheenBRDF( geometry.normal, geometry.viewDir, material.sheenRoughness );\n\t#endif\n\tvec3 singleScattering = vec3( 0.0 );\n\tvec3 multiScattering = vec3( 0.0 );\n\tvec3 cosineWeightedIrradiance = irradiance * RECIPROCAL_PI;\n\t#ifdef USE_IRIDESCENCE\n\t\tcomputeMultiscatteringIridescence( geometry.normal, geometry.viewDir, material.specularColor, material.specularF90, material.iridescence, material.iridescenceFresnel, material.roughness, singleScattering, multiScattering );\n\t#else\n\t\tcomputeMultiscattering( geometry.normal, geometry.viewDir, material.specularColor, material.specularF90, material.roughness, singleScattering, multiScattering );\n\t#endif\n\tvec3 totalScattering = singleScattering + multiScattering;\n\tvec3 diffuse = material.diffuseColor * ( 1.0 - max( max( totalScattering.r, totalScattering.g ), totalScattering.b ) );\n\treflectedLight.indirectSpecular += radiance * singleScattering;\n\treflectedLight.indirectSpecular += multiScattering * cosineWeightedIrradiance;\n\treflectedLight.indirectDiffuse += diffuse * cosineWeightedIrradiance;\n}\n#define RE_Direct\t\t\t\tRE_Direct_Physical\n#define RE_Direct_RectArea\t\tRE_Direct_RectArea_Physical\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_Physical\n#define RE_IndirectSpecular\t\tRE_IndirectSpecular_Physical\nfloat computeSpecularOcclusion( const in float dotNV, const in float ambientOcclusion, const in float roughness ) {\n\treturn saturate( pow( dotNV + ambientOcclusion, exp2( - 16.0 * roughness - 1.0 ) ) - 1.0 + ambientOcclusion );\n}",Yo="\nGeometricContext geometry;\ngeometry.position = - vViewPosition;\ngeometry.normal = normal;\ngeometry.viewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( vViewPosition );\n#ifdef USE_CLEARCOAT\n\tgeometry.clearcoatNormal = clearcoatNormal;\n#endif\n#ifdef USE_IRIDESCENCE\nfloat dotNVi = saturate( dot( normal, geometry.viewDir ) );\nif ( material.iridescenceThickness == 0.0 ) {\n\tmaterial.iridescence = 0.0;\n} else {\n\tmaterial.iridescence = saturate( material.iridescence );\n}\nif ( material.iridescence > 0.0 ) {\n\tmaterial.iridescenceFresnel = evalIridescence( 1.0, material.iridescenceIOR, dotNVi, material.iridescenceThickness, material.specularColor );\n\tmaterial.iridescenceF0 = Schlick_to_F0( material.iridescenceFresnel, 1.0, dotNVi );\n}\n#endif\nIncidentLight directLight;\n#if ( NUM_POINT_LIGHTS > 0 ) && defined( RE_Direct )\n\tPointLight pointLight;\n\t#if defined( USE_SHADOWMAP ) && NUM_POINT_LIGHT_SHADOWS > 0\n\tPointLightShadow pointLightShadow;\n\t#endif\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\n\t\tpointLight = pointLights[ i ];\n\t\tgetPointLightInfo( pointLight, geometry, directLight );\n\t\t#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_POINT_LIGHT_SHADOWS )\n\t\tpointLightShadow = pointLightShadows[ i ];\n\t\tdirectLight.color *= all( bvec2( directLight.visible, receiveShadow ) ) ? getPointShadow( pointShadowMap[ i ], pointLightShadow.shadowMapSize, pointLightShadow.shadowBias, pointLightShadow.shadowRadius, vPointShadowCoord[ i ], pointLightShadow.shadowCameraNear, pointLightShadow.shadowCameraFar ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if ( NUM_SPOT_LIGHTS > 0 ) && defined( RE_Direct )\n\tSpotLight spotLight;\n\t#if defined( USE_SHADOWMAP ) && NUM_SPOT_LIGHT_SHADOWS > 0\n\tSpotLightShadow spotLightShadow;\n\t#endif\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\n\t\tspotLight = spotLights[ i ];\n\t\tgetSpotLightInfo( spotLight, geometry, directLight );\n\t\t#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )\n\t\tspotLightShadow = spotLightShadows[ i ];\n\t\tdirectLight.color *= all( bvec2( directLight.visible, receiveShadow ) ) ? getShadow( spotShadowMap[ i ], spotLightShadow.shadowMapSize, spotLightShadow.shadowBias, spotLightShadow.shadowRadius, vSpotShadowCoord[ i ] ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if ( NUM_DIR_LIGHTS > 0 ) && defined( RE_Direct )\n\tDirectionalLight directionalLight;\n\t#if defined( USE_SHADOWMAP ) && NUM_DIR_LIGHT_SHADOWS > 0\n\tDirectionalLightShadow directionalLightShadow;\n\t#endif\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\n\t\tdirectionalLight = directionalLights[ i ];\n\t\tgetDirectionalLightInfo( directionalLight, geometry, directLight );\n\t\t#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_DIR_LIGHT_SHADOWS )\n\t\tdirectionalLightShadow = directionalLightShadows[ i ];\n\t\tdirectLight.color *= all( bvec2( directLight.visible, receiveShadow ) ) ? getShadow( directionalShadowMap[ i ], directionalLightShadow.shadowMapSize, directionalLightShadow.shadowBias, directionalLightShadow.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if ( NUM_RECT_AREA_LIGHTS > 0 ) && defined( RE_Direct_RectArea )\n\tRectAreaLight rectAreaLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_RECT_AREA_LIGHTS; i ++ ) {\n\t\trectAreaLight = rectAreaLights[ i ];\n\t\tRE_Direct_RectArea( rectAreaLight, geometry, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if defined( RE_IndirectDiffuse )\n\tvec3 iblIrradiance = vec3( 0.0 );\n\tvec3 irradiance = getAmbientLightIrradiance( ambientLightColor );\n\tirradiance += getLightProbeIrradiance( lightProbe, geometry.normal );\n\t#if ( NUM_HEMI_LIGHTS > 0 )\n\t\t#pragma unroll_loop_start\n\t\tfor ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {\n\t\t\tirradiance += getHemisphereLightIrradiance( hemisphereLights[ i ], geometry.normal );\n\t\t}\n\t\t#pragma unroll_loop_end\n\t#endif\n#endif\n#if defined( RE_IndirectSpecular )\n\tvec3 radiance = vec3( 0.0 );\n\tvec3 clearcoatRadiance = vec3( 0.0 );\n#endif",Xo="#if defined( RE_IndirectDiffuse )\n\t#ifdef USE_LIGHTMAP\n\t\tvec4 lightMapTexel = texture2D( lightMap, vUv2 );\n\t\tvec3 lightMapIrradiance = lightMapTexel.rgb * lightMapIntensity;\n\t\tirradiance += lightMapIrradiance;\n\t#endif\n\t#if defined( USE_ENVMAP ) && defined( STANDARD ) && defined( ENVMAP_TYPE_CUBE_UV )\n\t\tiblIrradiance += getIBLIrradiance( geometry.normal );\n\t#endif\n#endif\n#if defined( USE_ENVMAP ) && defined( RE_IndirectSpecular )\n\tradiance += getIBLRadiance( geometry.viewDir, geometry.normal, material.roughness );\n\t#ifdef USE_CLEARCOAT\n\t\tclearcoatRadiance += getIBLRadiance( geometry.viewDir, geometry.clearcoatNormal, material.clearcoatRoughness );\n\t#endif\n#endif",Jo="#if defined( RE_IndirectDiffuse )\n\tRE_IndirectDiffuse( irradiance, geometry, material, reflectedLight );\n#endif\n#if defined( RE_IndirectSpecular )\n\tRE_IndirectSpecular( radiance, iblIrradiance, clearcoatRadiance, geometry, material, reflectedLight );\n#endif",Ko="#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )\n\tgl_FragDepthEXT = vIsPerspective == 0.0 ? gl_FragCoord.z : log2( vFragDepth ) * logDepthBufFC * 0.5;\n#endif",Zo="#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )\n\tuniform float logDepthBufFC;\n\tvarying float vFragDepth;\n\tvarying float vIsPerspective;\n#endif",Qo="#ifdef USE_LOGDEPTHBUF\n\t#ifdef USE_LOGDEPTHBUF_EXT\n\t\tvarying float vFragDepth;\n\t\tvarying float vIsPerspective;\n\t#else\n\t\tuniform float logDepthBufFC;\n\t#endif\n#endif",$o="#ifdef USE_LOGDEPTHBUF\n\t#ifdef USE_LOGDEPTHBUF_EXT\n\t\tvFragDepth = 1.0 + gl_Position.w;\n\t\tvIsPerspective = float( isPerspectiveMatrix( projectionMatrix ) );\n\t#else\n\t\tif ( isPerspectiveMatrix( projectionMatrix ) ) {\n\t\t\tgl_Position.z = log2( max( EPSILON, gl_Position.w + 1.0 ) ) * logDepthBufFC - 1.0;\n\t\t\tgl_Position.z *= gl_Position.w;\n\t\t}\n\t#endif\n#endif",ta="#ifdef USE_MAP\n\tvec4 sampledDiffuseColor = texture2D( map, vUv );\n\t#ifdef DECODE_VIDEO_TEXTURE\n\t\tsampledDiffuseColor = vec4( mix( pow( sampledDiffuseColor.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), sampledDiffuseColor.rgb * 0.0773993808, vec3( lessThanEqual( sampledDiffuseColor.rgb, vec3( 0.04045 ) ) ) ), sampledDiffuseColor.w );\n\t#endif\n\tdiffuseColor *= sampledDiffuseColor;\n#endif",ea="#ifdef USE_MAP\n\tuniform sampler2D map;\n#endif",na="#if defined( USE_MAP ) || defined( USE_ALPHAMAP )\n\tvec2 uv = ( uvTransform * vec3( gl_PointCoord.x, 1.0 - gl_PointCoord.y, 1 ) ).xy;\n#endif\n#ifdef USE_MAP\n\tdiffuseColor *= texture2D( map, uv );\n#endif\n#ifdef USE_ALPHAMAP\n\tdiffuseColor.a *= texture2D( alphaMap, uv ).g;\n#endif",ra="#if defined( USE_MAP ) || defined( USE_ALPHAMAP )\n\tuniform mat3 uvTransform;\n#endif\n#ifdef USE_MAP\n\tuniform sampler2D map;\n#endif\n#ifdef USE_ALPHAMAP\n\tuniform sampler2D alphaMap;\n#endif",ia="float metalnessFactor = metalness;\n#ifdef USE_METALNESSMAP\n\tvec4 texelMetalness = texture2D( metalnessMap, vUv );\n\tmetalnessFactor *= texelMetalness.b;\n#endif",sa="#ifdef USE_METALNESSMAP\n\tuniform sampler2D metalnessMap;\n#endif",oa="#if defined( USE_MORPHCOLORS ) && defined( MORPHTARGETS_TEXTURE )\n\tvColor *= morphTargetBaseInfluence;\n\tfor ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {\n\t\t#if defined( USE_COLOR_ALPHA )\n\t\t\tif ( morphTargetInfluences[ i ] != 0.0 ) vColor += getMorph( gl_VertexID, i, 2 ) * morphTargetInfluences[ i ];\n\t\t#elif defined( USE_COLOR )\n\t\t\tif ( morphTargetInfluences[ i ] != 0.0 ) vColor += getMorph( gl_VertexID, i, 2 ).rgb * morphTargetInfluences[ i ];\n\t\t#endif\n\t}\n#endif",aa="#ifdef USE_MORPHNORMALS\n\tobjectNormal *= morphTargetBaseInfluence;\n\t#ifdef MORPHTARGETS_TEXTURE\n\t\tfor ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {\n\t\t\tif ( morphTargetInfluences[ i ] != 0.0 ) objectNormal += getMorph( gl_VertexID, i, 1 ).xyz * morphTargetInfluences[ i ];\n\t\t}\n\t#else\n\t\tobjectNormal += morphNormal0 * morphTargetInfluences[ 0 ];\n\t\tobjectNormal += morphNormal1 * morphTargetInfluences[ 1 ];\n\t\tobjectNormal += morphNormal2 * morphTargetInfluences[ 2 ];\n\t\tobjectNormal += morphNormal3 * morphTargetInfluences[ 3 ];\n\t#endif\n#endif",la="#ifdef USE_MORPHTARGETS\n\tuniform float morphTargetBaseInfluence;\n\t#ifdef MORPHTARGETS_TEXTURE\n\t\tuniform float morphTargetInfluences[ MORPHTARGETS_COUNT ];\n\t\tuniform sampler2DArray morphTargetsTexture;\n\t\tuniform ivec2 morphTargetsTextureSize;\n\t\tvec4 getMorph( const in int vertexIndex, const in int morphTargetIndex, const in int offset ) {\n\t\t\tint texelIndex = vertexIndex * MORPHTARGETS_TEXTURE_STRIDE + offset;\n\t\t\tint y = texelIndex / morphTargetsTextureSize.x;\n\t\t\tint x = texelIndex - y * morphTargetsTextureSize.x;\n\t\t\tivec3 morphUV = ivec3( x, y, morphTargetIndex );\n\t\t\treturn texelFetch( morphTargetsTexture, morphUV, 0 );\n\t\t}\n\t#else\n\t\t#ifndef USE_MORPHNORMALS\n\t\t\tuniform float morphTargetInfluences[ 8 ];\n\t\t#else\n\t\t\tuniform float morphTargetInfluences[ 4 ];\n\t\t#endif\n\t#endif\n#endif",ca="#ifdef USE_MORPHTARGETS\n\ttransformed *= morphTargetBaseInfluence;\n\t#ifdef MORPHTARGETS_TEXTURE\n\t\tfor ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {\n\t\t\tif ( morphTargetInfluences[ i ] != 0.0 ) transformed += getMorph( gl_VertexID, i, 0 ).xyz * morphTargetInfluences[ i ];\n\t\t}\n\t#else\n\t\ttransformed += morphTarget0 * morphTargetInfluences[ 0 ];\n\t\ttransformed += morphTarget1 * morphTargetInfluences[ 1 ];\n\t\ttransformed += morphTarget2 * morphTargetInfluences[ 2 ];\n\t\ttransformed += morphTarget3 * morphTargetInfluences[ 3 ];\n\t\t#ifndef USE_MORPHNORMALS\n\t\t\ttransformed += morphTarget4 * morphTargetInfluences[ 4 ];\n\t\t\ttransformed += morphTarget5 * morphTargetInfluences[ 5 ];\n\t\t\ttransformed += morphTarget6 * morphTargetInfluences[ 6 ];\n\t\t\ttransformed += morphTarget7 * morphTargetInfluences[ 7 ];\n\t\t#endif\n\t#endif\n#endif",ua="float faceDirection = gl_FrontFacing ? 1.0 : - 1.0;\n#ifdef FLAT_SHADED\n\tvec3 fdx = vec3( dFdx( vViewPosition.x ), dFdx( vViewPosition.y ), dFdx( vViewPosition.z ) );\n\tvec3 fdy = vec3( dFdy( vViewPosition.x ), dFdy( vViewPosition.y ), dFdy( vViewPosition.z ) );\n\tvec3 normal = normalize( cross( fdx, fdy ) );\n#else\n\tvec3 normal = normalize( vNormal );\n\t#ifdef DOUBLE_SIDED\n\t\tnormal = normal * faceDirection;\n\t#endif\n\t#ifdef USE_TANGENT\n\t\tvec3 tangent = normalize( vTangent );\n\t\tvec3 bitangent = normalize( vBitangent );\n\t\t#ifdef DOUBLE_SIDED\n\t\t\ttangent = tangent * faceDirection;\n\t\t\tbitangent = bitangent * faceDirection;\n\t\t#endif\n\t\t#if defined( TANGENTSPACE_NORMALMAP ) || defined( USE_CLEARCOAT_NORMALMAP )\n\t\t\tmat3 vTBN = mat3( tangent, bitangent, normal );\n\t\t#endif\n\t#endif\n#endif\nvec3 geometryNormal = normal;",ha="#ifdef OBJECTSPACE_NORMALMAP\n\tnormal = texture2D( normalMap, vUv ).xyz * 2.0 - 1.0;\n\t#ifdef FLIP_SIDED\n\t\tnormal = - normal;\n\t#endif\n\t#ifdef DOUBLE_SIDED\n\t\tnormal = normal * faceDirection;\n\t#endif\n\tnormal = normalize( normalMatrix * normal );\n#elif defined( TANGENTSPACE_NORMALMAP )\n\tvec3 mapN = texture2D( normalMap, vUv ).xyz * 2.0 - 1.0;\n\tmapN.xy *= normalScale;\n\t#ifdef USE_TANGENT\n\t\tnormal = normalize( vTBN * mapN );\n\t#else\n\t\tnormal = perturbNormal2Arb( - vViewPosition, normal, mapN, faceDirection );\n\t#endif\n#elif defined( USE_BUMPMAP )\n\tnormal = perturbNormalArb( - vViewPosition, normal, dHdxy_fwd(), faceDirection );\n#endif",da="#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n\t#ifdef USE_TANGENT\n\t\tvarying vec3 vTangent;\n\t\tvarying vec3 vBitangent;\n\t#endif\n#endif",fa="#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n\t#ifdef USE_TANGENT\n\t\tvarying vec3 vTangent;\n\t\tvarying vec3 vBitangent;\n\t#endif\n#endif",pa="#ifndef FLAT_SHADED\n\tvNormal = normalize( transformedNormal );\n\t#ifdef USE_TANGENT\n\t\tvTangent = normalize( transformedTangent );\n\t\tvBitangent = normalize( cross( vNormal, vTangent ) * tangent.w );\n\t#endif\n#endif",ma="#ifdef USE_NORMALMAP\n\tuniform sampler2D normalMap;\n\tuniform vec2 normalScale;\n#endif\n#ifdef OBJECTSPACE_NORMALMAP\n\tuniform mat3 normalMatrix;\n#endif\n#if ! defined ( USE_TANGENT ) && ( defined ( TANGENTSPACE_NORMALMAP ) || defined ( USE_CLEARCOAT_NORMALMAP ) )\n\tvec3 perturbNormal2Arb( vec3 eye_pos, vec3 surf_norm, vec3 mapN, float faceDirection ) {\n\t\tvec3 q0 = vec3( dFdx( eye_pos.x ), dFdx( eye_pos.y ), dFdx( eye_pos.z ) );\n\t\tvec3 q1 = vec3( dFdy( eye_pos.x ), dFdy( eye_pos.y ), dFdy( eye_pos.z ) );\n\t\tvec2 st0 = dFdx( vUv.st );\n\t\tvec2 st1 = dFdy( vUv.st );\n\t\tvec3 N = surf_norm;\n\t\tvec3 q1perp = cross( q1, N );\n\t\tvec3 q0perp = cross( N, q0 );\n\t\tvec3 T = q1perp * st0.x + q0perp * st1.x;\n\t\tvec3 B = q1perp * st0.y + q0perp * st1.y;\n\t\tfloat det = max( dot( T, T ), dot( B, B ) );\n\t\tfloat scale = ( det == 0.0 ) ? 0.0 : faceDirection * inversesqrt( det );\n\t\treturn normalize( T * ( mapN.x * scale ) + B * ( mapN.y * scale ) + N * mapN.z );\n\t}\n#endif",ga="#ifdef USE_CLEARCOAT\n\tvec3 clearcoatNormal = geometryNormal;\n#endif",va="#ifdef USE_CLEARCOAT_NORMALMAP\n\tvec3 clearcoatMapN = texture2D( clearcoatNormalMap, vUv ).xyz * 2.0 - 1.0;\n\tclearcoatMapN.xy *= clearcoatNormalScale;\n\t#ifdef USE_TANGENT\n\t\tclearcoatNormal = normalize( vTBN * clearcoatMapN );\n\t#else\n\t\tclearcoatNormal = perturbNormal2Arb( - vViewPosition, clearcoatNormal, clearcoatMapN, faceDirection );\n\t#endif\n#endif",ya="#ifdef USE_CLEARCOATMAP\n\tuniform sampler2D clearcoatMap;\n#endif\n#ifdef USE_CLEARCOAT_ROUGHNESSMAP\n\tuniform sampler2D clearcoatRoughnessMap;\n#endif\n#ifdef USE_CLEARCOAT_NORMALMAP\n\tuniform sampler2D clearcoatNormalMap;\n\tuniform vec2 clearcoatNormalScale;\n#endif",xa="#ifdef USE_IRIDESCENCEMAP\n\tuniform sampler2D iridescenceMap;\n#endif\n#ifdef USE_IRIDESCENCE_THICKNESSMAP\n\tuniform sampler2D iridescenceThicknessMap;\n#endif",ba="#ifdef OPAQUE\ndiffuseColor.a = 1.0;\n#endif\n#ifdef USE_TRANSMISSION\ndiffuseColor.a *= transmissionAlpha + 0.1;\n#endif\ngl_FragColor = vec4( outgoingLight, diffuseColor.a );",wa="vec3 packNormalToRGB( const in vec3 normal ) {\n\treturn normalize( normal ) * 0.5 + 0.5;\n}\nvec3 unpackRGBToNormal( const in vec3 rgb ) {\n\treturn 2.0 * rgb.xyz - 1.0;\n}\nconst float PackUpscale = 256. / 255.;const float UnpackDownscale = 255. / 256.;\nconst vec3 PackFactors = vec3( 256. * 256. * 256., 256. * 256., 256. );\nconst vec4 UnpackFactors = UnpackDownscale / vec4( PackFactors, 1. );\nconst float ShiftRight8 = 1. / 256.;\nvec4 packDepthToRGBA( const in float v ) {\n\tvec4 r = vec4( fract( v * PackFactors ), v );\n\tr.yzw -= r.xyz * ShiftRight8;\treturn r * PackUpscale;\n}\nfloat unpackRGBAToDepth( const in vec4 v ) {\n\treturn dot( v, UnpackFactors );\n}\nvec4 pack2HalfToRGBA( vec2 v ) {\n\tvec4 r = vec4( v.x, fract( v.x * 255.0 ), v.y, fract( v.y * 255.0 ) );\n\treturn vec4( r.x - r.y / 255.0, r.y, r.z - r.w / 255.0, r.w );\n}\nvec2 unpackRGBATo2Half( vec4 v ) {\n\treturn vec2( v.x + ( v.y / 255.0 ), v.z + ( v.w / 255.0 ) );\n}\nfloat viewZToOrthographicDepth( const in float viewZ, const in float near, const in float far ) {\n\treturn ( viewZ + near ) / ( near - far );\n}\nfloat orthographicDepthToViewZ( const in float linearClipZ, const in float near, const in float far ) {\n\treturn linearClipZ * ( near - far ) - near;\n}\nfloat viewZToPerspectiveDepth( const in float viewZ, const in float near, const in float far ) {\n\treturn ( ( near + viewZ ) * far ) / ( ( far - near ) * viewZ );\n}\nfloat perspectiveDepthToViewZ( const in float invClipZ, const in float near, const in float far ) {\n\treturn ( near * far ) / ( ( far - near ) * invClipZ - far );\n}",_a="#ifdef PREMULTIPLIED_ALPHA\n\tgl_FragColor.rgb *= gl_FragColor.a;\n#endif",Ma="vec4 mvPosition = vec4( transformed, 1.0 );\n#ifdef USE_INSTANCING\n\tmvPosition = instanceMatrix * mvPosition;\n#endif\nmvPosition = modelViewMatrix * mvPosition;\ngl_Position = projectionMatrix * mvPosition;",Aa="#ifdef DITHERING\n\tgl_FragColor.rgb = dithering( gl_FragColor.rgb );\n#endif",Sa="#ifdef DITHERING\n\tvec3 dithering( vec3 color ) {\n\t\tfloat grid_position = rand( gl_FragCoord.xy );\n\t\tvec3 dither_shift_RGB = vec3( 0.25 / 255.0, -0.25 / 255.0, 0.25 / 255.0 );\n\t\tdither_shift_RGB = mix( 2.0 * dither_shift_RGB, -2.0 * dither_shift_RGB, grid_position );\n\t\treturn color + dither_shift_RGB;\n\t}\n#endif",Ea="float roughnessFactor = roughness;\n#ifdef USE_ROUGHNESSMAP\n\tvec4 texelRoughness = texture2D( roughnessMap, vUv );\n\troughnessFactor *= texelRoughness.g;\n#endif",Ta="#ifdef USE_ROUGHNESSMAP\n\tuniform sampler2D roughnessMap;\n#endif",Ca="#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\t\tuniform sampler2D directionalShadowMap[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tvarying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tstruct DirectionalLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\t\tuniform sampler2D spotShadowMap[ NUM_SPOT_LIGHT_SHADOWS ];\n\t\tvarying vec4 vSpotShadowCoord[ NUM_SPOT_LIGHT_SHADOWS ];\n\t\tstruct SpotLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\t\tuniform sampler2D pointShadowMap[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tvarying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tstruct PointLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t\tfloat shadowCameraNear;\n\t\t\tfloat shadowCameraFar;\n\t\t};\n\t\tuniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];\n\t#endif\n\tfloat texture2DCompare( sampler2D depths, vec2 uv, float compare ) {\n\t\treturn step( compare, unpackRGBAToDepth( texture2D( depths, uv ) ) );\n\t}\n\tvec2 texture2DDistribution( sampler2D shadow, vec2 uv ) {\n\t\treturn unpackRGBATo2Half( texture2D( shadow, uv ) );\n\t}\n\tfloat VSMShadow (sampler2D shadow, vec2 uv, float compare ){\n\t\tfloat occlusion = 1.0;\n\t\tvec2 distribution = texture2DDistribution( shadow, uv );\n\t\tfloat hard_shadow = step( compare , distribution.x );\n\t\tif (hard_shadow != 1.0 ) {\n\t\t\tfloat distance = compare - distribution.x ;\n\t\t\tfloat variance = max( 0.00000, distribution.y * distribution.y );\n\t\t\tfloat softness_probability = variance / (variance + distance * distance );\t\t\tsoftness_probability = clamp( ( softness_probability - 0.3 ) / ( 0.95 - 0.3 ), 0.0, 1.0 );\t\t\tocclusion = clamp( max( hard_shadow, softness_probability ), 0.0, 1.0 );\n\t\t}\n\t\treturn occlusion;\n\t}\n\tfloat getShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord ) {\n\t\tfloat shadow = 1.0;\n\t\tshadowCoord.xyz /= shadowCoord.w;\n\t\tshadowCoord.z += shadowBias;\n\t\tbvec4 inFrustumVec = bvec4 ( shadowCoord.x >= 0.0, shadowCoord.x <= 1.0, shadowCoord.y >= 0.0, shadowCoord.y <= 1.0 );\n\t\tbool inFrustum = all( inFrustumVec );\n\t\tbvec2 frustumTestVec = bvec2( inFrustum, shadowCoord.z <= 1.0 );\n\t\tbool frustumTest = all( frustumTestVec );\n\t\tif ( frustumTest ) {\n\t\t#if defined( SHADOWMAP_TYPE_PCF )\n\t\t\tvec2 texelSize = vec2( 1.0 ) / shadowMapSize;\n\t\t\tfloat dx0 = - texelSize.x * shadowRadius;\n\t\t\tfloat dy0 = - texelSize.y * shadowRadius;\n\t\t\tfloat dx1 = + texelSize.x * shadowRadius;\n\t\t\tfloat dy1 = + texelSize.y * shadowRadius;\n\t\t\tfloat dx2 = dx0 / 2.0;\n\t\t\tfloat dy2 = dy0 / 2.0;\n\t\t\tfloat dx3 = dx1 / 2.0;\n\t\t\tfloat dy3 = dy1 / 2.0;\n\t\t\tshadow = (\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy2 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy2 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy2 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy3 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy3 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy3 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy1 ), shadowCoord.z )\n\t\t\t) * ( 1.0 / 17.0 );\n\t\t#elif defined( SHADOWMAP_TYPE_PCF_SOFT )\n\t\t\tvec2 texelSize = vec2( 1.0 ) / shadowMapSize;\n\t\t\tfloat dx = texelSize.x;\n\t\t\tfloat dy = texelSize.y;\n\t\t\tvec2 uv = shadowCoord.xy;\n\t\t\tvec2 f = fract( uv * shadowMapSize + 0.5 );\n\t\t\tuv -= f * texelSize;\n\t\t\tshadow = (\n\t\t\t\ttexture2DCompare( shadowMap, uv, shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, uv + vec2( dx, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, uv + vec2( 0.0, dy ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, uv + texelSize, shadowCoord.z ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( -dx, 0.0 ), shadowCoord.z ), \n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 0.0 ), shadowCoord.z ),\n\t\t\t\t\t f.x ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( -dx, dy ), shadowCoord.z ), \n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, dy ), shadowCoord.z ),\n\t\t\t\t\t f.x ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( 0.0, -dy ), shadowCoord.z ), \n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( 0.0, 2.0 * dy ), shadowCoord.z ),\n\t\t\t\t\t f.y ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( dx, -dy ), shadowCoord.z ), \n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( dx, 2.0 * dy ), shadowCoord.z ),\n\t\t\t\t\t f.y ) +\n\t\t\t\tmix( mix( texture2DCompare( shadowMap, uv + vec2( -dx, -dy ), shadowCoord.z ), \n\t\t\t\t\t\t  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, -dy ), shadowCoord.z ),\n\t\t\t\t\t\t  f.x ),\n\t\t\t\t\t mix( texture2DCompare( shadowMap, uv + vec2( -dx, 2.0 * dy ), shadowCoord.z ), \n\t\t\t\t\t\t  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 2.0 * dy ), shadowCoord.z ),\n\t\t\t\t\t\t  f.x ),\n\t\t\t\t\t f.y )\n\t\t\t) * ( 1.0 / 9.0 );\n\t\t#elif defined( SHADOWMAP_TYPE_VSM )\n\t\t\tshadow = VSMShadow( shadowMap, shadowCoord.xy, shadowCoord.z );\n\t\t#else\n\t\t\tshadow = texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z );\n\t\t#endif\n\t\t}\n\t\treturn shadow;\n\t}\n\tvec2 cubeToUV( vec3 v, float texelSizeY ) {\n\t\tvec3 absV = abs( v );\n\t\tfloat scaleToCube = 1.0 / max( absV.x, max( absV.y, absV.z ) );\n\t\tabsV *= scaleToCube;\n\t\tv *= scaleToCube * ( 1.0 - 2.0 * texelSizeY );\n\t\tvec2 planar = v.xy;\n\t\tfloat almostATexel = 1.5 * texelSizeY;\n\t\tfloat almostOne = 1.0 - almostATexel;\n\t\tif ( absV.z >= almostOne ) {\n\t\t\tif ( v.z > 0.0 )\n\t\t\t\tplanar.x = 4.0 - v.x;\n\t\t} else if ( absV.x >= almostOne ) {\n\t\t\tfloat signX = sign( v.x );\n\t\t\tplanar.x = v.z * signX + 2.0 * signX;\n\t\t} else if ( absV.y >= almostOne ) {\n\t\t\tfloat signY = sign( v.y );\n\t\t\tplanar.x = v.x + 2.0 * signY + 2.0;\n\t\t\tplanar.y = v.z * signY - 2.0;\n\t\t}\n\t\treturn vec2( 0.125, 0.25 ) * planar + vec2( 0.375, 0.75 );\n\t}\n\tfloat getPointShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord, float shadowCameraNear, float shadowCameraFar ) {\n\t\tvec2 texelSize = vec2( 1.0 ) / ( shadowMapSize * vec2( 4.0, 2.0 ) );\n\t\tvec3 lightToPosition = shadowCoord.xyz;\n\t\tfloat dp = ( length( lightToPosition ) - shadowCameraNear ) / ( shadowCameraFar - shadowCameraNear );\t\tdp += shadowBias;\n\t\tvec3 bd3D = normalize( lightToPosition );\n\t\t#if defined( SHADOWMAP_TYPE_PCF ) || defined( SHADOWMAP_TYPE_PCF_SOFT ) || defined( SHADOWMAP_TYPE_VSM )\n\t\t\tvec2 offset = vec2( - 1, 1 ) * shadowRadius * texelSize.y;\n\t\t\treturn (\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxx, texelSize.y ), dp )\n\t\t\t) * ( 1.0 / 9.0 );\n\t\t#else\n\t\t\treturn texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp );\n\t\t#endif\n\t}\n#endif",Ra="#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\t\tuniform mat4 directionalShadowMatrix[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tvarying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tstruct DirectionalLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\t\tuniform mat4 spotShadowMatrix[ NUM_SPOT_LIGHT_SHADOWS ];\n\t\tvarying vec4 vSpotShadowCoord[ NUM_SPOT_LIGHT_SHADOWS ];\n\t\tstruct SpotLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\t\tuniform mat4 pointShadowMatrix[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tvarying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tstruct PointLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t\tfloat shadowCameraNear;\n\t\t\tfloat shadowCameraFar;\n\t\t};\n\t\tuniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];\n\t#endif\n#endif",Ia="#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS > 0 || NUM_SPOT_LIGHT_SHADOWS > 0 || NUM_POINT_LIGHT_SHADOWS > 0\n\t\tvec3 shadowWorldNormal = inverseTransformDirection( transformedNormal, viewMatrix );\n\t\tvec4 shadowWorldPosition;\n\t#endif\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {\n\t\tshadowWorldPosition = worldPosition + vec4( shadowWorldNormal * directionalLightShadows[ i ].shadowNormalBias, 0 );\n\t\tvDirectionalShadowCoord[ i ] = directionalShadowMatrix[ i ] * shadowWorldPosition;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_SPOT_LIGHT_SHADOWS; i ++ ) {\n\t\tshadowWorldPosition = worldPosition + vec4( shadowWorldNormal * spotLightShadows[ i ].shadowNormalBias, 0 );\n\t\tvSpotShadowCoord[ i ] = spotShadowMatrix[ i ] * shadowWorldPosition;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {\n\t\tshadowWorldPosition = worldPosition + vec4( shadowWorldNormal * pointLightShadows[ i ].shadowNormalBias, 0 );\n\t\tvPointShadowCoord[ i ] = pointShadowMatrix[ i ] * shadowWorldPosition;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n#endif",Pa="float getShadowMask() {\n\tfloat shadow = 1.0;\n\t#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\tDirectionalLightShadow directionalLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {\n\t\tdirectionalLight = directionalLightShadows[ i ];\n\t\tshadow *= receiveShadow ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\tSpotLightShadow spotLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_SPOT_LIGHT_SHADOWS; i ++ ) {\n\t\tspotLight = spotLightShadows[ i ];\n\t\tshadow *= receiveShadow ? getShadow( spotShadowMap[ i ], spotLight.shadowMapSize, spotLight.shadowBias, spotLight.shadowRadius, vSpotShadowCoord[ i ] ) : 1.0;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\tPointLightShadow pointLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {\n\t\tpointLight = pointLightShadows[ i ];\n\t\tshadow *= receiveShadow ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ], pointLight.shadowCameraNear, pointLight.shadowCameraFar ) : 1.0;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#endif\n\treturn shadow;\n}",La="#ifdef USE_SKINNING\n\tmat4 boneMatX = getBoneMatrix( skinIndex.x );\n\tmat4 boneMatY = getBoneMatrix( skinIndex.y );\n\tmat4 boneMatZ = getBoneMatrix( skinIndex.z );\n\tmat4 boneMatW = getBoneMatrix( skinIndex.w );\n#endif",Na="#ifdef USE_SKINNING\n\tuniform mat4 bindMatrix;\n\tuniform mat4 bindMatrixInverse;\n\tuniform highp sampler2D boneTexture;\n\tuniform int boneTextureSize;\n\tmat4 getBoneMatrix( const in float i ) {\n\t\tfloat j = i * 4.0;\n\t\tfloat x = mod( j, float( boneTextureSize ) );\n\t\tfloat y = floor( j / float( boneTextureSize ) );\n\t\tfloat dx = 1.0 / float( boneTextureSize );\n\t\tfloat dy = 1.0 / float( boneTextureSize );\n\t\ty = dy * ( y + 0.5 );\n\t\tvec4 v1 = texture2D( boneTexture, vec2( dx * ( x + 0.5 ), y ) );\n\t\tvec4 v2 = texture2D( boneTexture, vec2( dx * ( x + 1.5 ), y ) );\n\t\tvec4 v3 = texture2D( boneTexture, vec2( dx * ( x + 2.5 ), y ) );\n\t\tvec4 v4 = texture2D( boneTexture, vec2( dx * ( x + 3.5 ), y ) );\n\t\tmat4 bone = mat4( v1, v2, v3, v4 );\n\t\treturn bone;\n\t}\n#endif",ka="#ifdef USE_SKINNING\n\tvec4 skinVertex = bindMatrix * vec4( transformed, 1.0 );\n\tvec4 skinned = vec4( 0.0 );\n\tskinned += boneMatX * skinVertex * skinWeight.x;\n\tskinned += boneMatY * skinVertex * skinWeight.y;\n\tskinned += boneMatZ * skinVertex * skinWeight.z;\n\tskinned += boneMatW * skinVertex * skinWeight.w;\n\ttransformed = ( bindMatrixInverse * skinned ).xyz;\n#endif",Oa="#ifdef USE_SKINNING\n\tmat4 skinMatrix = mat4( 0.0 );\n\tskinMatrix += skinWeight.x * boneMatX;\n\tskinMatrix += skinWeight.y * boneMatY;\n\tskinMatrix += skinWeight.z * boneMatZ;\n\tskinMatrix += skinWeight.w * boneMatW;\n\tskinMatrix = bindMatrixInverse * skinMatrix * bindMatrix;\n\tobjectNormal = vec4( skinMatrix * vec4( objectNormal, 0.0 ) ).xyz;\n\t#ifdef USE_TANGENT\n\t\tobjectTangent = vec4( skinMatrix * vec4( objectTangent, 0.0 ) ).xyz;\n\t#endif\n#endif",Da="float specularStrength;\n#ifdef USE_SPECULARMAP\n\tvec4 texelSpecular = texture2D( specularMap, vUv );\n\tspecularStrength = texelSpecular.r;\n#else\n\tspecularStrength = 1.0;\n#endif",za="#ifdef USE_SPECULARMAP\n\tuniform sampler2D specularMap;\n#endif",Fa="#if defined( TONE_MAPPING )\n\tgl_FragColor.rgb = toneMapping( gl_FragColor.rgb );\n#endif",Ua="#ifndef saturate\n#define saturate( a ) clamp( a, 0.0, 1.0 )\n#endif\nuniform float toneMappingExposure;\nvec3 LinearToneMapping( vec3 color ) {\n\treturn toneMappingExposure * color;\n}\nvec3 ReinhardToneMapping( vec3 color ) {\n\tcolor *= toneMappingExposure;\n\treturn saturate( color / ( vec3( 1.0 ) + color ) );\n}\nvec3 OptimizedCineonToneMapping( vec3 color ) {\n\tcolor *= toneMappingExposure;\n\tcolor = max( vec3( 0.0 ), color - 0.004 );\n\treturn pow( ( color * ( 6.2 * color + 0.5 ) ) / ( color * ( 6.2 * color + 1.7 ) + 0.06 ), vec3( 2.2 ) );\n}\nvec3 RRTAndODTFit( vec3 v ) {\n\tvec3 a = v * ( v + 0.0245786 ) - 0.000090537;\n\tvec3 b = v * ( 0.983729 * v + 0.4329510 ) + 0.238081;\n\treturn a / b;\n}\nvec3 ACESFilmicToneMapping( vec3 color ) {\n\tconst mat3 ACESInputMat = mat3(\n\t\tvec3( 0.59719, 0.07600, 0.02840 ),\t\tvec3( 0.35458, 0.90834, 0.13383 ),\n\t\tvec3( 0.04823, 0.01566, 0.83777 )\n\t);\n\tconst mat3 ACESOutputMat = mat3(\n\t\tvec3(  1.60475, -0.10208, -0.00327 ),\t\tvec3( -0.53108,  1.10813, -0.07276 ),\n\t\tvec3( -0.07367, -0.00605,  1.07602 )\n\t);\n\tcolor *= toneMappingExposure / 0.6;\n\tcolor = ACESInputMat * color;\n\tcolor = RRTAndODTFit( color );\n\tcolor = ACESOutputMat * color;\n\treturn saturate( color );\n}\nvec3 CustomToneMapping( vec3 color ) { return color; }",Ba="#ifdef USE_TRANSMISSION\n\tfloat transmissionAlpha = 1.0;\n\tfloat transmissionFactor = transmission;\n\tfloat thicknessFactor = thickness;\n\t#ifdef USE_TRANSMISSIONMAP\n\t\ttransmissionFactor *= texture2D( transmissionMap, vUv ).r;\n\t#endif\n\t#ifdef USE_THICKNESSMAP\n\t\tthicknessFactor *= texture2D( thicknessMap, vUv ).g;\n\t#endif\n\tvec3 pos = vWorldPosition;\n\tvec3 v = normalize( cameraPosition - pos );\n\tvec3 n = inverseTransformDirection( normal, viewMatrix );\n\tvec4 transmission = getIBLVolumeRefraction(\n\t\tn, v, roughnessFactor, material.diffuseColor, material.specularColor, material.specularF90,\n\t\tpos, modelMatrix, viewMatrix, projectionMatrix, ior, thicknessFactor,\n\t\tattenuationColor, attenuationDistance );\n\ttotalDiffuse = mix( totalDiffuse, transmission.rgb, transmissionFactor );\n\ttransmissionAlpha = mix( transmissionAlpha, transmission.a, transmissionFactor );\n#endif",Ga="#ifdef USE_TRANSMISSION\n\tuniform float transmission;\n\tuniform float thickness;\n\tuniform float attenuationDistance;\n\tuniform vec3 attenuationColor;\n\t#ifdef USE_TRANSMISSIONMAP\n\t\tuniform sampler2D transmissionMap;\n\t#endif\n\t#ifdef USE_THICKNESSMAP\n\t\tuniform sampler2D thicknessMap;\n\t#endif\n\tuniform vec2 transmissionSamplerSize;\n\tuniform sampler2D transmissionSamplerMap;\n\tuniform mat4 modelMatrix;\n\tuniform mat4 projectionMatrix;\n\tvarying vec3 vWorldPosition;\n\tvec3 getVolumeTransmissionRay( const in vec3 n, const in vec3 v, const in float thickness, const in float ior, const in mat4 modelMatrix ) {\n\t\tvec3 refractionVector = refract( - v, normalize( n ), 1.0 / ior );\n\t\tvec3 modelScale;\n\t\tmodelScale.x = length( vec3( modelMatrix[ 0 ].xyz ) );\n\t\tmodelScale.y = length( vec3( modelMatrix[ 1 ].xyz ) );\n\t\tmodelScale.z = length( vec3( modelMatrix[ 2 ].xyz ) );\n\t\treturn normalize( refractionVector ) * thickness * modelScale;\n\t}\n\tfloat applyIorToRoughness( const in float roughness, const in float ior ) {\n\t\treturn roughness * clamp( ior * 2.0 - 2.0, 0.0, 1.0 );\n\t}\n\tvec4 getTransmissionSample( const in vec2 fragCoord, const in float roughness, const in float ior ) {\n\t\tfloat framebufferLod = log2( transmissionSamplerSize.x ) * applyIorToRoughness( roughness, ior );\n\t\t#ifdef texture2DLodEXT\n\t\t\treturn texture2DLodEXT( transmissionSamplerMap, fragCoord.xy, framebufferLod );\n\t\t#else\n\t\t\treturn texture2D( transmissionSamplerMap, fragCoord.xy, framebufferLod );\n\t\t#endif\n\t}\n\tvec3 applyVolumeAttenuation( const in vec3 radiance, const in float transmissionDistance, const in vec3 attenuationColor, const in float attenuationDistance ) {\n\t\tif ( attenuationDistance == 0.0 ) {\n\t\t\treturn radiance;\n\t\t} else {\n\t\t\tvec3 attenuationCoefficient = -log( attenuationColor ) / attenuationDistance;\n\t\t\tvec3 transmittance = exp( - attenuationCoefficient * transmissionDistance );\t\t\treturn transmittance * radiance;\n\t\t}\n\t}\n\tvec4 getIBLVolumeRefraction( const in vec3 n, const in vec3 v, const in float roughness, const in vec3 diffuseColor,\n\t\tconst in vec3 specularColor, const in float specularF90, const in vec3 position, const in mat4 modelMatrix,\n\t\tconst in mat4 viewMatrix, const in mat4 projMatrix, const in float ior, const in float thickness,\n\t\tconst in vec3 attenuationColor, const in float attenuationDistance ) {\n\t\tvec3 transmissionRay = getVolumeTransmissionRay( n, v, thickness, ior, modelMatrix );\n\t\tvec3 refractedRayExit = position + transmissionRay;\n\t\tvec4 ndcPos = projMatrix * viewMatrix * vec4( refractedRayExit, 1.0 );\n\t\tvec2 refractionCoords = ndcPos.xy / ndcPos.w;\n\t\trefractionCoords += 1.0;\n\t\trefractionCoords /= 2.0;\n\t\tvec4 transmittedLight = getTransmissionSample( refractionCoords, roughness, ior );\n\t\tvec3 attenuatedColor = applyVolumeAttenuation( transmittedLight.rgb, length( transmissionRay ), attenuationColor, attenuationDistance );\n\t\tvec3 F = EnvironmentBRDF( n, v, specularColor, specularF90, roughness );\n\t\treturn vec4( ( 1.0 - F ) * attenuatedColor * diffuseColor, transmittedLight.a );\n\t}\n#endif",Ha="#if ( defined( USE_UV ) && ! defined( UVS_VERTEX_ONLY ) )\n\tvarying vec2 vUv;\n#endif",Va="#ifdef USE_UV\n\t#ifdef UVS_VERTEX_ONLY\n\t\tvec2 vUv;\n\t#else\n\t\tvarying vec2 vUv;\n\t#endif\n\tuniform mat3 uvTransform;\n#endif",ja="#ifdef USE_UV\n\tvUv = ( uvTransform * vec3( uv, 1 ) ).xy;\n#endif",Wa="#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\n\tvarying vec2 vUv2;\n#endif",qa="#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\n\tattribute vec2 uv2;\n\tvarying vec2 vUv2;\n\tuniform mat3 uv2Transform;\n#endif",Ya="#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\n\tvUv2 = ( uv2Transform * vec3( uv2, 1 ) ).xy;\n#endif",Xa="#if defined( USE_ENVMAP ) || defined( DISTANCE ) || defined ( USE_SHADOWMAP ) || defined ( USE_TRANSMISSION )\n\tvec4 worldPosition = vec4( transformed, 1.0 );\n\t#ifdef USE_INSTANCING\n\t\tworldPosition = instanceMatrix * worldPosition;\n\t#endif\n\tworldPosition = modelMatrix * worldPosition;\n#endif";const Ja="varying vec2 vUv;\nuniform mat3 uvTransform;\nvoid main() {\n\tvUv = ( uvTransform * vec3( uv, 1 ) ).xy;\n\tgl_Position = vec4( position.xy, 1.0, 1.0 );\n}",Ka="uniform sampler2D t2D;\nvarying vec2 vUv;\nvoid main() {\n\tgl_FragColor = texture2D( t2D, vUv );\n\t#ifdef DECODE_VIDEO_TEXTURE\n\t\tgl_FragColor = vec4( mix( pow( gl_FragColor.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), gl_FragColor.rgb * 0.0773993808, vec3( lessThanEqual( gl_FragColor.rgb, vec3( 0.04045 ) ) ) ), gl_FragColor.w );\n\t#endif\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n}",Za="varying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvWorldDirection = transformDirection( position, modelMatrix );\n\t#include <begin_vertex>\n\t#include <project_vertex>\n\tgl_Position.z = gl_Position.w;\n}",Qa="#include <envmap_common_pars_fragment>\nuniform float opacity;\nvarying vec3 vWorldDirection;\n#include <cube_uv_reflection_fragment>\nvoid main() {\n\tvec3 vReflect = vWorldDirection;\n\t#include <envmap_fragment>\n\tgl_FragColor = envColor;\n\tgl_FragColor.a *= opacity;\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n}",$a="#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvarying vec2 vHighPrecisionZW;\nvoid main() {\n\t#include <uv_vertex>\n\t#include <skinbase_vertex>\n\t#ifdef USE_DISPLACEMENTMAP\n\t\t#include <beginnormal_vertex>\n\t\t#include <morphnormal_vertex>\n\t\t#include <skinnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvHighPrecisionZW = gl_Position.zw;\n}",tl="#if DEPTH_PACKING == 3200\n\tuniform float opacity;\n#endif\n#include <common>\n#include <packing>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvarying vec2 vHighPrecisionZW;\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( 1.0 );\n\t#if DEPTH_PACKING == 3200\n\t\tdiffuseColor.a = opacity;\n\t#endif\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <logdepthbuf_fragment>\n\tfloat fragCoordZ = 0.5 * vHighPrecisionZW[0] / vHighPrecisionZW[1] + 0.5;\n\t#if DEPTH_PACKING == 3200\n\t\tgl_FragColor = vec4( vec3( 1.0 - fragCoordZ ), opacity );\n\t#elif DEPTH_PACKING == 3201\n\t\tgl_FragColor = packDepthToRGBA( fragCoordZ );\n\t#endif\n}",el="#define DISTANCE\nvarying vec3 vWorldPosition;\n#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <skinbase_vertex>\n\t#ifdef USE_DISPLACEMENTMAP\n\t\t#include <beginnormal_vertex>\n\t\t#include <morphnormal_vertex>\n\t\t#include <skinnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <worldpos_vertex>\n\t#include <clipping_planes_vertex>\n\tvWorldPosition = worldPosition.xyz;\n}",nl="#define DISTANCE\nuniform vec3 referencePosition;\nuniform float nearDistance;\nuniform float farDistance;\nvarying vec3 vWorldPosition;\n#include <common>\n#include <packing>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main () {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( 1.0 );\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\tfloat dist = length( vWorldPosition - referencePosition );\n\tdist = ( dist - nearDistance ) / ( farDistance - nearDistance );\n\tdist = saturate( dist );\n\tgl_FragColor = packDepthToRGBA( dist );\n}",rl="varying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvWorldDirection = transformDirection( position, modelMatrix );\n\t#include <begin_vertex>\n\t#include <project_vertex>\n}",il="uniform sampler2D tEquirect;\nvarying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvec3 direction = normalize( vWorldDirection );\n\tvec2 sampleUV = equirectUv( direction );\n\tgl_FragColor = texture2D( tEquirect, sampleUV );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n}",sl="uniform float scale;\nattribute float lineDistance;\nvarying float vLineDistance;\n#include <common>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\tvLineDistance = scale * lineDistance;\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n}",ol="uniform vec3 diffuse;\nuniform float opacity;\nuniform float dashSize;\nuniform float totalSize;\nvarying float vLineDistance;\n#include <common>\n#include <color_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tif ( mod( vLineDistance, totalSize ) > dashSize ) {\n\t\tdiscard;\n\t}\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <color_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n}",al="#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#if defined ( USE_ENVMAP ) || defined ( USE_SKINNING )\n\t\t#include <beginnormal_vertex>\n\t\t#include <morphnormal_vertex>\n\t\t#include <skinbase_vertex>\n\t\t#include <skinnormal_vertex>\n\t\t#include <defaultnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <fog_vertex>\n}",ll="uniform vec3 diffuse;\nuniform float opacity;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_pars_fragment>\n#include <cube_uv_reflection_fragment>\n#include <fog_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <specularmap_fragment>\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\t#ifdef USE_LIGHTMAP\n\t\tvec4 lightMapTexel = texture2D( lightMap, vUv2 );\n\t\treflectedLight.indirectDiffuse += lightMapTexel.rgb * lightMapIntensity * RECIPROCAL_PI;\n\t#else\n\t\treflectedLight.indirectDiffuse += vec3( 1.0 );\n\t#endif\n\t#include <aomap_fragment>\n\treflectedLight.indirectDiffuse *= diffuseColor.rgb;\n\tvec3 outgoingLight = reflectedLight.indirectDiffuse;\n\t#include <envmap_fragment>\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",cl="#define LAMBERT\nvarying vec3 vLightFront;\nvarying vec3 vIndirectFront;\n#ifdef DOUBLE_SIDED\n\tvarying vec3 vLightBack;\n\tvarying vec3 vIndirectBack;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <envmap_pars_vertex>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <lights_lambert_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",ul="uniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float opacity;\nvarying vec3 vLightFront;\nvarying vec3 vIndirectFront;\n#ifdef DOUBLE_SIDED\n\tvarying vec3 vLightBack;\n\tvarying vec3 vIndirectBack;\n#endif\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_pars_fragment>\n#include <cube_uv_reflection_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <fog_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <shadowmask_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <specularmap_fragment>\n\t#include <emissivemap_fragment>\n\t#ifdef DOUBLE_SIDED\n\t\treflectedLight.indirectDiffuse += ( gl_FrontFacing ) ? vIndirectFront : vIndirectBack;\n\t#else\n\t\treflectedLight.indirectDiffuse += vIndirectFront;\n\t#endif\n\t#include <lightmap_fragment>\n\treflectedLight.indirectDiffuse *= BRDF_Lambert( diffuseColor.rgb );\n\t#ifdef DOUBLE_SIDED\n\t\treflectedLight.directDiffuse = ( gl_FrontFacing ) ? vLightFront : vLightBack;\n\t#else\n\t\treflectedLight.directDiffuse = vLightFront;\n\t#endif\n\treflectedLight.directDiffuse *= BRDF_Lambert( diffuseColor.rgb ) * getShadowMask();\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;\n\t#include <envmap_fragment>\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",hl="#define MATCAP\nvarying vec3 vViewPosition;\n#include <common>\n#include <uv_pars_vertex>\n#include <color_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n\tvViewPosition = - mvPosition.xyz;\n}",dl="#define MATCAP\nuniform vec3 diffuse;\nuniform float opacity;\nuniform sampler2D matcap;\nvarying vec3 vViewPosition;\n#include <common>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <fog_pars_fragment>\n#include <normal_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\tvec3 viewDir = normalize( vViewPosition );\n\tvec3 x = normalize( vec3( viewDir.z, 0.0, - viewDir.x ) );\n\tvec3 y = cross( viewDir, x );\n\tvec2 uv = vec2( dot( x, normal ), dot( y, normal ) ) * 0.495 + 0.5;\n\t#ifdef USE_MATCAP\n\t\tvec4 matcapColor = texture2D( matcap, uv );\n\t#else\n\t\tvec4 matcapColor = vec4( vec3( mix( 0.2, 0.8, uv.y ) ), 1.0 );\n\t#endif\n\tvec3 outgoingLight = diffuseColor.rgb * matcapColor.rgb;\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",fl="#define NORMAL\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )\n\tvarying vec3 vViewPosition;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )\n\tvViewPosition = - mvPosition.xyz;\n#endif\n}",pl="#define NORMAL\nuniform float opacity;\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )\n\tvarying vec3 vViewPosition;\n#endif\n#include <packing>\n#include <uv_pars_fragment>\n#include <normal_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\t#include <logdepthbuf_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\tgl_FragColor = vec4( packNormalToRGB( normal ), opacity );\n\t#ifdef OPAQUE\n\t\tgl_FragColor.a = 1.0;\n\t#endif\n}",ml="#define PHONG\nvarying vec3 vViewPosition;\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",gl="#define PHONG\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform vec3 specular;\nuniform float shininess;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_pars_fragment>\n#include <cube_uv_reflection_fragment>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <normal_pars_fragment>\n#include <lights_phong_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <specularmap_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_phong_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;\n\t#include <envmap_fragment>\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",vl="#define STANDARD\nvarying vec3 vViewPosition;\n#ifdef USE_TRANSMISSION\n\tvarying vec3 vWorldPosition;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n#ifdef USE_TRANSMISSION\n\tvWorldPosition = worldPosition.xyz;\n#endif\n}",yl="#define STANDARD\n#ifdef PHYSICAL\n\t#define IOR\n\t#define SPECULAR\n#endif\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float roughness;\nuniform float metalness;\nuniform float opacity;\n#ifdef IOR\n\tuniform float ior;\n#endif\n#ifdef SPECULAR\n\tuniform float specularIntensity;\n\tuniform vec3 specularColor;\n\t#ifdef USE_SPECULARINTENSITYMAP\n\t\tuniform sampler2D specularIntensityMap;\n\t#endif\n\t#ifdef USE_SPECULARCOLORMAP\n\t\tuniform sampler2D specularColorMap;\n\t#endif\n#endif\n#ifdef USE_CLEARCOAT\n\tuniform float clearcoat;\n\tuniform float clearcoatRoughness;\n#endif\n#ifdef USE_IRIDESCENCE\n\tuniform float iridescence;\n\tuniform float iridescenceIOR;\n\tuniform float iridescenceThicknessMinimum;\n\tuniform float iridescenceThicknessMaximum;\n#endif\n#ifdef USE_SHEEN\n\tuniform vec3 sheenColor;\n\tuniform float sheenRoughness;\n\t#ifdef USE_SHEENCOLORMAP\n\t\tuniform sampler2D sheenColorMap;\n\t#endif\n\t#ifdef USE_SHEENROUGHNESSMAP\n\t\tuniform sampler2D sheenRoughnessMap;\n\t#endif\n#endif\nvarying vec3 vViewPosition;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <bsdfs>\n#include <iridescence_fragment>\n#include <cube_uv_reflection_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_physical_pars_fragment>\n#include <fog_pars_fragment>\n#include <lights_pars_begin>\n#include <normal_pars_fragment>\n#include <lights_physical_pars_fragment>\n#include <transmission_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <clearcoat_pars_fragment>\n#include <iridescence_pars_fragment>\n#include <roughnessmap_pars_fragment>\n#include <metalnessmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <roughnessmap_fragment>\n\t#include <metalnessmap_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <clearcoat_normal_fragment_begin>\n\t#include <clearcoat_normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_physical_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 totalDiffuse = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse;\n\tvec3 totalSpecular = reflectedLight.directSpecular + reflectedLight.indirectSpecular;\n\t#include <transmission_fragment>\n\tvec3 outgoingLight = totalDiffuse + totalSpecular + totalEmissiveRadiance;\n\t#ifdef USE_SHEEN\n\t\tfloat sheenEnergyComp = 1.0 - 0.157 * max3( material.sheenColor );\n\t\toutgoingLight = outgoingLight * sheenEnergyComp + sheenSpecular;\n\t#endif\n\t#ifdef USE_CLEARCOAT\n\t\tfloat dotNVcc = saturate( dot( geometry.clearcoatNormal, geometry.viewDir ) );\n\t\tvec3 Fcc = F_Schlick( material.clearcoatF0, material.clearcoatF90, dotNVcc );\n\t\toutgoingLight = outgoingLight * ( 1.0 - material.clearcoat * Fcc ) + clearcoatSpecular * material.clearcoat;\n\t#endif\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",xl="#define TOON\nvarying vec3 vViewPosition;\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",bl="#define TOON\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <gradientmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <normal_pars_fragment>\n#include <lights_toon_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_toon_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",wl="uniform float size;\nuniform float scale;\n#include <common>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <project_vertex>\n\tgl_PointSize = size;\n\t#ifdef USE_SIZEATTENUATION\n\t\tbool isPerspective = isPerspectiveMatrix( projectionMatrix );\n\t\tif ( isPerspective ) gl_PointSize *= ( scale / - mvPosition.z );\n\t#endif\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <worldpos_vertex>\n\t#include <fog_vertex>\n}",_l="uniform vec3 diffuse;\nuniform float opacity;\n#include <common>\n#include <color_pars_fragment>\n#include <map_particle_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_particle_fragment>\n\t#include <color_fragment>\n\t#include <alphatest_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n}",Ml="#include <common>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\nvoid main() {\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",Al="uniform vec3 color;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <shadowmap_pars_fragment>\n#include <shadowmask_pars_fragment>\nvoid main() {\n\tgl_FragColor = vec4( color, opacity * ( 1.0 - getShadowMask() ) );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n}",Sl="uniform float rotation;\nuniform vec2 center;\n#include <common>\n#include <uv_pars_vertex>\n#include <fog_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\tvec4 mvPosition = modelViewMatrix * vec4( 0.0, 0.0, 0.0, 1.0 );\n\tvec2 scale;\n\tscale.x = length( vec3( modelMatrix[ 0 ].x, modelMatrix[ 0 ].y, modelMatrix[ 0 ].z ) );\n\tscale.y = length( vec3( modelMatrix[ 1 ].x, modelMatrix[ 1 ].y, modelMatrix[ 1 ].z ) );\n\t#ifndef USE_SIZEATTENUATION\n\t\tbool isPerspective = isPerspectiveMatrix( projectionMatrix );\n\t\tif ( isPerspective ) scale *= - mvPosition.z;\n\t#endif\n\tvec2 alignedPosition = ( position.xy - ( center - vec2( 0.5 ) ) ) * scale;\n\tvec2 rotatedPosition;\n\trotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;\n\trotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;\n\tmvPosition.xy += rotatedPosition;\n\tgl_Position = projectionMatrix * mvPosition;\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n}",El="uniform vec3 diffuse;\nuniform float opacity;\n#include <common>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n}",Tl={alphamap_fragment:Zs,alphamap_pars_fragment:Qs,alphatest_fragment:$s,alphatest_pars_fragment:to,aomap_fragment:eo,aomap_pars_fragment:no,begin_vertex:ro,beginnormal_vertex:io,bsdfs:so,iridescence_fragment:oo,bumpmap_pars_fragment:ao,clipping_planes_fragment:lo,clipping_planes_pars_fragment:co,clipping_planes_pars_vertex:uo,clipping_planes_vertex:ho,color_fragment:fo,color_pars_fragment:po,color_pars_vertex:mo,color_vertex:go,common:vo,cube_uv_reflection_fragment:yo,defaultnormal_vertex:xo,displacementmap_pars_vertex:bo,displacementmap_vertex:wo,emissivemap_fragment:_o,emissivemap_pars_fragment:Mo,encodings_fragment:Ao,encodings_pars_fragment:So,envmap_fragment:Eo,envmap_common_pars_fragment:To,envmap_pars_fragment:Co,envmap_pars_vertex:Ro,envmap_physical_pars_fragment:Bo,envmap_vertex:Io,fog_vertex:Po,fog_pars_vertex:Lo,fog_fragment:No,fog_pars_fragment:ko,gradientmap_pars_fragment:Oo,lightmap_fragment:Do,lightmap_pars_fragment:zo,lights_lambert_vertex:Fo,lights_pars_begin:Uo,lights_toon_fragment:Go,lights_toon_pars_fragment:Ho,lights_phong_fragment:Vo,lights_phong_pars_fragment:jo,lights_physical_fragment:Wo,lights_physical_pars_fragment:qo,lights_fragment_begin:Yo,lights_fragment_maps:Xo,lights_fragment_end:Jo,logdepthbuf_fragment:Ko,logdepthbuf_pars_fragment:Zo,logdepthbuf_pars_vertex:Qo,logdepthbuf_vertex:$o,map_fragment:ta,map_pars_fragment:ea,map_particle_fragment:na,map_particle_pars_fragment:ra,metalnessmap_fragment:ia,metalnessmap_pars_fragment:sa,morphcolor_vertex:oa,morphnormal_vertex:aa,morphtarget_pars_vertex:la,morphtarget_vertex:ca,normal_fragment_begin:ua,normal_fragment_maps:ha,normal_pars_fragment:da,normal_pars_vertex:fa,normal_vertex:pa,normalmap_pars_fragment:ma,clearcoat_normal_fragment_begin:ga,clearcoat_normal_fragment_maps:va,clearcoat_pars_fragment:ya,iridescence_pars_fragment:xa,output_fragment:ba,packing:wa,premultiplied_alpha_fragment:_a,project_vertex:Ma,dithering_fragment:Aa,dithering_pars_fragment:Sa,roughnessmap_fragment:Ea,roughnessmap_pars_fragment:Ta,shadowmap_pars_fragment:Ca,shadowmap_pars_vertex:Ra,shadowmap_vertex:Ia,shadowmask_pars_fragment:Pa,skinbase_vertex:La,skinning_pars_vertex:Na,skinning_vertex:ka,skinnormal_vertex:Oa,specularmap_fragment:Da,specularmap_pars_fragment:za,tonemapping_fragment:Fa,tonemapping_pars_fragment:Ua,transmission_fragment:Ba,transmission_pars_fragment:Ga,uv_pars_fragment:Ha,uv_pars_vertex:Va,uv_vertex:ja,uv2_pars_fragment:Wa,uv2_pars_vertex:qa,uv2_vertex:Ya,worldpos_vertex:Xa,background_vert:Ja,background_frag:Ka,cube_vert:Za,cube_frag:Qa,depth_vert:$a,depth_frag:tl,distanceRGBA_vert:el,distanceRGBA_frag:nl,equirect_vert:rl,equirect_frag:il,linedashed_vert:sl,linedashed_frag:ol,meshbasic_vert:al,meshbasic_frag:ll,meshlambert_vert:cl,meshlambert_frag:ul,meshmatcap_vert:hl,meshmatcap_frag:dl,meshnormal_vert:fl,meshnormal_frag:pl,meshphong_vert:ml,meshphong_frag:gl,meshphysical_vert:vl,meshphysical_frag:yl,meshtoon_vert:xl,meshtoon_frag:bl,points_vert:wl,points_frag:_l,shadow_vert:Ml,shadow_frag:Al,sprite_vert:Sl,sprite_frag:El},Cl={common:{diffuse:{value:new lr(16777215)},opacity:{value:1},map:{value:null},uvTransform:{value:new Yn},uv2Transform:{value:new Yn},alphaMap:{value:null},alphaTest:{value:0}},specularmap:{specularMap:{value:null}},envmap:{envMap:{value:null},flipEnvMap:{value:-1},reflectivity:{value:1},ior:{value:1.5},refractionRatio:{value:.98}},aomap:{aoMap:{value:null},aoMapIntensity:{value:1}},lightmap:{lightMap:{value:null},lightMapIntensity:{value:1}},emissivemap:{emissiveMap:{value:null}},bumpmap:{bumpMap:{value:null},bumpScale:{value:1}},normalmap:{normalMap:{value:null},normalScale:{value:new qn(1,1)}},displacementmap:{displacementMap:{value:null},displacementScale:{value:1},displacementBias:{value:0}},roughnessmap:{roughnessMap:{value:null}},metalnessmap:{metalnessMap:{value:null}},gradientmap:{gradientMap:{value:null}},fog:{fogDensity:{value:25e-5},fogNear:{value:1},fogFar:{value:2e3},fogColor:{value:new lr(16777215)}},lights:{ambientLightColor:{value:[]},lightProbe:{value:[]},directionalLights:{value:[],properties:{direction:{},color:{}}},directionalLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},directionalShadowMap:{value:[]},directionalShadowMatrix:{value:[]},spotLights:{value:[],properties:{color:{},position:{},direction:{},distance:{},coneCos:{},penumbraCos:{},decay:{}}},spotLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},spotShadowMap:{value:[]},spotShadowMatrix:{value:[]},pointLights:{value:[],properties:{color:{},position:{},decay:{},distance:{}}},pointLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{},shadowCameraNear:{},shadowCameraFar:{}}},pointShadowMap:{value:[]},pointShadowMatrix:{value:[]},hemisphereLights:{value:[],properties:{direction:{},skyColor:{},groundColor:{}}},rectAreaLights:{value:[],properties:{color:{},position:{},width:{},height:{}}},ltc_1:{value:null},ltc_2:{value:null}},points:{diffuse:{value:new lr(16777215)},opacity:{value:1},size:{value:1},scale:{value:1},map:{value:null},alphaMap:{value:null},alphaTest:{value:0},uvTransform:{value:new Yn}},sprite:{diffuse:{value:new lr(16777215)},opacity:{value:1},center:{value:new qn(.5,.5)},rotation:{value:0},map:{value:null},alphaMap:{value:null},alphaTest:{value:0},uvTransform:{value:new Yn}}},Rl={basic:{uniforms:Rs([Cl.common,Cl.specularmap,Cl.envmap,Cl.aomap,Cl.lightmap,Cl.fog]),vertexShader:Tl.meshbasic_vert,fragmentShader:Tl.meshbasic_frag},lambert:{uniforms:Rs([Cl.common,Cl.specularmap,Cl.envmap,Cl.aomap,Cl.lightmap,Cl.emissivemap,Cl.fog,Cl.lights,{emissive:{value:new lr(0)}}]),vertexShader:Tl.meshlambert_vert,fragmentShader:Tl.meshlambert_frag},phong:{uniforms:Rs([Cl.common,Cl.specularmap,Cl.envmap,Cl.aomap,Cl.lightmap,Cl.emissivemap,Cl.bumpmap,Cl.normalmap,Cl.displacementmap,Cl.fog,Cl.lights,{emissive:{value:new lr(0)},specular:{value:new lr(1118481)},shininess:{value:30}}]),vertexShader:Tl.meshphong_vert,fragmentShader:Tl.meshphong_frag},standard:{uniforms:Rs([Cl.common,Cl.envmap,Cl.aomap,Cl.lightmap,Cl.emissivemap,Cl.bumpmap,Cl.normalmap,Cl.displacementmap,Cl.roughnessmap,Cl.metalnessmap,Cl.fog,Cl.lights,{emissive:{value:new lr(0)},roughness:{value:1},metalness:{value:0},envMapIntensity:{value:1}}]),vertexShader:Tl.meshphysical_vert,fragmentShader:Tl.meshphysical_frag},toon:{uniforms:Rs([Cl.common,Cl.aomap,Cl.lightmap,Cl.emissivemap,Cl.bumpmap,Cl.normalmap,Cl.displacementmap,Cl.gradientmap,Cl.fog,Cl.lights,{emissive:{value:new lr(0)}}]),vertexShader:Tl.meshtoon_vert,fragmentShader:Tl.meshtoon_frag},matcap:{uniforms:Rs([Cl.common,Cl.bumpmap,Cl.normalmap,Cl.displacementmap,Cl.fog,{matcap:{value:null}}]),vertexShader:Tl.meshmatcap_vert,fragmentShader:Tl.meshmatcap_frag},points:{uniforms:Rs([Cl.points,Cl.fog]),vertexShader:Tl.points_vert,fragmentShader:Tl.points_frag},dashed:{uniforms:Rs([Cl.common,Cl.fog,{scale:{value:1},dashSize:{value:1},totalSize:{value:2}}]),vertexShader:Tl.linedashed_vert,fragmentShader:Tl.linedashed_frag},depth:{uniforms:Rs([Cl.common,Cl.displacementmap]),vertexShader:Tl.depth_vert,fragmentShader:Tl.depth_frag},normal:{uniforms:Rs([Cl.common,Cl.bumpmap,Cl.normalmap,Cl.displacementmap,{opacity:{value:1}}]),vertexShader:Tl.meshnormal_vert,fragmentShader:Tl.meshnormal_frag},sprite:{uniforms:Rs([Cl.sprite,Cl.fog]),vertexShader:Tl.sprite_vert,fragmentShader:Tl.sprite_frag},background:{uniforms:{uvTransform:{value:new Yn},t2D:{value:null}},vertexShader:Tl.background_vert,fragmentShader:Tl.background_frag},cube:{uniforms:Rs([Cl.envmap,{opacity:{value:1}}]),vertexShader:Tl.cube_vert,fragmentShader:Tl.cube_frag},equirect:{uniforms:{tEquirect:{value:null}},vertexShader:Tl.equirect_vert,fragmentShader:Tl.equirect_frag},distanceRGBA:{uniforms:Rs([Cl.common,Cl.displacementmap,{referencePosition:{value:new Mr},nearDistance:{value:1},farDistance:{value:1e3}}]),vertexShader:Tl.distanceRGBA_vert,fragmentShader:Tl.distanceRGBA_frag},shadow:{uniforms:Rs([Cl.lights,Cl.fog,{color:{value:new lr(0)},opacity:{value:1}}]),vertexShader:Tl.shadow_vert,fragmentShader:Tl.shadow_frag}};function Il(t,e,n,r,i,s){const o=new lr(0);let a,l,c=!0===i?0:1,u=null,h=0,d=null;function f(n,i){let s=!1,f=!0===i.isScene?i.background:null;f&&f.isTexture&&(f=e.get(f));const m=t.xr,y=m.getSession&&m.getSession();y&&"additive"===y.environmentBlendMode&&(f=null),null===f?p(o,c):f&&f.isColor&&(p(f,1),s=!0),(t.autoClear||s)&&t.clear(t.autoClearColor,t.autoClearDepth,t.autoClearStencil),f&&(f.isCubeTexture||f.mapping===ht)?(void 0===l&&(l=new As(new Ts(1,1,1),new Ns({name:"BackgroundCubeMaterial",uniforms:Cs(Rl.cube.uniforms),vertexShader:Rl.cube.vertexShader,fragmentShader:Rl.cube.fragmentShader,side:v,depthTest:!1,depthWrite:!1,fog:!1})),l.geometry.deleteAttribute("normal"),l.geometry.deleteAttribute("uv"),l.onBeforeRender=function(t,e,n){this.matrixWorld.copyPosition(n.matrixWorld)},Object.defineProperty(l.material,"envMap",{get:function(){return this.uniforms.envMap.value}}),r.update(l)),l.material.uniforms.envMap.value=f,l.material.uniforms.flipEnvMap.value=f.isCubeTexture&&!1===f.isRenderTargetTexture?-1:1,u===f&&h===f.version&&d===t.toneMapping||(l.material.needsUpdate=!0,u=f,h=f.version,d=t.toneMapping),l.layers.enableAll(),n.unshift(l,l.geometry,l.material,0,0,null)):f&&f.isTexture&&(void 0===a&&(a=new As(new Ks(2,2),new Ns({name:"BackgroundMaterial",uniforms:Cs(Rl.background.uniforms),vertexShader:Rl.background.vertexShader,fragmentShader:Rl.background.fragmentShader,side:g,depthTest:!1,depthWrite:!1,fog:!1})),a.geometry.deleteAttribute("normal"),Object.defineProperty(a.material,"map",{get:function(){return this.uniforms.t2D.value}}),r.update(a)),a.material.uniforms.t2D.value=f,!0===f.matrixAutoUpdate&&f.updateMatrix(),a.material.uniforms.uvTransform.value.copy(f.matrix),u===f&&h===f.version&&d===t.toneMapping||(a.material.needsUpdate=!0,u=f,h=f.version,d=t.toneMapping),a.layers.enableAll(),n.unshift(a,a.geometry,a.material,0,0,null))}function p(t,e){n.buffers.color.setClear(t.r,t.g,t.b,e,s)}return{getClearColor:function(){return o},setClearColor:function(t,e=1){o.set(t),c=e,p(o,c)},getClearAlpha:function(){return c},setClearAlpha:function(t){c=t,p(o,c)},render:f}}function Pl(t,e,n,r){const i=t.getParameter(34921),s=r.isWebGL2?null:e.get("OES_vertex_array_object"),o=r.isWebGL2||null!==s,a={},l=g(null);let c=l,u=!1;function h(e,r,i,s,a){let l=!1;if(o){const t=m(s,i,r);c!==t&&(c=t,f(c.object)),l=v(e,s,i,a),l&&y(e,s,i,a)}else{const t=!0===r.wireframe;c.geometry===s.id&&c.program===i.id&&c.wireframe===t||(c.geometry=s.id,c.program=i.id,c.wireframe=t,l=!0)}null!==a&&n.update(a,34963),(l||u)&&(u=!1,A(e,r,i,s),null!==a&&t.bindBuffer(34963,n.get(a).buffer))}function d(){return r.isWebGL2?t.createVertexArray():s.createVertexArrayOES()}function f(e){return r.isWebGL2?t.bindVertexArray(e):s.bindVertexArrayOES(e)}function p(e){return r.isWebGL2?t.deleteVertexArray(e):s.deleteVertexArrayOES(e)}function m(t,e,n){const r=!0===n.wireframe;let i=a[t.id];void 0===i&&(i={},a[t.id]=i);let s=i[e.id];void 0===s&&(s={},i[e.id]=s);let o=s[r];return void 0===o&&(o=g(d()),s[r]=o),o}function g(t){const e=[],n=[],r=[];for(let s=0;s<i;s++)e[s]=0,n[s]=0,r[s]=0;return{geometry:null,program:null,wireframe:!1,newAttributes:e,enabledAttributes:n,attributeDivisors:r,object:t,attributes:{},index:null}}function v(t,e,n,r){const i=c.attributes,s=e.attributes;let o=0;const a=n.getAttributes();for(const l in a){const e=a[l];if(e.location>=0){const e=i[l];let n=s[l];if(void 0===n&&("instanceMatrix"===l&&t.instanceMatrix&&(n=t.instanceMatrix),"instanceColor"===l&&t.instanceColor&&(n=t.instanceColor)),void 0===e)return!0;if(e.attribute!==n)return!0;if(n&&e.data!==n.data)return!0;o++}}return c.attributesNum!==o||c.index!==r}function y(t,e,n,r){const i={},s=e.attributes;let o=0;const a=n.getAttributes();for(const l in a){const e=a[l];if(e.location>=0){let e=s[l];void 0===e&&("instanceMatrix"===l&&t.instanceMatrix&&(e=t.instanceMatrix),"instanceColor"===l&&t.instanceColor&&(e=t.instanceColor));const n={};n.attribute=e,e&&e.data&&(n.data=e.data),i[l]=n,o++}}c.attributes=i,c.attributesNum=o,c.index=r}function x(){const t=c.newAttributes;for(let e=0,n=t.length;e<n;e++)t[e]=0}function b(t){w(t,0)}function w(n,i){const s=c.newAttributes,o=c.enabledAttributes,a=c.attributeDivisors;if(s[n]=1,0===o[n]&&(t.enableVertexAttribArray(n),o[n]=1),a[n]!==i){const s=r.isWebGL2?t:e.get("ANGLE_instanced_arrays");s[r.isWebGL2?"vertexAttribDivisor":"vertexAttribDivisorANGLE"](n,i),a[n]=i}}function _(){const e=c.newAttributes,n=c.enabledAttributes;for(let r=0,i=n.length;r<i;r++)n[r]!==e[r]&&(t.disableVertexAttribArray(r),n[r]=0)}function M(e,n,i,s,o,a){!0!==r.isWebGL2||5124!==i&&5125!==i?t.vertexAttribPointer(e,n,i,s,o,a):t.vertexAttribIPointer(e,n,i,o,a)}function A(i,s,o,a){if(!1===r.isWebGL2&&(i.isInstancedMesh||a.isInstancedBufferGeometry)&&null===e.get("ANGLE_instanced_arrays"))return;x();const l=a.attributes,c=o.getAttributes(),u=s.defaultAttributeValues;for(const e in c){const r=c[e];if(r.location>=0){let s=l[e];if(void 0===s&&("instanceMatrix"===e&&i.instanceMatrix&&(s=i.instanceMatrix),"instanceColor"===e&&i.instanceColor&&(s=i.instanceColor)),void 0!==s){const e=s.normalized,o=s.itemSize,l=n.get(s);if(void 0===l)continue;const c=l.buffer,u=l.type,h=l.bytesPerElement;if(s.isInterleavedBufferAttribute){const n=s.data,l=n.stride,d=s.offset;if(n.isInstancedInterleavedBuffer){for(let t=0;t<r.locationSize;t++)w(r.location+t,n.meshPerAttribute);!0!==i.isInstancedMesh&&void 0===a._maxInstanceCount&&(a._maxInstanceCount=n.meshPerAttribute*n.count)}else for(let t=0;t<r.locationSize;t++)b(r.location+t);t.bindBuffer(34962,c);for(let t=0;t<r.locationSize;t++)M(r.location+t,o/r.locationSize,u,e,l*h,(d+o/r.locationSize*t)*h)}else{if(s.isInstancedBufferAttribute){for(let t=0;t<r.locationSize;t++)w(r.location+t,s.meshPerAttribute);!0!==i.isInstancedMesh&&void 0===a._maxInstanceCount&&(a._maxInstanceCount=s.meshPerAttribute*s.count)}else for(let t=0;t<r.locationSize;t++)b(r.location+t);t.bindBuffer(34962,c);for(let t=0;t<r.locationSize;t++)M(r.location+t,o/r.locationSize,u,e,o*h,o/r.locationSize*t*h)}}else if(void 0!==u){const n=u[e];if(void 0!==n)switch(n.length){case 2:t.vertexAttrib2fv(r.location,n);break;case 3:t.vertexAttrib3fv(r.location,n);break;case 4:t.vertexAttrib4fv(r.location,n);break;default:t.vertexAttrib1fv(r.location,n)}}}}_()}function S(){C();for(const t in a){const e=a[t];for(const t in e){const n=e[t];for(const t in n)p(n[t].object),delete n[t];delete e[t]}delete a[t]}}function E(t){if(void 0===a[t.id])return;const e=a[t.id];for(const n in e){const t=e[n];for(const e in t)p(t[e].object),delete t[e];delete e[n]}delete a[t.id]}function T(t){for(const e in a){const n=a[e];if(void 0===n[t.id])continue;const r=n[t.id];for(const t in r)p(r[t].object),delete r[t];delete n[t.id]}}function C(){R(),u=!0,c!==l&&(c=l,f(c.object))}function R(){l.geometry=null,l.program=null,l.wireframe=!1}return{setup:h,reset:C,resetDefaultState:R,dispose:S,releaseStatesOfGeometry:E,releaseStatesOfProgram:T,initAttributes:x,enableAttribute:b,disableUnusedAttributes:_}}function Ll(t,e,n,r){const i=r.isWebGL2;let s;function o(t){s=t}function a(e,r){t.drawArrays(s,e,r),n.update(r,s,1)}function l(r,o,a){if(0===a)return;let l,c;if(i)l=t,c="drawArraysInstanced";else if(l=e.get("ANGLE_instanced_arrays"),c="drawArraysInstancedANGLE",null===l)return void console.error("THREE.WebGLBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");l[c](s,r,o,a),n.update(o,s,a)}this.setMode=o,this.render=a,this.renderInstances=l}function Nl(t,e,n){let r;function i(){if(void 0!==r)return r;if(!0===e.has("EXT_texture_filter_anisotropic")){const n=e.get("EXT_texture_filter_anisotropic");r=t.getParameter(n.MAX_TEXTURE_MAX_ANISOTROPY_EXT)}else r=0;return r}function s(e){if("highp"===e){if(t.getShaderPrecisionFormat(35633,36338).precision>0&&t.getShaderPrecisionFormat(35632,36338).precision>0)return"highp";e="mediump"}return"mediump"===e&&t.getShaderPrecisionFormat(35633,36337).precision>0&&t.getShaderPrecisionFormat(35632,36337).precision>0?"mediump":"lowp"}const o="undefined"!==typeof WebGL2RenderingContext&&t instanceof WebGL2RenderingContext||"undefined"!==typeof WebGL2ComputeRenderingContext&&t instanceof WebGL2ComputeRenderingContext;let a=void 0!==n.precision?n.precision:"highp";const l=s(a);l!==a&&(console.warn("THREE.WebGLRenderer:",a,"not supported, using",l,"instead."),a=l);const c=o||e.has("WEBGL_draw_buffers"),u=!0===n.logarithmicDepthBuffer,h=t.getParameter(34930),d=t.getParameter(35660),f=t.getParameter(3379),p=t.getParameter(34076),m=t.getParameter(34921),g=t.getParameter(36347),v=t.getParameter(36348),y=t.getParameter(36349),x=d>0,b=o||e.has("OES_texture_float"),w=x&&b,_=o?t.getParameter(36183):0;return{isWebGL2:o,drawBuffers:c,getMaxAnisotropy:i,getMaxPrecision:s,precision:a,logarithmicDepthBuffer:u,maxTextures:h,maxVertexTextures:d,maxTextureSize:f,maxCubemapSize:p,maxAttributes:m,maxVertexUniforms:g,maxVaryings:v,maxFragmentUniforms:y,vertexTextures:x,floatFragmentTextures:b,floatVertexTextures:w,maxSamples:_}}function kl(t){const e=this;let n=null,r=0,i=!1,s=!1;const o=new js,a=new Yn,l={value:null,needsUpdate:!1};function c(){l.value!==n&&(l.value=n,l.needsUpdate=r>0),e.numPlanes=r,e.numIntersection=0}function u(t,n,r,i){const s=null!==t?t.length:0;let c=null;if(0!==s){if(c=l.value,!0!==i||null===c){const e=r+4*s,i=n.matrixWorldInverse;a.getNormalMatrix(i),(null===c||c.length<e)&&(c=new Float32Array(e));for(let n=0,l=r;n!==s;++n,l+=4)o.copy(t[n]).applyMatrix4(i,a),o.normal.toArray(c,l),c[l+3]=o.constant}l.value=c,l.needsUpdate=!0}return e.numPlanes=s,e.numIntersection=0,c}this.uniform=l,this.numPlanes=0,this.numIntersection=0,this.init=function(t,e,s){const o=0!==t.length||e||0!==r||i;return i=e,n=u(t,s,0),r=t.length,o},this.beginShadows=function(){s=!0,u(null)},this.endShadows=function(){s=!1,c()},this.setState=function(e,o,a){const h=e.clippingPlanes,d=e.clipIntersection,f=e.clipShadows,p=t.get(e);if(!i||null===h||0===h.length||s&&!f)s?u(null):c();else{const t=s?0:r,e=4*t;let i=p.clippingState||null;l.value=i,i=u(h,o,e,a);for(let r=0;r!==e;++r)i[r]=n[r];p.clippingState=i,this.numIntersection=d?this.numPlanes:0,this.numPlanes+=t}}}function Ol(t){let e=new WeakMap;function n(t,e){return e===ct?t.mapping=at:e===ut&&(t.mapping=lt),t}function r(r){if(r&&r.isTexture&&!1===r.isRenderTargetTexture){const s=r.mapping;if(s===ct||s===ut){if(e.has(r)){const t=e.get(r).texture;return n(t,r.mapping)}{const s=r.image;if(s&&s.height>0){const o=new Bs(s.height/2);return o.fromEquirectangularTexture(t,r),e.set(r,o),r.addEventListener("dispose",i),n(o.texture,r.mapping)}return null}}}return r}function i(t){const n=t.target;n.removeEventListener("dispose",i);const r=e.get(n);void 0!==r&&(e.delete(n),r.dispose())}function s(){e=new WeakMap}return{get:r,dispose:s}}Rl.physical={uniforms:Rs([Rl.standard.uniforms,{clearcoat:{value:0},clearcoatMap:{value:null},clearcoatRoughness:{value:0},clearcoatRoughnessMap:{value:null},clearcoatNormalScale:{value:new qn(1,1)},clearcoatNormalMap:{value:null},iridescence:{value:0},iridescenceMap:{value:null},iridescenceIOR:{value:1.3},iridescenceThicknessMinimum:{value:100},iridescenceThicknessMaximum:{value:400},iridescenceThicknessMap:{value:null},sheen:{value:0},sheenColor:{value:new lr(0)},sheenColorMap:{value:null},sheenRoughness:{value:1},sheenRoughnessMap:{value:null},transmission:{value:0},transmissionMap:{value:null},transmissionSamplerSize:{value:new qn},transmissionSamplerMap:{value:null},thickness:{value:0},thicknessMap:{value:null},attenuationDistance:{value:0},attenuationColor:{value:new lr(0)},specularIntensity:{value:1},specularIntensityMap:{value:null},specularColor:{value:new lr(1,1,1)},specularColorMap:{value:null}}]),vertexShader:Tl.meshphysical_vert,fragmentShader:Tl.meshphysical_frag};class Dl extends ks{constructor(t=-1,e=1,n=1,r=-1,i=.1,s=2e3){super(),this.isOrthographicCamera=!0,this.type="OrthographicCamera",this.zoom=1,this.view=null,this.left=t,this.right=e,this.top=n,this.bottom=r,this.near=i,this.far=s,this.updateProjectionMatrix()}copy(t,e){return super.copy(t,e),this.left=t.left,this.right=t.right,this.top=t.top,this.bottom=t.bottom,this.near=t.near,this.far=t.far,this.zoom=t.zoom,this.view=null===t.view?null:Object.assign({},t.view),this}setViewOffset(t,e,n,r,i,s){null===this.view&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=t,this.view.fullHeight=e,this.view.offsetX=n,this.view.offsetY=r,this.view.width=i,this.view.height=s,this.updateProjectionMatrix()}clearViewOffset(){null!==this.view&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){const t=(this.right-this.left)/(2*this.zoom),e=(this.top-this.bottom)/(2*this.zoom),n=(this.right+this.left)/2,r=(this.top+this.bottom)/2;let i=n-t,s=n+t,o=r+e,a=r-e;if(null!==this.view&&this.view.enabled){const t=(this.right-this.left)/this.view.fullWidth/this.zoom,e=(this.top-this.bottom)/this.view.fullHeight/this.zoom;i+=t*this.view.offsetX,s=i+t*this.view.width,o-=e*this.view.offsetY,a=o-e*this.view.height}this.projectionMatrix.makeOrthographic(i,s,o,a,this.near,this.far),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(t){const e=super.toJSON(t);return e.object.zoom=this.zoom,e.object.left=this.left,e.object.right=this.right,e.object.top=this.top,e.object.bottom=this.bottom,e.object.near=this.near,e.object.far=this.far,null!==this.view&&(e.object.view=Object.assign({},this.view)),e}}const zl=4,Fl=[.125,.215,.35,.446,.526,.582],Ul=20,Bl=new Dl,Gl=new lr;let Hl=null;const Vl=(1+Math.sqrt(5))/2,jl=1/Vl,Wl=[new Mr(1,1,1),new Mr(-1,1,1),new Mr(1,1,-1),new Mr(-1,1,-1),new Mr(0,Vl,jl),new Mr(0,Vl,-jl),new Mr(jl,0,Vl),new Mr(-jl,0,Vl),new Mr(Vl,jl,0),new Mr(-Vl,jl,0)];class ql{constructor(t){this._renderer=t,this._pingPongRenderTarget=null,this._lodMax=0,this._cubeSize=0,this._lodPlanes=[],this._sizeLods=[],this._sigmas=[],this._blurMaterial=null,this._cubemapMaterial=null,this._equirectMaterial=null,this._compileMaterial(this._blurMaterial)}fromScene(t,e=0,n=.1,r=100){Hl=this._renderer.getRenderTarget(),this._setSize(256);const i=this._allocateTargets();return i.depthBuffer=!0,this._sceneToCubeUV(t,n,r,i),e>0&&this._blur(i,0,0,e),this._applyPMREM(i),this._cleanup(i),i}fromEquirectangular(t,e=null){return this._fromTexture(t,e)}fromCubemap(t,e=null){return this._fromTexture(t,e)}compileCubemapShader(){null===this._cubemapMaterial&&(this._cubemapMaterial=Ql(),this._compileMaterial(this._cubemapMaterial))}compileEquirectangularShader(){null===this._equirectMaterial&&(this._equirectMaterial=Zl(),this._compileMaterial(this._equirectMaterial))}dispose(){this._dispose(),null!==this._cubemapMaterial&&this._cubemapMaterial.dispose(),null!==this._equirectMaterial&&this._equirectMaterial.dispose()}_setSize(t){this._lodMax=Math.floor(Math.log2(t)),this._cubeSize=Math.pow(2,this._lodMax)}_dispose(){null!==this._blurMaterial&&this._blurMaterial.dispose(),null!==this._pingPongRenderTarget&&this._pingPongRenderTarget.dispose();for(let t=0;t<this._lodPlanes.length;t++)this._lodPlanes[t].dispose()}_cleanup(t){this._renderer.setRenderTarget(Hl),t.scissorTest=!1,Jl(t,0,0,t.width,t.height)}_fromTexture(t,e){t.mapping===at||t.mapping===lt?this._setSize(0===t.image.length?16:t.image[0].width||t.image[0].image.width):this._setSize(t.image.width/4),Hl=this._renderer.getRenderTarget();const n=e||this._allocateTargets();return this._textureToCubeUV(t,n),this._applyPMREM(n),this._cleanup(n),n}_allocateTargets(){const t=3*Math.max(this._cubeSize,112),e=4*this._cubeSize,n={magFilter:bt,minFilter:bt,generateMipmaps:!1,type:Lt,format:Ft,encoding:ke,depthBuffer:!1},r=Xl(t,e,n);if(null===this._pingPongRenderTarget||this._pingPongRenderTarget.width!==t){null!==this._pingPongRenderTarget&&this._dispose(),this._pingPongRenderTarget=Xl(t,e,n);const{_lodMax:r}=this;({sizeLods:this._sizeLods,lodPlanes:this._lodPlanes,sigmas:this._sigmas}=Yl(r)),this._blurMaterial=Kl(r,t,e)}return r}_compileMaterial(t){const e=new As(this._lodPlanes[0],t);this._renderer.compile(e,Bl)}_sceneToCubeUV(t,e,n,r){const i=90,s=1,o=new Os(i,s,e,n),a=[1,-1,1,1,1,1],l=[1,1,1,-1,-1,-1],c=this._renderer,u=c.autoClear,h=c.toneMapping;c.getClearColor(Gl),c.toneMapping=tt,c.autoClear=!1;const d=new Ui({name:"PMREM.Background",side:v,depthWrite:!1,depthTest:!1}),f=new As(new Ts,d);let p=!1;const m=t.background;m?m.isColor&&(d.color.copy(m),t.background=null,p=!0):(d.color.copy(Gl),p=!0);for(let g=0;g<6;g++){const e=g%3;0===e?(o.up.set(0,a[g],0),o.lookAt(l[g],0,0)):1===e?(o.up.set(0,0,a[g]),o.lookAt(0,l[g],0)):(o.up.set(0,a[g],0),o.lookAt(0,0,l[g]));const n=this._cubeSize;Jl(r,e*n,g>2?n:0,n,n),c.setRenderTarget(r),p&&c.render(f,o),c.render(t,o)}f.geometry.dispose(),f.material.dispose(),c.toneMapping=h,c.autoClear=u,t.background=m}_textureToCubeUV(t,e){const n=this._renderer,r=t.mapping===at||t.mapping===lt;r?(null===this._cubemapMaterial&&(this._cubemapMaterial=Ql()),this._cubemapMaterial.uniforms.flipEnvMap.value=!1===t.isRenderTargetTexture?-1:1):null===this._equirectMaterial&&(this._equirectMaterial=Zl());const i=r?this._cubemapMaterial:this._equirectMaterial,s=new As(this._lodPlanes[0],i),o=i.uniforms;o["envMap"].value=t;const a=this._cubeSize;Jl(e,0,0,3*a,2*a),n.setRenderTarget(e),n.render(s,Bl)}_applyPMREM(t){const e=this._renderer,n=e.autoClear;e.autoClear=!1;for(let r=1;r<this._lodPlanes.length;r++){const e=Math.sqrt(this._sigmas[r]*this._sigmas[r]-this._sigmas[r-1]*this._sigmas[r-1]),n=Wl[(r-1)%Wl.length];this._blur(t,r-1,r,e,n)}e.autoClear=n}_blur(t,e,n,r,i){const s=this._pingPongRenderTarget;this._halfBlur(t,s,e,n,r,"latitudinal",i),this._halfBlur(s,t,n,n,r,"longitudinal",i)}_halfBlur(t,e,n,r,i,s,o){const a=this._renderer,l=this._blurMaterial;"latitudinal"!==s&&"longitudinal"!==s&&console.error("blur direction must be either latitudinal or longitudinal!");const c=3,u=new As(this._lodPlanes[r],l),h=l.uniforms,d=this._sizeLods[n]-1,f=isFinite(i)?Math.PI/(2*d):2*Math.PI/(2*Ul-1),p=i/f,m=isFinite(i)?1+Math.floor(c*p):Ul;m>Ul&&console.warn(`sigmaRadians, ${i}, is too large and will clip, as it requested ${m} samples when the maximum is set to ${Ul}`);const g=[];let v=0;for(let _=0;_<Ul;++_){const t=_/p,e=Math.exp(-t*t/2);g.push(e),0===_?v+=e:_<m&&(v+=2*e)}for(let _=0;_<g.length;_++)g[_]=g[_]/v;h["envMap"].value=t.texture,h["samples"].value=m,h["weights"].value=g,h["latitudinal"].value="latitudinal"===s,o&&(h["poleAxis"].value=o);const{_lodMax:y}=this;h["dTheta"].value=f,h["mipInt"].value=y-n;const x=this._sizeLods[r],b=3*x*(r>y-zl?r-y+zl:0),w=4*(this._cubeSize-x);Jl(e,b,w,3*x,2*x),a.setRenderTarget(e),a.render(u,Bl)}}function Yl(t){const e=[],n=[],r=[];let i=t;const s=t-zl+1+Fl.length;for(let o=0;o<s;o++){const s=Math.pow(2,i);n.push(s);let a=1/s;o>t-zl?a=Fl[o-t+zl-1]:0===o&&(a=0),r.push(a);const l=1/(s-2),c=-l,u=1+l,h=[c,c,u,c,u,u,c,c,u,u,c,u],d=6,f=6,p=3,m=2,g=1,v=new Float32Array(p*f*d),y=new Float32Array(m*f*d),x=new Float32Array(g*f*d);for(let t=0;t<d;t++){const e=t%3*2/3-1,n=t>2?0:-1,r=[e,n,0,e+2/3,n,0,e+2/3,n+1,0,e,n,0,e+2/3,n+1,0,e,n+1,0];v.set(r,p*f*t),y.set(h,m*f*t);const i=[t,t,t,t,t,t];x.set(i,g*f*t)}const b=new os;b.setAttribute("position",new Hi(v,p)),b.setAttribute("uv",new Hi(y,m)),b.setAttribute("faceIndex",new Hi(x,g)),e.push(b),i>zl&&i--}return{lodPlanes:e,sizeLods:n,sigmas:r}}function Xl(t,e,n){const r=new gr(t,e,n);return r.texture.mapping=ht,r.texture.name="PMREM.cubeUv",r.scissorTest=!0,r}function Jl(t,e,n,r,i){t.viewport.set(e,n,r,i),t.scissor.set(e,n,r,i)}function Kl(t,e,n){const r=new Float32Array(Ul),i=new Mr(0,1,0),s=new Ns({name:"SphericalGaussianBlur",defines:{n:Ul,CUBEUV_TEXEL_WIDTH:1/e,CUBEUV_TEXEL_HEIGHT:1/n,CUBEUV_MAX_MIP:`${t}.0`},uniforms:{envMap:{value:null},samples:{value:1},weights:{value:r},latitudinal:{value:!1},dTheta:{value:0},mipInt:{value:0},poleAxis:{value:i}},vertexShader:$l(),fragmentShader:"\n\n\t\t\tprecision mediump float;\n\t\t\tprecision mediump int;\n\n\t\t\tvarying vec3 vOutputDirection;\n\n\t\t\tuniform sampler2D envMap;\n\t\t\tuniform int samples;\n\t\t\tuniform float weights[ n ];\n\t\t\tuniform bool latitudinal;\n\t\t\tuniform float dTheta;\n\t\t\tuniform float mipInt;\n\t\t\tuniform vec3 poleAxis;\n\n\t\t\t#define ENVMAP_TYPE_CUBE_UV\n\t\t\t#include <cube_uv_reflection_fragment>\n\n\t\t\tvec3 getSample( float theta, vec3 axis ) {\n\n\t\t\t\tfloat cosTheta = cos( theta );\n\t\t\t\t// Rodrigues' axis-angle rotation\n\t\t\t\tvec3 sampleDirection = vOutputDirection * cosTheta\n\t\t\t\t\t+ cross( axis, vOutputDirection ) * sin( theta )\n\t\t\t\t\t+ axis * dot( axis, vOutputDirection ) * ( 1.0 - cosTheta );\n\n\t\t\t\treturn bilinearCubeUV( envMap, sampleDirection, mipInt );\n\n\t\t\t}\n\n\t\t\tvoid main() {\n\n\t\t\t\tvec3 axis = latitudinal ? poleAxis : cross( poleAxis, vOutputDirection );\n\n\t\t\t\tif ( all( equal( axis, vec3( 0.0 ) ) ) ) {\n\n\t\t\t\t\taxis = vec3( vOutputDirection.z, 0.0, - vOutputDirection.x );\n\n\t\t\t\t}\n\n\t\t\t\taxis = normalize( axis );\n\n\t\t\t\tgl_FragColor = vec4( 0.0, 0.0, 0.0, 1.0 );\n\t\t\t\tgl_FragColor.rgb += weights[ 0 ] * getSample( 0.0, axis );\n\n\t\t\t\tfor ( int i = 1; i < n; i++ ) {\n\n\t\t\t\t\tif ( i >= samples ) {\n\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\t}\n\n\t\t\t\t\tfloat theta = dTheta * float( i );\n\t\t\t\t\tgl_FragColor.rgb += weights[ i ] * getSample( -1.0 * theta, axis );\n\t\t\t\t\tgl_FragColor.rgb += weights[ i ] * getSample( theta, axis );\n\n\t\t\t\t}\n\n\t\t\t}\n\t\t",blending:w,depthTest:!1,depthWrite:!1});return s}function Zl(){return new Ns({name:"EquirectangularToCubeUV",uniforms:{envMap:{value:null}},vertexShader:$l(),fragmentShader:"\n\n\t\t\tprecision mediump float;\n\t\t\tprecision mediump int;\n\n\t\t\tvarying vec3 vOutputDirection;\n\n\t\t\tuniform sampler2D envMap;\n\n\t\t\t#include <common>\n\n\t\t\tvoid main() {\n\n\t\t\t\tvec3 outputDirection = normalize( vOutputDirection );\n\t\t\t\tvec2 uv = equirectUv( outputDirection );\n\n\t\t\t\tgl_FragColor = vec4( texture2D ( envMap, uv ).rgb, 1.0 );\n\n\t\t\t}\n\t\t",blending:w,depthTest:!1,depthWrite:!1})}function Ql(){return new Ns({name:"CubemapToCubeUV",uniforms:{envMap:{value:null},flipEnvMap:{value:-1}},vertexShader:$l(),fragmentShader:"\n\n\t\t\tprecision mediump float;\n\t\t\tprecision mediump int;\n\n\t\t\tuniform float flipEnvMap;\n\n\t\t\tvarying vec3 vOutputDirection;\n\n\t\t\tuniform samplerCube envMap;\n\n\t\t\tvoid main() {\n\n\t\t\t\tgl_FragColor = textureCube( envMap, vec3( flipEnvMap * vOutputDirection.x, vOutputDirection.yz ) );\n\n\t\t\t}\n\t\t",blending:w,depthTest:!1,depthWrite:!1})}function $l(){return"\n\n\t\tprecision mediump float;\n\t\tprecision mediump int;\n\n\t\tattribute float faceIndex;\n\n\t\tvarying vec3 vOutputDirection;\n\n\t\t// RH coordinate system; PMREM face-indexing convention\n\t\tvec3 getDirection( vec2 uv, float face ) {\n\n\t\t\tuv = 2.0 * uv - 1.0;\n\n\t\t\tvec3 direction = vec3( uv, 1.0 );\n\n\t\t\tif ( face == 0.0 ) {\n\n\t\t\t\tdirection = direction.zyx; // ( 1, v, u ) pos x\n\n\t\t\t} else if ( face == 1.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xz *= -1.0; // ( -u, 1, -v ) pos y\n\n\t\t\t} else if ( face == 2.0 ) {\n\n\t\t\t\tdirection.x *= -1.0; // ( -u, v, 1 ) pos z\n\n\t\t\t} else if ( face == 3.0 ) {\n\n\t\t\t\tdirection = direction.zyx;\n\t\t\t\tdirection.xz *= -1.0; // ( -1, v, -u ) neg x\n\n\t\t\t} else if ( face == 4.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xy *= -1.0; // ( -u, -1, v ) neg y\n\n\t\t\t} else if ( face == 5.0 ) {\n\n\t\t\t\tdirection.z *= -1.0; // ( u, v, -1 ) neg z\n\n\t\t\t}\n\n\t\t\treturn direction;\n\n\t\t}\n\n\t\tvoid main() {\n\n\t\t\tvOutputDirection = getDirection( uv, faceIndex );\n\t\t\tgl_Position = vec4( position, 1.0 );\n\n\t\t}\n\t"}function tc(t){let e=new WeakMap,n=null;function r(r){if(r&&r.isTexture){const o=r.mapping,a=o===ct||o===ut,l=o===at||o===lt;if(a||l){if(r.isRenderTargetTexture&&!0===r.needsPMREMUpdate){r.needsPMREMUpdate=!1;let i=e.get(r);return null===n&&(n=new ql(t)),i=a?n.fromEquirectangular(r,i):n.fromCubemap(r,i),e.set(r,i),i.texture}if(e.has(r))return e.get(r).texture;{const o=r.image;if(a&&o&&o.height>0||l&&o&&i(o)){null===n&&(n=new ql(t));const i=a?n.fromEquirectangular(r):n.fromCubemap(r);return e.set(r,i),r.addEventListener("dispose",s),i.texture}return null}}}return r}function i(t){let e=0;const n=6;for(let r=0;r<n;r++)void 0!==t[r]&&e++;return e===n}function s(t){const n=t.target;n.removeEventListener("dispose",s);const r=e.get(n);void 0!==r&&(e.delete(n),r.dispose())}function o(){e=new WeakMap,null!==n&&(n.dispose(),n=null)}return{get:r,dispose:o}}function ec(t){const e={};function n(n){if(void 0!==e[n])return e[n];let r;switch(n){case"WEBGL_depth_texture":r=t.getExtension("WEBGL_depth_texture")||t.getExtension("MOZ_WEBGL_depth_texture")||t.getExtension("WEBKIT_WEBGL_depth_texture");break;case"EXT_texture_filter_anisotropic":r=t.getExtension("EXT_texture_filter_anisotropic")||t.getExtension("MOZ_EXT_texture_filter_anisotropic")||t.getExtension("WEBKIT_EXT_texture_filter_anisotropic");break;case"WEBGL_compressed_texture_s3tc":r=t.getExtension("WEBGL_compressed_texture_s3tc")||t.getExtension("MOZ_WEBGL_compressed_texture_s3tc")||t.getExtension("WEBKIT_WEBGL_compressed_texture_s3tc");break;case"WEBGL_compressed_texture_pvrtc":r=t.getExtension("WEBGL_compressed_texture_pvrtc")||t.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc");break;default:r=t.getExtension(n)}return e[n]=r,r}return{has:function(t){return null!==n(t)},init:function(t){t.isWebGL2?n("EXT_color_buffer_float"):(n("WEBGL_depth_texture"),n("OES_texture_float"),n("OES_texture_half_float"),n("OES_texture_half_float_linear"),n("OES_standard_derivatives"),n("OES_element_index_uint"),n("OES_vertex_array_object"),n("ANGLE_instanced_arrays")),n("OES_texture_float_linear"),n("EXT_color_buffer_half_float"),n("WEBGL_multisampled_render_to_texture")},get:function(t){const e=n(t);return null===e&&console.warn("THREE.WebGLRenderer: "+t+" extension not supported."),e}}}function nc(t,e,n,r){const i={},s=new WeakMap;function o(t){const a=t.target;null!==a.index&&e.remove(a.index);for(const n in a.attributes)e.remove(a.attributes[n]);a.removeEventListener("dispose",o),delete i[a.id];const l=s.get(a);l&&(e.remove(l),s.delete(a)),r.releaseStatesOfGeometry(a),!0===a.isInstancedBufferGeometry&&delete a._maxInstanceCount,n.memory.geometries--}function a(t,e){return!0===i[e.id]||(e.addEventListener("dispose",o),i[e.id]=!0,n.memory.geometries++),e}function l(t){const n=t.attributes;for(const i in n)e.update(n[i],34962);const r=t.morphAttributes;for(const i in r){const t=r[i];for(let n=0,r=t.length;n<r;n++)e.update(t[n],34962)}}function c(t){const n=[],r=t.index,i=t.attributes.position;let o=0;if(null!==r){const t=r.array;o=r.version;for(let e=0,r=t.length;e<r;e+=3){const r=t[e+0],i=t[e+1],s=t[e+2];n.push(r,i,i,s,s,r)}}else{const t=i.array;o=i.version;for(let e=0,r=t.length/3-1;e<r;e+=3){const t=e+0,r=e+1,i=e+2;n.push(t,r,r,i,i,t)}}const a=new(Xn(n)?Ji:Yi)(n,1);a.version=o;const l=s.get(t);l&&e.remove(l),s.set(t,a)}function u(t){const e=s.get(t);if(e){const n=t.index;null!==n&&e.version<n.version&&c(t)}else c(t);return s.get(t)}return{get:a,update:l,getWireframeAttribute:u}}function rc(t,e,n,r){const i=r.isWebGL2;let s,o,a;function l(t){s=t}function c(t){o=t.type,a=t.bytesPerElement}function u(e,r){t.drawElements(s,r,o,e*a),n.update(r,s,1)}function h(r,l,c){if(0===c)return;let u,h;if(i)u=t,h="drawElementsInstanced";else if(u=e.get("ANGLE_instanced_arrays"),h="drawElementsInstancedANGLE",null===u)return void console.error("THREE.WebGLIndexedBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");u[h](s,l,o,r*a,c),n.update(l,s,c)}this.setMode=l,this.setIndex=c,this.render=u,this.renderInstances=h}function ic(t){const e={geometries:0,textures:0},n={frame:0,calls:0,triangles:0,points:0,lines:0};function r(t,e,r){switch(n.calls++,e){case 4:n.triangles+=r*(t/3);break;case 1:n.lines+=r*(t/2);break;case 3:n.lines+=r*(t-1);break;case 2:n.lines+=r*t;break;case 0:n.points+=r*t;break;default:console.error("THREE.WebGLInfo: Unknown draw mode:",e);break}}function i(){n.frame++,n.calls=0,n.triangles=0,n.points=0,n.lines=0}return{memory:e,render:n,programs:null,autoReset:!0,reset:i,update:r}}function sc(t,e){return t[0]-e[0]}function oc(t,e){return Math.abs(e[1])-Math.abs(t[1])}function ac(t,e){let n=1;const r=e.isInterleavedBufferAttribute?e.data.array:e.array;r instanceof Int8Array?n=127:r instanceof Int16Array?n=32767:r instanceof Int32Array?n=2147483647:console.error("THREE.WebGLMorphtargets: Unsupported morph attribute data type: ",r),t.divideScalar(n)}function lc(t,e,n){const r={},i=new Float32Array(8),s=new WeakMap,o=new mr,a=[];for(let c=0;c<8;c++)a[c]=[c,0];function l(l,c,u,h){const d=l.morphTargetInfluences;if(!0===e.isWebGL2){const r=c.morphAttributes.position||c.morphAttributes.normal||c.morphAttributes.color,i=void 0!==r?r.length:0;let a=s.get(c);if(void 0===a||a.count!==i){let t=function(){v.dispose(),s.delete(c),c.removeEventListener("dispose",t)};void 0!==a&&a.texture.dispose();const n=void 0!==c.morphAttributes.position,r=void 0!==c.morphAttributes.normal,l=void 0!==c.morphAttributes.color,u=c.morphAttributes.position||[],h=c.morphAttributes.normal||[],d=c.morphAttributes.color||[];let f=0;!0===n&&(f=1),!0===r&&(f=2),!0===l&&(f=3);let p=c.attributes.position.count*f,m=1;p>e.maxTextureSize&&(m=Math.ceil(p/e.maxTextureSize),p=e.maxTextureSize);const g=new Float32Array(p*m*4*i),v=new vr(g,p,m,i);v.type=Pt,v.needsUpdate=!0;const y=4*f;for(let e=0;e<i;e++){const t=u[e],i=h[e],s=d[e],a=p*m*4*e;for(let e=0;e<t.count;e++){const c=e*y;!0===n&&(o.fromBufferAttribute(t,e),!0===t.normalized&&ac(o,t),g[a+c+0]=o.x,g[a+c+1]=o.y,g[a+c+2]=o.z,g[a+c+3]=0),!0===r&&(o.fromBufferAttribute(i,e),!0===i.normalized&&ac(o,i),g[a+c+4]=o.x,g[a+c+5]=o.y,g[a+c+6]=o.z,g[a+c+7]=0),!0===l&&(o.fromBufferAttribute(s,e),!0===s.normalized&&ac(o,s),g[a+c+8]=o.x,g[a+c+9]=o.y,g[a+c+10]=o.z,g[a+c+11]=4===s.itemSize?o.w:1)}}a={count:i,texture:v,size:new qn(p,m)},s.set(c,a),c.addEventListener("dispose",t)}let l=0;for(let t=0;t<d.length;t++)l+=d[t];const u=c.morphTargetsRelative?1:1-l;h.getUniforms().setValue(t,"morphTargetBaseInfluence",u),h.getUniforms().setValue(t,"morphTargetInfluences",d),h.getUniforms().setValue(t,"morphTargetsTexture",a.texture,n),h.getUniforms().setValue(t,"morphTargetsTextureSize",a.size)}else{const e=void 0===d?0:d.length;let n=r[c.id];if(void 0===n||n.length!==e){n=[];for(let t=0;t<e;t++)n[t]=[t,0];r[c.id]=n}for(let t=0;t<e;t++){const e=n[t];e[0]=t,e[1]=d[t]}n.sort(oc);for(let t=0;t<8;t++)t<e&&n[t][1]?(a[t][0]=n[t][0],a[t][1]=n[t][1]):(a[t][0]=Number.MAX_SAFE_INTEGER,a[t][1]=0);a.sort(sc);const s=c.morphAttributes.position,o=c.morphAttributes.normal;let l=0;for(let t=0;t<8;t++){const e=a[t],n=e[0],r=e[1];n!==Number.MAX_SAFE_INTEGER&&r?(s&&c.getAttribute("morphTarget"+t)!==s[n]&&c.setAttribute("morphTarget"+t,s[n]),o&&c.getAttribute("morphNormal"+t)!==o[n]&&c.setAttribute("morphNormal"+t,o[n]),i[t]=r,l+=r):(s&&!0===c.hasAttribute("morphTarget"+t)&&c.deleteAttribute("morphTarget"+t),o&&!0===c.hasAttribute("morphNormal"+t)&&c.deleteAttribute("morphNormal"+t),i[t]=0)}const u=c.morphTargetsRelative?1:1-l;h.getUniforms().setValue(t,"morphTargetBaseInfluence",u),h.getUniforms().setValue(t,"morphTargetInfluences",i)}}return{update:l}}function cc(t,e,n,r){let i=new WeakMap;function s(t){const s=r.render.frame,o=t.geometry,l=e.get(t,o);return i.get(l)!==s&&(e.update(l),i.set(l,s)),t.isInstancedMesh&&(!1===t.hasEventListener("dispose",a)&&t.addEventListener("dispose",a),n.update(t.instanceMatrix,34962),null!==t.instanceColor&&n.update(t.instanceColor,34962)),l}function o(){i=new WeakMap}function a(t){const e=t.target;e.removeEventListener("dispose",a),n.remove(e.instanceMatrix),null!==e.instanceColor&&n.remove(e.instanceColor)}return{update:s,dispose:o}}const uc=new pr,hc=new vr,dc=new xr,fc=new Us,pc=[],mc=[],gc=new Float32Array(16),vc=new Float32Array(9),yc=new Float32Array(4);function xc(t,e,n){const r=t[0];if(r<=0||r>0)return t;const i=e*n;let s=pc[i];if(void 0===s&&(s=new Float32Array(i),pc[i]=s),0!==e){r.toArray(s,0);for(let r=1,i=0;r!==e;++r)i+=n,t[r].toArray(s,i)}return s}function bc(t,e){if(t.length!==e.length)return!1;for(let n=0,r=t.length;n<r;n++)if(t[n]!==e[n])return!1;return!0}function wc(t,e){for(let n=0,r=e.length;n<r;n++)t[n]=e[n]}function _c(t,e){let n=mc[e];void 0===n&&(n=new Int32Array(e),mc[e]=n);for(let r=0;r!==e;++r)n[r]=t.allocateTextureUnit();return n}function Mc(t,e){const n=this.cache;n[0]!==e&&(t.uniform1f(this.addr,e),n[0]=e)}function Ac(t,e){const n=this.cache;if(void 0!==e.x)n[0]===e.x&&n[1]===e.y||(t.uniform2f(this.addr,e.x,e.y),n[0]=e.x,n[1]=e.y);else{if(bc(n,e))return;t.uniform2fv(this.addr,e),wc(n,e)}}function Sc(t,e){const n=this.cache;if(void 0!==e.x)n[0]===e.x&&n[1]===e.y&&n[2]===e.z||(t.uniform3f(this.addr,e.x,e.y,e.z),n[0]=e.x,n[1]=e.y,n[2]=e.z);else if(void 0!==e.r)n[0]===e.r&&n[1]===e.g&&n[2]===e.b||(t.uniform3f(this.addr,e.r,e.g,e.b),n[0]=e.r,n[1]=e.g,n[2]=e.b);else{if(bc(n,e))return;t.uniform3fv(this.addr,e),wc(n,e)}}function Ec(t,e){const n=this.cache;if(void 0!==e.x)n[0]===e.x&&n[1]===e.y&&n[2]===e.z&&n[3]===e.w||(t.uniform4f(this.addr,e.x,e.y,e.z,e.w),n[0]=e.x,n[1]=e.y,n[2]=e.z,n[3]=e.w);else{if(bc(n,e))return;t.uniform4fv(this.addr,e),wc(n,e)}}function Tc(t,e){const n=this.cache,r=e.elements;if(void 0===r){if(bc(n,e))return;t.uniformMatrix2fv(this.addr,!1,e),wc(n,e)}else{if(bc(n,r))return;yc.set(r),t.uniformMatrix2fv(this.addr,!1,yc),wc(n,r)}}function Cc(t,e){const n=this.cache,r=e.elements;if(void 0===r){if(bc(n,e))return;t.uniformMatrix3fv(this.addr,!1,e),wc(n,e)}else{if(bc(n,r))return;vc.set(r),t.uniformMatrix3fv(this.addr,!1,vc),wc(n,r)}}function Rc(t,e){const n=this.cache,r=e.elements;if(void 0===r){if(bc(n,e))return;t.uniformMatrix4fv(this.addr,!1,e),wc(n,e)}else{if(bc(n,r))return;gc.set(r),t.uniformMatrix4fv(this.addr,!1,gc),wc(n,r)}}function Ic(t,e){const n=this.cache;n[0]!==e&&(t.uniform1i(this.addr,e),n[0]=e)}function Pc(t,e){const n=this.cache;bc(n,e)||(t.uniform2iv(this.addr,e),wc(n,e))}function Lc(t,e){const n=this.cache;bc(n,e)||(t.uniform3iv(this.addr,e),wc(n,e))}function Nc(t,e){const n=this.cache;bc(n,e)||(t.uniform4iv(this.addr,e),wc(n,e))}function kc(t,e){const n=this.cache;n[0]!==e&&(t.uniform1ui(this.addr,e),n[0]=e)}function Oc(t,e){const n=this.cache;bc(n,e)||(t.uniform2uiv(this.addr,e),wc(n,e))}function Dc(t,e){const n=this.cache;bc(n,e)||(t.uniform3uiv(this.addr,e),wc(n,e))}function zc(t,e){const n=this.cache;bc(n,e)||(t.uniform4uiv(this.addr,e),wc(n,e))}function Fc(t,e,n){const r=this.cache,i=n.allocateTextureUnit();r[0]!==i&&(t.uniform1i(this.addr,i),r[0]=i),n.setTexture2D(e||uc,i)}function Uc(t,e,n){const r=this.cache,i=n.allocateTextureUnit();r[0]!==i&&(t.uniform1i(this.addr,i),r[0]=i),n.setTexture3D(e||dc,i)}function Bc(t,e,n){const r=this.cache,i=n.allocateTextureUnit();r[0]!==i&&(t.uniform1i(this.addr,i),r[0]=i),n.setTextureCube(e||fc,i)}function Gc(t,e,n){const r=this.cache,i=n.allocateTextureUnit();r[0]!==i&&(t.uniform1i(this.addr,i),r[0]=i),n.setTexture2DArray(e||hc,i)}function Hc(t){switch(t){case 5126:return Mc;case 35664:return Ac;case 35665:return Sc;case 35666:return Ec;case 35674:return Tc;case 35675:return Cc;case 35676:return Rc;case 5124:case 35670:return Ic;case 35667:case 35671:return Pc;case 35668:case 35672:return Lc;case 35669:case 35673:return Nc;case 5125:return kc;case 36294:return Oc;case 36295:return Dc;case 36296:return zc;case 35678:case 36198:case 36298:case 36306:case 35682:return Fc;case 35679:case 36299:case 36307:return Uc;case 35680:case 36300:case 36308:case 36293:return Bc;case 36289:case 36303:case 36311:case 36292:return Gc}}function Vc(t,e){t.uniform1fv(this.addr,e)}function jc(t,e){const n=xc(e,this.size,2);t.uniform2fv(this.addr,n)}function Wc(t,e){const n=xc(e,this.size,3);t.uniform3fv(this.addr,n)}function qc(t,e){const n=xc(e,this.size,4);t.uniform4fv(this.addr,n)}function Yc(t,e){const n=xc(e,this.size,4);t.uniformMatrix2fv(this.addr,!1,n)}function Xc(t,e){const n=xc(e,this.size,9);t.uniformMatrix3fv(this.addr,!1,n)}function Jc(t,e){const n=xc(e,this.size,16);t.uniformMatrix4fv(this.addr,!1,n)}function Kc(t,e){t.uniform1iv(this.addr,e)}function Zc(t,e){t.uniform2iv(this.addr,e)}function Qc(t,e){t.uniform3iv(this.addr,e)}function $c(t,e){t.uniform4iv(this.addr,e)}function tu(t,e){t.uniform1uiv(this.addr,e)}function eu(t,e){t.uniform2uiv(this.addr,e)}function nu(t,e){t.uniform3uiv(this.addr,e)}function ru(t,e){t.uniform4uiv(this.addr,e)}function iu(t,e,n){const r=e.length,i=_c(n,r);t.uniform1iv(this.addr,i);for(let s=0;s!==r;++s)n.setTexture2D(e[s]||uc,i[s])}function su(t,e,n){const r=e.length,i=_c(n,r);t.uniform1iv(this.addr,i);for(let s=0;s!==r;++s)n.setTexture3D(e[s]||dc,i[s])}function ou(t,e,n){const r=e.length,i=_c(n,r);t.uniform1iv(this.addr,i);for(let s=0;s!==r;++s)n.setTextureCube(e[s]||fc,i[s])}function au(t,e,n){const r=e.length,i=_c(n,r);t.uniform1iv(this.addr,i);for(let s=0;s!==r;++s)n.setTexture2DArray(e[s]||hc,i[s])}function lu(t){switch(t){case 5126:return Vc;case 35664:return jc;case 35665:return Wc;case 35666:return qc;case 35674:return Yc;case 35675:return Xc;case 35676:return Jc;case 5124:case 35670:return Kc;case 35667:case 35671:return Zc;case 35668:case 35672:return Qc;case 35669:case 35673:return $c;case 5125:return tu;case 36294:return eu;case 36295:return nu;case 36296:return ru;case 35678:case 36198:case 36298:case 36306:case 35682:return iu;case 35679:case 36299:case 36307:return su;case 35680:case 36300:case 36308:case 36293:return ou;case 36289:case 36303:case 36311:case 36292:return au}}class cu{constructor(t,e,n){this.id=t,this.addr=n,this.cache=[],this.setValue=Hc(e.type)}}class uu{constructor(t,e,n){this.id=t,this.addr=n,this.cache=[],this.size=e.size,this.setValue=lu(e.type)}}class hu{constructor(t){this.id=t,this.seq=[],this.map={}}setValue(t,e,n){const r=this.seq;for(let i=0,s=r.length;i!==s;++i){const s=r[i];s.setValue(t,e[s.id],n)}}}const du=/(\w+)(\])?(\[|\.)?/g;function fu(t,e){t.seq.push(e),t.map[e.id]=e}function pu(t,e,n){const r=t.name,i=r.length;du.lastIndex=0;while(1){const s=du.exec(r),o=du.lastIndex;let a=s[1];const l="]"===s[2],c=s[3];if(l&&(a|=0),void 0===c||"["===c&&o+2===i){fu(n,void 0===c?new cu(a,t,e):new uu(a,t,e));break}{const t=n.map;let e=t[a];void 0===e&&(e=new hu(a),fu(n,e)),n=e}}}class mu{constructor(t,e){this.seq=[],this.map={};const n=t.getProgramParameter(e,35718);for(let r=0;r<n;++r){const n=t.getActiveUniform(e,r),i=t.getUniformLocation(e,n.name);pu(n,i,this)}}setValue(t,e,n,r){const i=this.map[e];void 0!==i&&i.setValue(t,n,r)}setOptional(t,e,n){const r=e[n];void 0!==r&&this.setValue(t,n,r)}static upload(t,e,n,r){for(let i=0,s=e.length;i!==s;++i){const s=e[i],o=n[s.id];!1!==o.needsUpdate&&s.setValue(t,o.value,r)}}static seqWithValue(t,e){const n=[];for(let r=0,i=t.length;r!==i;++r){const i=t[r];i.id in e&&n.push(i)}return n}}function gu(t,e,n){const r=t.createShader(e);return t.shaderSource(r,n),t.compileShader(r),r}let vu=0;function yu(t,e){const n=t.split("\n"),r=[],i=Math.max(e-6,0),s=Math.min(e+6,n.length);for(let o=i;o<s;o++){const t=o+1;r.push(`${t===e?">":" "} ${t}: ${n[o]}`)}return r.join("\n")}function xu(t){switch(t){case ke:return["Linear","( value )"];case Oe:return["sRGB","( value )"];default:return console.warn("THREE.WebGLProgram: Unsupported encoding:",t),["Linear","( value )"]}}function bu(t,e,n){const r=t.getShaderParameter(e,35713),i=t.getShaderInfoLog(e).trim();if(r&&""===i)return"";const s=/ERROR: 0:(\d+)/.exec(i);if(s){const r=parseInt(s[1]);return n.toUpperCase()+"\n\n"+i+"\n\n"+yu(t.getShaderSource(e),r)}return i}function wu(t,e){const n=xu(e);return"vec4 "+t+"( vec4 value ) { return LinearTo"+n[0]+n[1]+"; }"}function _u(t,e){let n;switch(e){case et:n="Linear";break;case nt:n="Reinhard";break;case rt:n="OptimizedCineon";break;case it:n="ACESFilmic";break;case st:n="Custom";break;default:console.warn("THREE.WebGLProgram: Unsupported toneMapping:",e),n="Linear"}return"vec3 "+t+"( vec3 color ) { return "+n+"ToneMapping( color ); }"}function Mu(t){const e=[t.extensionDerivatives||t.envMapCubeUVHeight||t.bumpMap||t.tangentSpaceNormalMap||t.clearcoatNormalMap||t.flatShading||"physical"===t.shaderID?"#extension GL_OES_standard_derivatives : enable":"",(t.extensionFragDepth||t.logarithmicDepthBuffer)&&t.rendererExtensionFragDepth?"#extension GL_EXT_frag_depth : enable":"",t.extensionDrawBuffers&&t.rendererExtensionDrawBuffers?"#extension GL_EXT_draw_buffers : require":"",(t.extensionShaderTextureLOD||t.envMap||t.transmission)&&t.rendererExtensionShaderTextureLod?"#extension GL_EXT_shader_texture_lod : enable":""];return e.filter(Eu).join("\n")}function Au(t){const e=[];for(const n in t){const r=t[n];!1!==r&&e.push("#define "+n+" "+r)}return e.join("\n")}function Su(t,e){const n={},r=t.getProgramParameter(e,35721);for(let i=0;i<r;i++){const r=t.getActiveAttrib(e,i),s=r.name;let o=1;35674===r.type&&(o=2),35675===r.type&&(o=3),35676===r.type&&(o=4),n[s]={type:r.type,location:t.getAttribLocation(e,s),locationSize:o}}return n}function Eu(t){return""!==t}function Tu(t,e){return t.replace(/NUM_DIR_LIGHTS/g,e.numDirLights).replace(/NUM_SPOT_LIGHTS/g,e.numSpotLights).replace(/NUM_RECT_AREA_LIGHTS/g,e.numRectAreaLights).replace(/NUM_POINT_LIGHTS/g,e.numPointLights).replace(/NUM_HEMI_LIGHTS/g,e.numHemiLights).replace(/NUM_DIR_LIGHT_SHADOWS/g,e.numDirLightShadows).replace(/NUM_SPOT_LIGHT_SHADOWS/g,e.numSpotLightShadows).replace(/NUM_POINT_LIGHT_SHADOWS/g,e.numPointLightShadows)}function Cu(t,e){return t.replace(/NUM_CLIPPING_PLANES/g,e.numClippingPlanes).replace(/UNION_CLIPPING_PLANES/g,e.numClippingPlanes-e.numClipIntersection)}const Ru=/^[ \t]*#include +<([\w\d./]+)>/gm;function Iu(t){return t.replace(Ru,Pu)}function Pu(t,e){const n=Tl[e];if(void 0===n)throw new Error("Can not resolve #include <"+e+">");return Iu(n)}const Lu=/#pragma unroll_loop[\s]+?for \( int i \= (\d+)\; i < (\d+)\; i \+\+ \) \{([\s\S]+?)(?=\})\}/g,Nu=/#pragma unroll_loop_start\s+for\s*\(\s*int\s+i\s*=\s*(\d+)\s*;\s*i\s*<\s*(\d+)\s*;\s*i\s*\+\+\s*\)\s*{([\s\S]+?)}\s+#pragma unroll_loop_end/g;function ku(t){return t.replace(Nu,Du).replace(Lu,Ou)}function Ou(t,e,n,r){return console.warn("WebGLProgram: #pragma unroll_loop shader syntax is deprecated. Please use #pragma unroll_loop_start syntax instead."),Du(t,e,n,r)}function Du(t,e,n,r){let i="";for(let s=parseInt(e);s<parseInt(n);s++)i+=r.replace(/\[\s*i\s*\]/g,"[ "+s+" ]").replace(/UNROLLED_LOOP_INDEX/g,s);return i}function zu(t){let e="precision "+t.precision+" float;\nprecision "+t.precision+" int;";return"highp"===t.precision?e+="\n#define HIGH_PRECISION":"mediump"===t.precision?e+="\n#define MEDIUM_PRECISION":"lowp"===t.precision&&(e+="\n#define LOW_PRECISION"),e}function Fu(t){let e="SHADOWMAP_TYPE_BASIC";return t.shadowMapType===f?e="SHADOWMAP_TYPE_PCF":t.shadowMapType===p?e="SHADOWMAP_TYPE_PCF_SOFT":t.shadowMapType===m&&(e="SHADOWMAP_TYPE_VSM"),e}function Uu(t){let e="ENVMAP_TYPE_CUBE";if(t.envMap)switch(t.envMapMode){case at:case lt:e="ENVMAP_TYPE_CUBE";break;case ht:e="ENVMAP_TYPE_CUBE_UV";break}return e}function Bu(t){let e="ENVMAP_MODE_REFLECTION";if(t.envMap)switch(t.envMapMode){case lt:e="ENVMAP_MODE_REFRACTION";break}return e}function Gu(t){let e="ENVMAP_BLENDING_NONE";if(t.envMap)switch(t.combine){case Z:e="ENVMAP_BLENDING_MULTIPLY";break;case Q:e="ENVMAP_BLENDING_MIX";break;case $:e="ENVMAP_BLENDING_ADD";break}return e}function Hu(t){const e=t.envMapCubeUVHeight;if(null===e)return null;const n=Math.log2(e)-2,r=1/e,i=1/(3*Math.max(Math.pow(2,n),112));return{texelWidth:i,texelHeight:r,maxMip:n}}function Vu(t,e,n,r){const i=t.getContext(),s=n.defines;let o=n.vertexShader,a=n.fragmentShader;const l=Fu(n),c=Uu(n),u=Bu(n),h=Gu(n),d=Hu(n),f=n.isWebGL2?"":Mu(n),p=Au(s),m=i.createProgram();let g,v,y=n.glslVersion?"#version "+n.glslVersion+"\n":"";n.isRawShaderMaterial?(g=[p].filter(Eu).join("\n"),g.length>0&&(g+="\n"),v=[f,p].filter(Eu).join("\n"),v.length>0&&(v+="\n")):(g=[zu(n),"#define SHADER_NAME "+n.shaderName,p,n.instancing?"#define USE_INSTANCING":"",n.instancingColor?"#define USE_INSTANCING_COLOR":"",n.supportsVertexTextures?"#define VERTEX_TEXTURES":"",n.useFog&&n.fog?"#define USE_FOG":"",n.useFog&&n.fogExp2?"#define FOG_EXP2":"",n.map?"#define USE_MAP":"",n.envMap?"#define USE_ENVMAP":"",n.envMap?"#define "+u:"",n.lightMap?"#define USE_LIGHTMAP":"",n.aoMap?"#define USE_AOMAP":"",n.emissiveMap?"#define USE_EMISSIVEMAP":"",n.bumpMap?"#define USE_BUMPMAP":"",n.normalMap?"#define USE_NORMALMAP":"",n.normalMap&&n.objectSpaceNormalMap?"#define OBJECTSPACE_NORMALMAP":"",n.normalMap&&n.tangentSpaceNormalMap?"#define TANGENTSPACE_NORMALMAP":"",n.clearcoatMap?"#define USE_CLEARCOATMAP":"",n.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",n.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",n.iridescenceMap?"#define USE_IRIDESCENCEMAP":"",n.iridescenceThicknessMap?"#define USE_IRIDESCENCE_THICKNESSMAP":"",n.displacementMap&&n.supportsVertexTextures?"#define USE_DISPLACEMENTMAP":"",n.specularMap?"#define USE_SPECULARMAP":"",n.specularIntensityMap?"#define USE_SPECULARINTENSITYMAP":"",n.specularColorMap?"#define USE_SPECULARCOLORMAP":"",n.roughnessMap?"#define USE_ROUGHNESSMAP":"",n.metalnessMap?"#define USE_METALNESSMAP":"",n.alphaMap?"#define USE_ALPHAMAP":"",n.transmission?"#define USE_TRANSMISSION":"",n.transmissionMap?"#define USE_TRANSMISSIONMAP":"",n.thicknessMap?"#define USE_THICKNESSMAP":"",n.sheenColorMap?"#define USE_SHEENCOLORMAP":"",n.sheenRoughnessMap?"#define USE_SHEENROUGHNESSMAP":"",n.vertexTangents?"#define USE_TANGENT":"",n.vertexColors?"#define USE_COLOR":"",n.vertexAlphas?"#define USE_COLOR_ALPHA":"",n.vertexUvs?"#define USE_UV":"",n.uvsVertexOnly?"#define UVS_VERTEX_ONLY":"",n.flatShading?"#define FLAT_SHADED":"",n.skinning?"#define USE_SKINNING":"",n.morphTargets?"#define USE_MORPHTARGETS":"",n.morphNormals&&!1===n.flatShading?"#define USE_MORPHNORMALS":"",n.morphColors&&n.isWebGL2?"#define USE_MORPHCOLORS":"",n.morphTargetsCount>0&&n.isWebGL2?"#define MORPHTARGETS_TEXTURE":"",n.morphTargetsCount>0&&n.isWebGL2?"#define MORPHTARGETS_TEXTURE_STRIDE "+n.morphTextureStride:"",n.morphTargetsCount>0&&n.isWebGL2?"#define MORPHTARGETS_COUNT "+n.morphTargetsCount:"",n.doubleSided?"#define DOUBLE_SIDED":"",n.flipSided?"#define FLIP_SIDED":"",n.shadowMapEnabled?"#define USE_SHADOWMAP":"",n.shadowMapEnabled?"#define "+l:"",n.sizeAttenuation?"#define USE_SIZEATTENUATION":"",n.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",n.logarithmicDepthBuffer&&n.rendererExtensionFragDepth?"#define USE_LOGDEPTHBUF_EXT":"","uniform mat4 modelMatrix;","uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","uniform mat4 viewMatrix;","uniform mat3 normalMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;","#ifdef USE_INSTANCING","\tattribute mat4 instanceMatrix;","#endif","#ifdef USE_INSTANCING_COLOR","\tattribute vec3 instanceColor;","#endif","attribute vec3 position;","attribute vec3 normal;","attribute vec2 uv;","#ifdef USE_TANGENT","\tattribute vec4 tangent;","#endif","#if defined( USE_COLOR_ALPHA )","\tattribute vec4 color;","#elif defined( USE_COLOR )","\tattribute vec3 color;","#endif","#if ( defined( USE_MORPHTARGETS ) && ! defined( MORPHTARGETS_TEXTURE ) )","\tattribute vec3 morphTarget0;","\tattribute vec3 morphTarget1;","\tattribute vec3 morphTarget2;","\tattribute vec3 morphTarget3;","\t#ifdef USE_MORPHNORMALS","\t\tattribute vec3 morphNormal0;","\t\tattribute vec3 morphNormal1;","\t\tattribute vec3 morphNormal2;","\t\tattribute vec3 morphNormal3;","\t#else","\t\tattribute vec3 morphTarget4;","\t\tattribute vec3 morphTarget5;","\t\tattribute vec3 morphTarget6;","\t\tattribute vec3 morphTarget7;","\t#endif","#endif","#ifdef USE_SKINNING","\tattribute vec4 skinIndex;","\tattribute vec4 skinWeight;","#endif","\n"].filter(Eu).join("\n"),v=[f,zu(n),"#define SHADER_NAME "+n.shaderName,p,n.useFog&&n.fog?"#define USE_FOG":"",n.useFog&&n.fogExp2?"#define FOG_EXP2":"",n.map?"#define USE_MAP":"",n.matcap?"#define USE_MATCAP":"",n.envMap?"#define USE_ENVMAP":"",n.envMap?"#define "+c:"",n.envMap?"#define "+u:"",n.envMap?"#define "+h:"",d?"#define CUBEUV_TEXEL_WIDTH "+d.texelWidth:"",d?"#define CUBEUV_TEXEL_HEIGHT "+d.texelHeight:"",d?"#define CUBEUV_MAX_MIP "+d.maxMip+".0":"",n.lightMap?"#define USE_LIGHTMAP":"",n.aoMap?"#define USE_AOMAP":"",n.emissiveMap?"#define USE_EMISSIVEMAP":"",n.bumpMap?"#define USE_BUMPMAP":"",n.normalMap?"#define USE_NORMALMAP":"",n.normalMap&&n.objectSpaceNormalMap?"#define OBJECTSPACE_NORMALMAP":"",n.normalMap&&n.tangentSpaceNormalMap?"#define TANGENTSPACE_NORMALMAP":"",n.clearcoat?"#define USE_CLEARCOAT":"",n.clearcoatMap?"#define USE_CLEARCOATMAP":"",n.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",n.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",n.iridescence?"#define USE_IRIDESCENCE":"",n.iridescenceMap?"#define USE_IRIDESCENCEMAP":"",n.iridescenceThicknessMap?"#define USE_IRIDESCENCE_THICKNESSMAP":"",n.specularMap?"#define USE_SPECULARMAP":"",n.specularIntensityMap?"#define USE_SPECULARINTENSITYMAP":"",n.specularColorMap?"#define USE_SPECULARCOLORMAP":"",n.roughnessMap?"#define USE_ROUGHNESSMAP":"",n.metalnessMap?"#define USE_METALNESSMAP":"",n.alphaMap?"#define USE_ALPHAMAP":"",n.alphaTest?"#define USE_ALPHATEST":"",n.sheen?"#define USE_SHEEN":"",n.sheenColorMap?"#define USE_SHEENCOLORMAP":"",n.sheenRoughnessMap?"#define USE_SHEENROUGHNESSMAP":"",n.transmission?"#define USE_TRANSMISSION":"",n.transmissionMap?"#define USE_TRANSMISSIONMAP":"",n.thicknessMap?"#define USE_THICKNESSMAP":"",n.decodeVideoTexture?"#define DECODE_VIDEO_TEXTURE":"",n.vertexTangents?"#define USE_TANGENT":"",n.vertexColors||n.instancingColor?"#define USE_COLOR":"",n.vertexAlphas?"#define USE_COLOR_ALPHA":"",n.vertexUvs?"#define USE_UV":"",n.uvsVertexOnly?"#define UVS_VERTEX_ONLY":"",n.gradientMap?"#define USE_GRADIENTMAP":"",n.flatShading?"#define FLAT_SHADED":"",n.doubleSided?"#define DOUBLE_SIDED":"",n.flipSided?"#define FLIP_SIDED":"",n.shadowMapEnabled?"#define USE_SHADOWMAP":"",n.shadowMapEnabled?"#define "+l:"",n.premultipliedAlpha?"#define PREMULTIPLIED_ALPHA":"",n.physicallyCorrectLights?"#define PHYSICALLY_CORRECT_LIGHTS":"",n.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",n.logarithmicDepthBuffer&&n.rendererExtensionFragDepth?"#define USE_LOGDEPTHBUF_EXT":"","uniform mat4 viewMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;",n.toneMapping!==tt?"#define TONE_MAPPING":"",n.toneMapping!==tt?Tl["tonemapping_pars_fragment"]:"",n.toneMapping!==tt?_u("toneMapping",n.toneMapping):"",n.dithering?"#define DITHERING":"",n.opaque?"#define OPAQUE":"",Tl["encodings_pars_fragment"],wu("linearToOutputTexel",n.outputEncoding),n.useDepthPacking?"#define DEPTH_PACKING "+n.depthPacking:"","\n"].filter(Eu).join("\n")),o=Iu(o),o=Tu(o,n),o=Cu(o,n),a=Iu(a),a=Tu(a,n),a=Cu(a,n),o=ku(o),a=ku(a),n.isWebGL2&&!0!==n.isRawShaderMaterial&&(y="#version 300 es\n",g=["precision mediump sampler2DArray;","#define attribute in","#define varying out","#define texture2D texture"].join("\n")+"\n"+g,v=["#define varying in",n.glslVersion===gn?"":"layout(location = 0) out highp vec4 pc_fragColor;",n.glslVersion===gn?"":"#define gl_FragColor pc_fragColor","#define gl_FragDepthEXT gl_FragDepth","#define texture2D texture","#define textureCube texture","#define texture2DProj textureProj","#define texture2DLodEXT textureLod","#define texture2DProjLodEXT textureProjLod","#define textureCubeLodEXT textureLod","#define texture2DGradEXT textureGrad","#define texture2DProjGradEXT textureProjGrad","#define textureCubeGradEXT textureGrad"].join("\n")+"\n"+v);const x=y+g+o,b=y+v+a,w=gu(i,35633,x),_=gu(i,35632,b);if(i.attachShader(m,w),i.attachShader(m,_),void 0!==n.index0AttributeName?i.bindAttribLocation(m,0,n.index0AttributeName):!0===n.morphTargets&&i.bindAttribLocation(m,0,"position"),i.linkProgram(m),t.debug.checkShaderErrors){const t=i.getProgramInfoLog(m).trim(),e=i.getShaderInfoLog(w).trim(),n=i.getShaderInfoLog(_).trim();let r=!0,s=!0;if(!1===i.getProgramParameter(m,35714)){r=!1;const e=bu(i,w,"vertex"),n=bu(i,_,"fragment");console.error("THREE.WebGLProgram: Shader Error "+i.getError()+" - VALIDATE_STATUS "+i.getProgramParameter(m,35715)+"\n\nProgram Info Log: "+t+"\n"+e+"\n"+n)}else""!==t?console.warn("THREE.WebGLProgram: Program Info Log:",t):""!==e&&""!==n||(s=!1);s&&(this.diagnostics={runnable:r,programLog:t,vertexShader:{log:e,prefix:g},fragmentShader:{log:n,prefix:v}})}let M,A;return i.deleteShader(w),i.deleteShader(_),this.getUniforms=function(){return void 0===M&&(M=new mu(i,m)),M},this.getAttributes=function(){return void 0===A&&(A=Su(i,m)),A},this.destroy=function(){r.releaseStatesOfProgram(this),i.deleteProgram(m),this.program=void 0},this.name=n.shaderName,this.id=vu++,this.cacheKey=e,this.usedTimes=1,this.program=m,this.vertexShader=w,this.fragmentShader=_,this}let ju=0;class Wu{constructor(){this.shaderCache=new Map,this.materialCache=new Map}update(t){const e=t.vertexShader,n=t.fragmentShader,r=this._getShaderStage(e),i=this._getShaderStage(n),s=this._getShaderCacheForMaterial(t);return!1===s.has(r)&&(s.add(r),r.usedTimes++),!1===s.has(i)&&(s.add(i),i.usedTimes++),this}remove(t){const e=this.materialCache.get(t);for(const n of e)n.usedTimes--,0===n.usedTimes&&this.shaderCache.delete(n.code);return this.materialCache.delete(t),this}getVertexShaderID(t){return this._getShaderStage(t.vertexShader).id}getFragmentShaderID(t){return this._getShaderStage(t.fragmentShader).id}dispose(){this.shaderCache.clear(),this.materialCache.clear()}_getShaderCacheForMaterial(t){const e=this.materialCache;return!1===e.has(t)&&e.set(t,new Set),e.get(t)}_getShaderStage(t){const e=this.shaderCache;if(!1===e.has(t)){const n=new qu(t);e.set(t,n)}return e.get(t)}}class qu{constructor(t){this.id=ju++,this.code=t,this.usedTimes=0}}function Yu(t,e,n,r,i,s,o){const a=new hi,l=new Wu,c=[],u=i.isWebGL2,h=i.logarithmicDepthBuffer,d=i.vertexTextures;let f=i.precision;const p={MeshDepthMaterial:"depth",MeshDistanceMaterial:"distanceRGBA",MeshNormalMaterial:"normal",MeshBasicMaterial:"basic",MeshLambertMaterial:"lambert",MeshPhongMaterial:"phong",MeshToonMaterial:"toon",MeshStandardMaterial:"physical",MeshPhysicalMaterial:"physical",MeshMatcapMaterial:"matcap",LineBasicMaterial:"basic",LineDashedMaterial:"dashed",PointsMaterial:"points",ShadowMaterial:"shadow",SpriteMaterial:"sprite"};function m(s,a,c,m,g){const x=m.fog,b=g.geometry,w=s.isMeshStandardMaterial?m.environment:null,M=(s.isMeshStandardMaterial?n:e).get(s.envMap||w),A=M&&M.mapping===ht?M.image.height:null,S=p[s.type];null!==s.precision&&(f=i.getMaxPrecision(s.precision),f!==s.precision&&console.warn("THREE.WebGLProgram.getParameters:",s.precision,"not supported, using",f,"instead."));const E=b.morphAttributes.position||b.morphAttributes.normal||b.morphAttributes.color,T=void 0!==E?E.length:0;let C,R,I,P,L=0;if(void 0!==b.morphAttributes.position&&(L=1),void 0!==b.morphAttributes.normal&&(L=2),void 0!==b.morphAttributes.color&&(L=3),S){const t=Rl[S];C=t.vertexShader,R=t.fragmentShader}else C=s.vertexShader,R=s.fragmentShader,l.update(s),I=l.getVertexShaderID(s),P=l.getFragmentShaderID(s);const N=t.getRenderTarget(),k=s.alphaTest>0,O=s.clearcoat>0,D=s.iridescence>0,z={isWebGL2:u,shaderID:S,shaderName:s.type,vertexShader:C,fragmentShader:R,defines:s.defines,customVertexShaderID:I,customFragmentShaderID:P,isRawShaderMaterial:!0===s.isRawShaderMaterial,glslVersion:s.glslVersion,precision:f,instancing:!0===g.isInstancedMesh,instancingColor:!0===g.isInstancedMesh&&null!==g.instanceColor,supportsVertexTextures:d,outputEncoding:null===N?t.outputEncoding:!0===N.isXRRenderTarget?N.texture.encoding:ke,map:!!s.map,matcap:!!s.matcap,envMap:!!M,envMapMode:M&&M.mapping,envMapCubeUVHeight:A,lightMap:!!s.lightMap,aoMap:!!s.aoMap,emissiveMap:!!s.emissiveMap,bumpMap:!!s.bumpMap,normalMap:!!s.normalMap,objectSpaceNormalMap:s.normalMapType===Ue,tangentSpaceNormalMap:s.normalMapType===Fe,decodeVideoTexture:!!s.map&&!0===s.map.isVideoTexture&&s.map.encoding===Oe,clearcoat:O,clearcoatMap:O&&!!s.clearcoatMap,clearcoatRoughnessMap:O&&!!s.clearcoatRoughnessMap,clearcoatNormalMap:O&&!!s.clearcoatNormalMap,iridescence:D,iridescenceMap:D&&!!s.iridescenceMap,iridescenceThicknessMap:D&&!!s.iridescenceThicknessMap,displacementMap:!!s.displacementMap,roughnessMap:!!s.roughnessMap,metalnessMap:!!s.metalnessMap,specularMap:!!s.specularMap,specularIntensityMap:!!s.specularIntensityMap,specularColorMap:!!s.specularColorMap,opaque:!1===s.transparent&&s.blending===_,alphaMap:!!s.alphaMap,alphaTest:k,gradientMap:!!s.gradientMap,sheen:s.sheen>0,sheenColorMap:!!s.sheenColorMap,sheenRoughnessMap:!!s.sheenRoughnessMap,transmission:s.transmission>0,transmissionMap:!!s.transmissionMap,thicknessMap:!!s.thicknessMap,combine:s.combine,vertexTangents:!!s.normalMap&&!!b.attributes.tangent,vertexColors:s.vertexColors,vertexAlphas:!0===s.vertexColors&&!!b.attributes.color&&4===b.attributes.color.itemSize,vertexUvs:!!s.map||!!s.bumpMap||!!s.normalMap||!!s.specularMap||!!s.alphaMap||!!s.emissiveMap||!!s.roughnessMap||!!s.metalnessMap||!!s.clearcoatMap||!!s.clearcoatRoughnessMap||!!s.clearcoatNormalMap||!!s.iridescenceMap||!!s.iridescenceThicknessMap||!!s.displacementMap||!!s.transmissionMap||!!s.thicknessMap||!!s.specularIntensityMap||!!s.specularColorMap||!!s.sheenColorMap||!!s.sheenRoughnessMap,uvsVertexOnly:!(s.map||s.bumpMap||s.normalMap||s.specularMap||s.alphaMap||s.emissiveMap||s.roughnessMap||s.metalnessMap||s.clearcoatNormalMap||s.iridescenceMap||s.iridescenceThicknessMap||s.transmission>0||s.transmissionMap||s.thicknessMap||s.specularIntensityMap||s.specularColorMap||s.sheen>0||s.sheenColorMap||s.sheenRoughnessMap)&&!!s.displacementMap,fog:!!x,useFog:!0===s.fog,fogExp2:x&&x.isFogExp2,flatShading:!!s.flatShading,sizeAttenuation:s.sizeAttenuation,logarithmicDepthBuffer:h,skinning:!0===g.isSkinnedMesh,morphTargets:void 0!==b.morphAttributes.position,morphNormals:void 0!==b.morphAttributes.normal,morphColors:void 0!==b.morphAttributes.color,morphTargetsCount:T,morphTextureStride:L,numDirLights:a.directional.length,numPointLights:a.point.length,numSpotLights:a.spot.length,numRectAreaLights:a.rectArea.length,numHemiLights:a.hemi.length,numDirLightShadows:a.directionalShadowMap.length,numPointLightShadows:a.pointShadowMap.length,numSpotLightShadows:a.spotShadowMap.length,numClippingPlanes:o.numPlanes,numClipIntersection:o.numIntersection,dithering:s.dithering,shadowMapEnabled:t.shadowMap.enabled&&c.length>0,shadowMapType:t.shadowMap.type,toneMapping:s.toneMapped?t.toneMapping:tt,physicallyCorrectLights:t.physicallyCorrectLights,premultipliedAlpha:s.premultipliedAlpha,doubleSided:s.side===y,flipSided:s.side===v,useDepthPacking:!!s.depthPacking,depthPacking:s.depthPacking||0,index0AttributeName:s.index0AttributeName,extensionDerivatives:s.extensions&&s.extensions.derivatives,extensionFragDepth:s.extensions&&s.extensions.fragDepth,extensionDrawBuffers:s.extensions&&s.extensions.drawBuffers,extensionShaderTextureLOD:s.extensions&&s.extensions.shaderTextureLOD,rendererExtensionFragDepth:u||r.has("EXT_frag_depth"),rendererExtensionDrawBuffers:u||r.has("WEBGL_draw_buffers"),rendererExtensionShaderTextureLod:u||r.has("EXT_shader_texture_lod"),customProgramCacheKey:s.customProgramCacheKey()};return z}function g(e){const n=[];if(e.shaderID?n.push(e.shaderID):(n.push(e.customVertexShaderID),n.push(e.customFragmentShaderID)),void 0!==e.defines)for(const t in e.defines)n.push(t),n.push(e.defines[t]);return!1===e.isRawShaderMaterial&&(x(n,e),b(n,e),n.push(t.outputEncoding)),n.push(e.customProgramCacheKey),n.join()}function x(t,e){t.push(e.precision),t.push(e.outputEncoding),t.push(e.envMapMode),t.push(e.envMapCubeUVHeight),t.push(e.combine),t.push(e.vertexUvs),t.push(e.fogExp2),t.push(e.sizeAttenuation),t.push(e.morphTargetsCount),t.push(e.morphAttributeCount),t.push(e.numDirLights),t.push(e.numPointLights),t.push(e.numSpotLights),t.push(e.numHemiLights),t.push(e.numRectAreaLights),t.push(e.numDirLightShadows),t.push(e.numPointLightShadows),t.push(e.numSpotLightShadows),t.push(e.shadowMapType),t.push(e.toneMapping),t.push(e.numClippingPlanes),t.push(e.numClipIntersection),t.push(e.depthPacking)}function b(t,e){a.disableAll(),e.isWebGL2&&a.enable(0),e.supportsVertexTextures&&a.enable(1),e.instancing&&a.enable(2),e.instancingColor&&a.enable(3),e.map&&a.enable(4),e.matcap&&a.enable(5),e.envMap&&a.enable(6),e.lightMap&&a.enable(7),e.aoMap&&a.enable(8),e.emissiveMap&&a.enable(9),e.bumpMap&&a.enable(10),e.normalMap&&a.enable(11),e.objectSpaceNormalMap&&a.enable(12),e.tangentSpaceNormalMap&&a.enable(13),e.clearcoat&&a.enable(14),e.clearcoatMap&&a.enable(15),e.clearcoatRoughnessMap&&a.enable(16),e.clearcoatNormalMap&&a.enable(17),e.iridescence&&a.enable(18),e.iridescenceMap&&a.enable(19),e.iridescenceThicknessMap&&a.enable(20),e.displacementMap&&a.enable(21),e.specularMap&&a.enable(22),e.roughnessMap&&a.enable(23),e.metalnessMap&&a.enable(24),e.gradientMap&&a.enable(25),e.alphaMap&&a.enable(26),e.alphaTest&&a.enable(27),e.vertexColors&&a.enable(28),e.vertexAlphas&&a.enable(29),e.vertexUvs&&a.enable(30),e.vertexTangents&&a.enable(31),e.uvsVertexOnly&&a.enable(32),e.fog&&a.enable(33),t.push(a.mask),a.disableAll(),e.useFog&&a.enable(0),e.flatShading&&a.enable(1),e.logarithmicDepthBuffer&&a.enable(2),e.skinning&&a.enable(3),e.morphTargets&&a.enable(4),e.morphNormals&&a.enable(5),e.morphColors&&a.enable(6),e.premultipliedAlpha&&a.enable(7),e.shadowMapEnabled&&a.enable(8),e.physicallyCorrectLights&&a.enable(9),e.doubleSided&&a.enable(10),e.flipSided&&a.enable(11),e.useDepthPacking&&a.enable(12),e.dithering&&a.enable(13),e.specularIntensityMap&&a.enable(14),e.specularColorMap&&a.enable(15),e.transmission&&a.enable(16),e.transmissionMap&&a.enable(17),e.thicknessMap&&a.enable(18),e.sheen&&a.enable(19),e.sheenColorMap&&a.enable(20),e.sheenRoughnessMap&&a.enable(21),e.decodeVideoTexture&&a.enable(22),e.opaque&&a.enable(23),t.push(a.mask)}function w(t){const e=p[t.type];let n;if(e){const t=Rl[e];n=Is.clone(t.uniforms)}else n=t.uniforms;return n}function M(e,n){let r;for(let t=0,i=c.length;t<i;t++){const e=c[t];if(e.cacheKey===n){r=e,++r.usedTimes;break}}return void 0===r&&(r=new Vu(t,n,e,s),c.push(r)),r}function A(t){if(0===--t.usedTimes){const e=c.indexOf(t);c[e]=c[c.length-1],c.pop(),t.destroy()}}function S(t){l.remove(t)}function E(){l.dispose()}return{getParameters:m,getProgramCacheKey:g,getUniforms:w,acquireProgram:M,releaseProgram:A,releaseShaderCache:S,programs:c,dispose:E}}function Xu(){let t=new WeakMap;function e(e){let n=t.get(e);return void 0===n&&(n={},t.set(e,n)),n}function n(e){t.delete(e)}function r(e,n,r){t.get(e)[n]=r}function i(){t=new WeakMap}return{get:e,remove:n,update:r,dispose:i}}function Ju(t,e){return t.groupOrder!==e.groupOrder?t.groupOrder-e.groupOrder:t.renderOrder!==e.renderOrder?t.renderOrder-e.renderOrder:t.material.id!==e.material.id?t.material.id-e.material.id:t.z!==e.z?t.z-e.z:t.id-e.id}function Ku(t,e){return t.groupOrder!==e.groupOrder?t.groupOrder-e.groupOrder:t.renderOrder!==e.renderOrder?t.renderOrder-e.renderOrder:t.z!==e.z?e.z-t.z:t.id-e.id}function Zu(){const t=[];let e=0;const n=[],r=[],i=[];function s(){e=0,n.length=0,r.length=0,i.length=0}function o(n,r,i,s,o,a){let l=t[e];return void 0===l?(l={id:n.id,object:n,geometry:r,material:i,groupOrder:s,renderOrder:n.renderOrder,z:o,group:a},t[e]=l):(l.id=n.id,l.object=n,l.geometry=r,l.material=i,l.groupOrder=s,l.renderOrder=n.renderOrder,l.z=o,l.group=a),e++,l}function a(t,e,s,a,l,c){const u=o(t,e,s,a,l,c);s.transmission>0?r.push(u):!0===s.transparent?i.push(u):n.push(u)}function l(t,e,s,a,l,c){const u=o(t,e,s,a,l,c);s.transmission>0?r.unshift(u):!0===s.transparent?i.unshift(u):n.unshift(u)}function c(t,e){n.length>1&&n.sort(t||Ju),r.length>1&&r.sort(e||Ku),i.length>1&&i.sort(e||Ku)}function u(){for(let n=e,r=t.length;n<r;n++){const e=t[n];if(null===e.id)break;e.id=null,e.object=null,e.geometry=null,e.material=null,e.group=null}}return{opaque:n,transmissive:r,transparent:i,init:s,push:a,unshift:l,finish:u,sort:c}}function Qu(){let t=new WeakMap;function e(e,n){let r;return!1===t.has(e)?(r=new Zu,t.set(e,[r])):n>=t.get(e).length?(r=new Zu,t.get(e).push(r)):r=t.get(e)[n],r}function n(){t=new WeakMap}return{get:e,dispose:n}}function $u(){const t={};return{get:function(e){if(void 0!==t[e.id])return t[e.id];let n;switch(e.type){case"DirectionalLight":n={direction:new Mr,color:new lr};break;case"SpotLight":n={position:new Mr,direction:new Mr,color:new lr,distance:0,coneCos:0,penumbraCos:0,decay:0};break;case"PointLight":n={position:new Mr,color:new lr,distance:0,decay:0};break;case"HemisphereLight":n={direction:new Mr,skyColor:new lr,groundColor:new lr};break;case"RectAreaLight":n={color:new lr,position:new Mr,halfWidth:new Mr,halfHeight:new Mr};break}return t[e.id]=n,n}}}function th(){const t={};return{get:function(e){if(void 0!==t[e.id])return t[e.id];let n;switch(e.type){case"DirectionalLight":n={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new qn};break;case"SpotLight":n={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new qn};break;case"PointLight":n={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new qn,shadowCameraNear:1,shadowCameraFar:1e3};break}return t[e.id]=n,n}}}let eh=0;function nh(t,e){return(e.castShadow?1:0)-(t.castShadow?1:0)}function rh(t,e){const n=new $u,r=th(),i={version:0,hash:{directionalLength:-1,pointLength:-1,spotLength:-1,rectAreaLength:-1,hemiLength:-1,numDirectionalShadows:-1,numPointShadows:-1,numSpotShadows:-1},ambient:[0,0,0],probe:[],directional:[],directionalShadow:[],directionalShadowMap:[],directionalShadowMatrix:[],spot:[],spotShadow:[],spotShadowMap:[],spotShadowMatrix:[],rectArea:[],rectAreaLTC1:null,rectAreaLTC2:null,point:[],pointShadow:[],pointShadowMap:[],pointShadowMatrix:[],hemi:[]};for(let u=0;u<9;u++)i.probe.push(new Mr);const s=new Mr,o=new ti,a=new ti;function l(s,o){let a=0,l=0,c=0;for(let t=0;t<9;t++)i.probe[t].set(0,0,0);let u=0,h=0,d=0,f=0,p=0,m=0,g=0,v=0;s.sort(nh);const y=!0!==o?Math.PI:1;for(let t=0,e=s.length;t<e;t++){const e=s[t],o=e.color,x=e.intensity,b=e.distance,w=e.shadow&&e.shadow.map?e.shadow.map.texture:null;if(e.isAmbientLight)a+=o.r*x*y,l+=o.g*x*y,c+=o.b*x*y;else if(e.isLightProbe)for(let t=0;t<9;t++)i.probe[t].addScaledVector(e.sh.coefficients[t],x);else if(e.isDirectionalLight){const t=n.get(e);if(t.color.copy(e.color).multiplyScalar(e.intensity*y),e.castShadow){const t=e.shadow,n=r.get(e);n.shadowBias=t.bias,n.shadowNormalBias=t.normalBias,n.shadowRadius=t.radius,n.shadowMapSize=t.mapSize,i.directionalShadow[u]=n,i.directionalShadowMap[u]=w,i.directionalShadowMatrix[u]=e.shadow.matrix,m++}i.directional[u]=t,u++}else if(e.isSpotLight){const t=n.get(e);if(t.position.setFromMatrixPosition(e.matrixWorld),t.color.copy(o).multiplyScalar(x*y),t.distance=b,t.coneCos=Math.cos(e.angle),t.penumbraCos=Math.cos(e.angle*(1-e.penumbra)),t.decay=e.decay,e.castShadow){const t=e.shadow,n=r.get(e);n.shadowBias=t.bias,n.shadowNormalBias=t.normalBias,n.shadowRadius=t.radius,n.shadowMapSize=t.mapSize,i.spotShadow[d]=n,i.spotShadowMap[d]=w,i.spotShadowMatrix[d]=e.shadow.matrix,v++}i.spot[d]=t,d++}else if(e.isRectAreaLight){const t=n.get(e);t.color.copy(o).multiplyScalar(x),t.halfWidth.set(.5*e.width,0,0),t.halfHeight.set(0,.5*e.height,0),i.rectArea[f]=t,f++}else if(e.isPointLight){const t=n.get(e);if(t.color.copy(e.color).multiplyScalar(e.intensity*y),t.distance=e.distance,t.decay=e.decay,e.castShadow){const t=e.shadow,n=r.get(e);n.shadowBias=t.bias,n.shadowNormalBias=t.normalBias,n.shadowRadius=t.radius,n.shadowMapSize=t.mapSize,n.shadowCameraNear=t.camera.near,n.shadowCameraFar=t.camera.far,i.pointShadow[h]=n,i.pointShadowMap[h]=w,i.pointShadowMatrix[h]=e.shadow.matrix,g++}i.point[h]=t,h++}else if(e.isHemisphereLight){const t=n.get(e);t.skyColor.copy(e.color).multiplyScalar(x*y),t.groundColor.copy(e.groundColor).multiplyScalar(x*y),i.hemi[p]=t,p++}}f>0&&(e.isWebGL2||!0===t.has("OES_texture_float_linear")?(i.rectAreaLTC1=Cl.LTC_FLOAT_1,i.rectAreaLTC2=Cl.LTC_FLOAT_2):!0===t.has("OES_texture_half_float_linear")?(i.rectAreaLTC1=Cl.LTC_HALF_1,i.rectAreaLTC2=Cl.LTC_HALF_2):console.error("THREE.WebGLRenderer: Unable to use RectAreaLight. Missing WebGL extensions.")),i.ambient[0]=a,i.ambient[1]=l,i.ambient[2]=c;const x=i.hash;x.directionalLength===u&&x.pointLength===h&&x.spotLength===d&&x.rectAreaLength===f&&x.hemiLength===p&&x.numDirectionalShadows===m&&x.numPointShadows===g&&x.numSpotShadows===v||(i.directional.length=u,i.spot.length=d,i.rectArea.length=f,i.point.length=h,i.hemi.length=p,i.directionalShadow.length=m,i.directionalShadowMap.length=m,i.pointShadow.length=g,i.pointShadowMap.length=g,i.spotShadow.length=v,i.spotShadowMap.length=v,i.directionalShadowMatrix.length=m,i.pointShadowMatrix.length=g,i.spotShadowMatrix.length=v,x.directionalLength=u,x.pointLength=h,x.spotLength=d,x.rectAreaLength=f,x.hemiLength=p,x.numDirectionalShadows=m,x.numPointShadows=g,x.numSpotShadows=v,i.version=eh++)}function c(t,e){let n=0,r=0,l=0,c=0,u=0;const h=e.matrixWorldInverse;for(let d=0,f=t.length;d<f;d++){const e=t[d];if(e.isDirectionalLight){const t=i.directional[n];t.direction.setFromMatrixPosition(e.matrixWorld),s.setFromMatrixPosition(e.target.matrixWorld),t.direction.sub(s),t.direction.transformDirection(h),n++}else if(e.isSpotLight){const t=i.spot[l];t.position.setFromMatrixPosition(e.matrixWorld),t.position.applyMatrix4(h),t.direction.setFromMatrixPosition(e.matrixWorld),s.setFromMatrixPosition(e.target.matrixWorld),t.direction.sub(s),t.direction.transformDirection(h),l++}else if(e.isRectAreaLight){const t=i.rectArea[c];t.position.setFromMatrixPosition(e.matrixWorld),t.position.applyMatrix4(h),a.identity(),o.copy(e.matrixWorld),o.premultiply(h),a.extractRotation(o),t.halfWidth.set(.5*e.width,0,0),t.halfHeight.set(0,.5*e.height,0),t.halfWidth.applyMatrix4(a),t.halfHeight.applyMatrix4(a),c++}else if(e.isPointLight){const t=i.point[r];t.position.setFromMatrixPosition(e.matrixWorld),t.position.applyMatrix4(h),r++}else if(e.isHemisphereLight){const t=i.hemi[u];t.direction.setFromMatrixPosition(e.matrixWorld),t.direction.transformDirection(h),u++}}}return{setup:l,setupView:c,state:i}}function ih(t,e){const n=new rh(t,e),r=[],i=[];function s(){r.length=0,i.length=0}function o(t){r.push(t)}function a(t){i.push(t)}function l(t){n.setup(r,t)}function c(t){n.setupView(r,t)}const u={lightsArray:r,shadowsArray:i,lights:n};return{init:s,state:u,setupLights:l,setupLightsView:c,pushLight:o,pushShadow:a}}function sh(t,e){let n=new WeakMap;function r(r,i=0){let s;return!1===n.has(r)?(s=new ih(t,e),n.set(r,[s])):i>=n.get(r).length?(s=new ih(t,e),n.get(r).push(s)):s=n.get(r)[i],s}function i(){n=new WeakMap}return{get:r,dispose:i}}class oh extends Fi{constructor(t){super(),this.isMeshDepthMaterial=!0,this.type="MeshDepthMaterial",this.depthPacking=De,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.setValues(t)}copy(t){return super.copy(t),this.depthPacking=t.depthPacking,this.map=t.map,this.alphaMap=t.alphaMap,this.displacementMap=t.displacementMap,this.displacementScale=t.displacementScale,this.displacementBias=t.displacementBias,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this}}class ah extends Fi{constructor(t){super(),this.isMeshDistanceMaterial=!0,this.type="MeshDistanceMaterial",this.referencePosition=new Mr,this.nearDistance=1,this.farDistance=1e3,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.setValues(t)}copy(t){return super.copy(t),this.referencePosition.copy(t.referencePosition),this.nearDistance=t.nearDistance,this.farDistance=t.farDistance,this.map=t.map,this.alphaMap=t.alphaMap,this.displacementMap=t.displacementMap,this.displacementScale=t.displacementScale,this.displacementBias=t.displacementBias,this}}const lh="void main() {\n\tgl_Position = vec4( position, 1.0 );\n}",ch="uniform sampler2D shadow_pass;\nuniform vec2 resolution;\nuniform float radius;\n#include <packing>\nvoid main() {\n\tconst float samples = float( VSM_SAMPLES );\n\tfloat mean = 0.0;\n\tfloat squared_mean = 0.0;\n\tfloat uvStride = samples <= 1.0 ? 0.0 : 2.0 / ( samples - 1.0 );\n\tfloat uvStart = samples <= 1.0 ? 0.0 : - 1.0;\n\tfor ( float i = 0.0; i < samples; i ++ ) {\n\t\tfloat uvOffset = uvStart + i * uvStride;\n\t\t#ifdef HORIZONTAL_PASS\n\t\t\tvec2 distribution = unpackRGBATo2Half( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( uvOffset, 0.0 ) * radius ) / resolution ) );\n\t\t\tmean += distribution.x;\n\t\t\tsquared_mean += distribution.y * distribution.y + distribution.x * distribution.x;\n\t\t#else\n\t\t\tfloat depth = unpackRGBAToDepth( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( 0.0, uvOffset ) * radius ) / resolution ) );\n\t\t\tmean += depth;\n\t\t\tsquared_mean += depth * depth;\n\t\t#endif\n\t}\n\tmean = mean / samples;\n\tsquared_mean = squared_mean / samples;\n\tfloat std_dev = sqrt( squared_mean - mean * mean );\n\tgl_FragColor = pack2HalfToRGBA( vec2( mean, std_dev ) );\n}";function uh(t,e,n){let r=new Ys;const i=new qn,s=new qn,o=new mr,a=new oh({depthPacking:ze}),l=new ah,c={},u=n.maxTextureSize,h={0:v,1:g,2:y},d=new Ns({defines:{VSM_SAMPLES:8},uniforms:{shadow_pass:{value:null},resolution:{value:new qn},radius:{value:4}},vertexShader:lh,fragmentShader:ch}),p=d.clone();p.defines.HORIZONTAL_PASS=1;const x=new os;x.setAttribute("position",new Hi(new Float32Array([-1,-1,.5,3,-1,.5,-1,3,.5]),3));const b=new As(x,d),_=this;function M(n,r){const i=e.update(b);d.defines.VSM_SAMPLES!==n.blurSamples&&(d.defines.VSM_SAMPLES=n.blurSamples,p.defines.VSM_SAMPLES=n.blurSamples,d.needsUpdate=!0,p.needsUpdate=!0),d.uniforms.shadow_pass.value=n.map.texture,d.uniforms.resolution.value=n.mapSize,d.uniforms.radius.value=n.radius,t.setRenderTarget(n.mapPass),t.clear(),t.renderBufferDirect(r,null,i,d,b,null),p.uniforms.shadow_pass.value=n.mapPass.texture,p.uniforms.resolution.value=n.mapSize,p.uniforms.radius.value=n.radius,t.setRenderTarget(n.map),t.clear(),t.renderBufferDirect(r,null,i,p,b,null)}function A(e,n,r,i,s,o){let u=null;const d=!0===r.isPointLight?e.customDistanceMaterial:e.customDepthMaterial;if(u=void 0!==d?d:!0===r.isPointLight?l:a,t.localClippingEnabled&&!0===n.clipShadows&&0!==n.clippingPlanes.length||n.displacementMap&&0!==n.displacementScale||n.alphaMap&&n.alphaTest>0){const t=u.uuid,e=n.uuid;let r=c[t];void 0===r&&(r={},c[t]=r);let i=r[e];void 0===i&&(i=u.clone(),r[e]=i),u=i}return u.visible=n.visible,u.wireframe=n.wireframe,u.side=o===m?null!==n.shadowSide?n.shadowSide:n.side:null!==n.shadowSide?n.shadowSide:h[n.side],u.alphaMap=n.alphaMap,u.alphaTest=n.alphaTest,u.clipShadows=n.clipShadows,u.clippingPlanes=n.clippingPlanes,u.clipIntersection=n.clipIntersection,u.displacementMap=n.displacementMap,u.displacementScale=n.displacementScale,u.displacementBias=n.displacementBias,u.wireframeLinewidth=n.wireframeLinewidth,u.linewidth=n.linewidth,!0===r.isPointLight&&!0===u.isMeshDistanceMaterial&&(u.referencePosition.setFromMatrixPosition(r.matrixWorld),u.nearDistance=i,u.farDistance=s),u}function S(n,i,s,o,a){if(!1===n.visible)return;const l=n.layers.test(i.layers);if(l&&(n.isMesh||n.isLine||n.isPoints)&&(n.castShadow||n.receiveShadow&&a===m)&&(!n.frustumCulled||r.intersectsObject(n))){n.modelViewMatrix.multiplyMatrices(s.matrixWorldInverse,n.matrixWorld);const r=e.update(n),i=n.material;if(Array.isArray(i)){const e=r.groups;for(let l=0,c=e.length;l<c;l++){const c=e[l],u=i[c.materialIndex];if(u&&u.visible){const e=A(n,u,o,s.near,s.far,a);t.renderBufferDirect(s,null,r,e,n,c)}}}else if(i.visible){const e=A(n,i,o,s.near,s.far,a);t.renderBufferDirect(s,null,r,e,n,null)}}const c=n.children;for(let t=0,e=c.length;t<e;t++)S(c[t],i,s,o,a)}this.enabled=!1,this.autoUpdate=!0,this.needsUpdate=!1,this.type=f,this.render=function(e,n,a){if(!1===_.enabled)return;if(!1===_.autoUpdate&&!1===_.needsUpdate)return;if(0===e.length)return;const l=t.getRenderTarget(),c=t.getActiveCubeFace(),h=t.getActiveMipmapLevel(),d=t.state;d.setBlending(w),d.buffers.color.setClear(1,1,1,1),d.buffers.depth.setTest(!0),d.setScissorTest(!1);for(let f=0,p=e.length;f<p;f++){const l=e[f],c=l.shadow;if(void 0===c){console.warn("THREE.WebGLShadowMap:",l,"has no shadow.");continue}if(!1===c.autoUpdate&&!1===c.needsUpdate)continue;i.copy(c.mapSize);const h=c.getFrameExtents();if(i.multiply(h),s.copy(c.mapSize),(i.x>u||i.y>u)&&(i.x>u&&(s.x=Math.floor(u/h.x),i.x=s.x*h.x,c.mapSize.x=s.x),i.y>u&&(s.y=Math.floor(u/h.y),i.y=s.y*h.y,c.mapSize.y=s.y)),null!==c.map||c.isPointLightShadow||this.type!==m||(c.map=new gr(i.x,i.y),c.map.texture.name=l.name+".shadowMap",c.mapPass=new gr(i.x,i.y),c.camera.updateProjectionMatrix()),null===c.map){const t={minFilter:mt,magFilter:mt,format:Ft};c.map=new gr(i.x,i.y,t),c.map.texture.name=l.name+".shadowMap",c.camera.updateProjectionMatrix()}t.setRenderTarget(c.map),t.clear();const p=c.getViewportCount();for(let t=0;t<p;t++){const e=c.getViewport(t);o.set(s.x*e.x,s.y*e.y,s.x*e.z,s.y*e.w),d.viewport(o),c.updateMatrices(l,t),r=c.getFrustum(),S(n,a,c.camera,l,this.type)}c.isPointLightShadow||this.type!==m||M(c,a),c.needsUpdate=!1}_.needsUpdate=!1,t.setRenderTarget(l,c,h)}}function hh(t,e,n){const r=n.isWebGL2;function i(){let e=!1;const n=new mr;let r=null;const i=new mr(0,0,0,0);return{setMask:function(n){r===n||e||(t.colorMask(n,n,n,n),r=n)},setLocked:function(t){e=t},setClear:function(e,r,s,o,a){!0===a&&(e*=o,r*=o,s*=o),n.set(e,r,s,o),!1===i.equals(n)&&(t.clearColor(e,r,s,o),i.copy(n))},reset:function(){e=!1,r=null,i.set(-1,0,0,0)}}}function s(){let e=!1,n=null,r=null,i=null;return{setTest:function(t){t?_t(2929):Mt(2929)},setMask:function(r){n===r||e||(t.depthMask(r),n=r)},setFunc:function(e){if(r!==e){if(e)switch(e){case V:t.depthFunc(512);break;case j:t.depthFunc(519);break;case W:t.depthFunc(513);break;case q:t.depthFunc(515);break;case Y:t.depthFunc(514);break;case X:t.depthFunc(518);break;case J:t.depthFunc(516);break;case K:t.depthFunc(517);break;default:t.depthFunc(515)}else t.depthFunc(515);r=e}},setLocked:function(t){e=t},setClear:function(e){i!==e&&(t.clearDepth(e),i=e)},reset:function(){e=!1,n=null,r=null,i=null}}}function o(){let e=!1,n=null,r=null,i=null,s=null,o=null,a=null,l=null,c=null;return{setTest:function(t){e||(t?_t(2960):Mt(2960))},setMask:function(r){n===r||e||(t.stencilMask(r),n=r)},setFunc:function(e,n,o){r===e&&i===n&&s===o||(t.stencilFunc(e,n,o),r=e,i=n,s=o)},setOp:function(e,n,r){o===e&&a===n&&l===r||(t.stencilOp(e,n,r),o=e,a=n,l=r)},setLocked:function(t){e=t},setClear:function(e){c!==e&&(t.clearStencil(e),c=e)},reset:function(){e=!1,n=null,r=null,i=null,s=null,o=null,a=null,l=null,c=null}}}const a=new i,h=new s,d=new o;let f={},p={},m=new WeakMap,g=[],x=null,b=!1,Z=null,Q=null,$=null,tt=null,et=null,nt=null,rt=null,it=!1,st=null,ot=null,at=null,lt=null,ct=null;const ut=t.getParameter(35661);let ht=!1,dt=0;const ft=t.getParameter(7938);-1!==ft.indexOf("WebGL")?(dt=parseFloat(/^WebGL (\d)/.exec(ft)[1]),ht=dt>=1):-1!==ft.indexOf("OpenGL ES")&&(dt=parseFloat(/^OpenGL ES (\d)/.exec(ft)[1]),ht=dt>=2);let pt=null,mt={};const gt=t.getParameter(3088),vt=t.getParameter(2978),yt=(new mr).fromArray(gt),xt=(new mr).fromArray(vt);function bt(e,n,r){const i=new Uint8Array(4),s=t.createTexture();t.bindTexture(e,s),t.texParameteri(e,10241,9728),t.texParameteri(e,10240,9728);for(let o=0;o<r;o++)t.texImage2D(n+o,0,6408,1,1,0,6408,5121,i);return s}const wt={};function _t(e){!0!==f[e]&&(t.enable(e),f[e]=!0)}function Mt(e){!1!==f[e]&&(t.disable(e),f[e]=!1)}function At(e,n){return p[e]!==n&&(t.bindFramebuffer(e,n),p[e]=n,r&&(36009===e&&(p[36160]=n),36160===e&&(p[36009]=n)),!0)}function St(r,i){let s=g,o=!1;if(r)if(s=m.get(i),void 0===s&&(s=[],m.set(i,s)),r.isWebGLMultipleRenderTargets){const t=r.texture;if(s.length!==t.length||36064!==s[0]){for(let e=0,n=t.length;e<n;e++)s[e]=36064+e;s.length=t.length,o=!0}}else 36064!==s[0]&&(s[0]=36064,o=!0);else 1029!==s[0]&&(s[0]=1029,o=!0);o&&(n.isWebGL2?t.drawBuffers(s):e.get("WEBGL_draw_buffers").drawBuffersWEBGL(s))}function Et(e){return x!==e&&(t.useProgram(e),x=e,!0)}wt[3553]=bt(3553,3553,1),wt[34067]=bt(34067,34069,6),a.setClear(0,0,0,1),h.setClear(1),d.setClear(0),_t(2929),h.setFunc(q),Pt(!1),Lt(c),_t(2884),Rt(w);const Tt={[T]:32774,[C]:32778,[R]:32779};if(r)Tt[I]=32775,Tt[P]=32776;else{const t=e.get("EXT_blend_minmax");null!==t&&(Tt[I]=t.MIN_EXT,Tt[P]=t.MAX_EXT)}const Ct={[L]:0,[N]:1,[k]:768,[D]:770,[H]:776,[B]:774,[F]:772,[O]:769,[z]:771,[G]:775,[U]:773};function Rt(e,n,r,i,s,o,a,l){if(e!==w){if(!1===b&&(_t(3042),b=!0),e===E)s=s||n,o=o||r,a=a||i,n===Q&&s===et||(t.blendEquationSeparate(Tt[n],Tt[s]),Q=n,et=s),r===$&&i===tt&&o===nt&&a===rt||(t.blendFuncSeparate(Ct[r],Ct[i],Ct[o],Ct[a]),$=r,tt=i,nt=o,rt=a),Z=e,it=null;else if(e!==Z||l!==it){if(Q===T&&et===T||(t.blendEquation(32774),Q=T,et=T),l)switch(e){case _:t.blendFuncSeparate(1,771,1,771);break;case M:t.blendFunc(1,1);break;case A:t.blendFuncSeparate(0,769,0,1);break;case S:t.blendFuncSeparate(0,768,0,770);break;default:console.error("THREE.WebGLState: Invalid blending: ",e);break}else switch(e){case _:t.blendFuncSeparate(770,771,1,771);break;case M:t.blendFunc(770,1);break;case A:t.blendFuncSeparate(0,769,0,1);break;case S:t.blendFunc(0,768);break;default:console.error("THREE.WebGLState: Invalid blending: ",e);break}$=null,tt=null,nt=null,rt=null,Z=e,it=l}}else!0===b&&(Mt(3042),b=!1)}function It(t,e){t.side===y?Mt(2884):_t(2884);let n=t.side===v;e&&(n=!n),Pt(n),t.blending===_&&!1===t.transparent?Rt(w):Rt(t.blending,t.blendEquation,t.blendSrc,t.blendDst,t.blendEquationAlpha,t.blendSrcAlpha,t.blendDstAlpha,t.premultipliedAlpha),h.setFunc(t.depthFunc),h.setTest(t.depthTest),h.setMask(t.depthWrite),a.setMask(t.colorWrite);const r=t.stencilWrite;d.setTest(r),r&&(d.setMask(t.stencilWriteMask),d.setFunc(t.stencilFunc,t.stencilRef,t.stencilFuncMask),d.setOp(t.stencilFail,t.stencilZFail,t.stencilZPass)),kt(t.polygonOffset,t.polygonOffsetFactor,t.polygonOffsetUnits),!0===t.alphaToCoverage?_t(32926):Mt(32926)}function Pt(e){st!==e&&(e?t.frontFace(2304):t.frontFace(2305),st=e)}function Lt(e){e!==l?(_t(2884),e!==ot&&(e===c?t.cullFace(1029):e===u?t.cullFace(1028):t.cullFace(1032))):Mt(2884),ot=e}function Nt(e){e!==at&&(ht&&t.lineWidth(e),at=e)}function kt(e,n,r){e?(_t(32823),lt===n&&ct===r||(t.polygonOffset(n,r),lt=n,ct=r)):Mt(32823)}function Ot(t){t?_t(3089):Mt(3089)}function Dt(e){void 0===e&&(e=33984+ut-1),pt!==e&&(t.activeTexture(e),pt=e)}function zt(e,n){null===pt&&Dt();let r=mt[pt];void 0===r&&(r={type:void 0,texture:void 0},mt[pt]=r),r.type===e&&r.texture===n||(t.bindTexture(e,n||wt[e]),r.type=e,r.texture=n)}function Ft(){const e=mt[pt];void 0!==e&&void 0!==e.type&&(t.bindTexture(e.type,null),e.type=void 0,e.texture=void 0)}function Ut(){try{t.compressedTexImage2D.apply(t,arguments)}catch(e){console.error("THREE.WebGLState:",e)}}function Bt(){try{t.texSubImage2D.apply(t,arguments)}catch(e){console.error("THREE.WebGLState:",e)}}function Gt(){try{t.texSubImage3D.apply(t,arguments)}catch(e){console.error("THREE.WebGLState:",e)}}function Ht(){try{t.compressedTexSubImage2D.apply(t,arguments)}catch(e){console.error("THREE.WebGLState:",e)}}function Vt(){try{t.texStorage2D.apply(t,arguments)}catch(e){console.error("THREE.WebGLState:",e)}}function jt(){try{t.texStorage3D.apply(t,arguments)}catch(e){console.error("THREE.WebGLState:",e)}}function Wt(){try{t.texImage2D.apply(t,arguments)}catch(e){console.error("THREE.WebGLState:",e)}}function qt(){try{t.texImage3D.apply(t,arguments)}catch(e){console.error("THREE.WebGLState:",e)}}function Yt(e){!1===yt.equals(e)&&(t.scissor(e.x,e.y,e.z,e.w),yt.copy(e))}function Xt(e){!1===xt.equals(e)&&(t.viewport(e.x,e.y,e.z,e.w),xt.copy(e))}function Jt(){t.disable(3042),t.disable(2884),t.disable(2929),t.disable(32823),t.disable(3089),t.disable(2960),t.disable(32926),t.blendEquation(32774),t.blendFunc(1,0),t.blendFuncSeparate(1,0,1,0),t.colorMask(!0,!0,!0,!0),t.clearColor(0,0,0,0),t.depthMask(!0),t.depthFunc(513),t.clearDepth(1),t.stencilMask(4294967295),t.stencilFunc(519,0,4294967295),t.stencilOp(7680,7680,7680),t.clearStencil(0),t.cullFace(1029),t.frontFace(2305),t.polygonOffset(0,0),t.activeTexture(33984),t.bindFramebuffer(36160,null),!0===r&&(t.bindFramebuffer(36009,null),t.bindFramebuffer(36008,null)),t.useProgram(null),t.lineWidth(1),t.scissor(0,0,t.canvas.width,t.canvas.height),t.viewport(0,0,t.canvas.width,t.canvas.height),f={},pt=null,mt={},p={},m=new WeakMap,g=[],x=null,b=!1,Z=null,Q=null,$=null,tt=null,et=null,nt=null,rt=null,it=!1,st=null,ot=null,at=null,lt=null,ct=null,yt.set(0,0,t.canvas.width,t.canvas.height),xt.set(0,0,t.canvas.width,t.canvas.height),a.reset(),h.reset(),d.reset()}return{buffers:{color:a,depth:h,stencil:d},enable:_t,disable:Mt,bindFramebuffer:At,drawBuffers:St,useProgram:Et,setBlending:Rt,setMaterial:It,setFlipSided:Pt,setCullFace:Lt,setLineWidth:Nt,setPolygonOffset:kt,setScissorTest:Ot,activeTexture:Dt,bindTexture:zt,unbindTexture:Ft,compressedTexImage2D:Ut,texImage2D:Wt,texImage3D:qt,texStorage2D:Vt,texStorage3D:jt,texSubImage2D:Bt,texSubImage3D:Gt,compressedTexSubImage2D:Ht,scissor:Yt,viewport:Xt,reset:Jt}}function dh(t,e,n,r,i,s,o){const a=i.isWebGL2,l=i.maxTextures,c=i.maxCubemapSize,u=i.maxTextureSize,h=i.maxSamples,d=e.has("WEBGL_multisampled_render_to_texture")?e.get("WEBGL_multisampled_render_to_texture"):null,f=/OculusBrowser/g.test(navigator.userAgent),p=new WeakMap;let m;const g=new WeakMap;let v=!1;try{v="undefined"!==typeof OffscreenCanvas&&null!==new OffscreenCanvas(1,1).getContext("2d")}catch(it){}function y(t,e){return v?new OffscreenCanvas(t,e):Zn("canvas")}function x(t,e,n,r){let i=1;if((t.width>r||t.height>r)&&(i=r/Math.max(t.width,t.height)),i<1||!0===e){if("undefined"!==typeof HTMLImageElement&&t instanceof HTMLImageElement||"undefined"!==typeof HTMLCanvasElement&&t instanceof HTMLCanvasElement||"undefined"!==typeof ImageBitmap&&t instanceof ImageBitmap){const r=e?Gn:Math.floor,s=r(i*t.width),o=r(i*t.height);void 0===m&&(m=y(s,o));const a=n?y(s,o):m;a.width=s,a.height=o;const l=a.getContext("2d");return l.drawImage(t,0,0,s,o),console.warn("THREE.WebGLRenderer: Texture has been resized from ("+t.width+"x"+t.height+") to ("+s+"x"+o+")."),a}return"data"in t&&console.warn("THREE.WebGLRenderer: Image in DataTexture is too big ("+t.width+"x"+t.height+")."),t}return t}function b(t){return Un(t.width)&&Un(t.height)}function w(t){return!a&&(t.wrapS!==ft||t.wrapT!==ft||t.minFilter!==mt&&t.minFilter!==bt)}function _(t,e){return t.generateMipmaps&&e&&t.minFilter!==mt&&t.minFilter!==bt}function M(e){t.generateMipmap(e)}function A(n,r,i,s,o=!1){if(!1===a)return r;if(null!==n){if(void 0!==t[n])return t[n];console.warn("THREE.WebGLRenderer: Attempt to use non-existing WebGL internal format '"+n+"'")}let l=r;return 6403===r&&(5126===i&&(l=33326),5131===i&&(l=33325),5121===i&&(l=33321)),33319===r&&(5126===i&&(l=33328),5131===i&&(l=33327),5121===i&&(l=33323)),6408===r&&(5126===i&&(l=34836),5131===i&&(l=34842),5121===i&&(l=s===Oe&&!1===o?35907:32856),32819===i&&(l=32854),32820===i&&(l=32855)),33325!==l&&33326!==l&&33327!==l&&33328!==l&&34842!==l&&34836!==l||e.get("EXT_color_buffer_float"),l}function S(t,e,n){return!0===_(t,n)||t.isFramebufferTexture&&t.minFilter!==mt&&t.minFilter!==bt?Math.log2(Math.max(e.width,e.height))+1:void 0!==t.mipmaps&&t.mipmaps.length>0?t.mipmaps.length:t.isCompressedTexture&&Array.isArray(t.image)?e.mipmaps.length:1}function E(t){return t===mt||t===gt||t===yt?9728:9729}function T(t){const e=t.target;e.removeEventListener("dispose",T),R(e),e.isVideoTexture&&p.delete(e)}function C(t){const e=t.target;e.removeEventListener("dispose",C),P(e)}function R(t){const e=r.get(t);if(void 0===e.__webglInit)return;const n=t.source,i=g.get(n);if(i){const r=i[e.__cacheKey];r.usedTimes--,0===r.usedTimes&&I(t),0===Object.keys(i).length&&g.delete(n)}r.remove(t)}function I(e){const n=r.get(e);t.deleteTexture(n.__webglTexture);const i=e.source,s=g.get(i);delete s[n.__cacheKey],o.memory.textures--}function P(e){const n=e.texture,i=r.get(e),s=r.get(n);if(void 0!==s.__webglTexture&&(t.deleteTexture(s.__webglTexture),o.memory.textures--),e.depthTexture&&e.depthTexture.dispose(),e.isWebGLCubeRenderTarget)for(let r=0;r<6;r++)t.deleteFramebuffer(i.__webglFramebuffer[r]),i.__webglDepthbuffer&&t.deleteRenderbuffer(i.__webglDepthbuffer[r]);else{if(t.deleteFramebuffer(i.__webglFramebuffer),i.__webglDepthbuffer&&t.deleteRenderbuffer(i.__webglDepthbuffer),i.__webglMultisampledFramebuffer&&t.deleteFramebuffer(i.__webglMultisampledFramebuffer),i.__webglColorRenderbuffer)for(let e=0;e<i.__webglColorRenderbuffer.length;e++)i.__webglColorRenderbuffer[e]&&t.deleteRenderbuffer(i.__webglColorRenderbuffer[e]);i.__webglDepthRenderbuffer&&t.deleteRenderbuffer(i.__webglDepthRenderbuffer)}if(e.isWebGLMultipleRenderTargets)for(let a=0,l=n.length;a<l;a++){const e=r.get(n[a]);e.__webglTexture&&(t.deleteTexture(e.__webglTexture),o.memory.textures--),r.remove(n[a])}r.remove(n),r.remove(e)}let L=0;function N(){L=0}function k(){const t=L;return t>=l&&console.warn("THREE.WebGLTextures: Trying to use "+t+" texture units while this GPU supports only "+l),L+=1,t}function O(t){const e=[];return e.push(t.wrapS),e.push(t.wrapT),e.push(t.magFilter),e.push(t.minFilter),e.push(t.anisotropy),e.push(t.internalFormat),e.push(t.format),e.push(t.type),e.push(t.generateMipmaps),e.push(t.premultiplyAlpha),e.push(t.flipY),e.push(t.unpackAlignment),e.push(t.encoding),e.join()}function D(t,e){const i=r.get(t);if(t.isVideoTexture&&nt(t),!1===t.isRenderTargetTexture&&t.version>0&&i.__version!==t.version){const n=t.image;if(null===n)console.warn("THREE.WebGLRenderer: Texture marked for update but no image data found.");else{if(!1!==n.complete)return void j(i,t,e);console.warn("THREE.WebGLRenderer: Texture marked for update but image is incomplete")}}n.activeTexture(33984+e),n.bindTexture(3553,i.__webglTexture)}function z(t,e){const i=r.get(t);t.version>0&&i.__version!==t.version?j(i,t,e):(n.activeTexture(33984+e),n.bindTexture(35866,i.__webglTexture))}function F(t,e){const i=r.get(t);t.version>0&&i.__version!==t.version?j(i,t,e):(n.activeTexture(33984+e),n.bindTexture(32879,i.__webglTexture))}function U(t,e){const i=r.get(t);t.version>0&&i.__version!==t.version?W(i,t,e):(n.activeTexture(33984+e),n.bindTexture(34067,i.__webglTexture))}const B={[dt]:10497,[ft]:33071,[pt]:33648},G={[mt]:9728,[gt]:9984,[yt]:9986,[bt]:9729,[wt]:9985,[Mt]:9987};function H(n,s,o){if(o?(t.texParameteri(n,10242,B[s.wrapS]),t.texParameteri(n,10243,B[s.wrapT]),32879!==n&&35866!==n||t.texParameteri(n,32882,B[s.wrapR]),t.texParameteri(n,10240,G[s.magFilter]),t.texParameteri(n,10241,G[s.minFilter])):(t.texParameteri(n,10242,33071),t.texParameteri(n,10243,33071),32879!==n&&35866!==n||t.texParameteri(n,32882,33071),s.wrapS===ft&&s.wrapT===ft||console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.wrapS and Texture.wrapT should be set to THREE.ClampToEdgeWrapping."),t.texParameteri(n,10240,E(s.magFilter)),t.texParameteri(n,10241,E(s.minFilter)),s.minFilter!==mt&&s.minFilter!==bt&&console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.minFilter should be set to THREE.NearestFilter or THREE.LinearFilter.")),!0===e.has("EXT_texture_filter_anisotropic")){const o=e.get("EXT_texture_filter_anisotropic");if(s.type===Pt&&!1===e.has("OES_texture_float_linear"))return;if(!1===a&&s.type===Lt&&!1===e.has("OES_texture_half_float_linear"))return;(s.anisotropy>1||r.get(s).__currentAnisotropy)&&(t.texParameterf(n,o.TEXTURE_MAX_ANISOTROPY_EXT,Math.min(s.anisotropy,i.getMaxAnisotropy())),r.get(s).__currentAnisotropy=s.anisotropy)}}function V(e,n){let r=!1;void 0===e.__webglInit&&(e.__webglInit=!0,n.addEventListener("dispose",T));const i=n.source;let s=g.get(i);void 0===s&&(s={},g.set(i,s));const a=O(n);if(a!==e.__cacheKey){void 0===s[a]&&(s[a]={texture:t.createTexture(),usedTimes:0},o.memory.textures++,r=!0),s[a].usedTimes++;const i=s[e.__cacheKey];void 0!==i&&(s[e.__cacheKey].usedTimes--,0===i.usedTimes&&I(n)),e.__cacheKey=a,e.__webglTexture=s[a].texture}return r}function j(e,r,i){let o=3553;r.isDataArrayTexture&&(o=35866),r.isData3DTexture&&(o=32879);const l=V(e,r),c=r.source;if(n.activeTexture(33984+i),n.bindTexture(o,e.__webglTexture),c.version!==c.__currentVersion||!0===l){t.pixelStorei(37440,r.flipY),t.pixelStorei(37441,r.premultiplyAlpha),t.pixelStorei(3317,r.unpackAlignment),t.pixelStorei(37443,0);const e=w(r)&&!1===b(r.image);let i=x(r.image,e,!1,u);i=rt(r,i);const h=b(i)||a,d=s.convert(r.format,r.encoding);let f,p=s.convert(r.type),m=A(r.internalFormat,d,p,r.encoding,r.isVideoTexture);H(o,r,h);const g=r.mipmaps,v=a&&!0!==r.isVideoTexture,y=void 0===c.__currentVersion||!0===l,E=S(r,i,h);if(r.isDepthTexture)m=6402,a?m=r.type===Pt?36012:r.type===It?33190:r.type===Ot?35056:33189:r.type===Pt&&console.error("WebGLRenderer: Floating point depth texture requires WebGL2."),r.format===Gt&&6402===m&&r.type!==Ct&&r.type!==It&&(console.warn("THREE.WebGLRenderer: Use UnsignedShortType or UnsignedIntType for DepthFormat DepthTexture."),r.type=It,p=s.convert(r.type)),r.format===Ht&&6402===m&&(m=34041,r.type!==Ot&&(console.warn("THREE.WebGLRenderer: Use UnsignedInt248Type for DepthStencilFormat DepthTexture."),r.type=Ot,p=s.convert(r.type))),y&&(v?n.texStorage2D(3553,1,m,i.width,i.height):n.texImage2D(3553,0,m,i.width,i.height,0,d,p,null));else if(r.isDataTexture)if(g.length>0&&h){v&&y&&n.texStorage2D(3553,E,m,g[0].width,g[0].height);for(let t=0,e=g.length;t<e;t++)f=g[t],v?n.texSubImage2D(3553,t,0,0,f.width,f.height,d,p,f.data):n.texImage2D(3553,t,m,f.width,f.height,0,d,p,f.data);r.generateMipmaps=!1}else v?(y&&n.texStorage2D(3553,E,m,i.width,i.height),n.texSubImage2D(3553,0,0,0,i.width,i.height,d,p,i.data)):n.texImage2D(3553,0,m,i.width,i.height,0,d,p,i.data);else if(r.isCompressedTexture){v&&y&&n.texStorage2D(3553,E,m,g[0].width,g[0].height);for(let t=0,e=g.length;t<e;t++)f=g[t],r.format!==Ft?null!==d?v?n.compressedTexSubImage2D(3553,t,0,0,f.width,f.height,d,f.data):n.compressedTexImage2D(3553,t,m,f.width,f.height,0,f.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):v?n.texSubImage2D(3553,t,0,0,f.width,f.height,d,p,f.data):n.texImage2D(3553,t,m,f.width,f.height,0,d,p,f.data)}else if(r.isDataArrayTexture)v?(y&&n.texStorage3D(35866,E,m,i.width,i.height,i.depth),n.texSubImage3D(35866,0,0,0,0,i.width,i.height,i.depth,d,p,i.data)):n.texImage3D(35866,0,m,i.width,i.height,i.depth,0,d,p,i.data);else if(r.isData3DTexture)v?(y&&n.texStorage3D(32879,E,m,i.width,i.height,i.depth),n.texSubImage3D(32879,0,0,0,0,i.width,i.height,i.depth,d,p,i.data)):n.texImage3D(32879,0,m,i.width,i.height,i.depth,0,d,p,i.data);else if(r.isFramebufferTexture){if(y)if(v)n.texStorage2D(3553,E,m,i.width,i.height);else{let t=i.width,e=i.height;for(let r=0;r<E;r++)n.texImage2D(3553,r,m,t,e,0,d,p,null),t>>=1,e>>=1}}else if(g.length>0&&h){v&&y&&n.texStorage2D(3553,E,m,g[0].width,g[0].height);for(let t=0,e=g.length;t<e;t++)f=g[t],v?n.texSubImage2D(3553,t,0,0,d,p,f):n.texImage2D(3553,t,m,d,p,f);r.generateMipmaps=!1}else v?(y&&n.texStorage2D(3553,E,m,i.width,i.height),n.texSubImage2D(3553,0,0,0,d,p,i)):n.texImage2D(3553,0,m,d,p,i);_(r,h)&&M(o),c.__currentVersion=c.version,r.onUpdate&&r.onUpdate(r)}e.__version=r.version}function W(e,r,i){if(6!==r.image.length)return;const o=V(e,r),l=r.source;if(n.activeTexture(33984+i),n.bindTexture(34067,e.__webglTexture),l.version!==l.__currentVersion||!0===o){t.pixelStorei(37440,r.flipY),t.pixelStorei(37441,r.premultiplyAlpha),t.pixelStorei(3317,r.unpackAlignment),t.pixelStorei(37443,0);const e=r.isCompressedTexture||r.image[0].isCompressedTexture,i=r.image[0]&&r.image[0].isDataTexture,u=[];for(let t=0;t<6;t++)u[t]=e||i?i?r.image[t].image:r.image[t]:x(r.image[t],!1,!0,c),u[t]=rt(r,u[t]);const h=u[0],d=b(h)||a,f=s.convert(r.format,r.encoding),p=s.convert(r.type),m=A(r.internalFormat,f,p,r.encoding),g=a&&!0!==r.isVideoTexture,v=void 0===l.__currentVersion||!0===o;let y,w=S(r,h,d);if(H(34067,r,d),e){g&&v&&n.texStorage2D(34067,w,m,h.width,h.height);for(let t=0;t<6;t++){y=u[t].mipmaps;for(let e=0;e<y.length;e++){const i=y[e];r.format!==Ft?null!==f?g?n.compressedTexSubImage2D(34069+t,e,0,0,i.width,i.height,f,i.data):n.compressedTexImage2D(34069+t,e,m,i.width,i.height,0,i.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .setTextureCube()"):g?n.texSubImage2D(34069+t,e,0,0,i.width,i.height,f,p,i.data):n.texImage2D(34069+t,e,m,i.width,i.height,0,f,p,i.data)}}}else{y=r.mipmaps,g&&v&&(y.length>0&&w++,n.texStorage2D(34067,w,m,u[0].width,u[0].height));for(let t=0;t<6;t++)if(i){g?n.texSubImage2D(34069+t,0,0,0,u[t].width,u[t].height,f,p,u[t].data):n.texImage2D(34069+t,0,m,u[t].width,u[t].height,0,f,p,u[t].data);for(let e=0;e<y.length;e++){const r=y[e],i=r.image[t].image;g?n.texSubImage2D(34069+t,e+1,0,0,i.width,i.height,f,p,i.data):n.texImage2D(34069+t,e+1,m,i.width,i.height,0,f,p,i.data)}}else{g?n.texSubImage2D(34069+t,0,0,0,f,p,u[t]):n.texImage2D(34069+t,0,m,f,p,u[t]);for(let e=0;e<y.length;e++){const r=y[e];g?n.texSubImage2D(34069+t,e+1,0,0,f,p,r.image[t]):n.texImage2D(34069+t,e+1,m,f,p,r.image[t])}}}_(r,d)&&M(34067),l.__currentVersion=l.version,r.onUpdate&&r.onUpdate(r)}e.__version=r.version}function q(e,i,o,a,l){const c=s.convert(o.format,o.encoding),u=s.convert(o.type),h=A(o.internalFormat,c,u,o.encoding),f=r.get(i);f.__hasExternalTextures||(32879===l||35866===l?n.texImage3D(l,0,h,i.width,i.height,i.depth,0,c,u,null):n.texImage2D(l,0,h,i.width,i.height,0,c,u,null)),n.bindFramebuffer(36160,e),et(i)?d.framebufferTexture2DMultisampleEXT(36160,a,l,r.get(o).__webglTexture,0,tt(i)):t.framebufferTexture2D(36160,a,l,r.get(o).__webglTexture,0),n.bindFramebuffer(36160,null)}function Y(e,n,r){if(t.bindRenderbuffer(36161,e),n.depthBuffer&&!n.stencilBuffer){let i=33189;if(r||et(n)){const e=n.depthTexture;e&&e.isDepthTexture&&(e.type===Pt?i=36012:e.type===It&&(i=33190));const r=tt(n);et(n)?d.renderbufferStorageMultisampleEXT(36161,r,i,n.width,n.height):t.renderbufferStorageMultisample(36161,r,i,n.width,n.height)}else t.renderbufferStorage(36161,i,n.width,n.height);t.framebufferRenderbuffer(36160,36096,36161,e)}else if(n.depthBuffer&&n.stencilBuffer){const i=tt(n);r&&!1===et(n)?t.renderbufferStorageMultisample(36161,i,35056,n.width,n.height):et(n)?d.renderbufferStorageMultisampleEXT(36161,i,35056,n.width,n.height):t.renderbufferStorage(36161,34041,n.width,n.height),t.framebufferRenderbuffer(36160,33306,36161,e)}else{const e=!0===n.isWebGLMultipleRenderTargets?n.texture:[n.texture];for(let i=0;i<e.length;i++){const o=e[i],a=s.convert(o.format,o.encoding),l=s.convert(o.type),c=A(o.internalFormat,a,l,o.encoding),u=tt(n);r&&!1===et(n)?t.renderbufferStorageMultisample(36161,u,c,n.width,n.height):et(n)?d.renderbufferStorageMultisampleEXT(36161,u,c,n.width,n.height):t.renderbufferStorage(36161,c,n.width,n.height)}}t.bindRenderbuffer(36161,null)}function X(e,i){const s=i&&i.isWebGLCubeRenderTarget;if(s)throw new Error("Depth Texture with cube render targets is not supported");if(n.bindFramebuffer(36160,e),!i.depthTexture||!i.depthTexture.isDepthTexture)throw new Error("renderTarget.depthTexture must be an instance of THREE.DepthTexture");r.get(i.depthTexture).__webglTexture&&i.depthTexture.image.width===i.width&&i.depthTexture.image.height===i.height||(i.depthTexture.image.width=i.width,i.depthTexture.image.height=i.height,i.depthTexture.needsUpdate=!0),D(i.depthTexture,0);const o=r.get(i.depthTexture).__webglTexture,a=tt(i);if(i.depthTexture.format===Gt)et(i)?d.framebufferTexture2DMultisampleEXT(36160,36096,3553,o,0,a):t.framebufferTexture2D(36160,36096,3553,o,0);else{if(i.depthTexture.format!==Ht)throw new Error("Unknown depthTexture format");et(i)?d.framebufferTexture2DMultisampleEXT(36160,33306,3553,o,0,a):t.framebufferTexture2D(36160,33306,3553,o,0)}}function J(e){const i=r.get(e),s=!0===e.isWebGLCubeRenderTarget;if(e.depthTexture&&!i.__autoAllocateDepthBuffer){if(s)throw new Error("target.depthTexture not supported in Cube render targets");X(i.__webglFramebuffer,e)}else if(s){i.__webglDepthbuffer=[];for(let r=0;r<6;r++)n.bindFramebuffer(36160,i.__webglFramebuffer[r]),i.__webglDepthbuffer[r]=t.createRenderbuffer(),Y(i.__webglDepthbuffer[r],e,!1)}else n.bindFramebuffer(36160,i.__webglFramebuffer),i.__webglDepthbuffer=t.createRenderbuffer(),Y(i.__webglDepthbuffer,e,!1);n.bindFramebuffer(36160,null)}function K(t,e,n){const i=r.get(t);void 0!==e&&q(i.__webglFramebuffer,t,t.texture,36064,3553),void 0!==n&&J(t)}function Z(e){const l=e.texture,c=r.get(e),u=r.get(l);e.addEventListener("dispose",C),!0!==e.isWebGLMultipleRenderTargets&&(void 0===u.__webglTexture&&(u.__webglTexture=t.createTexture()),u.__version=l.version,o.memory.textures++);const h=!0===e.isWebGLCubeRenderTarget,d=!0===e.isWebGLMultipleRenderTargets,f=b(e)||a;if(h){c.__webglFramebuffer=[];for(let e=0;e<6;e++)c.__webglFramebuffer[e]=t.createFramebuffer()}else{if(c.__webglFramebuffer=t.createFramebuffer(),d)if(i.drawBuffers){const n=e.texture;for(let e=0,i=n.length;e<i;e++){const i=r.get(n[e]);void 0===i.__webglTexture&&(i.__webglTexture=t.createTexture(),o.memory.textures++)}}else console.warn("THREE.WebGLRenderer: WebGLMultipleRenderTargets can only be used with WebGL2 or WEBGL_draw_buffers extension.");if(a&&e.samples>0&&!1===et(e)){const r=d?l:[l];c.__webglMultisampledFramebuffer=t.createFramebuffer(),c.__webglColorRenderbuffer=[],n.bindFramebuffer(36160,c.__webglMultisampledFramebuffer);for(let n=0;n<r.length;n++){const i=r[n];c.__webglColorRenderbuffer[n]=t.createRenderbuffer(),t.bindRenderbuffer(36161,c.__webglColorRenderbuffer[n]);const o=s.convert(i.format,i.encoding),a=s.convert(i.type),l=A(i.internalFormat,o,a,i.encoding),u=tt(e);t.renderbufferStorageMultisample(36161,u,l,e.width,e.height),t.framebufferRenderbuffer(36160,36064+n,36161,c.__webglColorRenderbuffer[n])}t.bindRenderbuffer(36161,null),e.depthBuffer&&(c.__webglDepthRenderbuffer=t.createRenderbuffer(),Y(c.__webglDepthRenderbuffer,e,!0)),n.bindFramebuffer(36160,null)}}if(h){n.bindTexture(34067,u.__webglTexture),H(34067,l,f);for(let t=0;t<6;t++)q(c.__webglFramebuffer[t],e,l,36064,34069+t);_(l,f)&&M(34067),n.unbindTexture()}else if(d){const t=e.texture;for(let i=0,s=t.length;i<s;i++){const s=t[i],o=r.get(s);n.bindTexture(3553,o.__webglTexture),H(3553,s,f),q(c.__webglFramebuffer,e,s,36064+i,3553),_(s,f)&&M(3553)}n.unbindTexture()}else{let t=3553;(e.isWebGL3DRenderTarget||e.isWebGLArrayRenderTarget)&&(a?t=e.isWebGL3DRenderTarget?32879:35866:console.error("THREE.WebGLTextures: THREE.Data3DTexture and THREE.DataArrayTexture only supported with WebGL2.")),n.bindTexture(t,u.__webglTexture),H(t,l,f),q(c.__webglFramebuffer,e,l,36064,t),_(l,f)&&M(t),n.unbindTexture()}e.depthBuffer&&J(e)}function Q(t){const e=b(t)||a,i=!0===t.isWebGLMultipleRenderTargets?t.texture:[t.texture];for(let s=0,o=i.length;s<o;s++){const o=i[s];if(_(o,e)){const e=t.isWebGLCubeRenderTarget?34067:3553,i=r.get(o).__webglTexture;n.bindTexture(e,i),M(e),n.unbindTexture()}}}function $(e){if(a&&e.samples>0&&!1===et(e)){const i=e.isWebGLMultipleRenderTargets?e.texture:[e.texture],s=e.width,o=e.height;let a=16384;const l=[],c=e.stencilBuffer?33306:36096,u=r.get(e),h=!0===e.isWebGLMultipleRenderTargets;if(h)for(let e=0;e<i.length;e++)n.bindFramebuffer(36160,u.__webglMultisampledFramebuffer),t.framebufferRenderbuffer(36160,36064+e,36161,null),n.bindFramebuffer(36160,u.__webglFramebuffer),t.framebufferTexture2D(36009,36064+e,3553,null,0);n.bindFramebuffer(36008,u.__webglMultisampledFramebuffer),n.bindFramebuffer(36009,u.__webglFramebuffer);for(let n=0;n<i.length;n++){l.push(36064+n),e.depthBuffer&&l.push(c);const d=void 0!==u.__ignoreDepthValues&&u.__ignoreDepthValues;if(!1===d&&(e.depthBuffer&&(a|=256),e.stencilBuffer&&(a|=1024)),h&&t.framebufferRenderbuffer(36008,36064,36161,u.__webglColorRenderbuffer[n]),!0===d&&(t.invalidateFramebuffer(36008,[c]),t.invalidateFramebuffer(36009,[c])),h){const e=r.get(i[n]).__webglTexture;t.framebufferTexture2D(36009,36064,3553,e,0)}t.blitFramebuffer(0,0,s,o,0,0,s,o,a,9728),f&&t.invalidateFramebuffer(36008,l)}if(n.bindFramebuffer(36008,null),n.bindFramebuffer(36009,null),h)for(let e=0;e<i.length;e++){n.bindFramebuffer(36160,u.__webglMultisampledFramebuffer),t.framebufferRenderbuffer(36160,36064+e,36161,u.__webglColorRenderbuffer[e]);const s=r.get(i[e]).__webglTexture;n.bindFramebuffer(36160,u.__webglFramebuffer),t.framebufferTexture2D(36009,36064+e,3553,s,0)}n.bindFramebuffer(36009,u.__webglMultisampledFramebuffer)}}function tt(t){return Math.min(h,t.samples)}function et(t){const n=r.get(t);return a&&t.samples>0&&!0===e.has("WEBGL_multisampled_render_to_texture")&&!1!==n.__useRenderToTexture}function nt(t){const e=o.render.frame;p.get(t)!==e&&(p.set(t,e),t.update())}function rt(t,n){const r=t.encoding,i=t.format,s=t.type;return!0===t.isCompressedTexture||!0===t.isVideoTexture||t.format===vn||r!==ke&&(r===Oe?!1===a?!0===e.has("EXT_sRGB")&&i===Ft?(t.format=vn,t.minFilter=bt,t.generateMipmaps=!1):n=ur.sRGBToLinear(n):i===Ft&&s===St||console.warn("THREE.WebGLTextures: sRGB encoded textures have to use RGBAFormat and UnsignedByteType."):console.error("THREE.WebGLTextures: Unsupported texture encoding:",r)),n}this.allocateTextureUnit=k,this.resetTextureUnits=N,this.setTexture2D=D,this.setTexture2DArray=z,this.setTexture3D=F,this.setTextureCube=U,this.rebindTextures=K,this.setupRenderTarget=Z,this.updateRenderTargetMipmap=Q,this.updateMultisampleRenderTarget=$,this.setupDepthRenderbuffer=J,this.setupFrameBufferTexture=q,this.useMultisampledRTT=et}function fh(t,e,n){const r=n.isWebGL2;function i(n,i=null){let s;if(n===St)return 5121;if(n===Nt)return 32819;if(n===kt)return 32820;if(n===Et)return 5120;if(n===Tt)return 5122;if(n===Ct)return 5123;if(n===Rt)return 5124;if(n===It)return 5125;if(n===Pt)return 5126;if(n===Lt)return r?5131:(s=e.get("OES_texture_half_float"),null!==s?s.HALF_FLOAT_OES:null);if(n===Dt)return 6406;if(n===Ft)return 6408;if(n===Ut)return 6409;if(n===Bt)return 6410;if(n===Gt)return 6402;if(n===Ht)return 34041;if(n===Vt)return 6403;if(n===zt)return console.warn("THREE.WebGLRenderer: THREE.RGBFormat has been removed. Use THREE.RGBAFormat instead. https://github.com/mrdoob/three.js/pull/23228"),6408;if(n===vn)return s=e.get("EXT_sRGB"),null!==s?s.SRGB_ALPHA_EXT:null;if(n===jt)return 36244;if(n===Wt)return 33319;if(n===qt)return 33320;if(n===Yt)return 36249;if(n===Xt||n===Jt||n===Kt||n===Zt)if(i===Oe){if(s=e.get("WEBGL_compressed_texture_s3tc_srgb"),null===s)return null;if(n===Xt)return s.COMPRESSED_SRGB_S3TC_DXT1_EXT;if(n===Jt)return s.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT;if(n===Kt)return s.COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT;if(n===Zt)return s.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT}else{if(s=e.get("WEBGL_compressed_texture_s3tc"),null===s)return null;if(n===Xt)return s.COMPRESSED_RGB_S3TC_DXT1_EXT;if(n===Jt)return s.COMPRESSED_RGBA_S3TC_DXT1_EXT;if(n===Kt)return s.COMPRESSED_RGBA_S3TC_DXT3_EXT;if(n===Zt)return s.COMPRESSED_RGBA_S3TC_DXT5_EXT}if(n===Qt||n===$t||n===te||n===ee){if(s=e.get("WEBGL_compressed_texture_pvrtc"),null===s)return null;if(n===Qt)return s.COMPRESSED_RGB_PVRTC_4BPPV1_IMG;if(n===$t)return s.COMPRESSED_RGB_PVRTC_2BPPV1_IMG;if(n===te)return s.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG;if(n===ee)return s.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG}if(n===ne)return s=e.get("WEBGL_compressed_texture_etc1"),null!==s?s.COMPRESSED_RGB_ETC1_WEBGL:null;if(n===re||n===ie){if(s=e.get("WEBGL_compressed_texture_etc"),null===s)return null;if(n===re)return i===Oe?s.COMPRESSED_SRGB8_ETC2:s.COMPRESSED_RGB8_ETC2;if(n===ie)return i===Oe?s.COMPRESSED_SRGB8_ALPHA8_ETC2_EAC:s.COMPRESSED_RGBA8_ETC2_EAC}if(n===se||n===oe||n===ae||n===le||n===ce||n===ue||n===he||n===de||n===fe||n===pe||n===me||n===ge||n===ve||n===ye){if(s=e.get("WEBGL_compressed_texture_astc"),null===s)return null;if(n===se)return i===Oe?s.COMPRESSED_SRGB8_ALPHA8_ASTC_4x4_KHR:s.COMPRESSED_RGBA_ASTC_4x4_KHR;if(n===oe)return i===Oe?s.COMPRESSED_SRGB8_ALPHA8_ASTC_5x4_KHR:s.COMPRESSED_RGBA_ASTC_5x4_KHR;if(n===ae)return i===Oe?s.COMPRESSED_SRGB8_ALPHA8_ASTC_5x5_KHR:s.COMPRESSED_RGBA_ASTC_5x5_KHR;if(n===le)return i===Oe?s.COMPRESSED_SRGB8_ALPHA8_ASTC_6x5_KHR:s.COMPRESSED_RGBA_ASTC_6x5_KHR;if(n===ce)return i===Oe?s.COMPRESSED_SRGB8_ALPHA8_ASTC_6x6_KHR:s.COMPRESSED_RGBA_ASTC_6x6_KHR;if(n===ue)return i===Oe?s.COMPRESSED_SRGB8_ALPHA8_ASTC_8x5_KHR:s.COMPRESSED_RGBA_ASTC_8x5_KHR;if(n===he)return i===Oe?s.COMPRESSED_SRGB8_ALPHA8_ASTC_8x6_KHR:s.COMPRESSED_RGBA_ASTC_8x6_KHR;if(n===de)return i===Oe?s.COMPRESSED_SRGB8_ALPHA8_ASTC_8x8_KHR:s.COMPRESSED_RGBA_ASTC_8x8_KHR;if(n===fe)return i===Oe?s.COMPRESSED_SRGB8_ALPHA8_ASTC_10x5_KHR:s.COMPRESSED_RGBA_ASTC_10x5_KHR;if(n===pe)return i===Oe?s.COMPRESSED_SRGB8_ALPHA8_ASTC_10x6_KHR:s.COMPRESSED_RGBA_ASTC_10x6_KHR;if(n===me)return i===Oe?s.COMPRESSED_SRGB8_ALPHA8_ASTC_10x8_KHR:s.COMPRESSED_RGBA_ASTC_10x8_KHR;if(n===ge)return i===Oe?s.COMPRESSED_SRGB8_ALPHA8_ASTC_10x10_KHR:s.COMPRESSED_RGBA_ASTC_10x10_KHR;if(n===ve)return i===Oe?s.COMPRESSED_SRGB8_ALPHA8_ASTC_12x10_KHR:s.COMPRESSED_RGBA_ASTC_12x10_KHR;if(n===ye)return i===Oe?s.COMPRESSED_SRGB8_ALPHA8_ASTC_12x12_KHR:s.COMPRESSED_RGBA_ASTC_12x12_KHR}if(n===xe){if(s=e.get("EXT_texture_compression_bptc"),null===s)return null;if(n===xe)return i===Oe?s.COMPRESSED_SRGB_ALPHA_BPTC_UNORM_EXT:s.COMPRESSED_RGBA_BPTC_UNORM_EXT}return n===Ot?r?34042:(s=e.get("WEBGL_depth_texture"),null!==s?s.UNSIGNED_INT_24_8_WEBGL:null):void 0!==t[n]?t[n]:null}return{convert:i}}class ph extends Os{constructor(t=[]){super(),this.isArrayCamera=!0,this.cameras=t}}class mh extends Si{constructor(){super(),this.isGroup=!0,this.type="Group"}}const gh={type:"move"};class vh{constructor(){this._targetRay=null,this._grip=null,this._hand=null}getHandSpace(){return null===this._hand&&(this._hand=new mh,this._hand.matrixAutoUpdate=!1,this._hand.visible=!1,this._hand.joints={},this._hand.inputState={pinching:!1}),this._hand}getTargetRaySpace(){return null===this._targetRay&&(this._targetRay=new mh,this._targetRay.matrixAutoUpdate=!1,this._targetRay.visible=!1,this._targetRay.hasLinearVelocity=!1,this._targetRay.linearVelocity=new Mr,this._targetRay.hasAngularVelocity=!1,this._targetRay.angularVelocity=new Mr),this._targetRay}getGripSpace(){return null===this._grip&&(this._grip=new mh,this._grip.matrixAutoUpdate=!1,this._grip.visible=!1,this._grip.hasLinearVelocity=!1,this._grip.linearVelocity=new Mr,this._grip.hasAngularVelocity=!1,this._grip.angularVelocity=new Mr),this._grip}dispatchEvent(t){return null!==this._targetRay&&this._targetRay.dispatchEvent(t),null!==this._grip&&this._grip.dispatchEvent(t),null!==this._hand&&this._hand.dispatchEvent(t),this}disconnect(t){return this.dispatchEvent({type:"disconnected",data:t}),null!==this._targetRay&&(this._targetRay.visible=!1),null!==this._grip&&(this._grip.visible=!1),null!==this._hand&&(this._hand.visible=!1),this}update(t,e,n){let r=null,i=null,s=null;const o=this._targetRay,a=this._grip,l=this._hand;if(t&&"visible-blurred"!==e.session.visibilityState)if(null!==o&&(r=e.getPose(t.targetRaySpace,n),null!==r&&(o.matrix.fromArray(r.transform.matrix),o.matrix.decompose(o.position,o.rotation,o.scale),r.linearVelocity?(o.hasLinearVelocity=!0,o.linearVelocity.copy(r.linearVelocity)):o.hasLinearVelocity=!1,r.angularVelocity?(o.hasAngularVelocity=!0,o.angularVelocity.copy(r.angularVelocity)):o.hasAngularVelocity=!1,this.dispatchEvent(gh))),l&&t.hand){s=!0;for(const s of t.hand.values()){const t=e.getJointPose(s,n);if(void 0===l.joints[s.jointName]){const t=new mh;t.matrixAutoUpdate=!1,t.visible=!1,l.joints[s.jointName]=t,l.add(t)}const r=l.joints[s.jointName];null!==t&&(r.matrix.fromArray(t.transform.matrix),r.matrix.decompose(r.position,r.rotation,r.scale),r.jointRadius=t.radius),r.visible=null!==t}const r=l.joints["index-finger-tip"],i=l.joints["thumb-tip"],o=r.position.distanceTo(i.position),a=.02,c=.005;l.inputState.pinching&&o>a+c?(l.inputState.pinching=!1,this.dispatchEvent({type:"pinchend",handedness:t.handedness,target:this})):!l.inputState.pinching&&o<=a-c&&(l.inputState.pinching=!0,this.dispatchEvent({type:"pinchstart",handedness:t.handedness,target:this}))}else null!==a&&t.gripSpace&&(i=e.getPose(t.gripSpace,n),null!==i&&(a.matrix.fromArray(i.transform.matrix),a.matrix.decompose(a.position,a.rotation,a.scale),i.linearVelocity?(a.hasLinearVelocity=!0,a.linearVelocity.copy(i.linearVelocity)):a.hasLinearVelocity=!1,i.angularVelocity?(a.hasAngularVelocity=!0,a.angularVelocity.copy(i.angularVelocity)):a.hasAngularVelocity=!1));return null!==o&&(o.visible=null!==r),null!==a&&(a.visible=null!==i),null!==l&&(l.visible=null!==s),this}}class yh extends pr{constructor(t,e,n,r,i,s,o,a,l,c){if(c=void 0!==c?c:Gt,c!==Gt&&c!==Ht)throw new Error("DepthTexture format must be either THREE.DepthFormat or THREE.DepthStencilFormat");void 0===n&&c===Gt&&(n=It),void 0===n&&c===Ht&&(n=Ot),super(null,r,i,s,o,a,c,n,l),this.isDepthTexture=!0,this.image={width:t,height:e},this.magFilter=void 0!==o?o:mt,this.minFilter=void 0!==a?a:mt,this.flipY=!1,this.generateMipmaps=!1}}class xh extends yn{constructor(t,e){super();const n=this;let r=null,i=1,s=null,o="local-floor",a=null,l=null,c=null,u=null,h=null,d=null;const f=e.getContextAttributes();let p=null,m=null;const g=[],v=new Map,y=new Os;y.layers.enable(1),y.viewport=new mr;const x=new Os;x.layers.enable(2),x.viewport=new mr;const b=[y,x],w=new ph;w.layers.enable(1),w.layers.enable(2);let _=null,M=null;function A(t){const e=v.get(t.inputSource);void 0!==e&&e.dispatchEvent({type:t.type,data:t.inputSource})}function S(){r.removeEventListener("select",A),r.removeEventListener("selectstart",A),r.removeEventListener("selectend",A),r.removeEventListener("squeeze",A),r.removeEventListener("squeezestart",A),r.removeEventListener("squeezeend",A),r.removeEventListener("end",S),r.removeEventListener("inputsourceschange",E),v.forEach((function(t,e){void 0!==t&&t.disconnect(e)})),v.clear(),_=null,M=null,t.setRenderTarget(p),h=null,u=null,c=null,r=null,m=null,N.stop(),n.isPresenting=!1,n.dispatchEvent({type:"sessionend"})}function E(t){const e=r.inputSources;for(let n=0;n<e.length;n++){const t="right"===e[n].handedness?1:0;v.set(e[n],g[t])}for(let n=0;n<t.removed.length;n++){const e=t.removed[n],r=v.get(e);r&&(r.dispatchEvent({type:"disconnected",data:e}),v.delete(e))}for(let n=0;n<t.added.length;n++){const e=t.added[n],r=v.get(e);r&&r.dispatchEvent({type:"connected",data:e})}}this.cameraAutoUpdate=!0,this.enabled=!1,this.isPresenting=!1,this.getController=function(t){let e=g[t];return void 0===e&&(e=new vh,g[t]=e),e.getTargetRaySpace()},this.getControllerGrip=function(t){let e=g[t];return void 0===e&&(e=new vh,g[t]=e),e.getGripSpace()},this.getHand=function(t){let e=g[t];return void 0===e&&(e=new vh,g[t]=e),e.getHandSpace()},this.setFramebufferScaleFactor=function(t){i=t,!0===n.isPresenting&&console.warn("THREE.WebXRManager: Cannot change framebuffer scale while presenting.")},this.setReferenceSpaceType=function(t){o=t,!0===n.isPresenting&&console.warn("THREE.WebXRManager: Cannot change reference space type while presenting.")},this.getReferenceSpace=function(){return a||s},this.setReferenceSpace=function(t){a=t},this.getBaseLayer=function(){return null!==u?u:h},this.getBinding=function(){return c},this.getFrame=function(){return d},this.getSession=function(){return r},this.setSession=async function(l){if(r=l,null!==r){if(p=t.getRenderTarget(),r.addEventListener("select",A),r.addEventListener("selectstart",A),r.addEventListener("selectend",A),r.addEventListener("squeeze",A),r.addEventListener("squeezestart",A),r.addEventListener("squeezeend",A),r.addEventListener("end",S),r.addEventListener("inputsourceschange",E),!0!==f.xrCompatible&&await e.makeXRCompatible(),void 0===r.renderState.layers||!1===t.capabilities.isWebGL2){const n={antialias:void 0!==r.renderState.layers||f.antialias,alpha:f.alpha,depth:f.depth,stencil:f.stencil,framebufferScaleFactor:i};h=new XRWebGLLayer(r,e,n),r.updateRenderState({baseLayer:h}),m=new gr(h.framebufferWidth,h.framebufferHeight,{format:Ft,type:St,encoding:t.outputEncoding})}else{let n=null,s=null,o=null;f.depth&&(o=f.stencil?35056:33190,n=f.stencil?Ht:Gt,s=f.stencil?Ot:It);const a={colorFormat:t.outputEncoding===Oe?35907:32856,depthFormat:o,scaleFactor:i};c=new XRWebGLBinding(r,e),u=c.createProjectionLayer(a),r.updateRenderState({layers:[u]}),m=new gr(u.textureWidth,u.textureHeight,{format:Ft,type:St,depthTexture:new yh(u.textureWidth,u.textureHeight,s,void 0,void 0,void 0,void 0,void 0,void 0,n),stencilBuffer:f.stencil,encoding:t.outputEncoding,samples:f.antialias?4:0});const l=t.properties.get(m);l.__ignoreDepthValues=u.ignoreDepthValues}m.isXRRenderTarget=!0,this.setFoveation(1),a=null,s=await r.requestReferenceSpace(o),N.setContext(r),N.start(),n.isPresenting=!0,n.dispatchEvent({type:"sessionstart"})}};const T=new Mr,C=new Mr;function R(t,e,n){T.setFromMatrixPosition(e.matrixWorld),C.setFromMatrixPosition(n.matrixWorld);const r=T.distanceTo(C),i=e.projectionMatrix.elements,s=n.projectionMatrix.elements,o=i[14]/(i[10]-1),a=i[14]/(i[10]+1),l=(i[9]+1)/i[5],c=(i[9]-1)/i[5],u=(i[8]-1)/i[0],h=(s[8]+1)/s[0],d=o*u,f=o*h,p=r/(-u+h),m=p*-u;e.matrixWorld.decompose(t.position,t.quaternion,t.scale),t.translateX(m),t.translateZ(p),t.matrixWorld.compose(t.position,t.quaternion,t.scale),t.matrixWorldInverse.copy(t.matrixWorld).invert();const g=o+p,v=a+p,y=d-m,x=f+(r-m),b=l*a/v*g,w=c*a/v*g;t.projectionMatrix.makePerspective(y,x,b,w,g,v)}function I(t,e){null===e?t.matrixWorld.copy(t.matrix):t.matrixWorld.multiplyMatrices(e.matrixWorld,t.matrix),t.matrixWorldInverse.copy(t.matrixWorld).invert()}this.updateCamera=function(t){if(null===r)return;w.near=x.near=y.near=t.near,w.far=x.far=y.far=t.far,_===w.near&&M===w.far||(r.updateRenderState({depthNear:w.near,depthFar:w.far}),_=w.near,M=w.far);const e=t.parent,n=w.cameras;I(w,e);for(let r=0;r<n.length;r++)I(n[r],e);w.matrixWorld.decompose(w.position,w.quaternion,w.scale),t.position.copy(w.position),t.quaternion.copy(w.quaternion),t.scale.copy(w.scale),t.matrix.copy(w.matrix),t.matrixWorld.copy(w.matrixWorld);const i=t.children;for(let r=0,s=i.length;r<s;r++)i[r].updateMatrixWorld(!0);2===n.length?R(w,y,x):w.projectionMatrix.copy(y.projectionMatrix)},this.getCamera=function(){return w},this.getFoveation=function(){return null!==u?u.fixedFoveation:null!==h?h.fixedFoveation:void 0},this.setFoveation=function(t){null!==u&&(u.fixedFoveation=t),null!==h&&void 0!==h.fixedFoveation&&(h.fixedFoveation=t)};let P=null;function L(e,n){if(l=n.getViewerPose(a||s),d=n,null!==l){const e=l.views;null!==h&&(t.setRenderTargetFramebuffer(m,h.framebuffer),t.setRenderTarget(m));let n=!1;e.length!==w.cameras.length&&(w.cameras.length=0,n=!0);for(let r=0;r<e.length;r++){const i=e[r];let s=null;if(null!==h)s=h.getViewport(i);else{const e=c.getViewSubImage(u,i);s=e.viewport,0===r&&(t.setRenderTargetTextures(m,e.colorTexture,u.ignoreDepthValues?void 0:e.depthStencilTexture),t.setRenderTarget(m))}let o=b[r];void 0===o&&(o=new Os,o.layers.enable(r),o.viewport=new mr,b[r]=o),o.matrix.fromArray(i.transform.matrix),o.projectionMatrix.fromArray(i.projectionMatrix),o.viewport.set(s.x,s.y,s.width,s.height),0===r&&w.matrix.copy(o.matrix),!0===n&&w.cameras.push(o)}}const i=r.inputSources;for(let t=0;t<g.length;t++){const e=i[t],r=v.get(e);void 0!==r&&r.update(e,n,a||s)}P&&P(e,n),d=null}const N=new Xs;N.setAnimationLoop(L),this.setAnimationLoop=function(t){P=t},this.dispose=function(){}}}function bh(t,e){function n(t,e){t.fogColor.value.copy(e.color),e.isFog?(t.fogNear.value=e.near,t.fogFar.value=e.far):e.isFogExp2&&(t.fogDensity.value=e.density)}function r(t,e,n,r,m){e.isMeshBasicMaterial||e.isMeshLambertMaterial?i(t,e):e.isMeshToonMaterial?(i(t,e),u(t,e)):e.isMeshPhongMaterial?(i(t,e),c(t,e)):e.isMeshStandardMaterial?(i(t,e),h(t,e),e.isMeshPhysicalMaterial&&d(t,e,m)):e.isMeshMatcapMaterial?(i(t,e),f(t,e)):e.isMeshDepthMaterial?i(t,e):e.isMeshDistanceMaterial?(i(t,e),p(t,e)):e.isMeshNormalMaterial?i(t,e):e.isLineBasicMaterial?(s(t,e),e.isLineDashedMaterial&&o(t,e)):e.isPointsMaterial?a(t,e,n,r):e.isSpriteMaterial?l(t,e):e.isShadowMaterial?(t.color.value.copy(e.color),t.opacity.value=e.opacity):e.isShaderMaterial&&(e.uniformsNeedUpdate=!1)}function i(n,r){n.opacity.value=r.opacity,r.color&&n.diffuse.value.copy(r.color),r.emissive&&n.emissive.value.copy(r.emissive).multiplyScalar(r.emissiveIntensity),r.map&&(n.map.value=r.map),r.alphaMap&&(n.alphaMap.value=r.alphaMap),r.bumpMap&&(n.bumpMap.value=r.bumpMap,n.bumpScale.value=r.bumpScale,r.side===v&&(n.bumpScale.value*=-1)),r.displacementMap&&(n.displacementMap.value=r.displacementMap,n.displacementScale.value=r.displacementScale,n.displacementBias.value=r.displacementBias),r.emissiveMap&&(n.emissiveMap.value=r.emissiveMap),r.normalMap&&(n.normalMap.value=r.normalMap,n.normalScale.value.copy(r.normalScale),r.side===v&&n.normalScale.value.negate()),r.specularMap&&(n.specularMap.value=r.specularMap),r.alphaTest>0&&(n.alphaTest.value=r.alphaTest);const i=e.get(r).envMap;if(i&&(n.envMap.value=i,n.flipEnvMap.value=i.isCubeTexture&&!1===i.isRenderTargetTexture?-1:1,n.reflectivity.value=r.reflectivity,n.ior.value=r.ior,n.refractionRatio.value=r.refractionRatio),r.lightMap){n.lightMap.value=r.lightMap;const e=!0!==t.physicallyCorrectLights?Math.PI:1;n.lightMapIntensity.value=r.lightMapIntensity*e}let s,o;r.aoMap&&(n.aoMap.value=r.aoMap,n.aoMapIntensity.value=r.aoMapIntensity),r.map?s=r.map:r.specularMap?s=r.specularMap:r.displacementMap?s=r.displacementMap:r.normalMap?s=r.normalMap:r.bumpMap?s=r.bumpMap:r.roughnessMap?s=r.roughnessMap:r.metalnessMap?s=r.metalnessMap:r.alphaMap?s=r.alphaMap:r.emissiveMap?s=r.emissiveMap:r.clearcoatMap?s=r.clearcoatMap:r.clearcoatNormalMap?s=r.clearcoatNormalMap:r.clearcoatRoughnessMap?s=r.clearcoatRoughnessMap:r.iridescenceMap?s=r.iridescenceMap:r.iridescenceThicknessMap?s=r.iridescenceThicknessMap:r.specularIntensityMap?s=r.specularIntensityMap:r.specularColorMap?s=r.specularColorMap:r.transmissionMap?s=r.transmissionMap:r.thicknessMap?s=r.thicknessMap:r.sheenColorMap?s=r.sheenColorMap:r.sheenRoughnessMap&&(s=r.sheenRoughnessMap),void 0!==s&&(s.isWebGLRenderTarget&&(s=s.texture),!0===s.matrixAutoUpdate&&s.updateMatrix(),n.uvTransform.value.copy(s.matrix)),r.aoMap?o=r.aoMap:r.lightMap&&(o=r.lightMap),void 0!==o&&(o.isWebGLRenderTarget&&(o=o.texture),!0===o.matrixAutoUpdate&&o.updateMatrix(),n.uv2Transform.value.copy(o.matrix))}function s(t,e){t.diffuse.value.copy(e.color),t.opacity.value=e.opacity}function o(t,e){t.dashSize.value=e.dashSize,t.totalSize.value=e.dashSize+e.gapSize,t.scale.value=e.scale}function a(t,e,n,r){let i;t.diffuse.value.copy(e.color),t.opacity.value=e.opacity,t.size.value=e.size*n,t.scale.value=.5*r,e.map&&(t.map.value=e.map),e.alphaMap&&(t.alphaMap.value=e.alphaMap),e.alphaTest>0&&(t.alphaTest.value=e.alphaTest),e.map?i=e.map:e.alphaMap&&(i=e.alphaMap),void 0!==i&&(!0===i.matrixAutoUpdate&&i.updateMatrix(),t.uvTransform.value.copy(i.matrix))}function l(t,e){let n;t.diffuse.value.copy(e.color),t.opacity.value=e.opacity,t.rotation.value=e.rotation,e.map&&(t.map.value=e.map),e.alphaMap&&(t.alphaMap.value=e.alphaMap),e.alphaTest>0&&(t.alphaTest.value=e.alphaTest),e.map?n=e.map:e.alphaMap&&(n=e.alphaMap),void 0!==n&&(!0===n.matrixAutoUpdate&&n.updateMatrix(),t.uvTransform.value.copy(n.matrix))}function c(t,e){t.specular.value.copy(e.specular),t.shininess.value=Math.max(e.shininess,1e-4)}function u(t,e){e.gradientMap&&(t.gradientMap.value=e.gradientMap)}function h(t,n){t.roughness.value=n.roughness,t.metalness.value=n.metalness,n.roughnessMap&&(t.roughnessMap.value=n.roughnessMap),n.metalnessMap&&(t.metalnessMap.value=n.metalnessMap);const r=e.get(n).envMap;r&&(t.envMapIntensity.value=n.envMapIntensity)}function d(t,e,n){t.ior.value=e.ior,e.sheen>0&&(t.sheenColor.value.copy(e.sheenColor).multiplyScalar(e.sheen),t.sheenRoughness.value=e.sheenRoughness,e.sheenColorMap&&(t.sheenColorMap.value=e.sheenColorMap),e.sheenRoughnessMap&&(t.sheenRoughnessMap.value=e.sheenRoughnessMap)),e.clearcoat>0&&(t.clearcoat.value=e.clearcoat,t.clearcoatRoughness.value=e.clearcoatRoughness,e.clearcoatMap&&(t.clearcoatMap.value=e.clearcoatMap),e.clearcoatRoughnessMap&&(t.clearcoatRoughnessMap.value=e.clearcoatRoughnessMap),e.clearcoatNormalMap&&(t.clearcoatNormalScale.value.copy(e.clearcoatNormalScale),t.clearcoatNormalMap.value=e.clearcoatNormalMap,e.side===v&&t.clearcoatNormalScale.value.negate())),e.iridescence>0&&(t.iridescence.value=e.iridescence,t.iridescenceIOR.value=e.iridescenceIOR,t.iridescenceThicknessMinimum.value=e.iridescenceThicknessRange[0],t.iridescenceThicknessMaximum.value=e.iridescenceThicknessRange[1],e.iridescenceMap&&(t.iridescenceMap.value=e.iridescenceMap),e.iridescenceThicknessMap&&(t.iridescenceThicknessMap.value=e.iridescenceThicknessMap)),e.transmission>0&&(t.transmission.value=e.transmission,t.transmissionSamplerMap.value=n.texture,t.transmissionSamplerSize.value.set(n.width,n.height),e.transmissionMap&&(t.transmissionMap.value=e.transmissionMap),t.thickness.value=e.thickness,e.thicknessMap&&(t.thicknessMap.value=e.thicknessMap),t.attenuationDistance.value=e.attenuationDistance,t.attenuationColor.value.copy(e.attenuationColor)),t.specularIntensity.value=e.specularIntensity,t.specularColor.value.copy(e.specularColor),e.specularIntensityMap&&(t.specularIntensityMap.value=e.specularIntensityMap),e.specularColorMap&&(t.specularColorMap.value=e.specularColorMap)}function f(t,e){e.matcap&&(t.matcap.value=e.matcap)}function p(t,e){t.referencePosition.value.copy(e.referencePosition),t.nearDistance.value=e.nearDistance,t.farDistance.value=e.farDistance}return{refreshFogUniforms:n,refreshMaterialUniforms:r}}function wh(){const t=Zn("canvas");return t.style.display="block",t}function _h(t={}){this.isWebGLRenderer=!0;const e=void 0!==t.canvas?t.canvas:wh(),n=void 0!==t.context?t.context:null,r=void 0===t.depth||t.depth,i=void 0===t.stencil||t.stencil,o=void 0!==t.antialias&&t.antialias,a=void 0===t.premultipliedAlpha||t.premultipliedAlpha,l=void 0!==t.preserveDrawingBuffer&&t.preserveDrawingBuffer,c=void 0!==t.powerPreference?t.powerPreference:"default",u=void 0!==t.failIfMajorPerformanceCaveat&&t.failIfMajorPerformanceCaveat;let h;h=null!==n?n.getContextAttributes().alpha:void 0!==t.alpha&&t.alpha;let d=null,f=null;const p=[],m=[];this.domElement=e,this.debug={checkShaderErrors:!0},this.autoClear=!0,this.autoClearColor=!0,this.autoClearDepth=!0,this.autoClearStencil=!0,this.sortObjects=!0,this.clippingPlanes=[],this.localClippingEnabled=!1,this.outputEncoding=ke,this.physicallyCorrectLights=!1,this.toneMapping=tt,this.toneMappingExposure=1,Object.defineProperties(this,{gammaFactor:{get:function(){return console.warn("THREE.WebGLRenderer: .gammaFactor has been removed."),2},set:function(){console.warn("THREE.WebGLRenderer: .gammaFactor has been removed.")}}});const x=this;let b=!1,w=0,_=0,M=null,A=-1,S=null;const E=new mr,T=new mr;let C=null,R=e.width,I=e.height,P=1,L=null,N=null;const k=new mr(0,0,R,I),O=new mr(0,0,R,I);let D=!1;const z=new Ys;let F=!1,U=!1,B=null;const G=new ti,H=new qn,V=new Mr,j={background:null,fog:null,environment:null,overrideMaterial:null,isScene:!0};function W(){return null===M?P:1}let q,Y,X,J,K,Z,Q,$,et,nt,rt,it,st,ot,at,lt,ct,ut,ht,dt,ft,pt,mt,gt=n;function vt(t,n){for(let r=0;r<t.length;r++){const i=t[r],s=e.getContext(i,n);if(null!==s)return s}return null}try{const t={alpha:!0,depth:r,stencil:i,antialias:o,premultipliedAlpha:a,preserveDrawingBuffer:l,powerPreference:c,failIfMajorPerformanceCaveat:u};if("setAttribute"in e&&e.setAttribute("data-engine",`three.js r${s}`),e.addEventListener("webglcontextlost",bt,!1),e.addEventListener("webglcontextrestored",wt,!1),e.addEventListener("webglcontextcreationerror",_t,!1),null===gt){const e=["webgl2","webgl","experimental-webgl"];if(!0===x.isWebGL1Renderer&&e.shift(),gt=vt(e,t),null===gt)throw vt(e)?new Error("Error creating WebGL context with your selected attributes."):new Error("Error creating WebGL context.")}void 0===gt.getShaderPrecisionFormat&&(gt.getShaderPrecisionFormat=function(){return{rangeMin:1,rangeMax:1,precision:1}})}catch(qt){throw console.error("THREE.WebGLRenderer: "+qt.message),qt}function yt(){q=new ec(gt),Y=new Nl(gt,q,t),q.init(Y),pt=new fh(gt,q,Y),X=new hh(gt,q,Y),J=new ic,K=new Xu,Z=new dh(gt,q,X,K,Y,pt,J),Q=new Ol(x),$=new tc(x),et=new Js(gt,Y),mt=new Pl(gt,q,et,Y),nt=new nc(gt,et,J,mt),rt=new cc(gt,nt,et,J),ht=new lc(gt,Y,Z),lt=new kl(K),it=new Yu(x,Q,$,q,Y,mt,lt),st=new bh(x,K),ot=new Qu,at=new sh(q,Y),ut=new Il(x,Q,X,rt,h,a),ct=new uh(x,rt,Y),dt=new Ll(gt,q,J,Y),ft=new rc(gt,q,J,Y),J.programs=it.programs,x.capabilities=Y,x.extensions=q,x.properties=K,x.renderLists=ot,x.shadowMap=ct,x.state=X,x.info=J}yt();const xt=new xh(x,gt);function bt(t){t.preventDefault(),console.log("THREE.WebGLRenderer: Context Lost."),b=!0}function wt(){console.log("THREE.WebGLRenderer: Context Restored."),b=!1;const t=J.autoReset,e=ct.enabled,n=ct.autoUpdate,r=ct.needsUpdate,i=ct.type;yt(),J.autoReset=t,ct.enabled=e,ct.autoUpdate=n,ct.needsUpdate=r,ct.type=i}function _t(t){console.error("THREE.WebGLRenderer: A WebGL context could not be created. Reason: ",t.statusMessage)}function At(t){const e=t.target;e.removeEventListener("dispose",At),Et(e)}function Et(t){Tt(t),K.remove(t)}function Tt(t){const e=K.get(t).programs;void 0!==e&&(e.forEach((function(t){it.releaseProgram(t)})),t.isShaderMaterial&&it.releaseShaderCache(t))}this.xr=xt,this.getContext=function(){return gt},this.getContextAttributes=function(){return gt.getContextAttributes()},this.forceContextLoss=function(){const t=q.get("WEBGL_lose_context");t&&t.loseContext()},this.forceContextRestore=function(){const t=q.get("WEBGL_lose_context");t&&t.restoreContext()},this.getPixelRatio=function(){return P},this.setPixelRatio=function(t){void 0!==t&&(P=t,this.setSize(R,I,!1))},this.getSize=function(t){return t.set(R,I)},this.setSize=function(t,n,r){xt.isPresenting?console.warn("THREE.WebGLRenderer: Can't change size while VR device is presenting."):(R=t,I=n,e.width=Math.floor(t*P),e.height=Math.floor(n*P),!1!==r&&(e.style.width=t+"px",e.style.height=n+"px"),this.setViewport(0,0,t,n))},this.getDrawingBufferSize=function(t){return t.set(R*P,I*P).floor()},this.setDrawingBufferSize=function(t,n,r){R=t,I=n,P=r,e.width=Math.floor(t*r),e.height=Math.floor(n*r),this.setViewport(0,0,t,n)},this.getCurrentViewport=function(t){return t.copy(E)},this.getViewport=function(t){return t.copy(k)},this.setViewport=function(t,e,n,r){t.isVector4?k.set(t.x,t.y,t.z,t.w):k.set(t,e,n,r),X.viewport(E.copy(k).multiplyScalar(P).floor())},this.getScissor=function(t){return t.copy(O)},this.setScissor=function(t,e,n,r){t.isVector4?O.set(t.x,t.y,t.z,t.w):O.set(t,e,n,r),X.scissor(T.copy(O).multiplyScalar(P).floor())},this.getScissorTest=function(){return D},this.setScissorTest=function(t){X.setScissorTest(D=t)},this.setOpaqueSort=function(t){L=t},this.setTransparentSort=function(t){N=t},this.getClearColor=function(t){return t.copy(ut.getClearColor())},this.setClearColor=function(){ut.setClearColor.apply(ut,arguments)},this.getClearAlpha=function(){return ut.getClearAlpha()},this.setClearAlpha=function(){ut.setClearAlpha.apply(ut,arguments)},this.clear=function(t=!0,e=!0,n=!0){let r=0;t&&(r|=16384),e&&(r|=256),n&&(r|=1024),gt.clear(r)},this.clearColor=function(){this.clear(!0,!1,!1)},this.clearDepth=function(){this.clear(!1,!0,!1)},this.clearStencil=function(){this.clear(!1,!1,!0)},this.dispose=function(){e.removeEventListener("webglcontextlost",bt,!1),e.removeEventListener("webglcontextrestored",wt,!1),e.removeEventListener("webglcontextcreationerror",_t,!1),ot.dispose(),at.dispose(),K.dispose(),Q.dispose(),$.dispose(),rt.dispose(),mt.dispose(),it.dispose(),xt.dispose(),xt.removeEventListener("sessionstart",It),xt.removeEventListener("sessionend",Nt),B&&(B.dispose(),B=null),kt.stop()},this.renderBufferDirect=function(t,e,n,r,i,s){null===e&&(e=j);const o=i.isMesh&&i.matrixWorld.determinant()<0,a=Vt(t,e,n,r,i);X.setMaterial(r,o);let l=n.index;const c=n.attributes.position;if(null===l){if(void 0===c||0===c.count)return}else if(0===l.count)return;let u,h=1;!0===r.wireframe&&(l=nt.getWireframeAttribute(n),h=2),mt.setup(i,r,a,n,l);let d=dt;null!==l&&(u=et.get(l),d=ft,d.setIndex(u));const f=null!==l?l.count:c.count,p=n.drawRange.start*h,m=n.drawRange.count*h,g=null!==s?s.start*h:0,v=null!==s?s.count*h:1/0,y=Math.max(p,g),x=Math.min(f,p+m,g+v)-1,b=Math.max(0,x-y+1);if(0!==b){if(i.isMesh)!0===r.wireframe?(X.setLineWidth(r.wireframeLinewidth*W()),d.setMode(1)):d.setMode(4);else if(i.isLine){let t=r.linewidth;void 0===t&&(t=1),X.setLineWidth(t*W()),i.isLineSegments?d.setMode(1):i.isLineLoop?d.setMode(2):d.setMode(3)}else i.isPoints?d.setMode(0):i.isSprite&&d.setMode(4);if(i.isInstancedMesh)d.renderInstances(y,b,i.count);else if(n.isInstancedBufferGeometry){const t=Math.min(n.instanceCount,n._maxInstanceCount);d.renderInstances(y,b,t)}else d.render(y,b)}},this.compile=function(t,e){f=at.get(t),f.init(),m.push(f),t.traverseVisible((function(t){t.isLight&&t.layers.test(e.layers)&&(f.pushLight(t),t.castShadow&&f.pushShadow(t))})),f.setupLights(x.physicallyCorrectLights),t.traverse((function(e){const n=e.material;if(n)if(Array.isArray(n))for(let r=0;r<n.length;r++){const i=n[r];Gt(i,t,e)}else Gt(n,t,e)})),m.pop(),f=null};let Ct=null;function Rt(t){Ct&&Ct(t)}function It(){kt.stop()}function Nt(){kt.start()}const kt=new Xs;function Ot(t,e,n,r){if(!1===t.visible)return;const i=t.layers.test(e.layers);if(i)if(t.isGroup)n=t.renderOrder;else if(t.isLOD)!0===t.autoUpdate&&t.update(e);else if(t.isLight)f.pushLight(t),t.castShadow&&f.pushShadow(t);else if(t.isSprite){if(!t.frustumCulled||z.intersectsSprite(t)){r&&V.setFromMatrixPosition(t.matrixWorld).applyMatrix4(G);const e=rt.update(t),i=t.material;i.visible&&d.push(t,e,i,n,V.z,null)}}else if((t.isMesh||t.isLine||t.isPoints)&&(t.isSkinnedMesh&&t.skeleton.frame!==J.render.frame&&(t.skeleton.update(),t.skeleton.frame=J.render.frame),!t.frustumCulled||z.intersectsObject(t))){r&&V.setFromMatrixPosition(t.matrixWorld).applyMatrix4(G);const e=rt.update(t),i=t.material;if(Array.isArray(i)){const r=e.groups;for(let s=0,o=r.length;s<o;s++){const o=r[s],a=i[o.materialIndex];a&&a.visible&&d.push(t,e,a,n,V.z,o)}}else i.visible&&d.push(t,e,i,n,V.z,null)}const s=t.children;for(let o=0,a=s.length;o<a;o++)Ot(s[o],e,n,r)}function Dt(t,e,n,r){const i=t.opaque,s=t.transmissive,o=t.transparent;f.setupLightsView(n),s.length>0&&zt(i,e,n),r&&X.viewport(E.copy(r)),i.length>0&&Ut(i,e,n),s.length>0&&Ut(s,e,n),o.length>0&&Ut(o,e,n),X.buffers.depth.setTest(!0),X.buffers.depth.setMask(!0),X.buffers.color.setMask(!0),X.setPolygonOffset(!1)}function zt(t,e,n){const r=Y.isWebGL2;null===B&&(B=new gr(1,1,{generateMipmaps:!0,type:q.has("EXT_color_buffer_half_float")?Lt:St,minFilter:Mt,samples:r&&!0===o?4:0})),x.getDrawingBufferSize(H),r?B.setSize(H.x,H.y):B.setSize(Gn(H.x),Gn(H.y));const i=x.getRenderTarget();x.setRenderTarget(B),x.clear();const s=x.toneMapping;x.toneMapping=tt,Ut(t,e,n),x.toneMapping=s,Z.updateMultisampleRenderTarget(B),Z.updateRenderTargetMipmap(B),x.setRenderTarget(i)}function Ut(t,e,n){const r=!0===e.isScene?e.overrideMaterial:null;for(let i=0,s=t.length;i<s;i++){const s=t[i],o=s.object,a=s.geometry,l=null===r?s.material:r,c=s.group;o.layers.test(n.layers)&&Bt(o,e,n,a,l,c)}}function Bt(t,e,n,r,i,s){t.onBeforeRender(x,e,n,r,i,s),t.modelViewMatrix.multiplyMatrices(n.matrixWorldInverse,t.matrixWorld),t.normalMatrix.getNormalMatrix(t.modelViewMatrix),i.onBeforeRender(x,e,n,r,t,s),!0===i.transparent&&i.side===y?(i.side=v,i.needsUpdate=!0,x.renderBufferDirect(n,e,r,i,t,s),i.side=g,i.needsUpdate=!0,x.renderBufferDirect(n,e,r,i,t,s),i.side=y):x.renderBufferDirect(n,e,r,i,t,s),t.onAfterRender(x,e,n,r,i,s)}function Gt(t,e,n){!0!==e.isScene&&(e=j);const r=K.get(t),i=f.state.lights,s=f.state.shadowsArray,o=i.state.version,a=it.getParameters(t,i.state,s,e,n),l=it.getProgramCacheKey(a);let c=r.programs;r.environment=t.isMeshStandardMaterial?e.environment:null,r.fog=e.fog,r.envMap=(t.isMeshStandardMaterial?$:Q).get(t.envMap||r.environment),void 0===c&&(t.addEventListener("dispose",At),c=new Map,r.programs=c);let u=c.get(l);if(void 0!==u){if(r.currentProgram===u&&r.lightsStateVersion===o)return Ht(t,a),u}else a.uniforms=it.getUniforms(t),t.onBuild(n,a,x),t.onBeforeCompile(a,x),u=it.acquireProgram(a,l),c.set(l,u),r.uniforms=a.uniforms;const h=r.uniforms;(t.isShaderMaterial||t.isRawShaderMaterial)&&!0!==t.clipping||(h.clippingPlanes=lt.uniform),Ht(t,a),r.needsLights=Wt(t),r.lightsStateVersion=o,r.needsLights&&(h.ambientLightColor.value=i.state.ambient,h.lightProbe.value=i.state.probe,h.directionalLights.value=i.state.directional,h.directionalLightShadows.value=i.state.directionalShadow,h.spotLights.value=i.state.spot,h.spotLightShadows.value=i.state.spotShadow,h.rectAreaLights.value=i.state.rectArea,h.ltc_1.value=i.state.rectAreaLTC1,h.ltc_2.value=i.state.rectAreaLTC2,h.pointLights.value=i.state.point,h.pointLightShadows.value=i.state.pointShadow,h.hemisphereLights.value=i.state.hemi,h.directionalShadowMap.value=i.state.directionalShadowMap,h.directionalShadowMatrix.value=i.state.directionalShadowMatrix,h.spotShadowMap.value=i.state.spotShadowMap,h.spotShadowMatrix.value=i.state.spotShadowMatrix,h.pointShadowMap.value=i.state.pointShadowMap,h.pointShadowMatrix.value=i.state.pointShadowMatrix);const d=u.getUniforms(),p=mu.seqWithValue(d.seq,h);return r.currentProgram=u,r.uniformsList=p,u}function Ht(t,e){const n=K.get(t);n.outputEncoding=e.outputEncoding,n.instancing=e.instancing,n.skinning=e.skinning,n.morphTargets=e.morphTargets,n.morphNormals=e.morphNormals,n.morphColors=e.morphColors,n.morphTargetsCount=e.morphTargetsCount,n.numClippingPlanes=e.numClippingPlanes,n.numIntersection=e.numClipIntersection,n.vertexAlphas=e.vertexAlphas,n.vertexTangents=e.vertexTangents,n.toneMapping=e.toneMapping}function Vt(t,e,n,r,i){!0!==e.isScene&&(e=j),Z.resetTextureUnits();const s=e.fog,o=r.isMeshStandardMaterial?e.environment:null,a=null===M?x.outputEncoding:!0===M.isXRRenderTarget?M.texture.encoding:ke,l=(r.isMeshStandardMaterial?$:Q).get(r.envMap||o),c=!0===r.vertexColors&&!!n.attributes.color&&4===n.attributes.color.itemSize,u=!!r.normalMap&&!!n.attributes.tangent,h=!!n.morphAttributes.position,d=!!n.morphAttributes.normal,p=!!n.morphAttributes.color,m=r.toneMapped?x.toneMapping:tt,g=n.morphAttributes.position||n.morphAttributes.normal||n.morphAttributes.color,v=void 0!==g?g.length:0,y=K.get(r),b=f.state.lights;if(!0===F&&(!0===U||t!==S)){const e=t===S&&r.id===A;lt.setState(r,t,e)}let w=!1;r.version===y.__version?y.needsLights&&y.lightsStateVersion!==b.state.version||y.outputEncoding!==a||i.isInstancedMesh&&!1===y.instancing?w=!0:i.isInstancedMesh||!0!==y.instancing?i.isSkinnedMesh&&!1===y.skinning?w=!0:i.isSkinnedMesh||!0!==y.skinning?y.envMap!==l||!0===r.fog&&y.fog!==s?w=!0:void 0===y.numClippingPlanes||y.numClippingPlanes===lt.numPlanes&&y.numIntersection===lt.numIntersection?(y.vertexAlphas!==c||y.vertexTangents!==u||y.morphTargets!==h||y.morphNormals!==d||y.morphColors!==p||y.toneMapping!==m||!0===Y.isWebGL2&&y.morphTargetsCount!==v)&&(w=!0):w=!0:w=!0:w=!0:(w=!0,y.__version=r.version);let _=y.currentProgram;!0===w&&(_=Gt(r,e,i));let E=!1,T=!1,C=!1;const R=_.getUniforms(),L=y.uniforms;if(X.useProgram(_.program)&&(E=!0,T=!0,C=!0),r.id!==A&&(A=r.id,T=!0),E||S!==t){if(R.setValue(gt,"projectionMatrix",t.projectionMatrix),Y.logarithmicDepthBuffer&&R.setValue(gt,"logDepthBufFC",2/(Math.log(t.far+1)/Math.LN2)),S!==t&&(S=t,T=!0,C=!0),r.isShaderMaterial||r.isMeshPhongMaterial||r.isMeshToonMaterial||r.isMeshStandardMaterial||r.envMap){const e=R.map.cameraPosition;void 0!==e&&e.setValue(gt,V.setFromMatrixPosition(t.matrixWorld))}(r.isMeshPhongMaterial||r.isMeshToonMaterial||r.isMeshLambertMaterial||r.isMeshBasicMaterial||r.isMeshStandardMaterial||r.isShaderMaterial)&&R.setValue(gt,"isOrthographic",!0===t.isOrthographicCamera),(r.isMeshPhongMaterial||r.isMeshToonMaterial||r.isMeshLambertMaterial||r.isMeshBasicMaterial||r.isMeshStandardMaterial||r.isShaderMaterial||r.isShadowMaterial||i.isSkinnedMesh)&&R.setValue(gt,"viewMatrix",t.matrixWorldInverse)}if(i.isSkinnedMesh){R.setOptional(gt,i,"bindMatrix"),R.setOptional(gt,i,"bindMatrixInverse");const t=i.skeleton;t&&(Y.floatVertexTextures?(null===t.boneTexture&&t.computeBoneTexture(),R.setValue(gt,"boneTexture",t.boneTexture,Z),R.setValue(gt,"boneTextureSize",t.boneTextureSize)):console.warn("THREE.WebGLRenderer: SkinnedMesh can only be used with WebGL 2. With WebGL 1 OES_texture_float and vertex textures support is required."))}const N=n.morphAttributes;return(void 0!==N.position||void 0!==N.normal||void 0!==N.color&&!0===Y.isWebGL2)&&ht.update(i,n,r,_),(T||y.receiveShadow!==i.receiveShadow)&&(y.receiveShadow=i.receiveShadow,R.setValue(gt,"receiveShadow",i.receiveShadow)),T&&(R.setValue(gt,"toneMappingExposure",x.toneMappingExposure),y.needsLights&&jt(L,C),s&&!0===r.fog&&st.refreshFogUniforms(L,s),st.refreshMaterialUniforms(L,r,P,I,B),mu.upload(gt,y.uniformsList,L,Z)),r.isShaderMaterial&&!0===r.uniformsNeedUpdate&&(mu.upload(gt,y.uniformsList,L,Z),r.uniformsNeedUpdate=!1),r.isSpriteMaterial&&R.setValue(gt,"center",i.center),R.setValue(gt,"modelViewMatrix",i.modelViewMatrix),R.setValue(gt,"normalMatrix",i.normalMatrix),R.setValue(gt,"modelMatrix",i.matrixWorld),_}function jt(t,e){t.ambientLightColor.needsUpdate=e,t.lightProbe.needsUpdate=e,t.directionalLights.needsUpdate=e,t.directionalLightShadows.needsUpdate=e,t.pointLights.needsUpdate=e,t.pointLightShadows.needsUpdate=e,t.spotLights.needsUpdate=e,t.spotLightShadows.needsUpdate=e,t.rectAreaLights.needsUpdate=e,t.hemisphereLights.needsUpdate=e}function Wt(t){return t.isMeshLambertMaterial||t.isMeshToonMaterial||t.isMeshPhongMaterial||t.isMeshStandardMaterial||t.isShadowMaterial||t.isShaderMaterial&&!0===t.lights}kt.setAnimationLoop(Rt),"undefined"!==typeof self&&kt.setContext(self),this.setAnimationLoop=function(t){Ct=t,xt.setAnimationLoop(t),null===t?kt.stop():kt.start()},xt.addEventListener("sessionstart",It),xt.addEventListener("sessionend",Nt),this.render=function(t,e){if(void 0!==e&&!0!==e.isCamera)return void console.error("THREE.WebGLRenderer.render: camera is not an instance of THREE.Camera.");if(!0===b)return;!0===t.autoUpdate&&t.updateMatrixWorld(),null===e.parent&&e.updateMatrixWorld(),!0===xt.enabled&&!0===xt.isPresenting&&(!0===xt.cameraAutoUpdate&&xt.updateCamera(e),e=xt.getCamera()),!0===t.isScene&&t.onBeforeRender(x,t,e,M),f=at.get(t,m.length),f.init(),m.push(f),G.multiplyMatrices(e.projectionMatrix,e.matrixWorldInverse),z.setFromProjectionMatrix(G),U=this.localClippingEnabled,F=lt.init(this.clippingPlanes,U,e),d=ot.get(t,p.length),d.init(),p.push(d),Ot(t,e,0,x.sortObjects),d.finish(),!0===x.sortObjects&&d.sort(L,N),!0===F&&lt.beginShadows();const n=f.state.shadowsArray;if(ct.render(n,t,e),!0===F&&lt.endShadows(),!0===this.info.autoReset&&this.info.reset(),ut.render(d,t),f.setupLights(x.physicallyCorrectLights),e.isArrayCamera){const n=e.cameras;for(let e=0,r=n.length;e<r;e++){const r=n[e];Dt(d,t,r,r.viewport)}}else Dt(d,t,e);null!==M&&(Z.updateMultisampleRenderTarget(M),Z.updateRenderTargetMipmap(M)),!0===t.isScene&&t.onAfterRender(x,t,e),mt.resetDefaultState(),A=-1,S=null,m.pop(),f=m.length>0?m[m.length-1]:null,p.pop(),d=p.length>0?p[p.length-1]:null},this.getActiveCubeFace=function(){return w},this.getActiveMipmapLevel=function(){return _},this.getRenderTarget=function(){return M},this.setRenderTargetTextures=function(t,e,n){K.get(t.texture).__webglTexture=e,K.get(t.depthTexture).__webglTexture=n;const r=K.get(t);r.__hasExternalTextures=!0,r.__hasExternalTextures&&(r.__autoAllocateDepthBuffer=void 0===n,r.__autoAllocateDepthBuffer||!0===q.has("WEBGL_multisampled_render_to_texture")&&(console.warn("THREE.WebGLRenderer: Render-to-texture extension was disabled because an external texture was provided"),r.__useRenderToTexture=!1))},this.setRenderTargetFramebuffer=function(t,e){const n=K.get(t);n.__webglFramebuffer=e,n.__useDefaultFramebuffer=void 0===e},this.setRenderTarget=function(t,e=0,n=0){M=t,w=e,_=n;let r=!0;if(t){const e=K.get(t);void 0!==e.__useDefaultFramebuffer?(X.bindFramebuffer(36160,null),r=!1):void 0===e.__webglFramebuffer?Z.setupRenderTarget(t):e.__hasExternalTextures&&Z.rebindTextures(t,K.get(t.texture).__webglTexture,K.get(t.depthTexture).__webglTexture)}let i=null,s=!1,o=!1;if(t){const n=t.texture;(n.isData3DTexture||n.isDataArrayTexture)&&(o=!0);const r=K.get(t).__webglFramebuffer;t.isWebGLCubeRenderTarget?(i=r[e],s=!0):i=Y.isWebGL2&&t.samples>0&&!1===Z.useMultisampledRTT(t)?K.get(t).__webglMultisampledFramebuffer:r,E.copy(t.viewport),T.copy(t.scissor),C=t.scissorTest}else E.copy(k).multiplyScalar(P).floor(),T.copy(O).multiplyScalar(P).floor(),C=D;const a=X.bindFramebuffer(36160,i);if(a&&Y.drawBuffers&&r&&X.drawBuffers(t,i),X.viewport(E),X.scissor(T),X.setScissorTest(C),s){const r=K.get(t.texture);gt.framebufferTexture2D(36160,36064,34069+e,r.__webglTexture,n)}else if(o){const r=K.get(t.texture),i=e||0;gt.framebufferTextureLayer(36160,36064,r.__webglTexture,n||0,i)}A=-1},this.readRenderTargetPixels=function(t,e,n,r,i,s,o){if(!t||!t.isWebGLRenderTarget)return void console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.");let a=K.get(t).__webglFramebuffer;if(t.isWebGLCubeRenderTarget&&void 0!==o&&(a=a[o]),a){X.bindFramebuffer(36160,a);try{const o=t.texture,a=o.format,l=o.type;if(a!==Ft&&pt.convert(a)!==gt.getParameter(35739))return void console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in RGBA or implementation defined format.");const c=l===Lt&&(q.has("EXT_color_buffer_half_float")||Y.isWebGL2&&q.has("EXT_color_buffer_float"));if(l!==St&&pt.convert(l)!==gt.getParameter(35738)&&(l!==Pt||!(Y.isWebGL2||q.has("OES_texture_float")||q.has("WEBGL_color_buffer_float")))&&!c)return void console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in UnsignedByteType or implementation defined type.");e>=0&&e<=t.width-r&&n>=0&&n<=t.height-i&&gt.readPixels(e,n,r,i,pt.convert(a),pt.convert(l),s)}finally{const t=null!==M?K.get(M).__webglFramebuffer:null;X.bindFramebuffer(36160,t)}}},this.copyFramebufferToTexture=function(t,e,n=0){const r=Math.pow(2,-n),i=Math.floor(e.image.width*r),s=Math.floor(e.image.height*r);Z.setTexture2D(e,0),gt.copyTexSubImage2D(3553,n,0,0,t.x,t.y,i,s),X.unbindTexture()},this.copyTextureToTexture=function(t,e,n,r=0){const i=e.image.width,s=e.image.height,o=pt.convert(n.format),a=pt.convert(n.type);Z.setTexture2D(n,0),gt.pixelStorei(37440,n.flipY),gt.pixelStorei(37441,n.premultiplyAlpha),gt.pixelStorei(3317,n.unpackAlignment),e.isDataTexture?gt.texSubImage2D(3553,r,t.x,t.y,i,s,o,a,e.image.data):e.isCompressedTexture?gt.compressedTexSubImage2D(3553,r,t.x,t.y,e.mipmaps[0].width,e.mipmaps[0].height,o,e.mipmaps[0].data):gt.texSubImage2D(3553,r,t.x,t.y,o,a,e.image),0===r&&n.generateMipmaps&&gt.generateMipmap(3553),X.unbindTexture()},this.copyTextureToTexture3D=function(t,e,n,r,i=0){if(x.isWebGL1Renderer)return void console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: can only be used with WebGL2.");const s=t.max.x-t.min.x+1,o=t.max.y-t.min.y+1,a=t.max.z-t.min.z+1,l=pt.convert(r.format),c=pt.convert(r.type);let u;if(r.isData3DTexture)Z.setTexture3D(r,0),u=32879;else{if(!r.isDataArrayTexture)return void console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: only supports THREE.DataTexture3D and THREE.DataTexture2DArray.");Z.setTexture2DArray(r,0),u=35866}gt.pixelStorei(37440,r.flipY),gt.pixelStorei(37441,r.premultiplyAlpha),gt.pixelStorei(3317,r.unpackAlignment);const h=gt.getParameter(3314),d=gt.getParameter(32878),f=gt.getParameter(3316),p=gt.getParameter(3315),m=gt.getParameter(32877),g=n.isCompressedTexture?n.mipmaps[0]:n.image;gt.pixelStorei(3314,g.width),gt.pixelStorei(32878,g.height),gt.pixelStorei(3316,t.min.x),gt.pixelStorei(3315,t.min.y),gt.pixelStorei(32877,t.min.z),n.isDataTexture||n.isData3DTexture?gt.texSubImage3D(u,i,e.x,e.y,e.z,s,o,a,l,c,g.data):n.isCompressedTexture?(console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: untested support for compressed srcTexture."),gt.compressedTexSubImage3D(u,i,e.x,e.y,e.z,s,o,a,l,g.data)):gt.texSubImage3D(u,i,e.x,e.y,e.z,s,o,a,l,c,g),gt.pixelStorei(3314,h),gt.pixelStorei(32878,d),gt.pixelStorei(3316,f),gt.pixelStorei(3315,p),gt.pixelStorei(32877,m),0===i&&r.generateMipmaps&&gt.generateMipmap(u),X.unbindTexture()},this.initTexture=function(t){Z.setTexture2D(t,0),X.unbindTexture()},this.resetState=function(){w=0,_=0,M=null,X.reset(),mt.reset()},"undefined"!==typeof __THREE_DEVTOOLS__&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}class Mh extends _h{}Mh.prototype.isWebGL1Renderer=!0;class Ah{constructor(t,e=25e-5){this.isFogExp2=!0,this.name="",this.color=new lr(t),this.density=e}clone(){return new Ah(this.color,this.density)}toJSON(){return{type:"FogExp2",color:this.color.getHex(),density:this.density}}}class Sh{constructor(t,e=1,n=1e3){this.isFog=!0,this.name="",this.color=new lr(t),this.near=e,this.far=n}clone(){return new Sh(this.color,this.near,this.far)}toJSON(){return{type:"Fog",color:this.color.getHex(),near:this.near,far:this.far}}}class Eh extends Si{constructor(){super(),this.isScene=!0,this.type="Scene",this.background=null,this.environment=null,this.fog=null,this.overrideMaterial=null,this.autoUpdate=!0,"undefined"!==typeof __THREE_DEVTOOLS__&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}copy(t,e){return super.copy(t,e),null!==t.background&&(this.background=t.background.clone()),null!==t.environment&&(this.environment=t.environment.clone()),null!==t.fog&&(this.fog=t.fog.clone()),null!==t.overrideMaterial&&(this.overrideMaterial=t.overrideMaterial.clone()),this.autoUpdate=t.autoUpdate,this.matrixAutoUpdate=t.matrixAutoUpdate,this}toJSON(t){const e=super.toJSON(t);return null!==this.fog&&(e.object.fog=this.fog.toJSON()),e}}class Th{constructor(t,e){this.isInterleavedBuffer=!0,this.array=t,this.stride=e,this.count=void 0!==t?t.length/e:0,this.usage=on,this.updateRange={offset:0,count:-1},this.version=0,this.uuid=Mn()}onUploadCallback(){}set needsUpdate(t){!0===t&&this.version++}setUsage(t){return this.usage=t,this}copy(t){return this.array=new t.array.constructor(t.array),this.count=t.count,this.stride=t.stride,this.usage=t.usage,this}copyAt(t,e,n){t*=this.stride,n*=e.stride;for(let r=0,i=this.stride;r<i;r++)this.array[t+r]=e.array[n+r];return this}set(t,e=0){return this.array.set(t,e),this}clone(t){void 0===t.arrayBuffers&&(t.arrayBuffers={}),void 0===this.array.buffer._uuid&&(this.array.buffer._uuid=Mn()),void 0===t.arrayBuffers[this.array.buffer._uuid]&&(t.arrayBuffers[this.array.buffer._uuid]=this.array.slice(0).buffer);const e=new this.array.constructor(t.arrayBuffers[this.array.buffer._uuid]),n=new this.constructor(e,this.stride);return n.setUsage(this.usage),n}onUpload(t){return this.onUploadCallback=t,this}toJSON(t){return void 0===t.arrayBuffers&&(t.arrayBuffers={}),void 0===this.array.buffer._uuid&&(this.array.buffer._uuid=Mn()),void 0===t.arrayBuffers[this.array.buffer._uuid]&&(t.arrayBuffers[this.array.buffer._uuid]=Array.prototype.slice.call(new Uint32Array(this.array.buffer))),{uuid:this.uuid,buffer:this.array.buffer._uuid,type:this.array.constructor.name,stride:this.stride}}}const Ch=new Mr;class Rh{constructor(t,e,n,r=!1){this.isInterleavedBufferAttribute=!0,this.name="",this.data=t,this.itemSize=e,this.offset=n,this.normalized=!0===r}get count(){return this.data.count}get array(){return this.data.array}set needsUpdate(t){this.data.needsUpdate=t}applyMatrix4(t){for(let e=0,n=this.data.count;e<n;e++)Ch.fromBufferAttribute(this,e),Ch.applyMatrix4(t),this.setXYZ(e,Ch.x,Ch.y,Ch.z);return this}applyNormalMatrix(t){for(let e=0,n=this.count;e<n;e++)Ch.fromBufferAttribute(this,e),Ch.applyNormalMatrix(t),this.setXYZ(e,Ch.x,Ch.y,Ch.z);return this}transformDirection(t){for(let e=0,n=this.count;e<n;e++)Ch.fromBufferAttribute(this,e),Ch.transformDirection(t),this.setXYZ(e,Ch.x,Ch.y,Ch.z);return this}setX(t,e){return this.data.array[t*this.data.stride+this.offset]=e,this}setY(t,e){return this.data.array[t*this.data.stride+this.offset+1]=e,this}setZ(t,e){return this.data.array[t*this.data.stride+this.offset+2]=e,this}setW(t,e){return this.data.array[t*this.data.stride+this.offset+3]=e,this}getX(t){return this.data.array[t*this.data.stride+this.offset]}getY(t){return this.data.array[t*this.data.stride+this.offset+1]}getZ(t){return this.data.array[t*this.data.stride+this.offset+2]}getW(t){return this.data.array[t*this.data.stride+this.offset+3]}setXY(t,e,n){return t=t*this.data.stride+this.offset,this.data.array[t+0]=e,this.data.array[t+1]=n,this}setXYZ(t,e,n,r){return t=t*this.data.stride+this.offset,this.data.array[t+0]=e,this.data.array[t+1]=n,this.data.array[t+2]=r,this}setXYZW(t,e,n,r,i){return t=t*this.data.stride+this.offset,this.data.array[t+0]=e,this.data.array[t+1]=n,this.data.array[t+2]=r,this.data.array[t+3]=i,this}clone(t){if(void 0===t){console.log("THREE.InterleavedBufferAttribute.clone(): Cloning an interlaved buffer attribute will deinterleave buffer data.");const t=[];for(let e=0;e<this.count;e++){const n=e*this.data.stride+this.offset;for(let e=0;e<this.itemSize;e++)t.push(this.data.array[n+e])}return new Hi(new this.array.constructor(t),this.itemSize,this.normalized)}return void 0===t.interleavedBuffers&&(t.interleavedBuffers={}),void 0===t.interleavedBuffers[this.data.uuid]&&(t.interleavedBuffers[this.data.uuid]=this.data.clone(t)),new Rh(t.interleavedBuffers[this.data.uuid],this.itemSize,this.offset,this.normalized)}toJSON(t){if(void 0===t){console.log("THREE.InterleavedBufferAttribute.toJSON(): Serializing an interlaved buffer attribute will deinterleave buffer data.");const t=[];for(let e=0;e<this.count;e++){const n=e*this.data.stride+this.offset;for(let e=0;e<this.itemSize;e++)t.push(this.data.array[n+e])}return{itemSize:this.itemSize,type:this.array.constructor.name,array:t,normalized:this.normalized}}return void 0===t.interleavedBuffers&&(t.interleavedBuffers={}),void 0===t.interleavedBuffers[this.data.uuid]&&(t.interleavedBuffers[this.data.uuid]=this.data.toJSON(t)),{isInterleavedBufferAttribute:!0,itemSize:this.itemSize,data:this.data.uuid,offset:this.offset,normalized:this.normalized}}}class Ih extends Fi{constructor(t){super(),this.isSpriteMaterial=!0,this.type="SpriteMaterial",this.color=new lr(16777215),this.map=null,this.alphaMap=null,this.rotation=0,this.sizeAttenuation=!0,this.transparent=!0,this.fog=!0,this.setValues(t)}copy(t){return super.copy(t),this.color.copy(t.color),this.map=t.map,this.alphaMap=t.alphaMap,this.rotation=t.rotation,this.sizeAttenuation=t.sizeAttenuation,this.fog=t.fog,this}}let Ph;const Lh=new Mr,Nh=new Mr,kh=new Mr,Oh=new qn,Dh=new qn,zh=new ti,Fh=new Mr,Uh=new Mr,Bh=new Mr,Gh=new qn,Hh=new qn,Vh=new qn;class jh extends Si{constructor(t){if(super(),this.isSprite=!0,this.type="Sprite",void 0===Ph){Ph=new os;const t=new Float32Array([-.5,-.5,0,0,0,.5,-.5,0,1,0,.5,.5,0,1,1,-.5,.5,0,0,1]),e=new Th(t,5);Ph.setIndex([0,1,2,0,2,3]),Ph.setAttribute("position",new Rh(e,3,0,!1)),Ph.setAttribute("uv",new Rh(e,2,3,!1))}this.geometry=Ph,this.material=void 0!==t?t:new Ih,this.center=new qn(.5,.5)}raycast(t,e){null===t.camera&&console.error('THREE.Sprite: "Raycaster.camera" needs to be set in order to raycast against sprites.'),Nh.setFromMatrixScale(this.matrixWorld),zh.copy(t.camera.matrixWorld),this.modelViewMatrix.multiplyMatrices(t.camera.matrixWorldInverse,this.matrixWorld),kh.setFromMatrixPosition(this.modelViewMatrix),t.camera.isPerspectiveCamera&&!1===this.material.sizeAttenuation&&Nh.multiplyScalar(-kh.z);const n=this.material.rotation;let r,i;0!==n&&(i=Math.cos(n),r=Math.sin(n));const s=this.center;Wh(Fh.set(-.5,-.5,0),kh,s,Nh,r,i),Wh(Uh.set(.5,-.5,0),kh,s,Nh,r,i),Wh(Bh.set(.5,.5,0),kh,s,Nh,r,i),Gh.set(0,0),Hh.set(1,0),Vh.set(1,1);let o=t.ray.intersectTriangle(Fh,Uh,Bh,!1,Lh);if(null===o&&(Wh(Uh.set(-.5,.5,0),kh,s,Nh,r,i),Hh.set(0,1),o=t.ray.intersectTriangle(Fh,Bh,Uh,!1,Lh),null===o))return;const a=t.ray.origin.distanceTo(Lh);a<t.near||a>t.far||e.push({distance:a,point:Lh.clone(),uv:Di.getUV(Lh,Fh,Uh,Bh,Gh,Hh,Vh,new qn),face:null,object:this})}copy(t,e){return super.copy(t,e),void 0!==t.center&&this.center.copy(t.center),this.material=t.material,this}}function Wh(t,e,n,r,i,s){Oh.subVectors(t,n).addScalar(.5).multiply(r),void 0!==i?(Dh.x=s*Oh.x-i*Oh.y,Dh.y=i*Oh.x+s*Oh.y):Dh.copy(Oh),t.copy(e),t.x+=Dh.x,t.y+=Dh.y,t.applyMatrix4(zh)}const qh=new Mr,Yh=new Mr;class Xh extends Si{constructor(){super(),this._currentLevel=0,this.type="LOD",Object.defineProperties(this,{levels:{enumerable:!0,value:[]},isLOD:{value:!0}}),this.autoUpdate=!0}copy(t){super.copy(t,!1);const e=t.levels;for(let n=0,r=e.length;n<r;n++){const t=e[n];this.addLevel(t.object.clone(),t.distance)}return this.autoUpdate=t.autoUpdate,this}addLevel(t,e=0){e=Math.abs(e);const n=this.levels;let r;for(r=0;r<n.length;r++)if(e<n[r].distance)break;return n.splice(r,0,{distance:e,object:t}),this.add(t),this}getCurrentLevel(){return this._currentLevel}getObjectForDistance(t){const e=this.levels;if(e.length>0){let n,r;for(n=1,r=e.length;n<r;n++)if(t<e[n].distance)break;return e[n-1].object}return null}raycast(t,e){const n=this.levels;if(n.length>0){qh.setFromMatrixPosition(this.matrixWorld);const n=t.ray.origin.distanceTo(qh);this.getObjectForDistance(n).raycast(t,e)}}update(t){const e=this.levels;if(e.length>1){qh.setFromMatrixPosition(t.matrixWorld),Yh.setFromMatrixPosition(this.matrixWorld);const n=qh.distanceTo(Yh)/t.zoom;let r,i;for(e[0].object.visible=!0,r=1,i=e.length;r<i;r++){if(!(n>=e[r].distance))break;e[r-1].object.visible=!1,e[r].object.visible=!0}for(this._currentLevel=r-1;r<i;r++)e[r].object.visible=!1}}toJSON(t){const e=super.toJSON(t);!1===this.autoUpdate&&(e.object.autoUpdate=!1),e.object.levels=[];const n=this.levels;for(let r=0,i=n.length;r<i;r++){const t=n[r];e.object.levels.push({object:t.object.uuid,distance:t.distance})}return e}}const Jh=new Mr,Kh=new mr,Zh=new mr,Qh=new Mr,$h=new ti;class td extends As{constructor(t,e){super(t,e),this.isSkinnedMesh=!0,this.type="SkinnedMesh",this.bindMode="attached",this.bindMatrix=new ti,this.bindMatrixInverse=new ti}copy(t,e){return super.copy(t,e),this.bindMode=t.bindMode,this.bindMatrix.copy(t.bindMatrix),this.bindMatrixInverse.copy(t.bindMatrixInverse),this.skeleton=t.skeleton,this}bind(t,e){this.skeleton=t,void 0===e&&(this.updateMatrixWorld(!0),this.skeleton.calculateInverses(),e=this.matrixWorld),this.bindMatrix.copy(e),this.bindMatrixInverse.copy(e).invert()}pose(){this.skeleton.pose()}normalizeSkinWeights(){const t=new mr,e=this.geometry.attributes.skinWeight;for(let n=0,r=e.count;n<r;n++){t.fromBufferAttribute(e,n);const r=1/t.manhattanLength();r!==1/0?t.multiplyScalar(r):t.set(1,0,0,0),e.setXYZW(n,t.x,t.y,t.z,t.w)}}updateMatrixWorld(t){super.updateMatrixWorld(t),"attached"===this.bindMode?this.bindMatrixInverse.copy(this.matrixWorld).invert():"detached"===this.bindMode?this.bindMatrixInverse.copy(this.bindMatrix).invert():console.warn("THREE.SkinnedMesh: Unrecognized bindMode: "+this.bindMode)}boneTransform(t,e){const n=this.skeleton,r=this.geometry;Kh.fromBufferAttribute(r.attributes.skinIndex,t),Zh.fromBufferAttribute(r.attributes.skinWeight,t),Jh.copy(e).applyMatrix4(this.bindMatrix),e.set(0,0,0);for(let i=0;i<4;i++){const t=Zh.getComponent(i);if(0!==t){const r=Kh.getComponent(i);$h.multiplyMatrices(n.bones[r].matrixWorld,n.boneInverses[r]),e.addScaledVector(Qh.copy(Jh).applyMatrix4($h),t)}}return e.applyMatrix4(this.bindMatrixInverse)}}class ed extends Si{constructor(){super(),this.isBone=!0,this.type="Bone"}}class nd extends pr{constructor(t=null,e=1,n=1,r,i,s,o,a,l=mt,c=mt,u,h){super(null,s,o,a,l,c,r,i,u,h),this.isDataTexture=!0,this.image={data:t,width:e,height:n},this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}const rd=new ti,id=new ti;class sd{constructor(t=[],e=[]){this.uuid=Mn(),this.bones=t.slice(0),this.boneInverses=e,this.boneMatrices=null,this.boneTexture=null,this.boneTextureSize=0,this.frame=-1,this.init()}init(){const t=this.bones,e=this.boneInverses;if(this.boneMatrices=new Float32Array(16*t.length),0===e.length)this.calculateInverses();else if(t.length!==e.length){console.warn("THREE.Skeleton: Number of inverse bone matrices does not match amount of bones."),this.boneInverses=[];for(let t=0,e=this.bones.length;t<e;t++)this.boneInverses.push(new ti)}}calculateInverses(){this.boneInverses.length=0;for(let t=0,e=this.bones.length;t<e;t++){const e=new ti;this.bones[t]&&e.copy(this.bones[t].matrixWorld).invert(),this.boneInverses.push(e)}}pose(){for(let t=0,e=this.bones.length;t<e;t++){const e=this.bones[t];e&&e.matrixWorld.copy(this.boneInverses[t]).invert()}for(let t=0,e=this.bones.length;t<e;t++){const e=this.bones[t];e&&(e.parent&&e.parent.isBone?(e.matrix.copy(e.parent.matrixWorld).invert(),e.matrix.multiply(e.matrixWorld)):e.matrix.copy(e.matrixWorld),e.matrix.decompose(e.position,e.quaternion,e.scale))}}update(){const t=this.bones,e=this.boneInverses,n=this.boneMatrices,r=this.boneTexture;for(let i=0,s=t.length;i<s;i++){const r=t[i]?t[i].matrixWorld:id;rd.multiplyMatrices(r,e[i]),rd.toArray(n,16*i)}null!==r&&(r.needsUpdate=!0)}clone(){return new sd(this.bones,this.boneInverses)}computeBoneTexture(){let t=Math.sqrt(4*this.bones.length);t=Bn(t),t=Math.max(t,4);const e=new Float32Array(t*t*4);e.set(this.boneMatrices);const n=new nd(e,t,t,Ft,Pt);return n.needsUpdate=!0,this.boneMatrices=e,this.boneTexture=n,this.boneTextureSize=t,this}getBoneByName(t){for(let e=0,n=this.bones.length;e<n;e++){const n=this.bones[e];if(n.name===t)return n}}dispose(){null!==this.boneTexture&&(this.boneTexture.dispose(),this.boneTexture=null)}fromJSON(t,e){this.uuid=t.uuid;for(let n=0,r=t.bones.length;n<r;n++){const r=t.bones[n];let i=e[r];void 0===i&&(console.warn("THREE.Skeleton: No bone found with UUID:",r),i=new ed),this.bones.push(i),this.boneInverses.push((new ti).fromArray(t.boneInverses[n]))}return this.init(),this}toJSON(){const t={metadata:{version:4.5,type:"Skeleton",generator:"Skeleton.toJSON"},bones:[],boneInverses:[]};t.uuid=this.uuid;const e=this.bones,n=this.boneInverses;for(let r=0,i=e.length;r<i;r++){const i=e[r];t.bones.push(i.uuid);const s=n[r];t.boneInverses.push(s.toArray())}return t}}class od extends Hi{constructor(t,e,n,r=1){"number"===typeof n&&(r=n,n=!1,console.error("THREE.InstancedBufferAttribute: The constructor now expects normalized as the third argument.")),super(t,e,n),this.isInstancedBufferAttribute=!0,this.meshPerAttribute=r}copy(t){return super.copy(t),this.meshPerAttribute=t.meshPerAttribute,this}toJSON(){const t=super.toJSON();return t.meshPerAttribute=this.meshPerAttribute,t.isInstancedBufferAttribute=!0,t}}const ad=new ti,ld=new ti,cd=[],ud=new As;class hd extends As{constructor(t,e,n){super(t,e),this.isInstancedMesh=!0,this.instanceMatrix=new od(new Float32Array(16*n),16),this.instanceColor=null,this.count=n,this.frustumCulled=!1}copy(t,e){return super.copy(t,e),this.instanceMatrix.copy(t.instanceMatrix),null!==t.instanceColor&&(this.instanceColor=t.instanceColor.clone()),this.count=t.count,this}getColorAt(t,e){e.fromArray(this.instanceColor.array,3*t)}getMatrixAt(t,e){e.fromArray(this.instanceMatrix.array,16*t)}raycast(t,e){const n=this.matrixWorld,r=this.count;if(ud.geometry=this.geometry,ud.material=this.material,void 0!==ud.material)for(let i=0;i<r;i++){this.getMatrixAt(i,ad),ld.multiplyMatrices(n,ad),ud.matrixWorld=ld,ud.raycast(t,cd);for(let t=0,n=cd.length;t<n;t++){const n=cd[t];n.instanceId=i,n.object=this,e.push(n)}cd.length=0}}setColorAt(t,e){null===this.instanceColor&&(this.instanceColor=new od(new Float32Array(3*this.instanceMatrix.count),3)),e.toArray(this.instanceColor.array,3*t)}setMatrixAt(t,e){e.toArray(this.instanceMatrix.array,16*t)}updateMorphTargets(){}dispose(){this.dispatchEvent({type:"dispose"})}}class dd extends Fi{constructor(t){super(),this.isLineBasicMaterial=!0,this.type="LineBasicMaterial",this.color=new lr(16777215),this.linewidth=1,this.linecap="round",this.linejoin="round",this.fog=!0,this.setValues(t)}copy(t){return super.copy(t),this.color.copy(t.color),this.linewidth=t.linewidth,this.linecap=t.linecap,this.linejoin=t.linejoin,this.fog=t.fog,this}}const fd=new Mr,pd=new Mr,md=new ti,gd=new $r,vd=new Wr;class yd extends Si{constructor(t=new os,e=new dd){super(),this.isLine=!0,this.type="Line",this.geometry=t,this.material=e,this.updateMorphTargets()}copy(t,e){return super.copy(t,e),this.material=t.material,this.geometry=t.geometry,this}computeLineDistances(){const t=this.geometry;if(null===t.index){const e=t.attributes.position,n=[0];for(let t=1,r=e.count;t<r;t++)fd.fromBufferAttribute(e,t-1),pd.fromBufferAttribute(e,t),n[t]=n[t-1],n[t]+=fd.distanceTo(pd);t.setAttribute("lineDistance",new Zi(n,1))}else console.warn("THREE.Line.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");return this}raycast(t,e){const n=this.geometry,r=this.matrixWorld,i=t.params.Line.threshold,s=n.drawRange;if(null===n.boundingSphere&&n.computeBoundingSphere(),vd.copy(n.boundingSphere),vd.applyMatrix4(r),vd.radius+=i,!1===t.ray.intersectsSphere(vd))return;md.copy(r).invert(),gd.copy(t.ray).applyMatrix4(md);const o=i/((this.scale.x+this.scale.y+this.scale.z)/3),a=o*o,l=new Mr,c=new Mr,u=new Mr,h=new Mr,d=this.isLineSegments?2:1,f=n.index,p=n.attributes,m=p.position;if(null!==f){const n=Math.max(0,s.start),r=Math.min(f.count,s.start+s.count);for(let i=n,s=r-1;i<s;i+=d){const n=f.getX(i),r=f.getX(i+1);l.fromBufferAttribute(m,n),c.fromBufferAttribute(m,r);const s=gd.distanceSqToSegment(l,c,h,u);if(s>a)continue;h.applyMatrix4(this.matrixWorld);const o=t.ray.origin.distanceTo(h);o<t.near||o>t.far||e.push({distance:o,point:u.clone().applyMatrix4(this.matrixWorld),index:i,face:null,faceIndex:null,object:this})}}else{const n=Math.max(0,s.start),r=Math.min(m.count,s.start+s.count);for(let i=n,s=r-1;i<s;i+=d){l.fromBufferAttribute(m,i),c.fromBufferAttribute(m,i+1);const n=gd.distanceSqToSegment(l,c,h,u);if(n>a)continue;h.applyMatrix4(this.matrixWorld);const r=t.ray.origin.distanceTo(h);r<t.near||r>t.far||e.push({distance:r,point:u.clone().applyMatrix4(this.matrixWorld),index:i,face:null,faceIndex:null,object:this})}}}updateMorphTargets(){const t=this.geometry,e=t.morphAttributes,n=Object.keys(e);if(n.length>0){const t=e[n[0]];if(void 0!==t){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let e=0,n=t.length;e<n;e++){const n=t[e].name||String(e);this.morphTargetInfluences.push(0),this.morphTargetDictionary[n]=e}}}}}const xd=new Mr,bd=new Mr;class wd extends yd{constructor(t,e){super(t,e),this.isLineSegments=!0,this.type="LineSegments"}computeLineDistances(){const t=this.geometry;if(null===t.index){const e=t.attributes.position,n=[];for(let t=0,r=e.count;t<r;t+=2)xd.fromBufferAttribute(e,t),bd.fromBufferAttribute(e,t+1),n[t]=0===t?0:n[t-1],n[t+1]=n[t]+xd.distanceTo(bd);t.setAttribute("lineDistance",new Zi(n,1))}else console.warn("THREE.LineSegments.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");return this}}class _d extends yd{constructor(t,e){super(t,e),this.isLineLoop=!0,this.type="LineLoop"}}class Md extends Fi{constructor(t){super(),this.isPointsMaterial=!0,this.type="PointsMaterial",this.color=new lr(16777215),this.map=null,this.alphaMap=null,this.size=1,this.sizeAttenuation=!0,this.fog=!0,this.setValues(t)}copy(t){return super.copy(t),this.color.copy(t.color),this.map=t.map,this.alphaMap=t.alphaMap,this.size=t.size,this.sizeAttenuation=t.sizeAttenuation,this.fog=t.fog,this}}const Ad=new ti,Sd=new $r,Ed=new Wr,Td=new Mr;class Cd extends Si{constructor(t=new os,e=new Md){super(),this.isPoints=!0,this.type="Points",this.geometry=t,this.material=e,this.updateMorphTargets()}copy(t,e){return super.copy(t,e),this.material=t.material,this.geometry=t.geometry,this}raycast(t,e){const n=this.geometry,r=this.matrixWorld,i=t.params.Points.threshold,s=n.drawRange;if(null===n.boundingSphere&&n.computeBoundingSphere(),Ed.copy(n.boundingSphere),Ed.applyMatrix4(r),Ed.radius+=i,!1===t.ray.intersectsSphere(Ed))return;Ad.copy(r).invert(),Sd.copy(t.ray).applyMatrix4(Ad);const o=i/((this.scale.x+this.scale.y+this.scale.z)/3),a=o*o,l=n.index,c=n.attributes,u=c.position;if(null!==l){const n=Math.max(0,s.start),i=Math.min(l.count,s.start+s.count);for(let s=n,o=i;s<o;s++){const n=l.getX(s);Td.fromBufferAttribute(u,n),Rd(Td,n,a,r,t,e,this)}}else{const n=Math.max(0,s.start),i=Math.min(u.count,s.start+s.count);for(let s=n,o=i;s<o;s++)Td.fromBufferAttribute(u,s),Rd(Td,s,a,r,t,e,this)}}updateMorphTargets(){const t=this.geometry,e=t.morphAttributes,n=Object.keys(e);if(n.length>0){const t=e[n[0]];if(void 0!==t){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let e=0,n=t.length;e<n;e++){const n=t[e].name||String(e);this.morphTargetInfluences.push(0),this.morphTargetDictionary[n]=e}}}}}function Rd(t,e,n,r,i,s,o){const a=Sd.distanceSqToPoint(t);if(a<n){const n=new Mr;Sd.closestPointToPoint(t,n),n.applyMatrix4(r);const l=i.ray.origin.distanceTo(n);if(l<i.near||l>i.far)return;s.push({distance:l,distanceToRay:Math.sqrt(a),point:n,index:e,face:null,object:o})}}class Id extends pr{constructor(t,e,n,r,i,s,o,a,l){super(t,e,n,r,i,s,o,a,l),this.isVideoTexture=!0,this.minFilter=void 0!==s?s:bt,this.magFilter=void 0!==i?i:bt,this.generateMipmaps=!1;const c=this;function u(){c.needsUpdate=!0,t.requestVideoFrameCallback(u)}"requestVideoFrameCallback"in t&&t.requestVideoFrameCallback(u)}clone(){return new this.constructor(this.image).copy(this)}update(){const t=this.image,e="requestVideoFrameCallback"in t;!1===e&&t.readyState>=t.HAVE_CURRENT_DATA&&(this.needsUpdate=!0)}}class Pd extends pr{constructor(t,e,n){super({width:t,height:e}),this.isFramebufferTexture=!0,this.format=n,this.magFilter=mt,this.minFilter=mt,this.generateMipmaps=!1,this.needsUpdate=!0}}class Ld extends pr{constructor(t,e,n,r,i,s,o,a,l,c,u,h){super(null,s,o,a,l,c,r,i,u,h),this.isCompressedTexture=!0,this.image={width:e,height:n},this.mipmaps=t,this.flipY=!1,this.generateMipmaps=!1}}class Nd extends pr{constructor(t,e,n,r,i,s,o,a,l){super(t,e,n,r,i,s,o,a,l),this.isCanvasTexture=!0,this.needsUpdate=!0}}class kd{constructor(){this.type="Curve",this.arcLengthDivisions=200}getPoint(){return console.warn("THREE.Curve: .getPoint() not implemented."),null}getPointAt(t,e){const n=this.getUtoTmapping(t);return this.getPoint(n,e)}getPoints(t=5){const e=[];for(let n=0;n<=t;n++)e.push(this.getPoint(n/t));return e}getSpacedPoints(t=5){const e=[];for(let n=0;n<=t;n++)e.push(this.getPointAt(n/t));return e}getLength(){const t=this.getLengths();return t[t.length-1]}getLengths(t=this.arcLengthDivisions){if(this.cacheArcLengths&&this.cacheArcLengths.length===t+1&&!this.needsUpdate)return this.cacheArcLengths;this.needsUpdate=!1;const e=[];let n,r=this.getPoint(0),i=0;e.push(0);for(let s=1;s<=t;s++)n=this.getPoint(s/t),i+=n.distanceTo(r),e.push(i),r=n;return this.cacheArcLengths=e,e}updateArcLengths(){this.needsUpdate=!0,this.getLengths()}getUtoTmapping(t,e){const n=this.getLengths();let r=0;const i=n.length;let s;s=e||t*n[i-1];let o,a=0,l=i-1;while(a<=l)if(r=Math.floor(a+(l-a)/2),o=n[r]-s,o<0)a=r+1;else{if(!(o>0)){l=r;break}l=r-1}if(r=l,n[r]===s)return r/(i-1);const c=n[r],u=n[r+1],h=u-c,d=(s-c)/h,f=(r+d)/(i-1);return f}getTangent(t,e){const n=1e-4;let r=t-n,i=t+n;r<0&&(r=0),i>1&&(i=1);const s=this.getPoint(r),o=this.getPoint(i),a=e||(s.isVector2?new qn:new Mr);return a.copy(o).sub(s).normalize(),a}getTangentAt(t,e){const n=this.getUtoTmapping(t);return this.getTangent(n,e)}computeFrenetFrames(t,e){const n=new Mr,r=[],i=[],s=[],o=new Mr,a=new ti;for(let d=0;d<=t;d++){const e=d/t;r[d]=this.getTangentAt(e,new Mr)}i[0]=new Mr,s[0]=new Mr;let l=Number.MAX_VALUE;const c=Math.abs(r[0].x),u=Math.abs(r[0].y),h=Math.abs(r[0].z);c<=l&&(l=c,n.set(1,0,0)),u<=l&&(l=u,n.set(0,1,0)),h<=l&&n.set(0,0,1),o.crossVectors(r[0],n).normalize(),i[0].crossVectors(r[0],o),s[0].crossVectors(r[0],i[0]);for(let d=1;d<=t;d++){if(i[d]=i[d-1].clone(),s[d]=s[d-1].clone(),o.crossVectors(r[d-1],r[d]),o.length()>Number.EPSILON){o.normalize();const t=Math.acos(An(r[d-1].dot(r[d]),-1,1));i[d].applyMatrix4(a.makeRotationAxis(o,t))}s[d].crossVectors(r[d],i[d])}if(!0===e){let e=Math.acos(An(i[0].dot(i[t]),-1,1));e/=t,r[0].dot(o.crossVectors(i[0],i[t]))>0&&(e=-e);for(let n=1;n<=t;n++)i[n].applyMatrix4(a.makeRotationAxis(r[n],e*n)),s[n].crossVectors(r[n],i[n])}return{tangents:r,normals:i,binormals:s}}clone(){return(new this.constructor).copy(this)}copy(t){return this.arcLengthDivisions=t.arcLengthDivisions,this}toJSON(){const t={metadata:{version:4.5,type:"Curve",generator:"Curve.toJSON"}};return t.arcLengthDivisions=this.arcLengthDivisions,t.type=this.type,t}fromJSON(t){return this.arcLengthDivisions=t.arcLengthDivisions,this}}class Od extends kd{constructor(t=0,e=0,n=1,r=1,i=0,s=2*Math.PI,o=!1,a=0){super(),this.isEllipseCurve=!0,this.type="EllipseCurve",this.aX=t,this.aY=e,this.xRadius=n,this.yRadius=r,this.aStartAngle=i,this.aEndAngle=s,this.aClockwise=o,this.aRotation=a}getPoint(t,e){const n=e||new qn,r=2*Math.PI;let i=this.aEndAngle-this.aStartAngle;const s=Math.abs(i)<Number.EPSILON;while(i<0)i+=r;while(i>r)i-=r;i<Number.EPSILON&&(i=s?0:r),!0!==this.aClockwise||s||(i===r?i=-r:i-=r);const o=this.aStartAngle+t*i;let a=this.aX+this.xRadius*Math.cos(o),l=this.aY+this.yRadius*Math.sin(o);if(0!==this.aRotation){const t=Math.cos(this.aRotation),e=Math.sin(this.aRotation),n=a-this.aX,r=l-this.aY;a=n*t-r*e+this.aX,l=n*e+r*t+this.aY}return n.set(a,l)}copy(t){return super.copy(t),this.aX=t.aX,this.aY=t.aY,this.xRadius=t.xRadius,this.yRadius=t.yRadius,this.aStartAngle=t.aStartAngle,this.aEndAngle=t.aEndAngle,this.aClockwise=t.aClockwise,this.aRotation=t.aRotation,this}toJSON(){const t=super.toJSON();return t.aX=this.aX,t.aY=this.aY,t.xRadius=this.xRadius,t.yRadius=this.yRadius,t.aStartAngle=this.aStartAngle,t.aEndAngle=this.aEndAngle,t.aClockwise=this.aClockwise,t.aRotation=this.aRotation,t}fromJSON(t){return super.fromJSON(t),this.aX=t.aX,this.aY=t.aY,this.xRadius=t.xRadius,this.yRadius=t.yRadius,this.aStartAngle=t.aStartAngle,this.aEndAngle=t.aEndAngle,this.aClockwise=t.aClockwise,this.aRotation=t.aRotation,this}}class Dd extends Od{constructor(t,e,n,r,i,s){super(t,e,n,n,r,i,s),this.isArcCurve=!0,this.type="ArcCurve"}}function zd(){let t=0,e=0,n=0,r=0;function i(i,s,o,a){t=i,e=o,n=-3*i+3*s-2*o-a,r=2*i-2*s+o+a}return{initCatmullRom:function(t,e,n,r,s){i(e,n,s*(n-t),s*(r-e))},initNonuniformCatmullRom:function(t,e,n,r,s,o,a){let l=(e-t)/s-(n-t)/(s+o)+(n-e)/o,c=(n-e)/o-(r-e)/(o+a)+(r-n)/a;l*=o,c*=o,i(e,n,l,c)},calc:function(i){const s=i*i,o=s*i;return t+e*i+n*s+r*o}}}const Fd=new Mr,Ud=new zd,Bd=new zd,Gd=new zd;class Hd extends kd{constructor(t=[],e=!1,n="centripetal",r=.5){super(),this.isCatmullRomCurve3=!0,this.type="CatmullRomCurve3",this.points=t,this.closed=e,this.curveType=n,this.tension=r}getPoint(t,e=new Mr){const n=e,r=this.points,i=r.length,s=(i-(this.closed?0:1))*t;let o,a,l=Math.floor(s),c=s-l;this.closed?l+=l>0?0:(Math.floor(Math.abs(l)/i)+1)*i:0===c&&l===i-1&&(l=i-2,c=1),this.closed||l>0?o=r[(l-1)%i]:(Fd.subVectors(r[0],r[1]).add(r[0]),o=Fd);const u=r[l%i],h=r[(l+1)%i];if(this.closed||l+2<i?a=r[(l+2)%i]:(Fd.subVectors(r[i-1],r[i-2]).add(r[i-1]),a=Fd),"centripetal"===this.curveType||"chordal"===this.curveType){const t="chordal"===this.curveType?.5:.25;let e=Math.pow(o.distanceToSquared(u),t),n=Math.pow(u.distanceToSquared(h),t),r=Math.pow(h.distanceToSquared(a),t);n<1e-4&&(n=1),e<1e-4&&(e=n),r<1e-4&&(r=n),Ud.initNonuniformCatmullRom(o.x,u.x,h.x,a.x,e,n,r),Bd.initNonuniformCatmullRom(o.y,u.y,h.y,a.y,e,n,r),Gd.initNonuniformCatmullRom(o.z,u.z,h.z,a.z,e,n,r)}else"catmullrom"===this.curveType&&(Ud.initCatmullRom(o.x,u.x,h.x,a.x,this.tension),Bd.initCatmullRom(o.y,u.y,h.y,a.y,this.tension),Gd.initCatmullRom(o.z,u.z,h.z,a.z,this.tension));return n.set(Ud.calc(c),Bd.calc(c),Gd.calc(c)),n}copy(t){super.copy(t),this.points=[];for(let e=0,n=t.points.length;e<n;e++){const n=t.points[e];this.points.push(n.clone())}return this.closed=t.closed,this.curveType=t.curveType,this.tension=t.tension,this}toJSON(){const t=super.toJSON();t.points=[];for(let e=0,n=this.points.length;e<n;e++){const n=this.points[e];t.points.push(n.toArray())}return t.closed=this.closed,t.curveType=this.curveType,t.tension=this.tension,t}fromJSON(t){super.fromJSON(t),this.points=[];for(let e=0,n=t.points.length;e<n;e++){const n=t.points[e];this.points.push((new Mr).fromArray(n))}return this.closed=t.closed,this.curveType=t.curveType,this.tension=t.tension,this}}function Vd(t,e,n,r,i){const s=.5*(r-e),o=.5*(i-n),a=t*t,l=t*a;return(2*n-2*r+s+o)*l+(-3*n+3*r-2*s-o)*a+s*t+n}function jd(t,e){const n=1-t;return n*n*e}function Wd(t,e){return 2*(1-t)*t*e}function qd(t,e){return t*t*e}function Yd(t,e,n,r){return jd(t,e)+Wd(t,n)+qd(t,r)}function Xd(t,e){const n=1-t;return n*n*n*e}function Jd(t,e){const n=1-t;return 3*n*n*t*e}function Kd(t,e){return 3*(1-t)*t*t*e}function Zd(t,e){return t*t*t*e}function Qd(t,e,n,r,i){return Xd(t,e)+Jd(t,n)+Kd(t,r)+Zd(t,i)}class $d extends kd{constructor(t=new qn,e=new qn,n=new qn,r=new qn){super(),this.isCubicBezierCurve=!0,this.type="CubicBezierCurve",this.v0=t,this.v1=e,this.v2=n,this.v3=r}getPoint(t,e=new qn){const n=e,r=this.v0,i=this.v1,s=this.v2,o=this.v3;return n.set(Qd(t,r.x,i.x,s.x,o.x),Qd(t,r.y,i.y,s.y,o.y)),n}copy(t){return super.copy(t),this.v0.copy(t.v0),this.v1.copy(t.v1),this.v2.copy(t.v2),this.v3.copy(t.v3),this}toJSON(){const t=super.toJSON();return t.v0=this.v0.toArray(),t.v1=this.v1.toArray(),t.v2=this.v2.toArray(),t.v3=this.v3.toArray(),t}fromJSON(t){return super.fromJSON(t),this.v0.fromArray(t.v0),this.v1.fromArray(t.v1),this.v2.fromArray(t.v2),this.v3.fromArray(t.v3),this}}class tf extends kd{constructor(t=new Mr,e=new Mr,n=new Mr,r=new Mr){super(),this.isCubicBezierCurve3=!0,this.type="CubicBezierCurve3",this.v0=t,this.v1=e,this.v2=n,this.v3=r}getPoint(t,e=new Mr){const n=e,r=this.v0,i=this.v1,s=this.v2,o=this.v3;return n.set(Qd(t,r.x,i.x,s.x,o.x),Qd(t,r.y,i.y,s.y,o.y),Qd(t,r.z,i.z,s.z,o.z)),n}copy(t){return super.copy(t),this.v0.copy(t.v0),this.v1.copy(t.v1),this.v2.copy(t.v2),this.v3.copy(t.v3),this}toJSON(){const t=super.toJSON();return t.v0=this.v0.toArray(),t.v1=this.v1.toArray(),t.v2=this.v2.toArray(),t.v3=this.v3.toArray(),t}fromJSON(t){return super.fromJSON(t),this.v0.fromArray(t.v0),this.v1.fromArray(t.v1),this.v2.fromArray(t.v2),this.v3.fromArray(t.v3),this}}class ef extends kd{constructor(t=new qn,e=new qn){super(),this.isLineCurve=!0,this.type="LineCurve",this.v1=t,this.v2=e}getPoint(t,e=new qn){const n=e;return 1===t?n.copy(this.v2):(n.copy(this.v2).sub(this.v1),n.multiplyScalar(t).add(this.v1)),n}getPointAt(t,e){return this.getPoint(t,e)}getTangent(t,e){const n=e||new qn;return n.copy(this.v2).sub(this.v1).normalize(),n}copy(t){return super.copy(t),this.v1.copy(t.v1),this.v2.copy(t.v2),this}toJSON(){const t=super.toJSON();return t.v1=this.v1.toArray(),t.v2=this.v2.toArray(),t}fromJSON(t){return super.fromJSON(t),this.v1.fromArray(t.v1),this.v2.fromArray(t.v2),this}}class nf extends kd{constructor(t=new Mr,e=new Mr){super(),this.isLineCurve3=!0,this.type="LineCurve3",this.v1=t,this.v2=e}getPoint(t,e=new Mr){const n=e;return 1===t?n.copy(this.v2):(n.copy(this.v2).sub(this.v1),n.multiplyScalar(t).add(this.v1)),n}getPointAt(t,e){return this.getPoint(t,e)}copy(t){return super.copy(t),this.v1.copy(t.v1),this.v2.copy(t.v2),this}toJSON(){const t=super.toJSON();return t.v1=this.v1.toArray(),t.v2=this.v2.toArray(),t}fromJSON(t){return super.fromJSON(t),this.v1.fromArray(t.v1),this.v2.fromArray(t.v2),this}}class rf extends kd{constructor(t=new qn,e=new qn,n=new qn){super(),this.isQuadraticBezierCurve=!0,this.type="QuadraticBezierCurve",this.v0=t,this.v1=e,this.v2=n}getPoint(t,e=new qn){const n=e,r=this.v0,i=this.v1,s=this.v2;return n.set(Yd(t,r.x,i.x,s.x),Yd(t,r.y,i.y,s.y)),n}copy(t){return super.copy(t),this.v0.copy(t.v0),this.v1.copy(t.v1),this.v2.copy(t.v2),this}toJSON(){const t=super.toJSON();return t.v0=this.v0.toArray(),t.v1=this.v1.toArray(),t.v2=this.v2.toArray(),t}fromJSON(t){return super.fromJSON(t),this.v0.fromArray(t.v0),this.v1.fromArray(t.v1),this.v2.fromArray(t.v2),this}}class sf extends kd{constructor(t=new Mr,e=new Mr,n=new Mr){super(),this.isQuadraticBezierCurve3=!0,this.type="QuadraticBezierCurve3",this.v0=t,this.v1=e,this.v2=n}getPoint(t,e=new Mr){const n=e,r=this.v0,i=this.v1,s=this.v2;return n.set(Yd(t,r.x,i.x,s.x),Yd(t,r.y,i.y,s.y),Yd(t,r.z,i.z,s.z)),n}copy(t){return super.copy(t),this.v0.copy(t.v0),this.v1.copy(t.v1),this.v2.copy(t.v2),this}toJSON(){const t=super.toJSON();return t.v0=this.v0.toArray(),t.v1=this.v1.toArray(),t.v2=this.v2.toArray(),t}fromJSON(t){return super.fromJSON(t),this.v0.fromArray(t.v0),this.v1.fromArray(t.v1),this.v2.fromArray(t.v2),this}}class of extends kd{constructor(t=[]){super(),this.isSplineCurve=!0,this.type="SplineCurve",this.points=t}getPoint(t,e=new qn){const n=e,r=this.points,i=(r.length-1)*t,s=Math.floor(i),o=i-s,a=r[0===s?s:s-1],l=r[s],c=r[s>r.length-2?r.length-1:s+1],u=r[s>r.length-3?r.length-1:s+2];return n.set(Vd(o,a.x,l.x,c.x,u.x),Vd(o,a.y,l.y,c.y,u.y)),n}copy(t){super.copy(t),this.points=[];for(let e=0,n=t.points.length;e<n;e++){const n=t.points[e];this.points.push(n.clone())}return this}toJSON(){const t=super.toJSON();t.points=[];for(let e=0,n=this.points.length;e<n;e++){const n=this.points[e];t.points.push(n.toArray())}return t}fromJSON(t){super.fromJSON(t),this.points=[];for(let e=0,n=t.points.length;e<n;e++){const n=t.points[e];this.points.push((new qn).fromArray(n))}return this}}var af=Object.freeze({__proto__:null,ArcCurve:Dd,CatmullRomCurve3:Hd,CubicBezierCurve:$d,CubicBezierCurve3:tf,EllipseCurve:Od,LineCurve:ef,LineCurve3:nf,QuadraticBezierCurve:rf,QuadraticBezierCurve3:sf,SplineCurve:of});class lf extends kd{constructor(){super(),this.type="CurvePath",this.curves=[],this.autoClose=!1}add(t){this.curves.push(t)}closePath(){const t=this.curves[0].getPoint(0),e=this.curves[this.curves.length-1].getPoint(1);t.equals(e)||this.curves.push(new ef(e,t))}getPoint(t,e){const n=t*this.getLength(),r=this.getCurveLengths();let i=0;while(i<r.length){if(r[i]>=n){const t=r[i]-n,s=this.curves[i],o=s.getLength(),a=0===o?0:1-t/o;return s.getPointAt(a,e)}i++}return null}getLength(){const t=this.getCurveLengths();return t[t.length-1]}updateArcLengths(){this.needsUpdate=!0,this.cacheLengths=null,this.getCurveLengths()}getCurveLengths(){if(this.cacheLengths&&this.cacheLengths.length===this.curves.length)return this.cacheLengths;const t=[];let e=0;for(let n=0,r=this.curves.length;n<r;n++)e+=this.curves[n].getLength(),t.push(e);return this.cacheLengths=t,t}getSpacedPoints(t=40){const e=[];for(let n=0;n<=t;n++)e.push(this.getPoint(n/t));return this.autoClose&&e.push(e[0]),e}getPoints(t=12){const e=[];let n;for(let r=0,i=this.curves;r<i.length;r++){const s=i[r],o=s.isEllipseCurve?2*t:s.isLineCurve||s.isLineCurve3?1:s.isSplineCurve?t*s.points.length:t,a=s.getPoints(o);for(let t=0;t<a.length;t++){const r=a[t];n&&n.equals(r)||(e.push(r),n=r)}}return this.autoClose&&e.length>1&&!e[e.length-1].equals(e[0])&&e.push(e[0]),e}copy(t){super.copy(t),this.curves=[];for(let e=0,n=t.curves.length;e<n;e++){const n=t.curves[e];this.curves.push(n.clone())}return this.autoClose=t.autoClose,this}toJSON(){const t=super.toJSON();t.autoClose=this.autoClose,t.curves=[];for(let e=0,n=this.curves.length;e<n;e++){const n=this.curves[e];t.curves.push(n.toJSON())}return t}fromJSON(t){super.fromJSON(t),this.autoClose=t.autoClose,this.curves=[];for(let e=0,n=t.curves.length;e<n;e++){const n=t.curves[e];this.curves.push((new af[n.type]).fromJSON(n))}return this}}class cf extends lf{constructor(t){super(),this.type="Path",this.currentPoint=new qn,t&&this.setFromPoints(t)}setFromPoints(t){this.moveTo(t[0].x,t[0].y);for(let e=1,n=t.length;e<n;e++)this.lineTo(t[e].x,t[e].y);return this}moveTo(t,e){return this.currentPoint.set(t,e),this}lineTo(t,e){const n=new ef(this.currentPoint.clone(),new qn(t,e));return this.curves.push(n),this.currentPoint.set(t,e),this}quadraticCurveTo(t,e,n,r){const i=new rf(this.currentPoint.clone(),new qn(t,e),new qn(n,r));return this.curves.push(i),this.currentPoint.set(n,r),this}bezierCurveTo(t,e,n,r,i,s){const o=new $d(this.currentPoint.clone(),new qn(t,e),new qn(n,r),new qn(i,s));return this.curves.push(o),this.currentPoint.set(i,s),this}splineThru(t){const e=[this.currentPoint.clone()].concat(t),n=new of(e);return this.curves.push(n),this.currentPoint.copy(t[t.length-1]),this}arc(t,e,n,r,i,s){const o=this.currentPoint.x,a=this.currentPoint.y;return this.absarc(t+o,e+a,n,r,i,s),this}absarc(t,e,n,r,i,s){return this.absellipse(t,e,n,n,r,i,s),this}ellipse(t,e,n,r,i,s,o,a){const l=this.currentPoint.x,c=this.currentPoint.y;return this.absellipse(t+l,e+c,n,r,i,s,o,a),this}absellipse(t,e,n,r,i,s,o,a){const l=new Od(t,e,n,r,i,s,o,a);if(this.curves.length>0){const t=l.getPoint(0);t.equals(this.currentPoint)||this.lineTo(t.x,t.y)}this.curves.push(l);const c=l.getPoint(1);return this.currentPoint.copy(c),this}copy(t){return super.copy(t),this.currentPoint.copy(t.currentPoint),this}toJSON(){const t=super.toJSON();return t.currentPoint=this.currentPoint.toArray(),t}fromJSON(t){return super.fromJSON(t),this.currentPoint.fromArray(t.currentPoint),this}}class uf extends os{constructor(t=[new qn(0,.5),new qn(.5,0),new qn(0,-.5)],e=12,n=0,r=2*Math.PI){super(),this.type="LatheGeometry",this.parameters={points:t,segments:e,phiStart:n,phiLength:r},e=Math.floor(e),r=An(r,0,2*Math.PI);const i=[],s=[],o=[],a=[],l=[],c=1/e,u=new Mr,h=new qn,d=new Mr,f=new Mr,p=new Mr;let m=0,g=0;for(let v=0;v<=t.length-1;v++)switch(v){case 0:m=t[v+1].x-t[v].x,g=t[v+1].y-t[v].y,d.x=1*g,d.y=-m,d.z=0*g,p.copy(d),d.normalize(),a.push(d.x,d.y,d.z);break;case t.length-1:a.push(p.x,p.y,p.z);break;default:m=t[v+1].x-t[v].x,g=t[v+1].y-t[v].y,d.x=1*g,d.y=-m,d.z=0*g,f.copy(d),d.x+=p.x,d.y+=p.y,d.z+=p.z,d.normalize(),a.push(d.x,d.y,d.z),p.copy(f)}for(let v=0;v<=e;v++){const i=n+v*c*r,d=Math.sin(i),f=Math.cos(i);for(let n=0;n<=t.length-1;n++){u.x=t[n].x*d,u.y=t[n].y,u.z=t[n].x*f,s.push(u.x,u.y,u.z),h.x=v/e,h.y=n/(t.length-1),o.push(h.x,h.y);const r=a[3*n+0]*d,i=a[3*n+1],c=a[3*n+0]*f;l.push(r,i,c)}}for(let v=0;v<e;v++)for(let e=0;e<t.length-1;e++){const n=e+v*t.length,r=n,s=n+t.length,o=n+t.length+1,a=n+1;i.push(r,s,a),i.push(o,a,s)}this.setIndex(i),this.setAttribute("position",new Zi(s,3)),this.setAttribute("uv",new Zi(o,2)),this.setAttribute("normal",new Zi(l,3))}static fromJSON(t){return new uf(t.points,t.segments,t.phiStart,t.phiLength)}}class hf extends uf{constructor(t=1,e=1,n=4,r=8){const i=new cf;i.absarc(0,-e/2,t,1.5*Math.PI,0),i.absarc(0,e/2,t,0,.5*Math.PI),super(i.getPoints(n),r),this.type="CapsuleGeometry",this.parameters={radius:t,height:e,capSegments:n,radialSegments:r}}static fromJSON(t){return new hf(t.radius,t.length,t.capSegments,t.radialSegments)}}class df extends os{constructor(t=1,e=8,n=0,r=2*Math.PI){super(),this.type="CircleGeometry",this.parameters={radius:t,segments:e,thetaStart:n,thetaLength:r},e=Math.max(3,e);const i=[],s=[],o=[],a=[],l=new Mr,c=new qn;s.push(0,0,0),o.push(0,0,1),a.push(.5,.5);for(let u=0,h=3;u<=e;u++,h+=3){const i=n+u/e*r;l.x=t*Math.cos(i),l.y=t*Math.sin(i),s.push(l.x,l.y,l.z),o.push(0,0,1),c.x=(s[h]/t+1)/2,c.y=(s[h+1]/t+1)/2,a.push(c.x,c.y)}for(let u=1;u<=e;u++)i.push(u,u+1,0);this.setIndex(i),this.setAttribute("position",new Zi(s,3)),this.setAttribute("normal",new Zi(o,3)),this.setAttribute("uv",new Zi(a,2))}static fromJSON(t){return new df(t.radius,t.segments,t.thetaStart,t.thetaLength)}}class ff extends os{constructor(t=1,e=1,n=1,r=8,i=1,s=!1,o=0,a=2*Math.PI){super(),this.type="CylinderGeometry",this.parameters={radiusTop:t,radiusBottom:e,height:n,radialSegments:r,heightSegments:i,openEnded:s,thetaStart:o,thetaLength:a};const l=this;r=Math.floor(r),i=Math.floor(i);const c=[],u=[],h=[],d=[];let f=0;const p=[],m=n/2;let g=0;function v(){const s=new Mr,v=new Mr;let y=0;const x=(e-t)/n;for(let l=0;l<=i;l++){const c=[],g=l/i,y=g*(e-t)+t;for(let t=0;t<=r;t++){const e=t/r,i=e*a+o,l=Math.sin(i),p=Math.cos(i);v.x=y*l,v.y=-g*n+m,v.z=y*p,u.push(v.x,v.y,v.z),s.set(l,x,p).normalize(),h.push(s.x,s.y,s.z),d.push(e,1-g),c.push(f++)}p.push(c)}for(let t=0;t<r;t++)for(let e=0;e<i;e++){const n=p[e][t],r=p[e+1][t],i=p[e+1][t+1],s=p[e][t+1];c.push(n,r,s),c.push(r,i,s),y+=6}l.addGroup(g,y,0),g+=y}function y(n){const i=f,s=new qn,p=new Mr;let v=0;const y=!0===n?t:e,x=!0===n?1:-1;for(let t=1;t<=r;t++)u.push(0,m*x,0),h.push(0,x,0),d.push(.5,.5),f++;const b=f;for(let t=0;t<=r;t++){const e=t/r,n=e*a+o,i=Math.cos(n),l=Math.sin(n);p.x=y*l,p.y=m*x,p.z=y*i,u.push(p.x,p.y,p.z),h.push(0,x,0),s.x=.5*i+.5,s.y=.5*l*x+.5,d.push(s.x,s.y),f++}for(let t=0;t<r;t++){const e=i+t,r=b+t;!0===n?c.push(r,r+1,e):c.push(r+1,r,e),v+=3}l.addGroup(g,v,!0===n?1:2),g+=v}v(),!1===s&&(t>0&&y(!0),e>0&&y(!1)),this.setIndex(c),this.setAttribute("position",new Zi(u,3)),this.setAttribute("normal",new Zi(h,3)),this.setAttribute("uv",new Zi(d,2))}static fromJSON(t){return new ff(t.radiusTop,t.radiusBottom,t.height,t.radialSegments,t.heightSegments,t.openEnded,t.thetaStart,t.thetaLength)}}class pf extends ff{constructor(t=1,e=1,n=8,r=1,i=!1,s=0,o=2*Math.PI){super(0,t,e,n,r,i,s,o),this.type="ConeGeometry",this.parameters={radius:t,height:e,radialSegments:n,heightSegments:r,openEnded:i,thetaStart:s,thetaLength:o}}static fromJSON(t){return new pf(t.radius,t.height,t.radialSegments,t.heightSegments,t.openEnded,t.thetaStart,t.thetaLength)}}class mf extends os{constructor(t=[],e=[],n=1,r=0){super(),this.type="PolyhedronGeometry",this.parameters={vertices:t,indices:e,radius:n,detail:r};const i=[],s=[];function o(t){const n=new Mr,r=new Mr,i=new Mr;for(let s=0;s<e.length;s+=3)d(e[s+0],n),d(e[s+1],r),d(e[s+2],i),a(n,r,i,t)}function a(t,e,n,r){const i=r+1,s=[];for(let o=0;o<=i;o++){s[o]=[];const r=t.clone().lerp(n,o/i),a=e.clone().lerp(n,o/i),l=i-o;for(let t=0;t<=l;t++)s[o][t]=0===t&&o===i?r:r.clone().lerp(a,t/l)}for(let o=0;o<i;o++)for(let t=0;t<2*(i-o)-1;t++){const e=Math.floor(t/2);t%2===0?(h(s[o][e+1]),h(s[o+1][e]),h(s[o][e])):(h(s[o][e+1]),h(s[o+1][e+1]),h(s[o+1][e]))}}function l(t){const e=new Mr;for(let n=0;n<i.length;n+=3)e.x=i[n+0],e.y=i[n+1],e.z=i[n+2],e.normalize().multiplyScalar(t),i[n+0]=e.x,i[n+1]=e.y,i[n+2]=e.z}function c(){const t=new Mr;for(let e=0;e<i.length;e+=3){t.x=i[e+0],t.y=i[e+1],t.z=i[e+2];const n=m(t)/2/Math.PI+.5,r=g(t)/Math.PI+.5;s.push(n,1-r)}f(),u()}function u(){for(let t=0;t<s.length;t+=6){const e=s[t+0],n=s[t+2],r=s[t+4],i=Math.max(e,n,r),o=Math.min(e,n,r);i>.9&&o<.1&&(e<.2&&(s[t+0]+=1),n<.2&&(s[t+2]+=1),r<.2&&(s[t+4]+=1))}}function h(t){i.push(t.x,t.y,t.z)}function d(e,n){const r=3*e;n.x=t[r+0],n.y=t[r+1],n.z=t[r+2]}function f(){const t=new Mr,e=new Mr,n=new Mr,r=new Mr,o=new qn,a=new qn,l=new qn;for(let c=0,u=0;c<i.length;c+=9,u+=6){t.set(i[c+0],i[c+1],i[c+2]),e.set(i[c+3],i[c+4],i[c+5]),n.set(i[c+6],i[c+7],i[c+8]),o.set(s[u+0],s[u+1]),a.set(s[u+2],s[u+3]),l.set(s[u+4],s[u+5]),r.copy(t).add(e).add(n).divideScalar(3);const h=m(r);p(o,u+0,t,h),p(a,u+2,e,h),p(l,u+4,n,h)}}function p(t,e,n,r){r<0&&1===t.x&&(s[e]=t.x-1),0===n.x&&0===n.z&&(s[e]=r/2/Math.PI+.5)}function m(t){return Math.atan2(t.z,-t.x)}function g(t){return Math.atan2(-t.y,Math.sqrt(t.x*t.x+t.z*t.z))}o(r),l(n),c(),this.setAttribute("position",new Zi(i,3)),this.setAttribute("normal",new Zi(i.slice(),3)),this.setAttribute("uv",new Zi(s,2)),0===r?this.computeVertexNormals():this.normalizeNormals()}static fromJSON(t){return new mf(t.vertices,t.indices,t.radius,t.details)}}class gf extends mf{constructor(t=1,e=0){const n=(1+Math.sqrt(5))/2,r=1/n,i=[-1,-1,-1,-1,-1,1,-1,1,-1,-1,1,1,1,-1,-1,1,-1,1,1,1,-1,1,1,1,0,-r,-n,0,-r,n,0,r,-n,0,r,n,-r,-n,0,-r,n,0,r,-n,0,r,n,0,-n,0,-r,n,0,-r,-n,0,r,n,0,r],s=[3,11,7,3,7,15,3,15,13,7,19,17,7,17,6,7,6,15,17,4,8,17,8,10,17,10,6,8,0,16,8,16,2,8,2,10,0,12,1,0,1,18,0,18,16,6,10,2,6,2,13,6,13,15,2,16,18,2,18,3,2,3,13,18,1,9,18,9,11,18,11,3,4,14,12,4,12,0,4,0,8,11,9,5,11,5,19,11,19,7,19,5,14,19,14,4,19,4,17,1,12,14,1,14,5,1,5,9];super(i,s,t,e),this.type="DodecahedronGeometry",this.parameters={radius:t,detail:e}}static fromJSON(t){return new gf(t.radius,t.detail)}}const vf=new Mr,yf=new Mr,xf=new Mr,bf=new Di;class wf extends os{constructor(t=null,e=1){if(super(),this.type="EdgesGeometry",this.parameters={geometry:t,thresholdAngle:e},null!==t){const n=4,r=Math.pow(10,n),i=Math.cos(wn*e),s=t.getIndex(),o=t.getAttribute("position"),a=s?s.count:o.count,l=[0,0,0],c=["a","b","c"],u=new Array(3),h={},d=[];for(let t=0;t<a;t+=3){s?(l[0]=s.getX(t),l[1]=s.getX(t+1),l[2]=s.getX(t+2)):(l[0]=t,l[1]=t+1,l[2]=t+2);const{a:e,b:n,c:a}=bf;if(e.fromBufferAttribute(o,l[0]),n.fromBufferAttribute(o,l[1]),a.fromBufferAttribute(o,l[2]),bf.getNormal(xf),u[0]=`${Math.round(e.x*r)},${Math.round(e.y*r)},${Math.round(e.z*r)}`,u[1]=`${Math.round(n.x*r)},${Math.round(n.y*r)},${Math.round(n.z*r)}`,u[2]=`${Math.round(a.x*r)},${Math.round(a.y*r)},${Math.round(a.z*r)}`,u[0]!==u[1]&&u[1]!==u[2]&&u[2]!==u[0])for(let t=0;t<3;t++){const e=(t+1)%3,n=u[t],r=u[e],s=bf[c[t]],o=bf[c[e]],a=`${n}_${r}`,f=`${r}_${n}`;f in h&&h[f]?(xf.dot(h[f].normal)<=i&&(d.push(s.x,s.y,s.z),d.push(o.x,o.y,o.z)),h[f]=null):a in h||(h[a]={index0:l[t],index1:l[e],normal:xf.clone()})}}for(const t in h)if(h[t]){const{index0:e,index1:n}=h[t];vf.fromBufferAttribute(o,e),yf.fromBufferAttribute(o,n),d.push(vf.x,vf.y,vf.z),d.push(yf.x,yf.y,yf.z)}this.setAttribute("position",new Zi(d,3))}}}class _f extends cf{constructor(t){super(t),this.uuid=Mn(),this.type="Shape",this.holes=[]}getPointsHoles(t){const e=[];for(let n=0,r=this.holes.length;n<r;n++)e[n]=this.holes[n].getPoints(t);return e}extractPoints(t){return{shape:this.getPoints(t),holes:this.getPointsHoles(t)}}copy(t){super.copy(t),this.holes=[];for(let e=0,n=t.holes.length;e<n;e++){const n=t.holes[e];this.holes.push(n.clone())}return this}toJSON(){const t=super.toJSON();t.uuid=this.uuid,t.holes=[];for(let e=0,n=this.holes.length;e<n;e++){const n=this.holes[e];t.holes.push(n.toJSON())}return t}fromJSON(t){super.fromJSON(t),this.uuid=t.uuid,this.holes=[];for(let e=0,n=t.holes.length;e<n;e++){const n=t.holes[e];this.holes.push((new cf).fromJSON(n))}return this}}const Mf={triangulate:function(t,e,n=2){const r=e&&e.length,i=r?e[0]*n:t.length;let s=Af(t,0,i,n,!0);const o=[];if(!s||s.next===s.prev)return o;let a,l,c,u,h,d,f;if(r&&(s=Pf(t,e,s,n)),t.length>80*n){a=c=t[0],l=u=t[1];for(let e=n;e<i;e+=n)h=t[e],d=t[e+1],h<a&&(a=h),d<l&&(l=d),h>c&&(c=h),d>u&&(u=d);f=Math.max(c-a,u-l),f=0!==f?1/f:0}return Ef(s,o,n,a,l,f),o}};function Af(t,e,n,r,i){let s,o;if(i===tp(t,e,n,r)>0)for(s=e;s<n;s+=r)o=Zf(s,t[s],t[s+1],o);else for(s=n-r;s>=e;s-=r)o=Zf(s,t[s],t[s+1],o);return o&&Vf(o,o.next)&&(Qf(o),o=o.next),o}function Sf(t,e){if(!t)return t;e||(e=t);let n,r=t;do{if(n=!1,r.steiner||!Vf(r,r.next)&&0!==Hf(r.prev,r,r.next))r=r.next;else{if(Qf(r),r=e=r.prev,r===r.next)break;n=!0}}while(n||r!==e);return e}function Ef(t,e,n,r,i,s,o){if(!t)return;!o&&s&&Df(t,r,i,s);let a,l,c=t;while(t.prev!==t.next)if(a=t.prev,l=t.next,s?Cf(t,r,i,s):Tf(t))e.push(a.i/n),e.push(t.i/n),e.push(l.i/n),Qf(t),t=l.next,c=l.next;else if(t=l,t===c){o?1===o?(t=Rf(Sf(t),e,n),Ef(t,e,n,r,i,s,2)):2===o&&If(t,e,n,r,i,s):Ef(Sf(t),e,n,r,i,s,1);break}}function Tf(t){const e=t.prev,n=t,r=t.next;if(Hf(e,n,r)>=0)return!1;let i=t.next.next;while(i!==t.prev){if(Bf(e.x,e.y,n.x,n.y,r.x,r.y,i.x,i.y)&&Hf(i.prev,i,i.next)>=0)return!1;i=i.next}return!0}function Cf(t,e,n,r){const i=t.prev,s=t,o=t.next;if(Hf(i,s,o)>=0)return!1;const a=i.x<s.x?i.x<o.x?i.x:o.x:s.x<o.x?s.x:o.x,l=i.y<s.y?i.y<o.y?i.y:o.y:s.y<o.y?s.y:o.y,c=i.x>s.x?i.x>o.x?i.x:o.x:s.x>o.x?s.x:o.x,u=i.y>s.y?i.y>o.y?i.y:o.y:s.y>o.y?s.y:o.y,h=Ff(a,l,e,n,r),d=Ff(c,u,e,n,r);let f=t.prevZ,p=t.nextZ;while(f&&f.z>=h&&p&&p.z<=d){if(f!==t.prev&&f!==t.next&&Bf(i.x,i.y,s.x,s.y,o.x,o.y,f.x,f.y)&&Hf(f.prev,f,f.next)>=0)return!1;if(f=f.prevZ,p!==t.prev&&p!==t.next&&Bf(i.x,i.y,s.x,s.y,o.x,o.y,p.x,p.y)&&Hf(p.prev,p,p.next)>=0)return!1;p=p.nextZ}while(f&&f.z>=h){if(f!==t.prev&&f!==t.next&&Bf(i.x,i.y,s.x,s.y,o.x,o.y,f.x,f.y)&&Hf(f.prev,f,f.next)>=0)return!1;f=f.prevZ}while(p&&p.z<=d){if(p!==t.prev&&p!==t.next&&Bf(i.x,i.y,s.x,s.y,o.x,o.y,p.x,p.y)&&Hf(p.prev,p,p.next)>=0)return!1;p=p.nextZ}return!0}function Rf(t,e,n){let r=t;do{const i=r.prev,s=r.next.next;!Vf(i,s)&&jf(i,r,r.next,s)&&Xf(i,s)&&Xf(s,i)&&(e.push(i.i/n),e.push(r.i/n),e.push(s.i/n),Qf(r),Qf(r.next),r=t=s),r=r.next}while(r!==t);return Sf(r)}function If(t,e,n,r,i,s){let o=t;do{let t=o.next.next;while(t!==o.prev){if(o.i!==t.i&&Gf(o,t)){let a=Kf(o,t);return o=Sf(o,o.next),a=Sf(a,a.next),Ef(o,e,n,r,i,s),void Ef(a,e,n,r,i,s)}t=t.next}o=o.next}while(o!==t)}function Pf(t,e,n,r){const i=[];let s,o,a,l,c;for(s=0,o=e.length;s<o;s++)a=e[s]*r,l=s<o-1?e[s+1]*r:t.length,c=Af(t,a,l,r,!1),c===c.next&&(c.steiner=!0),i.push(Uf(c));for(i.sort(Lf),s=0;s<i.length;s++)Nf(i[s],n),n=Sf(n,n.next);return n}function Lf(t,e){return t.x-e.x}function Nf(t,e){if(e=kf(t,e),e){const n=Kf(e,t);Sf(e,e.next),Sf(n,n.next)}}function kf(t,e){let n=e;const r=t.x,i=t.y;let s,o=-1/0;do{if(i<=n.y&&i>=n.next.y&&n.next.y!==n.y){const t=n.x+(i-n.y)*(n.next.x-n.x)/(n.next.y-n.y);if(t<=r&&t>o){if(o=t,t===r){if(i===n.y)return n;if(i===n.next.y)return n.next}s=n.x<n.next.x?n:n.next}}n=n.next}while(n!==e);if(!s)return null;if(r===o)return s;const a=s,l=s.x,c=s.y;let u,h=1/0;n=s;do{r>=n.x&&n.x>=l&&r!==n.x&&Bf(i<c?r:o,i,l,c,i<c?o:r,i,n.x,n.y)&&(u=Math.abs(i-n.y)/(r-n.x),Xf(n,t)&&(u<h||u===h&&(n.x>s.x||n.x===s.x&&Of(s,n)))&&(s=n,h=u)),n=n.next}while(n!==a);return s}function Of(t,e){return Hf(t.prev,t,e.prev)<0&&Hf(e.next,t,t.next)<0}function Df(t,e,n,r){let i=t;do{null===i.z&&(i.z=Ff(i.x,i.y,e,n,r)),i.prevZ=i.prev,i.nextZ=i.next,i=i.next}while(i!==t);i.prevZ.nextZ=null,i.prevZ=null,zf(i)}function zf(t){let e,n,r,i,s,o,a,l,c=1;do{n=t,t=null,s=null,o=0;while(n){for(o++,r=n,a=0,e=0;e<c;e++)if(a++,r=r.nextZ,!r)break;l=c;while(a>0||l>0&&r)0!==a&&(0===l||!r||n.z<=r.z)?(i=n,n=n.nextZ,a--):(i=r,r=r.nextZ,l--),s?s.nextZ=i:t=i,i.prevZ=s,s=i;n=r}s.nextZ=null,c*=2}while(o>1);return t}function Ff(t,e,n,r,i){return t=32767*(t-n)*i,e=32767*(e-r)*i,t=16711935&(t|t<<8),t=252645135&(t|t<<4),t=858993459&(t|t<<2),t=1431655765&(t|t<<1),e=16711935&(e|e<<8),e=252645135&(e|e<<4),e=858993459&(e|e<<2),e=1431655765&(e|e<<1),t|e<<1}function Uf(t){let e=t,n=t;do{(e.x<n.x||e.x===n.x&&e.y<n.y)&&(n=e),e=e.next}while(e!==t);return n}function Bf(t,e,n,r,i,s,o,a){return(i-o)*(e-a)-(t-o)*(s-a)>=0&&(t-o)*(r-a)-(n-o)*(e-a)>=0&&(n-o)*(s-a)-(i-o)*(r-a)>=0}function Gf(t,e){return t.next.i!==e.i&&t.prev.i!==e.i&&!Yf(t,e)&&(Xf(t,e)&&Xf(e,t)&&Jf(t,e)&&(Hf(t.prev,t,e.prev)||Hf(t,e.prev,e))||Vf(t,e)&&Hf(t.prev,t,t.next)>0&&Hf(e.prev,e,e.next)>0)}function Hf(t,e,n){return(e.y-t.y)*(n.x-e.x)-(e.x-t.x)*(n.y-e.y)}function Vf(t,e){return t.x===e.x&&t.y===e.y}function jf(t,e,n,r){const i=qf(Hf(t,e,n)),s=qf(Hf(t,e,r)),o=qf(Hf(n,r,t)),a=qf(Hf(n,r,e));return i!==s&&o!==a||(!(0!==i||!Wf(t,n,e))||(!(0!==s||!Wf(t,r,e))||(!(0!==o||!Wf(n,t,r))||!(0!==a||!Wf(n,e,r)))))}function Wf(t,e,n){return e.x<=Math.max(t.x,n.x)&&e.x>=Math.min(t.x,n.x)&&e.y<=Math.max(t.y,n.y)&&e.y>=Math.min(t.y,n.y)}function qf(t){return t>0?1:t<0?-1:0}function Yf(t,e){let n=t;do{if(n.i!==t.i&&n.next.i!==t.i&&n.i!==e.i&&n.next.i!==e.i&&jf(n,n.next,t,e))return!0;n=n.next}while(n!==t);return!1}function Xf(t,e){return Hf(t.prev,t,t.next)<0?Hf(t,e,t.next)>=0&&Hf(t,t.prev,e)>=0:Hf(t,e,t.prev)<0||Hf(t,t.next,e)<0}function Jf(t,e){let n=t,r=!1;const i=(t.x+e.x)/2,s=(t.y+e.y)/2;do{n.y>s!==n.next.y>s&&n.next.y!==n.y&&i<(n.next.x-n.x)*(s-n.y)/(n.next.y-n.y)+n.x&&(r=!r),n=n.next}while(n!==t);return r}function Kf(t,e){const n=new $f(t.i,t.x,t.y),r=new $f(e.i,e.x,e.y),i=t.next,s=e.prev;return t.next=e,e.prev=t,n.next=i,i.prev=n,r.next=n,n.prev=r,s.next=r,r.prev=s,r}function Zf(t,e,n,r){const i=new $f(t,e,n);return r?(i.next=r.next,i.prev=r,r.next.prev=i,r.next=i):(i.prev=i,i.next=i),i}function Qf(t){t.next.prev=t.prev,t.prev.next=t.next,t.prevZ&&(t.prevZ.nextZ=t.nextZ),t.nextZ&&(t.nextZ.prevZ=t.prevZ)}function $f(t,e,n){this.i=t,this.x=e,this.y=n,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}function tp(t,e,n,r){let i=0;for(let s=e,o=n-r;s<n;s+=r)i+=(t[o]-t[s])*(t[s+1]+t[o+1]),o=s;return i}class ep{static area(t){const e=t.length;let n=0;for(let r=e-1,i=0;i<e;r=i++)n+=t[r].x*t[i].y-t[i].x*t[r].y;return.5*n}static isClockWise(t){return ep.area(t)<0}static triangulateShape(t,e){const n=[],r=[],i=[];np(t),rp(n,t);let s=t.length;e.forEach(np);for(let a=0;a<e.length;a++)r.push(s),s+=e[a].length,rp(n,e[a]);const o=Mf.triangulate(n,r);for(let a=0;a<o.length;a+=3)i.push(o.slice(a,a+3));return i}}function np(t){const e=t.length;e>2&&t[e-1].equals(t[0])&&t.pop()}function rp(t,e){for(let n=0;n<e.length;n++)t.push(e[n].x),t.push(e[n].y)}class ip extends os{constructor(t=new _f([new qn(.5,.5),new qn(-.5,.5),new qn(-.5,-.5),new qn(.5,-.5)]),e={}){super(),this.type="ExtrudeGeometry",this.parameters={shapes:t,options:e},t=Array.isArray(t)?t:[t];const n=this,r=[],i=[];for(let o=0,a=t.length;o<a;o++){const e=t[o];s(e)}function s(t){const s=[],o=void 0!==e.curveSegments?e.curveSegments:12,a=void 0!==e.steps?e.steps:1;let l=void 0!==e.depth?e.depth:1,c=void 0===e.bevelEnabled||e.bevelEnabled,u=void 0!==e.bevelThickness?e.bevelThickness:.2,h=void 0!==e.bevelSize?e.bevelSize:u-.1,d=void 0!==e.bevelOffset?e.bevelOffset:0,f=void 0!==e.bevelSegments?e.bevelSegments:3;const p=e.extrudePath,m=void 0!==e.UVGenerator?e.UVGenerator:sp;void 0!==e.amount&&(console.warn("THREE.ExtrudeBufferGeometry: amount has been renamed to depth."),l=e.amount);let g,v,y,x,b,w=!1;p&&(g=p.getSpacedPoints(a),w=!0,c=!1,v=p.computeFrenetFrames(a,!1),y=new Mr,x=new Mr,b=new Mr),c||(f=0,u=0,h=0,d=0);const _=t.extractPoints(o);let M=_.shape;const A=_.holes,S=!ep.isClockWise(M);if(S){M=M.reverse();for(let t=0,e=A.length;t<e;t++){const e=A[t];ep.isClockWise(e)&&(A[t]=e.reverse())}}const E=ep.triangulateShape(M,A),T=M;for(let e=0,n=A.length;e<n;e++){const t=A[e];M=M.concat(t)}function C(t,e,n){return e||console.error("THREE.ExtrudeGeometry: vec does not exist"),e.clone().multiplyScalar(n).add(t)}const R=M.length,I=E.length;function P(t,e,n){let r,i,s;const o=t.x-e.x,a=t.y-e.y,l=n.x-t.x,c=n.y-t.y,u=o*o+a*a,h=o*c-a*l;if(Math.abs(h)>Number.EPSILON){const h=Math.sqrt(u),d=Math.sqrt(l*l+c*c),f=e.x-a/h,p=e.y+o/h,m=n.x-c/d,g=n.y+l/d,v=((m-f)*c-(g-p)*l)/(o*c-a*l);r=f+o*v-t.x,i=p+a*v-t.y;const y=r*r+i*i;if(y<=2)return new qn(r,i);s=Math.sqrt(y/2)}else{let t=!1;o>Number.EPSILON?l>Number.EPSILON&&(t=!0):o<-Number.EPSILON?l<-Number.EPSILON&&(t=!0):Math.sign(a)===Math.sign(c)&&(t=!0),t?(r=-a,i=o,s=Math.sqrt(u)):(r=o,i=a,s=Math.sqrt(u/2))}return new qn(r/s,i/s)}const L=[];for(let e=0,n=T.length,r=n-1,i=e+1;e<n;e++,r++,i++)r===n&&(r=0),i===n&&(i=0),L[e]=P(T[e],T[r],T[i]);const N=[];let k,O=L.concat();for(let e=0,n=A.length;e<n;e++){const t=A[e];k=[];for(let e=0,n=t.length,r=n-1,i=e+1;e<n;e++,r++,i++)r===n&&(r=0),i===n&&(i=0),k[e]=P(t[e],t[r],t[i]);N.push(k),O=O.concat(k)}for(let e=0;e<f;e++){const t=e/f,n=u*Math.cos(t*Math.PI/2),r=h*Math.sin(t*Math.PI/2)+d;for(let e=0,i=T.length;e<i;e++){const t=C(T[e],L[e],r);B(t.x,t.y,-n)}for(let e=0,i=A.length;e<i;e++){const t=A[e];k=N[e];for(let e=0,i=t.length;e<i;e++){const i=C(t[e],k[e],r);B(i.x,i.y,-n)}}}const D=h+d;for(let e=0;e<R;e++){const t=c?C(M[e],O[e],D):M[e];w?(x.copy(v.normals[0]).multiplyScalar(t.x),y.copy(v.binormals[0]).multiplyScalar(t.y),b.copy(g[0]).add(x).add(y),B(b.x,b.y,b.z)):B(t.x,t.y,0)}for(let e=1;e<=a;e++)for(let t=0;t<R;t++){const n=c?C(M[t],O[t],D):M[t];w?(x.copy(v.normals[e]).multiplyScalar(n.x),y.copy(v.binormals[e]).multiplyScalar(n.y),b.copy(g[e]).add(x).add(y),B(b.x,b.y,b.z)):B(n.x,n.y,l/a*e)}for(let e=f-1;e>=0;e--){const t=e/f,n=u*Math.cos(t*Math.PI/2),r=h*Math.sin(t*Math.PI/2)+d;for(let e=0,i=T.length;e<i;e++){const t=C(T[e],L[e],r);B(t.x,t.y,l+n)}for(let e=0,i=A.length;e<i;e++){const t=A[e];k=N[e];for(let e=0,i=t.length;e<i;e++){const i=C(t[e],k[e],r);w?B(i.x,i.y+g[a-1].y,g[a-1].x+n):B(i.x,i.y,l+n)}}}function z(){const t=r.length/3;if(c){let t=0,e=R*t;for(let n=0;n<I;n++){const t=E[n];G(t[2]+e,t[1]+e,t[0]+e)}t=a+2*f,e=R*t;for(let n=0;n<I;n++){const t=E[n];G(t[0]+e,t[1]+e,t[2]+e)}}else{for(let t=0;t<I;t++){const e=E[t];G(e[2],e[1],e[0])}for(let t=0;t<I;t++){const e=E[t];G(e[0]+R*a,e[1]+R*a,e[2]+R*a)}}n.addGroup(t,r.length/3-t,0)}function F(){const t=r.length/3;let e=0;U(T,e),e+=T.length;for(let n=0,r=A.length;n<r;n++){const t=A[n];U(t,e),e+=t.length}n.addGroup(t,r.length/3-t,1)}function U(t,e){let n=t.length;while(--n>=0){const r=n;let i=n-1;i<0&&(i=t.length-1);for(let t=0,n=a+2*f;t<n;t++){const n=R*t,s=R*(t+1),o=e+r+n,a=e+i+n,l=e+i+s,c=e+r+s;H(o,a,l,c)}}}function B(t,e,n){s.push(t),s.push(e),s.push(n)}function G(t,e,i){V(t),V(e),V(i);const s=r.length/3,o=m.generateTopUV(n,r,s-3,s-2,s-1);j(o[0]),j(o[1]),j(o[2])}function H(t,e,i,s){V(t),V(e),V(s),V(e),V(i),V(s);const o=r.length/3,a=m.generateSideWallUV(n,r,o-6,o-3,o-2,o-1);j(a[0]),j(a[1]),j(a[3]),j(a[1]),j(a[2]),j(a[3])}function V(t){r.push(s[3*t+0]),r.push(s[3*t+1]),r.push(s[3*t+2])}function j(t){i.push(t.x),i.push(t.y)}z(),F()}this.setAttribute("position",new Zi(r,3)),this.setAttribute("uv",new Zi(i,2)),this.computeVertexNormals()}toJSON(){const t=super.toJSON(),e=this.parameters.shapes,n=this.parameters.options;return op(e,n,t)}static fromJSON(t,e){const n=[];for(let i=0,s=t.shapes.length;i<s;i++){const r=e[t.shapes[i]];n.push(r)}const r=t.options.extrudePath;return void 0!==r&&(t.options.extrudePath=(new af[r.type]).fromJSON(r)),new ip(n,t.options)}}const sp={generateTopUV:function(t,e,n,r,i){const s=e[3*n],o=e[3*n+1],a=e[3*r],l=e[3*r+1],c=e[3*i],u=e[3*i+1];return[new qn(s,o),new qn(a,l),new qn(c,u)]},generateSideWallUV:function(t,e,n,r,i,s){const o=e[3*n],a=e[3*n+1],l=e[3*n+2],c=e[3*r],u=e[3*r+1],h=e[3*r+2],d=e[3*i],f=e[3*i+1],p=e[3*i+2],m=e[3*s],g=e[3*s+1],v=e[3*s+2];return Math.abs(a-u)<Math.abs(o-c)?[new qn(o,1-l),new qn(c,1-h),new qn(d,1-p),new qn(m,1-v)]:[new qn(a,1-l),new qn(u,1-h),new qn(f,1-p),new qn(g,1-v)]}};function op(t,e,n){if(n.shapes=[],Array.isArray(t))for(let r=0,i=t.length;r<i;r++){const e=t[r];n.shapes.push(e.uuid)}else n.shapes.push(t.uuid);return n.options=Object.assign({},e),void 0!==e.extrudePath&&(n.options.extrudePath=e.extrudePath.toJSON()),n}class ap extends mf{constructor(t=1,e=0){const n=(1+Math.sqrt(5))/2,r=[-1,n,0,1,n,0,-1,-n,0,1,-n,0,0,-1,n,0,1,n,0,-1,-n,0,1,-n,n,0,-1,n,0,1,-n,0,-1,-n,0,1],i=[0,11,5,0,5,1,0,1,7,0,7,10,0,10,11,1,5,9,5,11,4,11,10,2,10,7,6,7,1,8,3,9,4,3,4,2,3,2,6,3,6,8,3,8,9,4,9,5,2,4,11,6,2,10,8,6,7,9,8,1];super(r,i,t,e),this.type="IcosahedronGeometry",this.parameters={radius:t,detail:e}}static fromJSON(t){return new ap(t.radius,t.detail)}}class lp extends mf{constructor(t=1,e=0){const n=[1,0,0,-1,0,0,0,1,0,0,-1,0,0,0,1,0,0,-1],r=[0,2,4,0,4,3,0,3,5,0,5,2,1,2,5,1,5,3,1,3,4,1,4,2];super(n,r,t,e),this.type="OctahedronGeometry",this.parameters={radius:t,detail:e}}static fromJSON(t){return new lp(t.radius,t.detail)}}class cp extends os{constructor(t=.5,e=1,n=8,r=1,i=0,s=2*Math.PI){super(),this.type="RingGeometry",this.parameters={innerRadius:t,outerRadius:e,thetaSegments:n,phiSegments:r,thetaStart:i,thetaLength:s},n=Math.max(3,n),r=Math.max(1,r);const o=[],a=[],l=[],c=[];let u=t;const h=(e-t)/r,d=new Mr,f=new qn;for(let p=0;p<=r;p++){for(let t=0;t<=n;t++){const r=i+t/n*s;d.x=u*Math.cos(r),d.y=u*Math.sin(r),a.push(d.x,d.y,d.z),l.push(0,0,1),f.x=(d.x/e+1)/2,f.y=(d.y/e+1)/2,c.push(f.x,f.y)}u+=h}for(let p=0;p<r;p++){const t=p*(n+1);for(let e=0;e<n;e++){const r=e+t,i=r,s=r+n+1,a=r+n+2,l=r+1;o.push(i,s,l),o.push(s,a,l)}}this.setIndex(o),this.setAttribute("position",new Zi(a,3)),this.setAttribute("normal",new Zi(l,3)),this.setAttribute("uv",new Zi(c,2))}static fromJSON(t){return new cp(t.innerRadius,t.outerRadius,t.thetaSegments,t.phiSegments,t.thetaStart,t.thetaLength)}}class up extends os{constructor(t=new _f([new qn(0,.5),new qn(-.5,-.5),new qn(.5,-.5)]),e=12){super(),this.type="ShapeGeometry",this.parameters={shapes:t,curveSegments:e};const n=[],r=[],i=[],s=[];let o=0,a=0;if(!1===Array.isArray(t))l(t);else for(let c=0;c<t.length;c++)l(t[c]),this.addGroup(o,a,c),o+=a,a=0;function l(t){const o=r.length/3,l=t.extractPoints(e);let c=l.shape;const u=l.holes;!1===ep.isClockWise(c)&&(c=c.reverse());for(let e=0,n=u.length;e<n;e++){const t=u[e];!0===ep.isClockWise(t)&&(u[e]=t.reverse())}const h=ep.triangulateShape(c,u);for(let e=0,n=u.length;e<n;e++){const t=u[e];c=c.concat(t)}for(let e=0,n=c.length;e<n;e++){const t=c[e];r.push(t.x,t.y,0),i.push(0,0,1),s.push(t.x,t.y)}for(let e=0,r=h.length;e<r;e++){const t=h[e],r=t[0]+o,i=t[1]+o,s=t[2]+o;n.push(r,i,s),a+=3}}this.setIndex(n),this.setAttribute("position",new Zi(r,3)),this.setAttribute("normal",new Zi(i,3)),this.setAttribute("uv",new Zi(s,2))}toJSON(){const t=super.toJSON(),e=this.parameters.shapes;return hp(e,t)}static fromJSON(t,e){const n=[];for(let r=0,i=t.shapes.length;r<i;r++){const i=e[t.shapes[r]];n.push(i)}return new up(n,t.curveSegments)}}function hp(t,e){if(e.shapes=[],Array.isArray(t))for(let n=0,r=t.length;n<r;n++){const r=t[n];e.shapes.push(r.uuid)}else e.shapes.push(t.uuid);return e}class dp extends os{constructor(t=1,e=32,n=16,r=0,i=2*Math.PI,s=0,o=Math.PI){super(),this.type="SphereGeometry",this.parameters={radius:t,widthSegments:e,heightSegments:n,phiStart:r,phiLength:i,thetaStart:s,thetaLength:o},e=Math.max(3,Math.floor(e)),n=Math.max(2,Math.floor(n));const a=Math.min(s+o,Math.PI);let l=0;const c=[],u=new Mr,h=new Mr,d=[],f=[],p=[],m=[];for(let g=0;g<=n;g++){const d=[],v=g/n;let y=0;0==g&&0==s?y=.5/e:g==n&&a==Math.PI&&(y=-.5/e);for(let n=0;n<=e;n++){const a=n/e;u.x=-t*Math.cos(r+a*i)*Math.sin(s+v*o),u.y=t*Math.cos(s+v*o),u.z=t*Math.sin(r+a*i)*Math.sin(s+v*o),f.push(u.x,u.y,u.z),h.copy(u).normalize(),p.push(h.x,h.y,h.z),m.push(a+y,1-v),d.push(l++)}c.push(d)}for(let g=0;g<n;g++)for(let t=0;t<e;t++){const e=c[g][t+1],r=c[g][t],i=c[g+1][t],o=c[g+1][t+1];(0!==g||s>0)&&d.push(e,r,o),(g!==n-1||a<Math.PI)&&d.push(r,i,o)}this.setIndex(d),this.setAttribute("position",new Zi(f,3)),this.setAttribute("normal",new Zi(p,3)),this.setAttribute("uv",new Zi(m,2))}static fromJSON(t){return new dp(t.radius,t.widthSegments,t.heightSegments,t.phiStart,t.phiLength,t.thetaStart,t.thetaLength)}}class fp extends mf{constructor(t=1,e=0){const n=[1,1,1,-1,-1,1,-1,1,-1,1,-1,-1],r=[2,1,0,0,3,2,1,3,0,2,3,1];super(n,r,t,e),this.type="TetrahedronGeometry",this.parameters={radius:t,detail:e}}static fromJSON(t){return new fp(t.radius,t.detail)}}class pp extends os{constructor(t=1,e=.4,n=8,r=6,i=2*Math.PI){super(),this.type="TorusGeometry",this.parameters={radius:t,tube:e,radialSegments:n,tubularSegments:r,arc:i},n=Math.floor(n),r=Math.floor(r);const s=[],o=[],a=[],l=[],c=new Mr,u=new Mr,h=new Mr;for(let d=0;d<=n;d++)for(let s=0;s<=r;s++){const f=s/r*i,p=d/n*Math.PI*2;u.x=(t+e*Math.cos(p))*Math.cos(f),u.y=(t+e*Math.cos(p))*Math.sin(f),u.z=e*Math.sin(p),o.push(u.x,u.y,u.z),c.x=t*Math.cos(f),c.y=t*Math.sin(f),h.subVectors(u,c).normalize(),a.push(h.x,h.y,h.z),l.push(s/r),l.push(d/n)}for(let d=1;d<=n;d++)for(let t=1;t<=r;t++){const e=(r+1)*d+t-1,n=(r+1)*(d-1)+t-1,i=(r+1)*(d-1)+t,o=(r+1)*d+t;s.push(e,n,o),s.push(n,i,o)}this.setIndex(s),this.setAttribute("position",new Zi(o,3)),this.setAttribute("normal",new Zi(a,3)),this.setAttribute("uv",new Zi(l,2))}static fromJSON(t){return new pp(t.radius,t.tube,t.radialSegments,t.tubularSegments,t.arc)}}class mp extends os{constructor(t=1,e=.4,n=64,r=8,i=2,s=3){super(),this.type="TorusKnotGeometry",this.parameters={radius:t,tube:e,tubularSegments:n,radialSegments:r,p:i,q:s},n=Math.floor(n),r=Math.floor(r);const o=[],a=[],l=[],c=[],u=new Mr,h=new Mr,d=new Mr,f=new Mr,p=new Mr,m=new Mr,g=new Mr;for(let y=0;y<=n;++y){const o=y/n*i*Math.PI*2;v(o,i,s,t,d),v(o+.01,i,s,t,f),m.subVectors(f,d),g.addVectors(f,d),p.crossVectors(m,g),g.crossVectors(p,m),p.normalize(),g.normalize();for(let t=0;t<=r;++t){const i=t/r*Math.PI*2,s=-e*Math.cos(i),o=e*Math.sin(i);u.x=d.x+(s*g.x+o*p.x),u.y=d.y+(s*g.y+o*p.y),u.z=d.z+(s*g.z+o*p.z),a.push(u.x,u.y,u.z),h.subVectors(u,d).normalize(),l.push(h.x,h.y,h.z),c.push(y/n),c.push(t/r)}}for(let y=1;y<=n;y++)for(let t=1;t<=r;t++){const e=(r+1)*(y-1)+(t-1),n=(r+1)*y+(t-1),i=(r+1)*y+t,s=(r+1)*(y-1)+t;o.push(e,n,s),o.push(n,i,s)}function v(t,e,n,r,i){const s=Math.cos(t),o=Math.sin(t),a=n/e*t,l=Math.cos(a);i.x=r*(2+l)*.5*s,i.y=r*(2+l)*o*.5,i.z=r*Math.sin(a)*.5}this.setIndex(o),this.setAttribute("position",new Zi(a,3)),this.setAttribute("normal",new Zi(l,3)),this.setAttribute("uv",new Zi(c,2))}static fromJSON(t){return new mp(t.radius,t.tube,t.tubularSegments,t.radialSegments,t.p,t.q)}}class gp extends os{constructor(t=new sf(new Mr(-1,-1,0),new Mr(-1,1,0),new Mr(1,1,0)),e=64,n=1,r=8,i=!1){super(),this.type="TubeGeometry",this.parameters={path:t,tubularSegments:e,radius:n,radialSegments:r,closed:i};const s=t.computeFrenetFrames(e,i);this.tangents=s.tangents,this.normals=s.normals,this.binormals=s.binormals;const o=new Mr,a=new Mr,l=new qn;let c=new Mr;const u=[],h=[],d=[],f=[];function p(){for(let t=0;t<e;t++)m(t);m(!1===i?e:0),v(),g()}function m(i){c=t.getPointAt(i/e,c);const l=s.normals[i],d=s.binormals[i];for(let t=0;t<=r;t++){const e=t/r*Math.PI*2,i=Math.sin(e),s=-Math.cos(e);a.x=s*l.x+i*d.x,a.y=s*l.y+i*d.y,a.z=s*l.z+i*d.z,a.normalize(),h.push(a.x,a.y,a.z),o.x=c.x+n*a.x,o.y=c.y+n*a.y,o.z=c.z+n*a.z,u.push(o.x,o.y,o.z)}}function g(){for(let t=1;t<=e;t++)for(let e=1;e<=r;e++){const n=(r+1)*(t-1)+(e-1),i=(r+1)*t+(e-1),s=(r+1)*t+e,o=(r+1)*(t-1)+e;f.push(n,i,o),f.push(i,s,o)}}function v(){for(let t=0;t<=e;t++)for(let n=0;n<=r;n++)l.x=t/e,l.y=n/r,d.push(l.x,l.y)}p(),this.setIndex(f),this.setAttribute("position",new Zi(u,3)),this.setAttribute("normal",new Zi(h,3)),this.setAttribute("uv",new Zi(d,2))}toJSON(){const t=super.toJSON();return t.path=this.parameters.path.toJSON(),t}static fromJSON(t){return new gp((new af[t.path.type]).fromJSON(t.path),t.tubularSegments,t.radius,t.radialSegments,t.closed)}}class vp extends os{constructor(t=null){if(super(),this.type="WireframeGeometry",this.parameters={geometry:t},null!==t){const e=[],n=new Set,r=new Mr,i=new Mr;if(null!==t.index){const s=t.attributes.position,o=t.index;let a=t.groups;0===a.length&&(a=[{start:0,count:o.count,materialIndex:0}]);for(let t=0,l=a.length;t<l;++t){const l=a[t],c=l.start,u=l.count;for(let t=c,a=c+u;t<a;t+=3)for(let l=0;l<3;l++){const a=o.getX(t+l),c=o.getX(t+(l+1)%3);r.fromBufferAttribute(s,a),i.fromBufferAttribute(s,c),!0===yp(r,i,n)&&(e.push(r.x,r.y,r.z),e.push(i.x,i.y,i.z))}}}else{const s=t.attributes.position;for(let t=0,o=s.count/3;t<o;t++)for(let a=0;a<3;a++){const o=3*t+a,l=3*t+(a+1)%3;r.fromBufferAttribute(s,o),i.fromBufferAttribute(s,l),!0===yp(r,i,n)&&(e.push(r.x,r.y,r.z),e.push(i.x,i.y,i.z))}}this.setAttribute("position",new Zi(e,3))}}}function yp(t,e,n){const r=`${t.x},${t.y},${t.z}-${e.x},${e.y},${e.z}`,i=`${e.x},${e.y},${e.z}-${t.x},${t.y},${t.z}`;return!0!==n.has(r)&&!0!==n.has(i)&&(n.add(r),n.add(i),!0)}var xp=Object.freeze({__proto__:null,BoxGeometry:Ts,BoxBufferGeometry:Ts,CapsuleGeometry:hf,CapsuleBufferGeometry:hf,CircleGeometry:df,CircleBufferGeometry:df,ConeGeometry:pf,ConeBufferGeometry:pf,CylinderGeometry:ff,CylinderBufferGeometry:ff,DodecahedronGeometry:gf,DodecahedronBufferGeometry:gf,EdgesGeometry:wf,ExtrudeGeometry:ip,ExtrudeBufferGeometry:ip,IcosahedronGeometry:ap,IcosahedronBufferGeometry:ap,LatheGeometry:uf,LatheBufferGeometry:uf,OctahedronGeometry:lp,OctahedronBufferGeometry:lp,PlaneGeometry:Ks,PlaneBufferGeometry:Ks,PolyhedronGeometry:mf,PolyhedronBufferGeometry:mf,RingGeometry:cp,RingBufferGeometry:cp,ShapeGeometry:up,ShapeBufferGeometry:up,SphereGeometry:dp,SphereBufferGeometry:dp,TetrahedronGeometry:fp,TetrahedronBufferGeometry:fp,TorusGeometry:pp,TorusBufferGeometry:pp,TorusKnotGeometry:mp,TorusKnotBufferGeometry:mp,TubeGeometry:gp,TubeBufferGeometry:gp,WireframeGeometry:vp});class bp extends Fi{constructor(t){super(),this.isShadowMaterial=!0,this.type="ShadowMaterial",this.color=new lr(0),this.transparent=!0,this.fog=!0,this.setValues(t)}copy(t){return super.copy(t),this.color.copy(t.color),this.fog=t.fog,this}}class wp extends Ns{constructor(t){super(t),this.isRawShaderMaterial=!0,this.type="RawShaderMaterial"}}class _p extends Fi{constructor(t){super(),this.isMeshStandardMaterial=!0,this.defines={STANDARD:""},this.type="MeshStandardMaterial",this.color=new lr(16777215),this.roughness=1,this.metalness=0,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new lr(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=Fe,this.normalScale=new qn(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.roughnessMap=null,this.metalnessMap=null,this.alphaMap=null,this.envMap=null,this.envMapIntensity=1,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.fog=!0,this.setValues(t)}copy(t){return super.copy(t),this.defines={STANDARD:""},this.color.copy(t.color),this.roughness=t.roughness,this.metalness=t.metalness,this.map=t.map,this.lightMap=t.lightMap,this.lightMapIntensity=t.lightMapIntensity,this.aoMap=t.aoMap,this.aoMapIntensity=t.aoMapIntensity,this.emissive.copy(t.emissive),this.emissiveMap=t.emissiveMap,this.emissiveIntensity=t.emissiveIntensity,this.bumpMap=t.bumpMap,this.bumpScale=t.bumpScale,this.normalMap=t.normalMap,this.normalMapType=t.normalMapType,this.normalScale.copy(t.normalScale),this.displacementMap=t.displacementMap,this.displacementScale=t.displacementScale,this.displacementBias=t.displacementBias,this.roughnessMap=t.roughnessMap,this.metalnessMap=t.metalnessMap,this.alphaMap=t.alphaMap,this.envMap=t.envMap,this.envMapIntensity=t.envMapIntensity,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.wireframeLinecap=t.wireframeLinecap,this.wireframeLinejoin=t.wireframeLinejoin,this.flatShading=t.flatShading,this.fog=t.fog,this}}class Mp extends _p{constructor(t){super(),this.isMeshPhysicalMaterial=!0,this.defines={STANDARD:"",PHYSICAL:""},this.type="MeshPhysicalMaterial",this.clearcoatMap=null,this.clearcoatRoughness=0,this.clearcoatRoughnessMap=null,this.clearcoatNormalScale=new qn(1,1),this.clearcoatNormalMap=null,this.ior=1.5,Object.defineProperty(this,"reflectivity",{get:function(){return An(2.5*(this.ior-1)/(this.ior+1),0,1)},set:function(t){this.ior=(1+.4*t)/(1-.4*t)}}),this.iridescenceMap=null,this.iridescenceIOR=1.3,this.iridescenceThicknessRange=[100,400],this.iridescenceThicknessMap=null,this.sheenColor=new lr(0),this.sheenColorMap=null,this.sheenRoughness=1,this.sheenRoughnessMap=null,this.transmissionMap=null,this.thickness=0,this.thicknessMap=null,this.attenuationDistance=0,this.attenuationColor=new lr(1,1,1),this.specularIntensity=1,this.specularIntensityMap=null,this.specularColor=new lr(1,1,1),this.specularColorMap=null,this._sheen=0,this._clearcoat=0,this._iridescence=0,this._transmission=0,this.setValues(t)}get sheen(){return this._sheen}set sheen(t){this._sheen>0!==t>0&&this.version++,this._sheen=t}get clearcoat(){return this._clearcoat}set clearcoat(t){this._clearcoat>0!==t>0&&this.version++,this._clearcoat=t}get iridescence(){return this._iridescence}set iridescence(t){this._iridescence>0!==t>0&&this.version++,this._iridescence=t}get transmission(){return this._transmission}set transmission(t){this._transmission>0!==t>0&&this.version++,this._transmission=t}copy(t){return super.copy(t),this.defines={STANDARD:"",PHYSICAL:""},this.clearcoat=t.clearcoat,this.clearcoatMap=t.clearcoatMap,this.clearcoatRoughness=t.clearcoatRoughness,this.clearcoatRoughnessMap=t.clearcoatRoughnessMap,this.clearcoatNormalMap=t.clearcoatNormalMap,this.clearcoatNormalScale.copy(t.clearcoatNormalScale),this.ior=t.ior,this.iridescence=t.iridescence,this.iridescenceMap=t.iridescenceMap,this.iridescenceIOR=t.iridescenceIOR,this.iridescenceThicknessRange=[...t.iridescenceThicknessRange],this.iridescenceThicknessMap=t.iridescenceThicknessMap,this.sheen=t.sheen,this.sheenColor.copy(t.sheenColor),this.sheenColorMap=t.sheenColorMap,this.sheenRoughness=t.sheenRoughness,this.sheenRoughnessMap=t.sheenRoughnessMap,this.transmission=t.transmission,this.transmissionMap=t.transmissionMap,this.thickness=t.thickness,this.thicknessMap=t.thicknessMap,this.attenuationDistance=t.attenuationDistance,this.attenuationColor.copy(t.attenuationColor),this.specularIntensity=t.specularIntensity,this.specularIntensityMap=t.specularIntensityMap,this.specularColor.copy(t.specularColor),this.specularColorMap=t.specularColorMap,this}}class Ap extends Fi{constructor(t){super(),this.isMeshPhongMaterial=!0,this.type="MeshPhongMaterial",this.color=new lr(16777215),this.specular=new lr(1118481),this.shininess=30,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new lr(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=Fe,this.normalScale=new qn(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=Z,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.fog=!0,this.setValues(t)}copy(t){return super.copy(t),this.color.copy(t.color),this.specular.copy(t.specular),this.shininess=t.shininess,this.map=t.map,this.lightMap=t.lightMap,this.lightMapIntensity=t.lightMapIntensity,this.aoMap=t.aoMap,this.aoMapIntensity=t.aoMapIntensity,this.emissive.copy(t.emissive),this.emissiveMap=t.emissiveMap,this.emissiveIntensity=t.emissiveIntensity,this.bumpMap=t.bumpMap,this.bumpScale=t.bumpScale,this.normalMap=t.normalMap,this.normalMapType=t.normalMapType,this.normalScale.copy(t.normalScale),this.displacementMap=t.displacementMap,this.displacementScale=t.displacementScale,this.displacementBias=t.displacementBias,this.specularMap=t.specularMap,this.alphaMap=t.alphaMap,this.envMap=t.envMap,this.combine=t.combine,this.reflectivity=t.reflectivity,this.refractionRatio=t.refractionRatio,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.wireframeLinecap=t.wireframeLinecap,this.wireframeLinejoin=t.wireframeLinejoin,this.flatShading=t.flatShading,this.fog=t.fog,this}}class Sp extends Fi{constructor(t){super(),this.isMeshToonMaterial=!0,this.defines={TOON:""},this.type="MeshToonMaterial",this.color=new lr(16777215),this.map=null,this.gradientMap=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new lr(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=Fe,this.normalScale=new qn(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.alphaMap=null,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.fog=!0,this.setValues(t)}copy(t){return super.copy(t),this.color.copy(t.color),this.map=t.map,this.gradientMap=t.gradientMap,this.lightMap=t.lightMap,this.lightMapIntensity=t.lightMapIntensity,this.aoMap=t.aoMap,this.aoMapIntensity=t.aoMapIntensity,this.emissive.copy(t.emissive),this.emissiveMap=t.emissiveMap,this.emissiveIntensity=t.emissiveIntensity,this.bumpMap=t.bumpMap,this.bumpScale=t.bumpScale,this.normalMap=t.normalMap,this.normalMapType=t.normalMapType,this.normalScale.copy(t.normalScale),this.displacementMap=t.displacementMap,this.displacementScale=t.displacementScale,this.displacementBias=t.displacementBias,this.alphaMap=t.alphaMap,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.wireframeLinecap=t.wireframeLinecap,this.wireframeLinejoin=t.wireframeLinejoin,this.fog=t.fog,this}}class Ep extends Fi{constructor(t){super(),this.isMeshNormalMaterial=!0,this.type="MeshNormalMaterial",this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=Fe,this.normalScale=new qn(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.flatShading=!1,this.setValues(t)}copy(t){return super.copy(t),this.bumpMap=t.bumpMap,this.bumpScale=t.bumpScale,this.normalMap=t.normalMap,this.normalMapType=t.normalMapType,this.normalScale.copy(t.normalScale),this.displacementMap=t.displacementMap,this.displacementScale=t.displacementScale,this.displacementBias=t.displacementBias,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.flatShading=t.flatShading,this}}class Tp extends Fi{constructor(t){super(),this.isMeshLambertMaterial=!0,this.type="MeshLambertMaterial",this.color=new lr(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new lr(0),this.emissiveIntensity=1,this.emissiveMap=null,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=Z,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.fog=!0,this.setValues(t)}copy(t){return super.copy(t),this.color.copy(t.color),this.map=t.map,this.lightMap=t.lightMap,this.lightMapIntensity=t.lightMapIntensity,this.aoMap=t.aoMap,this.aoMapIntensity=t.aoMapIntensity,this.emissive.copy(t.emissive),this.emissiveMap=t.emissiveMap,this.emissiveIntensity=t.emissiveIntensity,this.specularMap=t.specularMap,this.alphaMap=t.alphaMap,this.envMap=t.envMap,this.combine=t.combine,this.reflectivity=t.reflectivity,this.refractionRatio=t.refractionRatio,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.wireframeLinecap=t.wireframeLinecap,this.wireframeLinejoin=t.wireframeLinejoin,this.fog=t.fog,this}}class Cp extends Fi{constructor(t){super(),this.isMeshMatcapMaterial=!0,this.defines={MATCAP:""},this.type="MeshMatcapMaterial",this.color=new lr(16777215),this.matcap=null,this.map=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=Fe,this.normalScale=new qn(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.alphaMap=null,this.flatShading=!1,this.fog=!0,this.setValues(t)}copy(t){return super.copy(t),this.defines={MATCAP:""},this.color.copy(t.color),this.matcap=t.matcap,this.map=t.map,this.bumpMap=t.bumpMap,this.bumpScale=t.bumpScale,this.normalMap=t.normalMap,this.normalMapType=t.normalMapType,this.normalScale.copy(t.normalScale),this.displacementMap=t.displacementMap,this.displacementScale=t.displacementScale,this.displacementBias=t.displacementBias,this.alphaMap=t.alphaMap,this.flatShading=t.flatShading,this.fog=t.fog,this}}class Rp extends dd{constructor(t){super(),this.isLineDashedMaterial=!0,this.type="LineDashedMaterial",this.scale=1,this.dashSize=3,this.gapSize=1,this.setValues(t)}copy(t){return super.copy(t),this.scale=t.scale,this.dashSize=t.dashSize,this.gapSize=t.gapSize,this}}const Ip={ShadowMaterial:bp,SpriteMaterial:Ih,RawShaderMaterial:wp,ShaderMaterial:Ns,PointsMaterial:Md,MeshPhysicalMaterial:Mp,MeshStandardMaterial:_p,MeshPhongMaterial:Ap,MeshToonMaterial:Sp,MeshNormalMaterial:Ep,MeshLambertMaterial:Tp,MeshDepthMaterial:oh,MeshDistanceMaterial:ah,MeshBasicMaterial:Ui,MeshMatcapMaterial:Cp,LineDashedMaterial:Rp,LineBasicMaterial:dd,Material:Fi};Fi.fromType=function(t){return new Ip[t]};const Pp={arraySlice:function(t,e,n){return Pp.isTypedArray(t)?new t.constructor(t.subarray(e,void 0!==n?n:t.length)):t.slice(e,n)},convertArray:function(t,e,n){return!t||!n&&t.constructor===e?t:"number"===typeof e.BYTES_PER_ELEMENT?new e(t):Array.prototype.slice.call(t)},isTypedArray:function(t){return ArrayBuffer.isView(t)&&!(t instanceof DataView)},getKeyframeOrder:function(t){function e(e,n){return t[e]-t[n]}const n=t.length,r=new Array(n);for(let i=0;i!==n;++i)r[i]=i;return r.sort(e),r},sortedArray:function(t,e,n){const r=t.length,i=new t.constructor(r);for(let s=0,o=0;o!==r;++s){const r=n[s]*e;for(let n=0;n!==e;++n)i[o++]=t[r+n]}return i},flattenJSON:function(t,e,n,r){let i=1,s=t[0];while(void 0!==s&&void 0===s[r])s=t[i++];if(void 0===s)return;let o=s[r];if(void 0!==o)if(Array.isArray(o))do{o=s[r],void 0!==o&&(e.push(s.time),n.push.apply(n,o)),s=t[i++]}while(void 0!==s);else if(void 0!==o.toArray)do{o=s[r],void 0!==o&&(e.push(s.time),o.toArray(n,n.length)),s=t[i++]}while(void 0!==s);else do{o=s[r],void 0!==o&&(e.push(s.time),n.push(o)),s=t[i++]}while(void 0!==s)},subclip:function(t,e,n,r,i=30){const s=t.clone();s.name=e;const o=[];for(let l=0;l<s.tracks.length;++l){const t=s.tracks[l],e=t.getValueSize(),a=[],c=[];for(let s=0;s<t.times.length;++s){const o=t.times[s]*i;if(!(o<n||o>=r)){a.push(t.times[s]);for(let n=0;n<e;++n)c.push(t.values[s*e+n])}}0!==a.length&&(t.times=Pp.convertArray(a,t.times.constructor),t.values=Pp.convertArray(c,t.values.constructor),o.push(t))}s.tracks=o;let a=1/0;for(let l=0;l<s.tracks.length;++l)a>s.tracks[l].times[0]&&(a=s.tracks[l].times[0]);for(let l=0;l<s.tracks.length;++l)s.tracks[l].shift(-1*a);return s.resetDuration(),s},makeClipAdditive:function(t,e=0,n=t,r=30){r<=0&&(r=30);const i=n.tracks.length,s=e/r;for(let o=0;o<i;++o){const e=n.tracks[o],r=e.ValueTypeName;if("bool"===r||"string"===r)continue;const i=t.tracks.find((function(t){return t.name===e.name&&t.ValueTypeName===r}));if(void 0===i)continue;let a=0;const l=e.getValueSize();e.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline&&(a=l/3);let c=0;const u=i.getValueSize();i.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline&&(c=u/3);const h=e.times.length-1;let d;if(s<=e.times[0]){const t=a,n=l-a;d=Pp.arraySlice(e.values,t,n)}else if(s>=e.times[h]){const t=h*l+a,n=t+l-a;d=Pp.arraySlice(e.values,t,n)}else{const t=e.createInterpolant(),n=a,r=l-a;t.evaluate(s),d=Pp.arraySlice(t.resultBuffer,n,r)}if("quaternion"===r){const t=(new _r).fromArray(d).normalize().conjugate();t.toArray(d)}const f=i.times.length;for(let t=0;t<f;++t){const e=t*u+c;if("quaternion"===r)_r.multiplyQuaternionsFlat(i.values,e,d,0,i.values,e);else{const t=u-2*c;for(let n=0;n<t;++n)i.values[e+n]-=d[n]}}}return t.blendMode=Ie,t}};class Lp{constructor(t,e,n,r){this.parameterPositions=t,this._cachedIndex=0,this.resultBuffer=void 0!==r?r:new e.constructor(n),this.sampleValues=e,this.valueSize=n,this.settings=null,this.DefaultSettings_={}}evaluate(t){const e=this.parameterPositions;let n=this._cachedIndex,r=e[n],i=e[n-1];t:{e:{let s;n:{r:if(!(t<r)){for(let s=n+2;;){if(void 0===r){if(t<i)break r;return n=e.length,this._cachedIndex=n,this.copySampleValue_(n-1)}if(n===s)break;if(i=r,r=e[++n],t<r)break e}s=e.length;break n}if(t>=i)break t;{const o=e[1];t<o&&(n=2,i=o);for(let s=n-2;;){if(void 0===i)return this._cachedIndex=0,this.copySampleValue_(0);if(n===s)break;if(r=i,i=e[--n-1],t>=i)break e}s=n,n=0}}while(n<s){const r=n+s>>>1;t<e[r]?s=r:n=r+1}if(r=e[n],i=e[n-1],void 0===i)return this._cachedIndex=0,this.copySampleValue_(0);if(void 0===r)return n=e.length,this._cachedIndex=n,this.copySampleValue_(n-1)}this._cachedIndex=n,this.intervalChanged_(n,i,r)}return this.interpolate_(n,i,t,r)}getSettings_(){return this.settings||this.DefaultSettings_}copySampleValue_(t){const e=this.resultBuffer,n=this.sampleValues,r=this.valueSize,i=t*r;for(let s=0;s!==r;++s)e[s]=n[i+s];return e}interpolate_(){throw new Error("call to abstract method")}intervalChanged_(){}}class Np extends Lp{constructor(t,e,n,r){super(t,e,n,r),this._weightPrev=-0,this._offsetPrev=-0,this._weightNext=-0,this._offsetNext=-0,this.DefaultSettings_={endingStart:Ee,endingEnd:Ee}}intervalChanged_(t,e,n){const r=this.parameterPositions;let i=t-2,s=t+1,o=r[i],a=r[s];if(void 0===o)switch(this.getSettings_().endingStart){case Te:i=t,o=2*e-n;break;case Ce:i=r.length-2,o=e+r[i]-r[i+1];break;default:i=t,o=n}if(void 0===a)switch(this.getSettings_().endingEnd){case Te:s=t,a=2*n-e;break;case Ce:s=1,a=n+r[1]-r[0];break;default:s=t-1,a=e}const l=.5*(n-e),c=this.valueSize;this._weightPrev=l/(e-o),this._weightNext=l/(a-n),this._offsetPrev=i*c,this._offsetNext=s*c}interpolate_(t,e,n,r){const i=this.resultBuffer,s=this.sampleValues,o=this.valueSize,a=t*o,l=a-o,c=this._offsetPrev,u=this._offsetNext,h=this._weightPrev,d=this._weightNext,f=(n-e)/(r-e),p=f*f,m=p*f,g=-h*m+2*h*p-h*f,v=(1+h)*m+(-1.5-2*h)*p+(-.5+h)*f+1,y=(-1-d)*m+(1.5+d)*p+.5*f,x=d*m-d*p;for(let b=0;b!==o;++b)i[b]=g*s[c+b]+v*s[l+b]+y*s[a+b]+x*s[u+b];return i}}class kp extends Lp{constructor(t,e,n,r){super(t,e,n,r)}interpolate_(t,e,n,r){const i=this.resultBuffer,s=this.sampleValues,o=this.valueSize,a=t*o,l=a-o,c=(n-e)/(r-e),u=1-c;for(let h=0;h!==o;++h)i[h]=s[l+h]*u+s[a+h]*c;return i}}class Op extends Lp{constructor(t,e,n,r){super(t,e,n,r)}interpolate_(t){return this.copySampleValue_(t-1)}}class Dp{constructor(t,e,n,r){if(void 0===t)throw new Error("THREE.KeyframeTrack: track name is undefined");if(void 0===e||0===e.length)throw new Error("THREE.KeyframeTrack: no keyframes in track named "+t);this.name=t,this.times=Pp.convertArray(e,this.TimeBufferType),this.values=Pp.convertArray(n,this.ValueBufferType),this.setInterpolation(r||this.DefaultInterpolation)}static toJSON(t){const e=t.constructor;let n;if(e.toJSON!==this.toJSON)n=e.toJSON(t);else{n={name:t.name,times:Pp.convertArray(t.times,Array),values:Pp.convertArray(t.values,Array)};const e=t.getInterpolation();e!==t.DefaultInterpolation&&(n.interpolation=e)}return n.type=t.ValueTypeName,n}InterpolantFactoryMethodDiscrete(t){return new Op(this.times,this.values,this.getValueSize(),t)}InterpolantFactoryMethodLinear(t){return new kp(this.times,this.values,this.getValueSize(),t)}InterpolantFactoryMethodSmooth(t){return new Np(this.times,this.values,this.getValueSize(),t)}setInterpolation(t){let e;switch(t){case Me:e=this.InterpolantFactoryMethodDiscrete;break;case Ae:e=this.InterpolantFactoryMethodLinear;break;case Se:e=this.InterpolantFactoryMethodSmooth;break}if(void 0===e){const e="unsupported interpolation for "+this.ValueTypeName+" keyframe track named "+this.name;if(void 0===this.createInterpolant){if(t===this.DefaultInterpolation)throw new Error(e);this.setInterpolation(this.DefaultInterpolation)}return console.warn("THREE.KeyframeTrack:",e),this}return this.createInterpolant=e,this}getInterpolation(){switch(this.createInterpolant){case this.InterpolantFactoryMethodDiscrete:return Me;case this.InterpolantFactoryMethodLinear:return Ae;case this.InterpolantFactoryMethodSmooth:return Se}}getValueSize(){return this.values.length/this.times.length}shift(t){if(0!==t){const e=this.times;for(let n=0,r=e.length;n!==r;++n)e[n]+=t}return this}scale(t){if(1!==t){const e=this.times;for(let n=0,r=e.length;n!==r;++n)e[n]*=t}return this}trim(t,e){const n=this.times,r=n.length;let i=0,s=r-1;while(i!==r&&n[i]<t)++i;while(-1!==s&&n[s]>e)--s;if(++s,0!==i||s!==r){i>=s&&(s=Math.max(s,1),i=s-1);const t=this.getValueSize();this.times=Pp.arraySlice(n,i,s),this.values=Pp.arraySlice(this.values,i*t,s*t)}return this}validate(){let t=!0;const e=this.getValueSize();e-Math.floor(e)!==0&&(console.error("THREE.KeyframeTrack: Invalid value size in track.",this),t=!1);const n=this.times,r=this.values,i=n.length;0===i&&(console.error("THREE.KeyframeTrack: Track is empty.",this),t=!1);let s=null;for(let o=0;o!==i;o++){const e=n[o];if("number"===typeof e&&isNaN(e)){console.error("THREE.KeyframeTrack: Time is not a valid number.",this,o,e),t=!1;break}if(null!==s&&s>e){console.error("THREE.KeyframeTrack: Out of order keys.",this,o,e,s),t=!1;break}s=e}if(void 0!==r&&Pp.isTypedArray(r))for(let o=0,a=r.length;o!==a;++o){const e=r[o];if(isNaN(e)){console.error("THREE.KeyframeTrack: Value is not a valid number.",this,o,e),t=!1;break}}return t}optimize(){const t=Pp.arraySlice(this.times),e=Pp.arraySlice(this.values),n=this.getValueSize(),r=this.getInterpolation()===Se,i=t.length-1;let s=1;for(let o=1;o<i;++o){let i=!1;const a=t[o],l=t[o+1];if(a!==l&&(1!==o||a!==t[0]))if(r)i=!0;else{const t=o*n,r=t-n,s=t+n;for(let o=0;o!==n;++o){const n=e[t+o];if(n!==e[r+o]||n!==e[s+o]){i=!0;break}}}if(i){if(o!==s){t[s]=t[o];const r=o*n,i=s*n;for(let t=0;t!==n;++t)e[i+t]=e[r+t]}++s}}if(i>0){t[s]=t[i];for(let t=i*n,r=s*n,o=0;o!==n;++o)e[r+o]=e[t+o];++s}return s!==t.length?(this.times=Pp.arraySlice(t,0,s),this.values=Pp.arraySlice(e,0,s*n)):(this.times=t,this.values=e),this}clone(){const t=Pp.arraySlice(this.times,0),e=Pp.arraySlice(this.values,0),n=this.constructor,r=new n(this.name,t,e);return r.createInterpolant=this.createInterpolant,r}}Dp.prototype.TimeBufferType=Float32Array,Dp.prototype.ValueBufferType=Float32Array,Dp.prototype.DefaultInterpolation=Ae;class zp extends Dp{}zp.prototype.ValueTypeName="bool",zp.prototype.ValueBufferType=Array,zp.prototype.DefaultInterpolation=Me,zp.prototype.InterpolantFactoryMethodLinear=void 0,zp.prototype.InterpolantFactoryMethodSmooth=void 0;class Fp extends Dp{}Fp.prototype.ValueTypeName="color";class Up extends Dp{}Up.prototype.ValueTypeName="number";class Bp extends Lp{constructor(t,e,n,r){super(t,e,n,r)}interpolate_(t,e,n,r){const i=this.resultBuffer,s=this.sampleValues,o=this.valueSize,a=(n-e)/(r-e);let l=t*o;for(let c=l+o;l!==c;l+=4)_r.slerpFlat(i,0,s,l-o,s,l,a);return i}}class Gp extends Dp{InterpolantFactoryMethodLinear(t){return new Bp(this.times,this.values,this.getValueSize(),t)}}Gp.prototype.ValueTypeName="quaternion",Gp.prototype.DefaultInterpolation=Ae,Gp.prototype.InterpolantFactoryMethodSmooth=void 0;class Hp extends Dp{}Hp.prototype.ValueTypeName="string",Hp.prototype.ValueBufferType=Array,Hp.prototype.DefaultInterpolation=Me,Hp.prototype.InterpolantFactoryMethodLinear=void 0,Hp.prototype.InterpolantFactoryMethodSmooth=void 0;class Vp extends Dp{}Vp.prototype.ValueTypeName="vector";class jp{constructor(t,e=-1,n,r=Re){this.name=t,this.tracks=n,this.duration=e,this.blendMode=r,this.uuid=Mn(),this.duration<0&&this.resetDuration()}static parse(t){const e=[],n=t.tracks,r=1/(t.fps||1);for(let s=0,o=n.length;s!==o;++s)e.push(qp(n[s]).scale(r));const i=new this(t.name,t.duration,e,t.blendMode);return i.uuid=t.uuid,i}static toJSON(t){const e=[],n=t.tracks,r={name:t.name,duration:t.duration,tracks:e,uuid:t.uuid,blendMode:t.blendMode};for(let i=0,s=n.length;i!==s;++i)e.push(Dp.toJSON(n[i]));return r}static CreateFromMorphTargetSequence(t,e,n,r){const i=e.length,s=[];for(let o=0;o<i;o++){let t=[],a=[];t.push((o+i-1)%i,o,(o+1)%i),a.push(0,1,0);const l=Pp.getKeyframeOrder(t);t=Pp.sortedArray(t,1,l),a=Pp.sortedArray(a,1,l),r||0!==t[0]||(t.push(i),a.push(a[0])),s.push(new Up(".morphTargetInfluences["+e[o].name+"]",t,a).scale(1/n))}return new this(t,-1,s)}static findByName(t,e){let n=t;if(!Array.isArray(t)){const e=t;n=e.geometry&&e.geometry.animations||e.animations}for(let r=0;r<n.length;r++)if(n[r].name===e)return n[r];return null}static CreateClipsFromMorphTargetSequences(t,e,n){const r={},i=/^([\w-]*?)([\d]+)$/;for(let o=0,a=t.length;o<a;o++){const e=t[o],n=e.name.match(i);if(n&&n.length>1){const t=n[1];let i=r[t];i||(r[t]=i=[]),i.push(e)}}const s=[];for(const o in r)s.push(this.CreateFromMorphTargetSequence(o,r[o],e,n));return s}static parseAnimation(t,e){if(!t)return console.error("THREE.AnimationClip: No animation in JSONLoader data."),null;const n=function(t,e,n,r,i){if(0!==n.length){const s=[],o=[];Pp.flattenJSON(n,s,o,r),0!==s.length&&i.push(new t(e,s,o))}},r=[],i=t.name||"default",s=t.fps||30,o=t.blendMode;let a=t.length||-1;const l=t.hierarchy||[];for(let u=0;u<l.length;u++){const t=l[u].keys;if(t&&0!==t.length)if(t[0].morphTargets){const e={};let n;for(n=0;n<t.length;n++)if(t[n].morphTargets)for(let r=0;r<t[n].morphTargets.length;r++)e[t[n].morphTargets[r]]=-1;for(const i in e){const e=[],s=[];for(let r=0;r!==t[n].morphTargets.length;++r){const r=t[n];e.push(r.time),s.push(r.morphTarget===i?1:0)}r.push(new Up(".morphTargetInfluence["+i+"]",e,s))}a=e.length*s}else{const i=".bones["+e[u].name+"]";n(Vp,i+".position",t,"pos",r),n(Gp,i+".quaternion",t,"rot",r),n(Vp,i+".scale",t,"scl",r)}}if(0===r.length)return null;const c=new this(i,a,r,o);return c}resetDuration(){const t=this.tracks;let e=0;for(let n=0,r=t.length;n!==r;++n){const t=this.tracks[n];e=Math.max(e,t.times[t.times.length-1])}return this.duration=e,this}trim(){for(let t=0;t<this.tracks.length;t++)this.tracks[t].trim(0,this.duration);return this}validate(){let t=!0;for(let e=0;e<this.tracks.length;e++)t=t&&this.tracks[e].validate();return t}optimize(){for(let t=0;t<this.tracks.length;t++)this.tracks[t].optimize();return this}clone(){const t=[];for(let e=0;e<this.tracks.length;e++)t.push(this.tracks[e].clone());return new this.constructor(this.name,this.duration,t,this.blendMode)}toJSON(){return this.constructor.toJSON(this)}}function Wp(t){switch(t.toLowerCase()){case"scalar":case"double":case"float":case"number":case"integer":return Up;case"vector":case"vector2":case"vector3":case"vector4":return Vp;case"color":return Fp;case"quaternion":return Gp;case"bool":case"boolean":return zp;case"string":return Hp}throw new Error("THREE.KeyframeTrack: Unsupported typeName: "+t)}function qp(t){if(void 0===t.type)throw new Error("THREE.KeyframeTrack: track type undefined, can not parse");const e=Wp(t.type);if(void 0===t.times){const e=[],n=[];Pp.flattenJSON(t.keys,e,n,"value"),t.times=e,t.values=n}return void 0!==e.parse?e.parse(t):new e(t.name,t.times,t.values,t.interpolation)}const Yp={enabled:!1,files:{},add:function(t,e){!1!==this.enabled&&(this.files[t]=e)},get:function(t){if(!1!==this.enabled)return this.files[t]},remove:function(t){delete this.files[t]},clear:function(){this.files={}}};class Xp{constructor(t,e,n){const r=this;let i,s=!1,o=0,a=0;const l=[];this.onStart=void 0,this.onLoad=t,this.onProgress=e,this.onError=n,this.itemStart=function(t){a++,!1===s&&void 0!==r.onStart&&r.onStart(t,o,a),s=!0},this.itemEnd=function(t){o++,void 0!==r.onProgress&&r.onProgress(t,o,a),o===a&&(s=!1,void 0!==r.onLoad&&r.onLoad())},this.itemError=function(t){void 0!==r.onError&&r.onError(t)},this.resolveURL=function(t){return i?i(t):t},this.setURLModifier=function(t){return i=t,this},this.addHandler=function(t,e){return l.push(t,e),this},this.removeHandler=function(t){const e=l.indexOf(t);return-1!==e&&l.splice(e,2),this},this.getHandler=function(t){for(let e=0,n=l.length;e<n;e+=2){const n=l[e],r=l[e+1];if(n.global&&(n.lastIndex=0),n.test(t))return r}return null}}}const Jp=new Xp;class Kp{constructor(t){this.manager=void 0!==t?t:Jp,this.crossOrigin="anonymous",this.withCredentials=!1,this.path="",this.resourcePath="",this.requestHeader={}}load(){}loadAsync(t,e){const n=this;return new Promise((function(r,i){n.load(t,r,e,i)}))}parse(){}setCrossOrigin(t){return this.crossOrigin=t,this}setWithCredentials(t){return this.withCredentials=t,this}setPath(t){return this.path=t,this}setResourcePath(t){return this.resourcePath=t,this}setRequestHeader(t){return this.requestHeader=t,this}}const Zp={};class Qp extends Kp{constructor(t){super(t)}load(t,e,n,r){void 0===t&&(t=""),void 0!==this.path&&(t=this.path+t),t=this.manager.resolveURL(t);const i=Yp.get(t);if(void 0!==i)return this.manager.itemStart(t),setTimeout((()=>{e&&e(i),this.manager.itemEnd(t)}),0),i;if(void 0!==Zp[t])return void Zp[t].push({onLoad:e,onProgress:n,onError:r});Zp[t]=[],Zp[t].push({onLoad:e,onProgress:n,onError:r});const s=new Request(t,{headers:new Headers(this.requestHeader),credentials:this.withCredentials?"include":"same-origin"}),o=this.mimeType,a=this.responseType;fetch(s).then((e=>{if(200===e.status||0===e.status){if(0===e.status&&console.warn("THREE.FileLoader: HTTP Status 0 received."),"undefined"===typeof ReadableStream||void 0===e.body||void 0===e.body.getReader)return e;const n=Zp[t],r=e.body.getReader(),i=e.headers.get("Content-Length"),s=i?parseInt(i):0,o=0!==s;let a=0;const l=new ReadableStream({start(t){function e(){r.read().then((({done:r,value:i})=>{if(r)t.close();else{a+=i.byteLength;const r=new ProgressEvent("progress",{lengthComputable:o,loaded:a,total:s});for(let t=0,e=n.length;t<e;t++){const e=n[t];e.onProgress&&e.onProgress(r)}t.enqueue(i),e()}}))}e()}});return new Response(l)}throw Error(`fetch for "${e.url}" responded with ${e.status}: ${e.statusText}`)})).then((t=>{switch(a){case"arraybuffer":return t.arrayBuffer();case"blob":return t.blob();case"document":return t.text().then((t=>{const e=new DOMParser;return e.parseFromString(t,o)}));case"json":return t.json();default:if(void 0===o)return t.text();{const e=/charset="?([^;"\s]*)"?/i,n=e.exec(o),r=n&&n[1]?n[1].toLowerCase():void 0,i=new TextDecoder(r);return t.arrayBuffer().then((t=>i.decode(t)))}}})).then((e=>{Yp.add(t,e);const n=Zp[t];delete Zp[t];for(let t=0,r=n.length;t<r;t++){const r=n[t];r.onLoad&&r.onLoad(e)}})).catch((e=>{const n=Zp[t];if(void 0===n)throw this.manager.itemError(t),e;delete Zp[t];for(let t=0,r=n.length;t<r;t++){const r=n[t];r.onError&&r.onError(e)}this.manager.itemError(t)})).finally((()=>{this.manager.itemEnd(t)})),this.manager.itemStart(t)}setResponseType(t){return this.responseType=t,this}setMimeType(t){return this.mimeType=t,this}}class $p extends Kp{constructor(t){super(t)}load(t,e,n,r){const i=this,s=new Qp(this.manager);s.setPath(this.path),s.setRequestHeader(this.requestHeader),s.setWithCredentials(this.withCredentials),s.load(t,(function(n){try{e(i.parse(JSON.parse(n)))}catch(s){r?r(s):console.error(s),i.manager.itemError(t)}}),n,r)}parse(t){const e=[];for(let n=0;n<t.length;n++){const r=jp.parse(t[n]);e.push(r)}return e}}class tm extends Kp{constructor(t){super(t)}load(t,e,n,r){const i=this,s=[],o=new Ld,a=new Qp(this.manager);a.setPath(this.path),a.setResponseType("arraybuffer"),a.setRequestHeader(this.requestHeader),a.setWithCredentials(i.withCredentials);let l=0;function c(c){a.load(t[c],(function(t){const n=i.parse(t,!0);s[c]={width:n.width,height:n.height,format:n.format,mipmaps:n.mipmaps},l+=1,6===l&&(1===n.mipmapCount&&(o.minFilter=bt),o.image=s,o.format=n.format,o.needsUpdate=!0,e&&e(o))}),n,r)}if(Array.isArray(t))for(let u=0,h=t.length;u<h;++u)c(u);else a.load(t,(function(t){const n=i.parse(t,!0);if(n.isCubemap){const t=n.mipmaps.length/n.mipmapCount;for(let e=0;e<t;e++){s[e]={mipmaps:[]};for(let t=0;t<n.mipmapCount;t++)s[e].mipmaps.push(n.mipmaps[e*n.mipmapCount+t]),s[e].format=n.format,s[e].width=n.width,s[e].height=n.height}o.image=s}else o.image.width=n.width,o.image.height=n.height,o.mipmaps=n.mipmaps;1===n.mipmapCount&&(o.minFilter=bt),o.format=n.format,o.needsUpdate=!0,e&&e(o)}),n,r);return o}}class em extends Kp{constructor(t){super(t)}load(t,e,n,r){void 0!==this.path&&(t=this.path+t),t=this.manager.resolveURL(t);const i=this,s=Yp.get(t);if(void 0!==s)return i.manager.itemStart(t),setTimeout((function(){e&&e(s),i.manager.itemEnd(t)}),0),s;const o=Zn("img");function a(){c(),Yp.add(t,this),e&&e(this),i.manager.itemEnd(t)}function l(e){c(),r&&r(e),i.manager.itemError(t),i.manager.itemEnd(t)}function c(){o.removeEventListener("load",a,!1),o.removeEventListener("error",l,!1)}return o.addEventListener("load",a,!1),o.addEventListener("error",l,!1),"data:"!==t.slice(0,5)&&void 0!==this.crossOrigin&&(o.crossOrigin=this.crossOrigin),i.manager.itemStart(t),o.src=t,o}}class nm extends Kp{constructor(t){super(t)}load(t,e,n,r){const i=new Us,s=new em(this.manager);s.setCrossOrigin(this.crossOrigin),s.setPath(this.path);let o=0;function a(n){s.load(t[n],(function(t){i.images[n]=t,o++,6===o&&(i.needsUpdate=!0,e&&e(i))}),void 0,r)}for(let l=0;l<t.length;++l)a(l);return i}}class rm extends Kp{constructor(t){super(t)}load(t,e,n,r){const i=this,s=new nd,o=new Qp(this.manager);return o.setResponseType("arraybuffer"),o.setRequestHeader(this.requestHeader),o.setPath(this.path),o.setWithCredentials(i.withCredentials),o.load(t,(function(t){const n=i.parse(t);n&&(void 0!==n.image?s.image=n.image:void 0!==n.data&&(s.image.width=n.width,s.image.height=n.height,s.image.data=n.data),s.wrapS=void 0!==n.wrapS?n.wrapS:ft,s.wrapT=void 0!==n.wrapT?n.wrapT:ft,s.magFilter=void 0!==n.magFilter?n.magFilter:bt,s.minFilter=void 0!==n.minFilter?n.minFilter:bt,s.anisotropy=void 0!==n.anisotropy?n.anisotropy:1,void 0!==n.encoding&&(s.encoding=n.encoding),void 0!==n.flipY&&(s.flipY=n.flipY),void 0!==n.format&&(s.format=n.format),void 0!==n.type&&(s.type=n.type),void 0!==n.mipmaps&&(s.mipmaps=n.mipmaps,s.minFilter=Mt),1===n.mipmapCount&&(s.minFilter=bt),void 0!==n.generateMipmaps&&(s.generateMipmaps=n.generateMipmaps),s.needsUpdate=!0,e&&e(s,n))}),n,r),s}}class im extends Kp{constructor(t){super(t)}load(t,e,n,r){const i=new pr,s=new em(this.manager);return s.setCrossOrigin(this.crossOrigin),s.setPath(this.path),s.load(t,(function(t){i.image=t,i.needsUpdate=!0,void 0!==e&&e(i)}),n,r),i}}class sm extends Si{constructor(t,e=1){super(),this.isLight=!0,this.type="Light",this.color=new lr(t),this.intensity=e}dispose(){}copy(t,e){return super.copy(t,e),this.color.copy(t.color),this.intensity=t.intensity,this}toJSON(t){const e=super.toJSON(t);return e.object.color=this.color.getHex(),e.object.intensity=this.intensity,void 0!==this.groundColor&&(e.object.groundColor=this.groundColor.getHex()),void 0!==this.distance&&(e.object.distance=this.distance),void 0!==this.angle&&(e.object.angle=this.angle),void 0!==this.decay&&(e.object.decay=this.decay),void 0!==this.penumbra&&(e.object.penumbra=this.penumbra),void 0!==this.shadow&&(e.object.shadow=this.shadow.toJSON()),e}}class om extends sm{constructor(t,e,n){super(t,n),this.isHemisphereLight=!0,this.type="HemisphereLight",this.position.copy(Si.DefaultUp),this.updateMatrix(),this.groundColor=new lr(e)}copy(t,e){return super.copy(t,e),this.groundColor.copy(t.groundColor),this}}const am=new ti,lm=new Mr,cm=new Mr;class um{constructor(t){this.camera=t,this.bias=0,this.normalBias=0,this.radius=1,this.blurSamples=8,this.mapSize=new qn(512,512),this.map=null,this.mapPass=null,this.matrix=new ti,this.autoUpdate=!0,this.needsUpdate=!1,this._frustum=new Ys,this._frameExtents=new qn(1,1),this._viewportCount=1,this._viewports=[new mr(0,0,1,1)]}getViewportCount(){return this._viewportCount}getFrustum(){return this._frustum}updateMatrices(t){const e=this.camera,n=this.matrix;lm.setFromMatrixPosition(t.matrixWorld),e.position.copy(lm),cm.setFromMatrixPosition(t.target.matrixWorld),e.lookAt(cm),e.updateMatrixWorld(),am.multiplyMatrices(e.projectionMatrix,e.matrixWorldInverse),this._frustum.setFromProjectionMatrix(am),n.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),n.multiply(e.projectionMatrix),n.multiply(e.matrixWorldInverse)}getViewport(t){return this._viewports[t]}getFrameExtents(){return this._frameExtents}dispose(){this.map&&this.map.dispose(),this.mapPass&&this.mapPass.dispose()}copy(t){return this.camera=t.camera.clone(),this.bias=t.bias,this.radius=t.radius,this.mapSize.copy(t.mapSize),this}clone(){return(new this.constructor).copy(this)}toJSON(){const t={};return 0!==this.bias&&(t.bias=this.bias),0!==this.normalBias&&(t.normalBias=this.normalBias),1!==this.radius&&(t.radius=this.radius),512===this.mapSize.x&&512===this.mapSize.y||(t.mapSize=this.mapSize.toArray()),t.camera=this.camera.toJSON(!1).object,delete t.camera.matrix,t}}class hm extends um{constructor(){super(new Os(50,1,.5,500)),this.isSpotLightShadow=!0,this.focus=1}updateMatrices(t){const e=this.camera,n=2*_n*t.angle*this.focus,r=this.mapSize.width/this.mapSize.height,i=t.distance||e.far;n===e.fov&&r===e.aspect&&i===e.far||(e.fov=n,e.aspect=r,e.far=i,e.updateProjectionMatrix()),super.updateMatrices(t)}copy(t){return super.copy(t),this.focus=t.focus,this}}class dm extends sm{constructor(t,e,n=0,r=Math.PI/3,i=0,s=1){super(t,e),this.isSpotLight=!0,this.type="SpotLight",this.position.copy(Si.DefaultUp),this.updateMatrix(),this.target=new Si,this.distance=n,this.angle=r,this.penumbra=i,this.decay=s,this.shadow=new hm}get power(){return this.intensity*Math.PI}set power(t){this.intensity=t/Math.PI}dispose(){this.shadow.dispose()}copy(t,e){return super.copy(t,e),this.distance=t.distance,this.angle=t.angle,this.penumbra=t.penumbra,this.decay=t.decay,this.target=t.target.clone(),this.shadow=t.shadow.clone(),this}}const fm=new ti,pm=new Mr,mm=new Mr;class gm extends um{constructor(){super(new Os(90,1,.5,500)),this.isPointLightShadow=!0,this._frameExtents=new qn(4,2),this._viewportCount=6,this._viewports=[new mr(2,1,1,1),new mr(0,1,1,1),new mr(3,1,1,1),new mr(1,1,1,1),new mr(3,0,1,1),new mr(1,0,1,1)],this._cubeDirections=[new Mr(1,0,0),new Mr(-1,0,0),new Mr(0,0,1),new Mr(0,0,-1),new Mr(0,1,0),new Mr(0,-1,0)],this._cubeUps=[new Mr(0,1,0),new Mr(0,1,0),new Mr(0,1,0),new Mr(0,1,0),new Mr(0,0,1),new Mr(0,0,-1)]}updateMatrices(t,e=0){const n=this.camera,r=this.matrix,i=t.distance||n.far;i!==n.far&&(n.far=i,n.updateProjectionMatrix()),pm.setFromMatrixPosition(t.matrixWorld),n.position.copy(pm),mm.copy(n.position),mm.add(this._cubeDirections[e]),n.up.copy(this._cubeUps[e]),n.lookAt(mm),n.updateMatrixWorld(),r.makeTranslation(-pm.x,-pm.y,-pm.z),fm.multiplyMatrices(n.projectionMatrix,n.matrixWorldInverse),this._frustum.setFromProjectionMatrix(fm)}}class vm extends sm{constructor(t,e,n=0,r=1){super(t,e),this.isPointLight=!0,this.type="PointLight",this.distance=n,this.decay=r,this.shadow=new gm}get power(){return 4*this.intensity*Math.PI}set power(t){this.intensity=t/(4*Math.PI)}dispose(){this.shadow.dispose()}copy(t,e){return super.copy(t,e),this.distance=t.distance,this.decay=t.decay,this.shadow=t.shadow.clone(),this}}class ym extends um{constructor(){super(new Dl(-5,5,5,-5,.5,500)),this.isDirectionalLightShadow=!0}}class xm extends sm{constructor(t,e){super(t,e),this.isDirectionalLight=!0,this.type="DirectionalLight",this.position.copy(Si.DefaultUp),this.updateMatrix(),this.target=new Si,this.shadow=new ym}dispose(){this.shadow.dispose()}copy(t){return super.copy(t),this.target=t.target.clone(),this.shadow=t.shadow.clone(),this}}class bm extends sm{constructor(t,e){super(t,e),this.isAmbientLight=!0,this.type="AmbientLight"}}class wm extends sm{constructor(t,e,n=10,r=10){super(t,e),this.isRectAreaLight=!0,this.type="RectAreaLight",this.width=n,this.height=r}get power(){return this.intensity*this.width*this.height*Math.PI}set power(t){this.intensity=t/(this.width*this.height*Math.PI)}copy(t){return super.copy(t),this.width=t.width,this.height=t.height,this}toJSON(t){const e=super.toJSON(t);return e.object.width=this.width,e.object.height=this.height,e}}class _m{constructor(){this.isSphericalHarmonics3=!0,this.coefficients=[];for(let t=0;t<9;t++)this.coefficients.push(new Mr)}set(t){for(let e=0;e<9;e++)this.coefficients[e].copy(t[e]);return this}zero(){for(let t=0;t<9;t++)this.coefficients[t].set(0,0,0);return this}getAt(t,e){const n=t.x,r=t.y,i=t.z,s=this.coefficients;return e.copy(s[0]).multiplyScalar(.282095),e.addScaledVector(s[1],.488603*r),e.addScaledVector(s[2],.488603*i),e.addScaledVector(s[3],.488603*n),e.addScaledVector(s[4],n*r*1.092548),e.addScaledVector(s[5],r*i*1.092548),e.addScaledVector(s[6],.315392*(3*i*i-1)),e.addScaledVector(s[7],n*i*1.092548),e.addScaledVector(s[8],.546274*(n*n-r*r)),e}getIrradianceAt(t,e){const n=t.x,r=t.y,i=t.z,s=this.coefficients;return e.copy(s[0]).multiplyScalar(.886227),e.addScaledVector(s[1],1.023328*r),e.addScaledVector(s[2],1.023328*i),e.addScaledVector(s[3],1.023328*n),e.addScaledVector(s[4],.858086*n*r),e.addScaledVector(s[5],.858086*r*i),e.addScaledVector(s[6],.743125*i*i-.247708),e.addScaledVector(s[7],.858086*n*i),e.addScaledVector(s[8],.429043*(n*n-r*r)),e}add(t){for(let e=0;e<9;e++)this.coefficients[e].add(t.coefficients[e]);return this}addScaledSH(t,e){for(let n=0;n<9;n++)this.coefficients[n].addScaledVector(t.coefficients[n],e);return this}scale(t){for(let e=0;e<9;e++)this.coefficients[e].multiplyScalar(t);return this}lerp(t,e){for(let n=0;n<9;n++)this.coefficients[n].lerp(t.coefficients[n],e);return this}equals(t){for(let e=0;e<9;e++)if(!this.coefficients[e].equals(t.coefficients[e]))return!1;return!0}copy(t){return this.set(t.coefficients)}clone(){return(new this.constructor).copy(this)}fromArray(t,e=0){const n=this.coefficients;for(let r=0;r<9;r++)n[r].fromArray(t,e+3*r);return this}toArray(t=[],e=0){const n=this.coefficients;for(let r=0;r<9;r++)n[r].toArray(t,e+3*r);return t}static getBasisAt(t,e){const n=t.x,r=t.y,i=t.z;e[0]=.282095,e[1]=.488603*r,e[2]=.488603*i,e[3]=.488603*n,e[4]=1.092548*n*r,e[5]=1.092548*r*i,e[6]=.315392*(3*i*i-1),e[7]=1.092548*n*i,e[8]=.546274*(n*n-r*r)}}class Mm extends sm{constructor(t=new _m,e=1){super(void 0,e),this.isLightProbe=!0,this.sh=t}copy(t){return super.copy(t),this.sh.copy(t.sh),this}fromJSON(t){return this.intensity=t.intensity,this.sh.fromArray(t.sh),this}toJSON(t){const e=super.toJSON(t);return e.object.sh=this.sh.toArray(),e}}class Am extends Kp{constructor(t){super(t),this.textures={}}load(t,e,n,r){const i=this,s=new Qp(i.manager);s.setPath(i.path),s.setRequestHeader(i.requestHeader),s.setWithCredentials(i.withCredentials),s.load(t,(function(n){try{e(i.parse(JSON.parse(n)))}catch(s){r?r(s):console.error(s),i.manager.itemError(t)}}),n,r)}parse(t){const e=this.textures;function n(t){return void 0===e[t]&&console.warn("THREE.MaterialLoader: Undefined texture",t),e[t]}const r=Fi.fromType(t.type);if(void 0!==t.uuid&&(r.uuid=t.uuid),void 0!==t.name&&(r.name=t.name),void 0!==t.color&&void 0!==r.color&&r.color.setHex(t.color),void 0!==t.roughness&&(r.roughness=t.roughness),void 0!==t.metalness&&(r.metalness=t.metalness),void 0!==t.sheen&&(r.sheen=t.sheen),void 0!==t.sheenColor&&(r.sheenColor=(new lr).setHex(t.sheenColor)),void 0!==t.sheenRoughness&&(r.sheenRoughness=t.sheenRoughness),void 0!==t.emissive&&void 0!==r.emissive&&r.emissive.setHex(t.emissive),void 0!==t.specular&&void 0!==r.specular&&r.specular.setHex(t.specular),void 0!==t.specularIntensity&&(r.specularIntensity=t.specularIntensity),void 0!==t.specularColor&&void 0!==r.specularColor&&r.specularColor.setHex(t.specularColor),void 0!==t.shininess&&(r.shininess=t.shininess),void 0!==t.clearcoat&&(r.clearcoat=t.clearcoat),void 0!==t.clearcoatRoughness&&(r.clearcoatRoughness=t.clearcoatRoughness),void 0!==t.iridescence&&(r.iridescence=t.iridescence),void 0!==t.iridescenceIOR&&(r.iridescenceIOR=t.iridescenceIOR),void 0!==t.iridescenceThicknessRange&&(r.iridescenceThicknessRange=t.iridescenceThicknessRange),void 0!==t.transmission&&(r.transmission=t.transmission),void 0!==t.thickness&&(r.thickness=t.thickness),void 0!==t.attenuationDistance&&(r.attenuationDistance=t.attenuationDistance),void 0!==t.attenuationColor&&void 0!==r.attenuationColor&&r.attenuationColor.setHex(t.attenuationColor),void 0!==t.fog&&(r.fog=t.fog),void 0!==t.flatShading&&(r.flatShading=t.flatShading),void 0!==t.blending&&(r.blending=t.blending),void 0!==t.combine&&(r.combine=t.combine),void 0!==t.side&&(r.side=t.side),void 0!==t.shadowSide&&(r.shadowSide=t.shadowSide),void 0!==t.opacity&&(r.opacity=t.opacity),void 0!==t.transparent&&(r.transparent=t.transparent),void 0!==t.alphaTest&&(r.alphaTest=t.alphaTest),void 0!==t.depthTest&&(r.depthTest=t.depthTest),void 0!==t.depthWrite&&(r.depthWrite=t.depthWrite),void 0!==t.colorWrite&&(r.colorWrite=t.colorWrite),void 0!==t.stencilWrite&&(r.stencilWrite=t.stencilWrite),void 0!==t.stencilWriteMask&&(r.stencilWriteMask=t.stencilWriteMask),void 0!==t.stencilFunc&&(r.stencilFunc=t.stencilFunc),void 0!==t.stencilRef&&(r.stencilRef=t.stencilRef),void 0!==t.stencilFuncMask&&(r.stencilFuncMask=t.stencilFuncMask),void 0!==t.stencilFail&&(r.stencilFail=t.stencilFail),void 0!==t.stencilZFail&&(r.stencilZFail=t.stencilZFail),void 0!==t.stencilZPass&&(r.stencilZPass=t.stencilZPass),void 0!==t.wireframe&&(r.wireframe=t.wireframe),void 0!==t.wireframeLinewidth&&(r.wireframeLinewidth=t.wireframeLinewidth),void 0!==t.wireframeLinecap&&(r.wireframeLinecap=t.wireframeLinecap),void 0!==t.wireframeLinejoin&&(r.wireframeLinejoin=t.wireframeLinejoin),void 0!==t.rotation&&(r.rotation=t.rotation),1!==t.linewidth&&(r.linewidth=t.linewidth),void 0!==t.dashSize&&(r.dashSize=t.dashSize),void 0!==t.gapSize&&(r.gapSize=t.gapSize),void 0!==t.scale&&(r.scale=t.scale),void 0!==t.polygonOffset&&(r.polygonOffset=t.polygonOffset),void 0!==t.polygonOffsetFactor&&(r.polygonOffsetFactor=t.polygonOffsetFactor),void 0!==t.polygonOffsetUnits&&(r.polygonOffsetUnits=t.polygonOffsetUnits),void 0!==t.dithering&&(r.dithering=t.dithering),void 0!==t.alphaToCoverage&&(r.alphaToCoverage=t.alphaToCoverage),void 0!==t.premultipliedAlpha&&(r.premultipliedAlpha=t.premultipliedAlpha),void 0!==t.visible&&(r.visible=t.visible),void 0!==t.toneMapped&&(r.toneMapped=t.toneMapped),void 0!==t.userData&&(r.userData=t.userData),void 0!==t.vertexColors&&("number"===typeof t.vertexColors?r.vertexColors=t.vertexColors>0:r.vertexColors=t.vertexColors),void 0!==t.uniforms)for(const i in t.uniforms){const e=t.uniforms[i];switch(r.uniforms[i]={},e.type){case"t":r.uniforms[i].value=n(e.value);break;case"c":r.uniforms[i].value=(new lr).setHex(e.value);break;case"v2":r.uniforms[i].value=(new qn).fromArray(e.value);break;case"v3":r.uniforms[i].value=(new Mr).fromArray(e.value);break;case"v4":r.uniforms[i].value=(new mr).fromArray(e.value);break;case"m3":r.uniforms[i].value=(new Yn).fromArray(e.value);break;case"m4":r.uniforms[i].value=(new ti).fromArray(e.value);break;default:r.uniforms[i].value=e.value}}if(void 0!==t.defines&&(r.defines=t.defines),void 0!==t.vertexShader&&(r.vertexShader=t.vertexShader),void 0!==t.fragmentShader&&(r.fragmentShader=t.fragmentShader),void 0!==t.extensions)for(const i in t.extensions)r.extensions[i]=t.extensions[i];if(void 0!==t.shading&&(r.flatShading=1===t.shading),void 0!==t.size&&(r.size=t.size),void 0!==t.sizeAttenuation&&(r.sizeAttenuation=t.sizeAttenuation),void 0!==t.map&&(r.map=n(t.map)),void 0!==t.matcap&&(r.matcap=n(t.matcap)),void 0!==t.alphaMap&&(r.alphaMap=n(t.alphaMap)),void 0!==t.bumpMap&&(r.bumpMap=n(t.bumpMap)),void 0!==t.bumpScale&&(r.bumpScale=t.bumpScale),void 0!==t.normalMap&&(r.normalMap=n(t.normalMap)),void 0!==t.normalMapType&&(r.normalMapType=t.normalMapType),void 0!==t.normalScale){let e=t.normalScale;!1===Array.isArray(e)&&(e=[e,e]),r.normalScale=(new qn).fromArray(e)}return void 0!==t.displacementMap&&(r.displacementMap=n(t.displacementMap)),void 0!==t.displacementScale&&(r.displacementScale=t.displacementScale),void 0!==t.displacementBias&&(r.displacementBias=t.displacementBias),void 0!==t.roughnessMap&&(r.roughnessMap=n(t.roughnessMap)),void 0!==t.metalnessMap&&(r.metalnessMap=n(t.metalnessMap)),void 0!==t.emissiveMap&&(r.emissiveMap=n(t.emissiveMap)),void 0!==t.emissiveIntensity&&(r.emissiveIntensity=t.emissiveIntensity),void 0!==t.specularMap&&(r.specularMap=n(t.specularMap)),void 0!==t.specularIntensityMap&&(r.specularIntensityMap=n(t.specularIntensityMap)),void 0!==t.specularColorMap&&(r.specularColorMap=n(t.specularColorMap)),void 0!==t.envMap&&(r.envMap=n(t.envMap)),void 0!==t.envMapIntensity&&(r.envMapIntensity=t.envMapIntensity),void 0!==t.reflectivity&&(r.reflectivity=t.reflectivity),void 0!==t.refractionRatio&&(r.refractionRatio=t.refractionRatio),void 0!==t.lightMap&&(r.lightMap=n(t.lightMap)),void 0!==t.lightMapIntensity&&(r.lightMapIntensity=t.lightMapIntensity),void 0!==t.aoMap&&(r.aoMap=n(t.aoMap)),void 0!==t.aoMapIntensity&&(r.aoMapIntensity=t.aoMapIntensity),void 0!==t.gradientMap&&(r.gradientMap=n(t.gradientMap)),void 0!==t.clearcoatMap&&(r.clearcoatMap=n(t.clearcoatMap)),void 0!==t.clearcoatRoughnessMap&&(r.clearcoatRoughnessMap=n(t.clearcoatRoughnessMap)),void 0!==t.clearcoatNormalMap&&(r.clearcoatNormalMap=n(t.clearcoatNormalMap)),void 0!==t.clearcoatNormalScale&&(r.clearcoatNormalScale=(new qn).fromArray(t.clearcoatNormalScale)),void 0!==t.iridescenceMap&&(r.iridescenceMap=n(t.iridescenceMap)),void 0!==t.iridescenceThicknessMap&&(r.iridescenceThicknessMap=n(t.iridescenceThicknessMap)),void 0!==t.transmissionMap&&(r.transmissionMap=n(t.transmissionMap)),void 0!==t.thicknessMap&&(r.thicknessMap=n(t.thicknessMap)),void 0!==t.sheenColorMap&&(r.sheenColorMap=n(t.sheenColorMap)),void 0!==t.sheenRoughnessMap&&(r.sheenRoughnessMap=n(t.sheenRoughnessMap)),r}setTextures(t){return this.textures=t,this}}class Sm{static decodeText(t){if("undefined"!==typeof TextDecoder)return(new TextDecoder).decode(t);let e="";for(let r=0,i=t.length;r<i;r++)e+=String.fromCharCode(t[r]);try{return decodeURIComponent(escape(e))}catch(n){return e}}static extractUrlBase(t){const e=t.lastIndexOf("/");return-1===e?"./":t.slice(0,e+1)}static resolveURL(t,e){return"string"!==typeof t||""===t?"":(/^https?:\/\//i.test(e)&&/^\//.test(t)&&(e=e.replace(/(^https?:\/\/[^\/]+).*/i,"$1")),/^(https?:)?\/\//i.test(t)||/^data:.*,.*$/i.test(t)||/^blob:.*$/i.test(t)?t:e+t)}}class Em extends os{constructor(){super(),this.isInstancedBufferGeometry=!0,this.type="InstancedBufferGeometry",this.instanceCount=1/0}copy(t){return super.copy(t),this.instanceCount=t.instanceCount,this}clone(){return(new this.constructor).copy(this)}toJSON(){const t=super.toJSON(this);return t.instanceCount=this.instanceCount,t.isInstancedBufferGeometry=!0,t}}class Tm extends Kp{constructor(t){super(t)}load(t,e,n,r){const i=this,s=new Qp(i.manager);s.setPath(i.path),s.setRequestHeader(i.requestHeader),s.setWithCredentials(i.withCredentials),s.load(t,(function(n){try{e(i.parse(JSON.parse(n)))}catch(s){r?r(s):console.error(s),i.manager.itemError(t)}}),n,r)}parse(t){const e={},n={};function r(t,n){if(void 0!==e[n])return e[n];const r=t.interleavedBuffers,s=r[n],o=i(t,s.buffer),a=Kn(s.type,o),l=new Th(a,s.stride);return l.uuid=s.uuid,e[n]=l,l}function i(t,e){if(void 0!==n[e])return n[e];const r=t.arrayBuffers,i=r[e],s=new Uint32Array(i).buffer;return n[e]=s,s}const s=t.isInstancedBufferGeometry?new Em:new os,o=t.data.index;if(void 0!==o){const t=Kn(o.type,o.array);s.setIndex(new Hi(t,1))}const a=t.data.attributes;for(const d in a){const e=a[d];let n;if(e.isInterleavedBufferAttribute){const i=r(t.data,e.data);n=new Rh(i,e.itemSize,e.offset,e.normalized)}else{const t=Kn(e.type,e.array),r=e.isInstancedBufferAttribute?od:Hi;n=new r(t,e.itemSize,e.normalized)}void 0!==e.name&&(n.name=e.name),void 0!==e.usage&&n.setUsage(e.usage),void 0!==e.updateRange&&(n.updateRange.offset=e.updateRange.offset,n.updateRange.count=e.updateRange.count),s.setAttribute(d,n)}const l=t.data.morphAttributes;if(l)for(const d in l){const e=l[d],n=[];for(let i=0,s=e.length;i<s;i++){const s=e[i];let o;if(s.isInterleavedBufferAttribute){const e=r(t.data,s.data);o=new Rh(e,s.itemSize,s.offset,s.normalized)}else{const t=Kn(s.type,s.array);o=new Hi(t,s.itemSize,s.normalized)}void 0!==s.name&&(o.name=s.name),n.push(o)}s.morphAttributes[d]=n}const c=t.data.morphTargetsRelative;c&&(s.morphTargetsRelative=!0);const u=t.data.groups||t.data.drawcalls||t.data.offsets;if(void 0!==u)for(let d=0,f=u.length;d!==f;++d){const t=u[d];s.addGroup(t.start,t.count,t.materialIndex)}const h=t.data.boundingSphere;if(void 0!==h){const t=new Mr;void 0!==h.center&&t.fromArray(h.center),s.boundingSphere=new Wr(t,h.radius)}return t.name&&(s.name=t.name),t.userData&&(s.userData=t.userData),s}}class Cm extends Kp{constructor(t){super(t)}load(t,e,n,r){const i=this,s=""===this.path?Sm.extractUrlBase(t):this.path;this.resourcePath=this.resourcePath||s;const o=new Qp(this.manager);o.setPath(this.path),o.setRequestHeader(this.requestHeader),o.setWithCredentials(this.withCredentials),o.load(t,(function(n){let s=null;try{s=JSON.parse(n)}catch(a){return void 0!==r&&r(a),void console.error("THREE:ObjectLoader: Can't parse "+t+".",a.message)}const o=s.metadata;void 0!==o&&void 0!==o.type&&"geometry"!==o.type.toLowerCase()?i.parse(s,e):console.error("THREE.ObjectLoader: Can't load "+t)}),n,r)}async loadAsync(t,e){const n=this,r=""===this.path?Sm.extractUrlBase(t):this.path;this.resourcePath=this.resourcePath||r;const i=new Qp(this.manager);i.setPath(this.path),i.setRequestHeader(this.requestHeader),i.setWithCredentials(this.withCredentials);const s=await i.loadAsync(t,e),o=JSON.parse(s),a=o.metadata;if(void 0===a||void 0===a.type||"geometry"===a.type.toLowerCase())throw new Error("THREE.ObjectLoader: Can't load "+t);return await n.parseAsync(o)}parse(t,e){const n=this.parseAnimations(t.animations),r=this.parseShapes(t.shapes),i=this.parseGeometries(t.geometries,r),s=this.parseImages(t.images,(function(){void 0!==e&&e(l)})),o=this.parseTextures(t.textures,s),a=this.parseMaterials(t.materials,o),l=this.parseObject(t.object,i,a,o,n),c=this.parseSkeletons(t.skeletons,l);if(this.bindSkeletons(l,c),void 0!==e){let t=!1;for(const e in s)if(s[e].data instanceof HTMLImageElement){t=!0;break}!1===t&&e(l)}return l}async parseAsync(t){const e=this.parseAnimations(t.animations),n=this.parseShapes(t.shapes),r=this.parseGeometries(t.geometries,n),i=await this.parseImagesAsync(t.images),s=this.parseTextures(t.textures,i),o=this.parseMaterials(t.materials,s),a=this.parseObject(t.object,r,o,s,e),l=this.parseSkeletons(t.skeletons,a);return this.bindSkeletons(a,l),a}parseShapes(t){const e={};if(void 0!==t)for(let n=0,r=t.length;n<r;n++){const r=(new _f).fromJSON(t[n]);e[r.uuid]=r}return e}parseSkeletons(t,e){const n={},r={};if(e.traverse((function(t){t.isBone&&(r[t.uuid]=t)})),void 0!==t)for(let i=0,s=t.length;i<s;i++){const e=(new sd).fromJSON(t[i],r);n[e.uuid]=e}return n}parseGeometries(t,e){const n={};if(void 0!==t){const r=new Tm;for(let i=0,s=t.length;i<s;i++){let s;const o=t[i];switch(o.type){case"BufferGeometry":case"InstancedBufferGeometry":s=r.parse(o);break;case"Geometry":console.error("THREE.ObjectLoader: The legacy Geometry type is no longer supported.");break;default:o.type in xp?s=xp[o.type].fromJSON(o,e):console.warn(`THREE.ObjectLoader: Unsupported geometry type "${o.type}"`)}s.uuid=o.uuid,void 0!==o.name&&(s.name=o.name),!0===s.isBufferGeometry&&void 0!==o.userData&&(s.userData=o.userData),n[o.uuid]=s}}return n}parseMaterials(t,e){const n={},r={};if(void 0!==t){const i=new Am;i.setTextures(e);for(let e=0,s=t.length;e<s;e++){const s=t[e];if("MultiMaterial"===s.type){const t=[];for(let e=0;e<s.materials.length;e++){const r=s.materials[e];void 0===n[r.uuid]&&(n[r.uuid]=i.parse(r)),t.push(n[r.uuid])}r[s.uuid]=t}else void 0===n[s.uuid]&&(n[s.uuid]=i.parse(s)),r[s.uuid]=n[s.uuid]}}return r}parseAnimations(t){const e={};if(void 0!==t)for(let n=0;n<t.length;n++){const r=t[n],i=jp.parse(r);e[i.uuid]=i}return e}parseImages(t,e){const n=this,r={};let i;function s(t){return n.manager.itemStart(t),i.load(t,(function(){n.manager.itemEnd(t)}),void 0,(function(){n.manager.itemError(t),n.manager.itemEnd(t)}))}function o(t){if("string"===typeof t){const e=t,r=/^(\/\/)|([a-z]+:(\/\/)?)/i.test(e)?e:n.resourcePath+e;return s(r)}return t.data?{data:Kn(t.type,t.data),width:t.width,height:t.height}:null}if(void 0!==t&&t.length>0){const n=new Xp(e);i=new em(n),i.setCrossOrigin(this.crossOrigin);for(let e=0,i=t.length;e<i;e++){const n=t[e],i=n.url;if(Array.isArray(i)){const t=[];for(let e=0,n=i.length;e<n;e++){const n=i[e],r=o(n);null!==r&&(r instanceof HTMLImageElement?t.push(r):t.push(new nd(r.data,r.width,r.height)))}r[n.uuid]=new hr(t)}else{const t=o(n.url);r[n.uuid]=new hr(t)}}}return r}async parseImagesAsync(t){const e=this,n={};let r;async function i(t){if("string"===typeof t){const n=t,i=/^(\/\/)|([a-z]+:(\/\/)?)/i.test(n)?n:e.resourcePath+n;return await r.loadAsync(i)}return t.data?{data:Kn(t.type,t.data),width:t.width,height:t.height}:null}if(void 0!==t&&t.length>0){r=new em(this.manager),r.setCrossOrigin(this.crossOrigin);for(let e=0,r=t.length;e<r;e++){const r=t[e],s=r.url;if(Array.isArray(s)){const t=[];for(let e=0,n=s.length;e<n;e++){const n=s[e],r=await i(n);null!==r&&(r instanceof HTMLImageElement?t.push(r):t.push(new nd(r.data,r.width,r.height)))}n[r.uuid]=new hr(t)}else{const t=await i(r.url);n[r.uuid]=new hr(t)}}}return n}parseTextures(t,e){function n(t,e){return"number"===typeof t?t:(console.warn("THREE.ObjectLoader.parseTexture: Constant should be in numeric form.",t),e[t])}const r={};if(void 0!==t)for(let i=0,s=t.length;i<s;i++){const s=t[i];void 0===s.image&&console.warn('THREE.ObjectLoader: No "image" specified for',s.uuid),void 0===e[s.image]&&console.warn("THREE.ObjectLoader: Undefined image",s.image);const o=e[s.image],a=o.data;let l;Array.isArray(a)?(l=new Us,6===a.length&&(l.needsUpdate=!0)):(l=a&&a.data?new nd:new pr,a&&(l.needsUpdate=!0)),l.source=o,l.uuid=s.uuid,void 0!==s.name&&(l.name=s.name),void 0!==s.mapping&&(l.mapping=n(s.mapping,Rm)),void 0!==s.offset&&l.offset.fromArray(s.offset),void 0!==s.repeat&&l.repeat.fromArray(s.repeat),void 0!==s.center&&l.center.fromArray(s.center),void 0!==s.rotation&&(l.rotation=s.rotation),void 0!==s.wrap&&(l.wrapS=n(s.wrap[0],Im),l.wrapT=n(s.wrap[1],Im)),void 0!==s.format&&(l.format=s.format),void 0!==s.type&&(l.type=s.type),void 0!==s.encoding&&(l.encoding=s.encoding),void 0!==s.minFilter&&(l.minFilter=n(s.minFilter,Pm)),void 0!==s.magFilter&&(l.magFilter=n(s.magFilter,Pm)),void 0!==s.anisotropy&&(l.anisotropy=s.anisotropy),void 0!==s.flipY&&(l.flipY=s.flipY),void 0!==s.premultiplyAlpha&&(l.premultiplyAlpha=s.premultiplyAlpha),void 0!==s.unpackAlignment&&(l.unpackAlignment=s.unpackAlignment),void 0!==s.userData&&(l.userData=s.userData),r[s.uuid]=l}return r}parseObject(t,e,n,r,i){let s,o,a;function l(t){return void 0===e[t]&&console.warn("THREE.ObjectLoader: Undefined geometry",t),e[t]}function c(t){if(void 0!==t){if(Array.isArray(t)){const e=[];for(let r=0,i=t.length;r<i;r++){const i=t[r];void 0===n[i]&&console.warn("THREE.ObjectLoader: Undefined material",i),e.push(n[i])}return e}return void 0===n[t]&&console.warn("THREE.ObjectLoader: Undefined material",t),n[t]}}function u(t){return void 0===r[t]&&console.warn("THREE.ObjectLoader: Undefined texture",t),r[t]}switch(t.type){case"Scene":s=new Eh,void 0!==t.background&&(Number.isInteger(t.background)?s.background=new lr(t.background):s.background=u(t.background)),void 0!==t.environment&&(s.environment=u(t.environment)),void 0!==t.fog&&("Fog"===t.fog.type?s.fog=new Sh(t.fog.color,t.fog.near,t.fog.far):"FogExp2"===t.fog.type&&(s.fog=new Ah(t.fog.color,t.fog.density)));break;case"PerspectiveCamera":s=new Os(t.fov,t.aspect,t.near,t.far),void 0!==t.focus&&(s.focus=t.focus),void 0!==t.zoom&&(s.zoom=t.zoom),void 0!==t.filmGauge&&(s.filmGauge=t.filmGauge),void 0!==t.filmOffset&&(s.filmOffset=t.filmOffset),void 0!==t.view&&(s.view=Object.assign({},t.view));break;case"OrthographicCamera":s=new Dl(t.left,t.right,t.top,t.bottom,t.near,t.far),void 0!==t.zoom&&(s.zoom=t.zoom),void 0!==t.view&&(s.view=Object.assign({},t.view));break;case"AmbientLight":s=new bm(t.color,t.intensity);break;case"DirectionalLight":s=new xm(t.color,t.intensity);break;case"PointLight":s=new vm(t.color,t.intensity,t.distance,t.decay);break;case"RectAreaLight":s=new wm(t.color,t.intensity,t.width,t.height);break;case"SpotLight":s=new dm(t.color,t.intensity,t.distance,t.angle,t.penumbra,t.decay);break;case"HemisphereLight":s=new om(t.color,t.groundColor,t.intensity);break;case"LightProbe":s=(new Mm).fromJSON(t);break;case"SkinnedMesh":o=l(t.geometry),a=c(t.material),s=new td(o,a),void 0!==t.bindMode&&(s.bindMode=t.bindMode),void 0!==t.bindMatrix&&s.bindMatrix.fromArray(t.bindMatrix),void 0!==t.skeleton&&(s.skeleton=t.skeleton);break;case"Mesh":o=l(t.geometry),a=c(t.material),s=new As(o,a);break;case"InstancedMesh":o=l(t.geometry),a=c(t.material);const e=t.count,n=t.instanceMatrix,r=t.instanceColor;s=new hd(o,a,e),s.instanceMatrix=new od(new Float32Array(n.array),16),void 0!==r&&(s.instanceColor=new od(new Float32Array(r.array),r.itemSize));break;case"LOD":s=new Xh;break;case"Line":s=new yd(l(t.geometry),c(t.material));break;case"LineLoop":s=new _d(l(t.geometry),c(t.material));break;case"LineSegments":s=new wd(l(t.geometry),c(t.material));break;case"PointCloud":case"Points":s=new Cd(l(t.geometry),c(t.material));break;case"Sprite":s=new jh(c(t.material));break;case"Group":s=new mh;break;case"Bone":s=new ed;break;default:s=new Si}if(s.uuid=t.uuid,void 0!==t.name&&(s.name=t.name),void 0!==t.matrix?(s.matrix.fromArray(t.matrix),void 0!==t.matrixAutoUpdate&&(s.matrixAutoUpdate=t.matrixAutoUpdate),s.matrixAutoUpdate&&s.matrix.decompose(s.position,s.quaternion,s.scale)):(void 0!==t.position&&s.position.fromArray(t.position),void 0!==t.rotation&&s.rotation.fromArray(t.rotation),void 0!==t.quaternion&&s.quaternion.fromArray(t.quaternion),void 0!==t.scale&&s.scale.fromArray(t.scale)),void 0!==t.castShadow&&(s.castShadow=t.castShadow),void 0!==t.receiveShadow&&(s.receiveShadow=t.receiveShadow),t.shadow&&(void 0!==t.shadow.bias&&(s.shadow.bias=t.shadow.bias),void 0!==t.shadow.normalBias&&(s.shadow.normalBias=t.shadow.normalBias),void 0!==t.shadow.radius&&(s.shadow.radius=t.shadow.radius),void 0!==t.shadow.mapSize&&s.shadow.mapSize.fromArray(t.shadow.mapSize),void 0!==t.shadow.camera&&(s.shadow.camera=this.parseObject(t.shadow.camera))),void 0!==t.visible&&(s.visible=t.visible),void 0!==t.frustumCulled&&(s.frustumCulled=t.frustumCulled),void 0!==t.renderOrder&&(s.renderOrder=t.renderOrder),void 0!==t.userData&&(s.userData=t.userData),void 0!==t.layers&&(s.layers.mask=t.layers),void 0!==t.children){const o=t.children;for(let t=0;t<o.length;t++)s.add(this.parseObject(o[t],e,n,r,i))}if(void 0!==t.animations){const e=t.animations;for(let t=0;t<e.length;t++){const n=e[t];s.animations.push(i[n])}}if("LOD"===t.type){void 0!==t.autoUpdate&&(s.autoUpdate=t.autoUpdate);const e=t.levels;for(let t=0;t<e.length;t++){const n=e[t],r=s.getObjectByProperty("uuid",n.object);void 0!==r&&s.addLevel(r,n.distance)}}return s}bindSkeletons(t,e){0!==Object.keys(e).length&&t.traverse((function(t){if(!0===t.isSkinnedMesh&&void 0!==t.skeleton){const n=e[t.skeleton];void 0===n?console.warn("THREE.ObjectLoader: No skeleton found with UUID:",t.skeleton):t.bind(n,t.bindMatrix)}}))}setTexturePath(t){return console.warn("THREE.ObjectLoader: .setTexturePath() has been renamed to .setResourcePath()."),this.setResourcePath(t)}}const Rm={UVMapping:ot,CubeReflectionMapping:at,CubeRefractionMapping:lt,EquirectangularReflectionMapping:ct,EquirectangularRefractionMapping:ut,CubeUVReflectionMapping:ht},Im={RepeatWrapping:dt,ClampToEdgeWrapping:ft,MirroredRepeatWrapping:pt},Pm={NearestFilter:mt,NearestMipmapNearestFilter:gt,NearestMipmapLinearFilter:yt,LinearFilter:bt,LinearMipmapNearestFilter:wt,LinearMipmapLinearFilter:Mt};class Lm extends Kp{constructor(t){super(t),this.isImageBitmapLoader=!0,"undefined"===typeof createImageBitmap&&console.warn("THREE.ImageBitmapLoader: createImageBitmap() not supported."),"undefined"===typeof fetch&&console.warn("THREE.ImageBitmapLoader: fetch() not supported."),this.options={premultiplyAlpha:"none"}}setOptions(t){return this.options=t,this}load(t,e,n,r){void 0===t&&(t=""),void 0!==this.path&&(t=this.path+t),t=this.manager.resolveURL(t);const i=this,s=Yp.get(t);if(void 0!==s)return i.manager.itemStart(t),setTimeout((function(){e&&e(s),i.manager.itemEnd(t)}),0),s;const o={};o.credentials="anonymous"===this.crossOrigin?"same-origin":"include",o.headers=this.requestHeader,fetch(t,o).then((function(t){return t.blob()})).then((function(t){return createImageBitmap(t,Object.assign(i.options,{colorSpaceConversion:"none"}))})).then((function(n){Yp.add(t,n),e&&e(n),i.manager.itemEnd(t)})).catch((function(e){r&&r(e),i.manager.itemError(t),i.manager.itemEnd(t)})),i.manager.itemStart(t)}}let Nm;const km={getContext:function(){return void 0===Nm&&(Nm=new(window.AudioContext||window.webkitAudioContext)),Nm},setContext:function(t){Nm=t}};class Om extends Kp{constructor(t){super(t)}load(t,e,n,r){const i=this,s=new Qp(this.manager);s.setResponseType("arraybuffer"),s.setPath(this.path),s.setRequestHeader(this.requestHeader),s.setWithCredentials(this.withCredentials),s.load(t,(function(n){try{const t=n.slice(0),r=km.getContext();r.decodeAudioData(t,(function(t){e(t)}))}catch(s){r?r(s):console.error(s),i.manager.itemError(t)}}),n,r)}}class Dm extends Mm{constructor(t,e,n=1){super(void 0,n),this.isHemisphereLightProbe=!0;const r=(new lr).set(t),i=(new lr).set(e),s=new Mr(r.r,r.g,r.b),o=new Mr(i.r,i.g,i.b),a=Math.sqrt(Math.PI),l=a*Math.sqrt(.75);this.sh.coefficients[0].copy(s).add(o).multiplyScalar(a),this.sh.coefficients[1].copy(s).sub(o).multiplyScalar(l)}}class zm extends Mm{constructor(t,e=1){super(void 0,e),this.isAmbientLightProbe=!0;const n=(new lr).set(t);this.sh.coefficients[0].set(n.r,n.g,n.b).multiplyScalar(2*Math.sqrt(Math.PI))}}const Fm=new ti,Um=new ti,Bm=new ti;class Gm{constructor(){this.type="StereoCamera",this.aspect=1,this.eyeSep=.064,this.cameraL=new Os,this.cameraL.layers.enable(1),this.cameraL.matrixAutoUpdate=!1,this.cameraR=new Os,this.cameraR.layers.enable(2),this.cameraR.matrixAutoUpdate=!1,this._cache={focus:null,fov:null,aspect:null,near:null,far:null,zoom:null,eyeSep:null}}update(t){const e=this._cache,n=e.focus!==t.focus||e.fov!==t.fov||e.aspect!==t.aspect*this.aspect||e.near!==t.near||e.far!==t.far||e.zoom!==t.zoom||e.eyeSep!==this.eyeSep;if(n){e.focus=t.focus,e.fov=t.fov,e.aspect=t.aspect*this.aspect,e.near=t.near,e.far=t.far,e.zoom=t.zoom,e.eyeSep=this.eyeSep,Bm.copy(t.projectionMatrix);const n=e.eyeSep/2,r=n*e.near/e.focus,i=e.near*Math.tan(wn*e.fov*.5)/e.zoom;let s,o;Um.elements[12]=-n,Fm.elements[12]=n,s=-i*e.aspect+r,o=i*e.aspect+r,Bm.elements[0]=2*e.near/(o-s),Bm.elements[8]=(o+s)/(o-s),this.cameraL.projectionMatrix.copy(Bm),s=-i*e.aspect-r,o=i*e.aspect-r,Bm.elements[0]=2*e.near/(o-s),Bm.elements[8]=(o+s)/(o-s),this.cameraR.projectionMatrix.copy(Bm)}this.cameraL.matrixWorld.copy(t.matrixWorld).multiply(Um),this.cameraR.matrixWorld.copy(t.matrixWorld).multiply(Fm)}}class Hm{constructor(t=!0){this.autoStart=t,this.startTime=0,this.oldTime=0,this.elapsedTime=0,this.running=!1}start(){this.startTime=Vm(),this.oldTime=this.startTime,this.elapsedTime=0,this.running=!0}stop(){this.getElapsedTime(),this.running=!1,this.autoStart=!1}getElapsedTime(){return this.getDelta(),this.elapsedTime}getDelta(){let t=0;if(this.autoStart&&!this.running)return this.start(),0;if(this.running){const e=Vm();t=(e-this.oldTime)/1e3,this.oldTime=e,this.elapsedTime+=t}return t}}function Vm(){return("undefined"===typeof performance?Date:performance).now()}const jm=new Mr,Wm=new _r,qm=new Mr,Ym=new Mr;class Xm extends Si{constructor(){super(),this.type="AudioListener",this.context=km.getContext(),this.gain=this.context.createGain(),this.gain.connect(this.context.destination),this.filter=null,this.timeDelta=0,this._clock=new Hm}getInput(){return this.gain}removeFilter(){return null!==this.filter&&(this.gain.disconnect(this.filter),this.filter.disconnect(this.context.destination),this.gain.connect(this.context.destination),this.filter=null),this}getFilter(){return this.filter}setFilter(t){return null!==this.filter?(this.gain.disconnect(this.filter),this.filter.disconnect(this.context.destination)):this.gain.disconnect(this.context.destination),this.filter=t,this.gain.connect(this.filter),this.filter.connect(this.context.destination),this}getMasterVolume(){return this.gain.gain.value}setMasterVolume(t){return this.gain.gain.setTargetAtTime(t,this.context.currentTime,.01),this}updateMatrixWorld(t){super.updateMatrixWorld(t);const e=this.context.listener,n=this.up;if(this.timeDelta=this._clock.getDelta(),this.matrixWorld.decompose(jm,Wm,qm),Ym.set(0,0,-1).applyQuaternion(Wm),e.positionX){const t=this.context.currentTime+this.timeDelta;e.positionX.linearRampToValueAtTime(jm.x,t),e.positionY.linearRampToValueAtTime(jm.y,t),e.positionZ.linearRampToValueAtTime(jm.z,t),e.forwardX.linearRampToValueAtTime(Ym.x,t),e.forwardY.linearRampToValueAtTime(Ym.y,t),e.forwardZ.linearRampToValueAtTime(Ym.z,t),e.upX.linearRampToValueAtTime(n.x,t),e.upY.linearRampToValueAtTime(n.y,t),e.upZ.linearRampToValueAtTime(n.z,t)}else e.setPosition(jm.x,jm.y,jm.z),e.setOrientation(Ym.x,Ym.y,Ym.z,n.x,n.y,n.z)}}class Jm extends Si{constructor(t){super(),this.type="Audio",this.listener=t,this.context=t.context,this.gain=this.context.createGain(),this.gain.connect(t.getInput()),this.autoplay=!1,this.buffer=null,this.detune=0,this.loop=!1,this.loopStart=0,this.loopEnd=0,this.offset=0,this.duration=void 0,this.playbackRate=1,this.isPlaying=!1,this.hasPlaybackControl=!0,this.source=null,this.sourceType="empty",this._startedAt=0,this._progress=0,this._connected=!1,this.filters=[]}getOutput(){return this.gain}setNodeSource(t){return this.hasPlaybackControl=!1,this.sourceType="audioNode",this.source=t,this.connect(),this}setMediaElementSource(t){return this.hasPlaybackControl=!1,this.sourceType="mediaNode",this.source=this.context.createMediaElementSource(t),this.connect(),this}setMediaStreamSource(t){return this.hasPlaybackControl=!1,this.sourceType="mediaStreamNode",this.source=this.context.createMediaStreamSource(t),this.connect(),this}setBuffer(t){return this.buffer=t,this.sourceType="buffer",this.autoplay&&this.play(),this}play(t=0){if(!0===this.isPlaying)return void console.warn("THREE.Audio: Audio is already playing.");if(!1===this.hasPlaybackControl)return void console.warn("THREE.Audio: this Audio has no playback control.");this._startedAt=this.context.currentTime+t;const e=this.context.createBufferSource();return e.buffer=this.buffer,e.loop=this.loop,e.loopStart=this.loopStart,e.loopEnd=this.loopEnd,e.onended=this.onEnded.bind(this),e.start(this._startedAt,this._progress+this.offset,this.duration),this.isPlaying=!0,this.source=e,this.setDetune(this.detune),this.setPlaybackRate(this.playbackRate),this.connect()}pause(){if(!1!==this.hasPlaybackControl)return!0===this.isPlaying&&(this._progress+=Math.max(this.context.currentTime-this._startedAt,0)*this.playbackRate,!0===this.loop&&(this._progress=this._progress%(this.duration||this.buffer.duration)),this.source.stop(),this.source.onended=null,this.isPlaying=!1),this;console.warn("THREE.Audio: this Audio has no playback control.")}stop(){if(!1!==this.hasPlaybackControl)return this._progress=0,this.source.stop(),this.source.onended=null,this.isPlaying=!1,this;console.warn("THREE.Audio: this Audio has no playback control.")}connect(){if(this.filters.length>0){this.source.connect(this.filters[0]);for(let t=1,e=this.filters.length;t<e;t++)this.filters[t-1].connect(this.filters[t]);this.filters[this.filters.length-1].connect(this.getOutput())}else this.source.connect(this.getOutput());return this._connected=!0,this}disconnect(){if(this.filters.length>0){this.source.disconnect(this.filters[0]);for(let t=1,e=this.filters.length;t<e;t++)this.filters[t-1].disconnect(this.filters[t]);this.filters[this.filters.length-1].disconnect(this.getOutput())}else this.source.disconnect(this.getOutput());return this._connected=!1,this}getFilters(){return this.filters}setFilters(t){return t||(t=[]),!0===this._connected?(this.disconnect(),this.filters=t.slice(),this.connect()):this.filters=t.slice(),this}setDetune(t){if(this.detune=t,void 0!==this.source.detune)return!0===this.isPlaying&&this.source.detune.setTargetAtTime(this.detune,this.context.currentTime,.01),this}getDetune(){return this.detune}getFilter(){return this.getFilters()[0]}setFilter(t){return this.setFilters(t?[t]:[])}setPlaybackRate(t){if(!1!==this.hasPlaybackControl)return this.playbackRate=t,!0===this.isPlaying&&this.source.playbackRate.setTargetAtTime(this.playbackRate,this.context.currentTime,.01),this;console.warn("THREE.Audio: this Audio has no playback control.")}getPlaybackRate(){return this.playbackRate}onEnded(){this.isPlaying=!1}getLoop(){return!1===this.hasPlaybackControl?(console.warn("THREE.Audio: this Audio has no playback control."),!1):this.loop}setLoop(t){if(!1!==this.hasPlaybackControl)return this.loop=t,!0===this.isPlaying&&(this.source.loop=this.loop),this;console.warn("THREE.Audio: this Audio has no playback control.")}setLoopStart(t){return this.loopStart=t,this}setLoopEnd(t){return this.loopEnd=t,this}getVolume(){return this.gain.gain.value}setVolume(t){return this.gain.gain.setTargetAtTime(t,this.context.currentTime,.01),this}}const Km=new Mr,Zm=new _r,Qm=new Mr,$m=new Mr;class tg extends Jm{constructor(t){super(t),this.panner=this.context.createPanner(),this.panner.panningModel="HRTF",this.panner.connect(this.gain)}disconnect(){super.disconnect(),this.panner.disconnect(this.gain)}getOutput(){return this.panner}getRefDistance(){return this.panner.refDistance}setRefDistance(t){return this.panner.refDistance=t,this}getRolloffFactor(){return this.panner.rolloffFactor}setRolloffFactor(t){return this.panner.rolloffFactor=t,this}getDistanceModel(){return this.panner.distanceModel}setDistanceModel(t){return this.panner.distanceModel=t,this}getMaxDistance(){return this.panner.maxDistance}setMaxDistance(t){return this.panner.maxDistance=t,this}setDirectionalCone(t,e,n){return this.panner.coneInnerAngle=t,this.panner.coneOuterAngle=e,this.panner.coneOuterGain=n,this}updateMatrixWorld(t){if(super.updateMatrixWorld(t),!0===this.hasPlaybackControl&&!1===this.isPlaying)return;this.matrixWorld.decompose(Km,Zm,Qm),$m.set(0,0,1).applyQuaternion(Zm);const e=this.panner;if(e.positionX){const t=this.context.currentTime+this.listener.timeDelta;e.positionX.linearRampToValueAtTime(Km.x,t),e.positionY.linearRampToValueAtTime(Km.y,t),e.positionZ.linearRampToValueAtTime(Km.z,t),e.orientationX.linearRampToValueAtTime($m.x,t),e.orientationY.linearRampToValueAtTime($m.y,t),e.orientationZ.linearRampToValueAtTime($m.z,t)}else e.setPosition(Km.x,Km.y,Km.z),e.setOrientation($m.x,$m.y,$m.z)}}class eg{constructor(t,e=2048){this.analyser=t.context.createAnalyser(),this.analyser.fftSize=e,this.data=new Uint8Array(this.analyser.frequencyBinCount),t.getOutput().connect(this.analyser)}getFrequencyData(){return this.analyser.getByteFrequencyData(this.data),this.data}getAverageFrequency(){let t=0;const e=this.getFrequencyData();for(let n=0;n<e.length;n++)t+=e[n];return t/e.length}}class ng{constructor(t,e,n){let r,i,s;switch(this.binding=t,this.valueSize=n,e){case"quaternion":r=this._slerp,i=this._slerpAdditive,s=this._setAdditiveIdentityQuaternion,this.buffer=new Float64Array(6*n),this._workIndex=5;break;case"string":case"bool":r=this._select,i=this._select,s=this._setAdditiveIdentityOther,this.buffer=new Array(5*n);break;default:r=this._lerp,i=this._lerpAdditive,s=this._setAdditiveIdentityNumeric,this.buffer=new Float64Array(5*n)}this._mixBufferRegion=r,this._mixBufferRegionAdditive=i,this._setIdentity=s,this._origIndex=3,this._addIndex=4,this.cumulativeWeight=0,this.cumulativeWeightAdditive=0,this.useCount=0,this.referenceCount=0}accumulate(t,e){const n=this.buffer,r=this.valueSize,i=t*r+r;let s=this.cumulativeWeight;if(0===s){for(let t=0;t!==r;++t)n[i+t]=n[t];s=e}else{s+=e;const t=e/s;this._mixBufferRegion(n,i,0,t,r)}this.cumulativeWeight=s}accumulateAdditive(t){const e=this.buffer,n=this.valueSize,r=n*this._addIndex;0===this.cumulativeWeightAdditive&&this._setIdentity(),this._mixBufferRegionAdditive(e,r,0,t,n),this.cumulativeWeightAdditive+=t}apply(t){const e=this.valueSize,n=this.buffer,r=t*e+e,i=this.cumulativeWeight,s=this.cumulativeWeightAdditive,o=this.binding;if(this.cumulativeWeight=0,this.cumulativeWeightAdditive=0,i<1){const t=e*this._origIndex;this._mixBufferRegion(n,r,t,1-i,e)}s>0&&this._mixBufferRegionAdditive(n,r,this._addIndex*e,1,e);for(let a=e,l=e+e;a!==l;++a)if(n[a]!==n[a+e]){o.setValue(n,r);break}}saveOriginalState(){const t=this.binding,e=this.buffer,n=this.valueSize,r=n*this._origIndex;t.getValue(e,r);for(let i=n,s=r;i!==s;++i)e[i]=e[r+i%n];this._setIdentity(),this.cumulativeWeight=0,this.cumulativeWeightAdditive=0}restoreOriginalState(){const t=3*this.valueSize;this.binding.setValue(this.buffer,t)}_setAdditiveIdentityNumeric(){const t=this._addIndex*this.valueSize,e=t+this.valueSize;for(let n=t;n<e;n++)this.buffer[n]=0}_setAdditiveIdentityQuaternion(){this._setAdditiveIdentityNumeric(),this.buffer[this._addIndex*this.valueSize+3]=1}_setAdditiveIdentityOther(){const t=this._origIndex*this.valueSize,e=this._addIndex*this.valueSize;for(let n=0;n<this.valueSize;n++)this.buffer[e+n]=this.buffer[t+n]}_select(t,e,n,r,i){if(r>=.5)for(let s=0;s!==i;++s)t[e+s]=t[n+s]}_slerp(t,e,n,r){_r.slerpFlat(t,e,t,e,t,n,r)}_slerpAdditive(t,e,n,r,i){const s=this._workIndex*i;_r.multiplyQuaternionsFlat(t,s,t,e,t,n),_r.slerpFlat(t,e,t,e,t,s,r)}_lerp(t,e,n,r,i){const s=1-r;for(let o=0;o!==i;++o){const i=e+o;t[i]=t[i]*s+t[n+o]*r}}_lerpAdditive(t,e,n,r,i){for(let s=0;s!==i;++s){const i=e+s;t[i]=t[i]+t[n+s]*r}}}const rg="\\[\\]\\.:\\/",ig=new RegExp("["+rg+"]","g"),sg="[^"+rg+"]",og="[^"+rg.replace("\\.","")+"]",ag=/((?:WC+[\/:])*)/.source.replace("WC",sg),lg=/(WCOD+)?/.source.replace("WCOD",og),cg=/(?:\.(WC+)(?:\[(.+)\])?)?/.source.replace("WC",sg),ug=/\.(WC+)(?:\[(.+)\])?/.source.replace("WC",sg),hg=new RegExp("^"+ag+lg+cg+ug+"$"),dg=["material","materials","bones"];class fg{constructor(t,e,n){const r=n||pg.parseTrackName(e);this._targetGroup=t,this._bindings=t.subscribe_(e,r)}getValue(t,e){this.bind();const n=this._targetGroup.nCachedObjects_,r=this._bindings[n];void 0!==r&&r.getValue(t,e)}setValue(t,e){const n=this._bindings;for(let r=this._targetGroup.nCachedObjects_,i=n.length;r!==i;++r)n[r].setValue(t,e)}bind(){const t=this._bindings;for(let e=this._targetGroup.nCachedObjects_,n=t.length;e!==n;++e)t[e].bind()}unbind(){const t=this._bindings;for(let e=this._targetGroup.nCachedObjects_,n=t.length;e!==n;++e)t[e].unbind()}}class pg{constructor(t,e,n){this.path=e,this.parsedPath=n||pg.parseTrackName(e),this.node=pg.findNode(t,this.parsedPath.nodeName)||t,this.rootNode=t,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}static create(t,e,n){return t&&t.isAnimationObjectGroup?new pg.Composite(t,e,n):new pg(t,e,n)}static sanitizeNodeName(t){return t.replace(/\s/g,"_").replace(ig,"")}static parseTrackName(t){const e=hg.exec(t);if(null===e)throw new Error("PropertyBinding: Cannot parse trackName: "+t);const n={nodeName:e[2],objectName:e[3],objectIndex:e[4],propertyName:e[5],propertyIndex:e[6]},r=n.nodeName&&n.nodeName.lastIndexOf(".");if(void 0!==r&&-1!==r){const t=n.nodeName.substring(r+1);-1!==dg.indexOf(t)&&(n.nodeName=n.nodeName.substring(0,r),n.objectName=t)}if(null===n.propertyName||0===n.propertyName.length)throw new Error("PropertyBinding: can not parse propertyName from trackName: "+t);return n}static findNode(t,e){if(void 0===e||""===e||"."===e||-1===e||e===t.name||e===t.uuid)return t;if(t.skeleton){const n=t.skeleton.getBoneByName(e);if(void 0!==n)return n}if(t.children){const n=function(t){for(let r=0;r<t.length;r++){const i=t[r];if(i.name===e||i.uuid===e)return i;const s=n(i.children);if(s)return s}return null},r=n(t.children);if(r)return r}return null}_getValue_unavailable(){}_setValue_unavailable(){}_getValue_direct(t,e){t[e]=this.targetObject[this.propertyName]}_getValue_array(t,e){const n=this.resolvedProperty;for(let r=0,i=n.length;r!==i;++r)t[e++]=n[r]}_getValue_arrayElement(t,e){t[e]=this.resolvedProperty[this.propertyIndex]}_getValue_toArray(t,e){this.resolvedProperty.toArray(t,e)}_setValue_direct(t,e){this.targetObject[this.propertyName]=t[e]}_setValue_direct_setNeedsUpdate(t,e){this.targetObject[this.propertyName]=t[e],this.targetObject.needsUpdate=!0}_setValue_direct_setMatrixWorldNeedsUpdate(t,e){this.targetObject[this.propertyName]=t[e],this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_array(t,e){const n=this.resolvedProperty;for(let r=0,i=n.length;r!==i;++r)n[r]=t[e++]}_setValue_array_setNeedsUpdate(t,e){const n=this.resolvedProperty;for(let r=0,i=n.length;r!==i;++r)n[r]=t[e++];this.targetObject.needsUpdate=!0}_setValue_array_setMatrixWorldNeedsUpdate(t,e){const n=this.resolvedProperty;for(let r=0,i=n.length;r!==i;++r)n[r]=t[e++];this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_arrayElement(t,e){this.resolvedProperty[this.propertyIndex]=t[e]}_setValue_arrayElement_setNeedsUpdate(t,e){this.resolvedProperty[this.propertyIndex]=t[e],this.targetObject.needsUpdate=!0}_setValue_arrayElement_setMatrixWorldNeedsUpdate(t,e){this.resolvedProperty[this.propertyIndex]=t[e],this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_fromArray(t,e){this.resolvedProperty.fromArray(t,e)}_setValue_fromArray_setNeedsUpdate(t,e){this.resolvedProperty.fromArray(t,e),this.targetObject.needsUpdate=!0}_setValue_fromArray_setMatrixWorldNeedsUpdate(t,e){this.resolvedProperty.fromArray(t,e),this.targetObject.matrixWorldNeedsUpdate=!0}_getValue_unbound(t,e){this.bind(),this.getValue(t,e)}_setValue_unbound(t,e){this.bind(),this.setValue(t,e)}bind(){let t=this.node;const e=this.parsedPath,n=e.objectName,r=e.propertyName;let i=e.propertyIndex;if(t||(t=pg.findNode(this.rootNode,e.nodeName)||this.rootNode,this.node=t),this.getValue=this._getValue_unavailable,this.setValue=this._setValue_unavailable,!t)return void console.error("THREE.PropertyBinding: Trying to update node for track: "+this.path+" but it wasn't found.");if(n){let r=e.objectIndex;switch(n){case"materials":if(!t.material)return void console.error("THREE.PropertyBinding: Can not bind to material as node does not have a material.",this);if(!t.material.materials)return void console.error("THREE.PropertyBinding: Can not bind to material.materials as node.material does not have a materials array.",this);t=t.material.materials;break;case"bones":if(!t.skeleton)return void console.error("THREE.PropertyBinding: Can not bind to bones as node does not have a skeleton.",this);t=t.skeleton.bones;for(let e=0;e<t.length;e++)if(t[e].name===r){r=e;break}break;default:if(void 0===t[n])return void console.error("THREE.PropertyBinding: Can not bind to objectName of node undefined.",this);t=t[n]}if(void 0!==r){if(void 0===t[r])return void console.error("THREE.PropertyBinding: Trying to bind to objectIndex of objectName, but is undefined.",this,t);t=t[r]}}const s=t[r];if(void 0===s){const n=e.nodeName;return void console.error("THREE.PropertyBinding: Trying to update property for track: "+n+"."+r+" but it wasn't found.",t)}let o=this.Versioning.None;this.targetObject=t,void 0!==t.needsUpdate?o=this.Versioning.NeedsUpdate:void 0!==t.matrixWorldNeedsUpdate&&(o=this.Versioning.MatrixWorldNeedsUpdate);let a=this.BindingType.Direct;if(void 0!==i){if("morphTargetInfluences"===r){if(!t.geometry)return void console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.",this);if(!t.geometry.morphAttributes)return void console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.morphAttributes.",this);void 0!==t.morphTargetDictionary[i]&&(i=t.morphTargetDictionary[i])}a=this.BindingType.ArrayElement,this.resolvedProperty=s,this.propertyIndex=i}else void 0!==s.fromArray&&void 0!==s.toArray?(a=this.BindingType.HasFromToArray,this.resolvedProperty=s):Array.isArray(s)?(a=this.BindingType.EntireArray,this.resolvedProperty=s):this.propertyName=r;this.getValue=this.GetterByBindingType[a],this.setValue=this.SetterByBindingTypeAndVersioning[a][o]}unbind(){this.node=null,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}}pg.Composite=fg,pg.prototype.BindingType={Direct:0,EntireArray:1,ArrayElement:2,HasFromToArray:3},pg.prototype.Versioning={None:0,NeedsUpdate:1,MatrixWorldNeedsUpdate:2},pg.prototype.GetterByBindingType=[pg.prototype._getValue_direct,pg.prototype._getValue_array,pg.prototype._getValue_arrayElement,pg.prototype._getValue_toArray],pg.prototype.SetterByBindingTypeAndVersioning=[[pg.prototype._setValue_direct,pg.prototype._setValue_direct_setNeedsUpdate,pg.prototype._setValue_direct_setMatrixWorldNeedsUpdate],[pg.prototype._setValue_array,pg.prototype._setValue_array_setNeedsUpdate,pg.prototype._setValue_array_setMatrixWorldNeedsUpdate],[pg.prototype._setValue_arrayElement,pg.prototype._setValue_arrayElement_setNeedsUpdate,pg.prototype._setValue_arrayElement_setMatrixWorldNeedsUpdate],[pg.prototype._setValue_fromArray,pg.prototype._setValue_fromArray_setNeedsUpdate,pg.prototype._setValue_fromArray_setMatrixWorldNeedsUpdate]];class mg{constructor(){this.isAnimationObjectGroup=!0,this.uuid=Mn(),this._objects=Array.prototype.slice.call(arguments),this.nCachedObjects_=0;const t={};this._indicesByUUID=t;for(let n=0,r=arguments.length;n!==r;++n)t[arguments[n].uuid]=n;this._paths=[],this._parsedPaths=[],this._bindings=[],this._bindingsIndicesByPath={};const e=this;this.stats={objects:{get total(){return e._objects.length},get inUse(){return this.total-e.nCachedObjects_}},get bindingsPerObject(){return e._bindings.length}}}add(){const t=this._objects,e=this._indicesByUUID,n=this._paths,r=this._parsedPaths,i=this._bindings,s=i.length;let o,a=t.length,l=this.nCachedObjects_;for(let c=0,u=arguments.length;c!==u;++c){const u=arguments[c],h=u.uuid;let d=e[h];if(void 0===d){d=a++,e[h]=d,t.push(u);for(let t=0,e=s;t!==e;++t)i[t].push(new pg(u,n[t],r[t]))}else if(d<l){o=t[d];const a=--l,c=t[a];e[c.uuid]=d,t[d]=c,e[h]=a,t[a]=u;for(let t=0,e=s;t!==e;++t){const e=i[t],s=e[a];let o=e[d];e[d]=s,void 0===o&&(o=new pg(u,n[t],r[t])),e[a]=o}}else t[d]!==o&&console.error("THREE.AnimationObjectGroup: Different objects with the same UUID detected. Clean the caches or recreate your infrastructure when reloading scenes.")}this.nCachedObjects_=l}remove(){const t=this._objects,e=this._indicesByUUID,n=this._bindings,r=n.length;let i=this.nCachedObjects_;for(let s=0,o=arguments.length;s!==o;++s){const o=arguments[s],a=o.uuid,l=e[a];if(void 0!==l&&l>=i){const s=i++,c=t[s];e[c.uuid]=l,t[l]=c,e[a]=s,t[s]=o;for(let t=0,e=r;t!==e;++t){const e=n[t],r=e[s],i=e[l];e[l]=r,e[s]=i}}}this.nCachedObjects_=i}uncache(){const t=this._objects,e=this._indicesByUUID,n=this._bindings,r=n.length;let i=this.nCachedObjects_,s=t.length;for(let o=0,a=arguments.length;o!==a;++o){const a=arguments[o],l=a.uuid,c=e[l];if(void 0!==c)if(delete e[l],c<i){const o=--i,a=t[o],l=--s,u=t[l];e[a.uuid]=c,t[c]=a,e[u.uuid]=o,t[o]=u,t.pop();for(let t=0,e=r;t!==e;++t){const e=n[t],r=e[o],i=e[l];e[c]=r,e[o]=i,e.pop()}}else{const i=--s,o=t[i];i>0&&(e[o.uuid]=c),t[c]=o,t.pop();for(let t=0,e=r;t!==e;++t){const e=n[t];e[c]=e[i],e.pop()}}}this.nCachedObjects_=i}subscribe_(t,e){const n=this._bindingsIndicesByPath;let r=n[t];const i=this._bindings;if(void 0!==r)return i[r];const s=this._paths,o=this._parsedPaths,a=this._objects,l=a.length,c=this.nCachedObjects_,u=new Array(l);r=i.length,n[t]=r,s.push(t),o.push(e),i.push(u);for(let h=c,d=a.length;h!==d;++h){const n=a[h];u[h]=new pg(n,t,e)}return u}unsubscribe_(t){const e=this._bindingsIndicesByPath,n=e[t];if(void 0!==n){const r=this._paths,i=this._parsedPaths,s=this._bindings,o=s.length-1,a=s[o],l=t[o];e[l]=n,s[n]=a,s.pop(),i[n]=i[o],i.pop(),r[n]=r[o],r.pop()}}}class gg{constructor(t,e,n=null,r=e.blendMode){this._mixer=t,this._clip=e,this._localRoot=n,this.blendMode=r;const i=e.tracks,s=i.length,o=new Array(s),a={endingStart:Ee,endingEnd:Ee};for(let l=0;l!==s;++l){const t=i[l].createInterpolant(null);o[l]=t,t.settings=a}this._interpolantSettings=a,this._interpolants=o,this._propertyBindings=new Array(s),this._cacheIndex=null,this._byClipCacheIndex=null,this._timeScaleInterpolant=null,this._weightInterpolant=null,this.loop=we,this._loopCount=-1,this._startTime=null,this.time=0,this.timeScale=1,this._effectiveTimeScale=1,this.weight=1,this._effectiveWeight=1,this.repetitions=1/0,this.paused=!1,this.enabled=!0,this.clampWhenFinished=!1,this.zeroSlopeAtStart=!0,this.zeroSlopeAtEnd=!0}play(){return this._mixer._activateAction(this),this}stop(){return this._mixer._deactivateAction(this),this.reset()}reset(){return this.paused=!1,this.enabled=!0,this.time=0,this._loopCount=-1,this._startTime=null,this.stopFading().stopWarping()}isRunning(){return this.enabled&&!this.paused&&0!==this.timeScale&&null===this._startTime&&this._mixer._isActiveAction(this)}isScheduled(){return this._mixer._isActiveAction(this)}startAt(t){return this._startTime=t,this}setLoop(t,e){return this.loop=t,this.repetitions=e,this}setEffectiveWeight(t){return this.weight=t,this._effectiveWeight=this.enabled?t:0,this.stopFading()}getEffectiveWeight(){return this._effectiveWeight}fadeIn(t){return this._scheduleFading(t,0,1)}fadeOut(t){return this._scheduleFading(t,1,0)}crossFadeFrom(t,e,n){if(t.fadeOut(e),this.fadeIn(e),n){const n=this._clip.duration,r=t._clip.duration,i=r/n,s=n/r;t.warp(1,i,e),this.warp(s,1,e)}return this}crossFadeTo(t,e,n){return t.crossFadeFrom(this,e,n)}stopFading(){const t=this._weightInterpolant;return null!==t&&(this._weightInterpolant=null,this._mixer._takeBackControlInterpolant(t)),this}setEffectiveTimeScale(t){return this.timeScale=t,this._effectiveTimeScale=this.paused?0:t,this.stopWarping()}getEffectiveTimeScale(){return this._effectiveTimeScale}setDuration(t){return this.timeScale=this._clip.duration/t,this.stopWarping()}syncWith(t){return this.time=t.time,this.timeScale=t.timeScale,this.stopWarping()}halt(t){return this.warp(this._effectiveTimeScale,0,t)}warp(t,e,n){const r=this._mixer,i=r.time,s=this.timeScale;let o=this._timeScaleInterpolant;null===o&&(o=r._lendControlInterpolant(),this._timeScaleInterpolant=o);const a=o.parameterPositions,l=o.sampleValues;return a[0]=i,a[1]=i+n,l[0]=t/s,l[1]=e/s,this}stopWarping(){const t=this._timeScaleInterpolant;return null!==t&&(this._timeScaleInterpolant=null,this._mixer._takeBackControlInterpolant(t)),this}getMixer(){return this._mixer}getClip(){return this._clip}getRoot(){return this._localRoot||this._mixer._root}_update(t,e,n,r){if(!this.enabled)return void this._updateWeight(t);const i=this._startTime;if(null!==i){const r=(t-i)*n;if(r<0||0===n)return;this._startTime=null,e=n*r}e*=this._updateTimeScale(t);const s=this._updateTime(e),o=this._updateWeight(t);if(o>0){const t=this._interpolants,e=this._propertyBindings;switch(this.blendMode){case Ie:for(let n=0,r=t.length;n!==r;++n)t[n].evaluate(s),e[n].accumulateAdditive(o);break;case Re:default:for(let n=0,i=t.length;n!==i;++n)t[n].evaluate(s),e[n].accumulate(r,o)}}}_updateWeight(t){let e=0;if(this.enabled){e=this.weight;const n=this._weightInterpolant;if(null!==n){const r=n.evaluate(t)[0];e*=r,t>n.parameterPositions[1]&&(this.stopFading(),0===r&&(this.enabled=!1))}}return this._effectiveWeight=e,e}_updateTimeScale(t){let e=0;if(!this.paused){e=this.timeScale;const n=this._timeScaleInterpolant;if(null!==n){const r=n.evaluate(t)[0];e*=r,t>n.parameterPositions[1]&&(this.stopWarping(),0===e?this.paused=!0:this.timeScale=e)}}return this._effectiveTimeScale=e,e}_updateTime(t){const e=this._clip.duration,n=this.loop;let r=this.time+t,i=this._loopCount;const s=n===_e;if(0===t)return-1===i?r:s&&1===(1&i)?e-r:r;if(n===be){-1===i&&(this._loopCount=0,this._setEndings(!0,!0,!1));t:{if(r>=e)r=e;else{if(!(r<0)){this.time=r;break t}r=0}this.clampWhenFinished?this.paused=!0:this.enabled=!1,this.time=r,this._mixer.dispatchEvent({type:"finished",action:this,direction:t<0?-1:1})}}else{if(-1===i&&(t>=0?(i=0,this._setEndings(!0,0===this.repetitions,s)):this._setEndings(0===this.repetitions,!0,s)),r>=e||r<0){const n=Math.floor(r/e);r-=e*n,i+=Math.abs(n);const o=this.repetitions-i;if(o<=0)this.clampWhenFinished?this.paused=!0:this.enabled=!1,r=t>0?e:0,this.time=r,this._mixer.dispatchEvent({type:"finished",action:this,direction:t>0?1:-1});else{if(1===o){const e=t<0;this._setEndings(e,!e,s)}else this._setEndings(!1,!1,s);this._loopCount=i,this.time=r,this._mixer.dispatchEvent({type:"loop",action:this,loopDelta:n})}}else this.time=r;if(s&&1===(1&i))return e-r}return r}_setEndings(t,e,n){const r=this._interpolantSettings;n?(r.endingStart=Te,r.endingEnd=Te):(r.endingStart=t?this.zeroSlopeAtStart?Te:Ee:Ce,r.endingEnd=e?this.zeroSlopeAtEnd?Te:Ee:Ce)}_scheduleFading(t,e,n){const r=this._mixer,i=r.time;let s=this._weightInterpolant;null===s&&(s=r._lendControlInterpolant(),this._weightInterpolant=s);const o=s.parameterPositions,a=s.sampleValues;return o[0]=i,a[0]=e,o[1]=i+t,a[1]=n,this}}const vg=new Float32Array(1);class yg extends yn{constructor(t){super(),this._root=t,this._initMemoryManager(),this._accuIndex=0,this.time=0,this.timeScale=1}_bindAction(t,e){const n=t._localRoot||this._root,r=t._clip.tracks,i=r.length,s=t._propertyBindings,o=t._interpolants,a=n.uuid,l=this._bindingsByRootAndName;let c=l[a];void 0===c&&(c={},l[a]=c);for(let u=0;u!==i;++u){const t=r[u],i=t.name;let l=c[i];if(void 0!==l)++l.referenceCount,s[u]=l;else{if(l=s[u],void 0!==l){null===l._cacheIndex&&(++l.referenceCount,this._addInactiveBinding(l,a,i));continue}const r=e&&e._propertyBindings[u].binding.parsedPath;l=new ng(pg.create(n,i,r),t.ValueTypeName,t.getValueSize()),++l.referenceCount,this._addInactiveBinding(l,a,i),s[u]=l}o[u].resultBuffer=l.buffer}}_activateAction(t){if(!this._isActiveAction(t)){if(null===t._cacheIndex){const e=(t._localRoot||this._root).uuid,n=t._clip.uuid,r=this._actionsByClip[n];this._bindAction(t,r&&r.knownActions[0]),this._addInactiveAction(t,n,e)}const e=t._propertyBindings;for(let t=0,n=e.length;t!==n;++t){const n=e[t];0===n.useCount++&&(this._lendBinding(n),n.saveOriginalState())}this._lendAction(t)}}_deactivateAction(t){if(this._isActiveAction(t)){const e=t._propertyBindings;for(let t=0,n=e.length;t!==n;++t){const n=e[t];0===--n.useCount&&(n.restoreOriginalState(),this._takeBackBinding(n))}this._takeBackAction(t)}}_initMemoryManager(){this._actions=[],this._nActiveActions=0,this._actionsByClip={},this._bindings=[],this._nActiveBindings=0,this._bindingsByRootAndName={},this._controlInterpolants=[],this._nActiveControlInterpolants=0;const t=this;this.stats={actions:{get total(){return t._actions.length},get inUse(){return t._nActiveActions}},bindings:{get total(){return t._bindings.length},get inUse(){return t._nActiveBindings}},controlInterpolants:{get total(){return t._controlInterpolants.length},get inUse(){return t._nActiveControlInterpolants}}}}_isActiveAction(t){const e=t._cacheIndex;return null!==e&&e<this._nActiveActions}_addInactiveAction(t,e,n){const r=this._actions,i=this._actionsByClip;let s=i[e];if(void 0===s)s={knownActions:[t],actionByRoot:{}},t._byClipCacheIndex=0,i[e]=s;else{const e=s.knownActions;t._byClipCacheIndex=e.length,e.push(t)}t._cacheIndex=r.length,r.push(t),s.actionByRoot[n]=t}_removeInactiveAction(t){const e=this._actions,n=e[e.length-1],r=t._cacheIndex;n._cacheIndex=r,e[r]=n,e.pop(),t._cacheIndex=null;const i=t._clip.uuid,s=this._actionsByClip,o=s[i],a=o.knownActions,l=a[a.length-1],c=t._byClipCacheIndex;l._byClipCacheIndex=c,a[c]=l,a.pop(),t._byClipCacheIndex=null;const u=o.actionByRoot,h=(t._localRoot||this._root).uuid;delete u[h],0===a.length&&delete s[i],this._removeInactiveBindingsForAction(t)}_removeInactiveBindingsForAction(t){const e=t._propertyBindings;for(let n=0,r=e.length;n!==r;++n){const t=e[n];0===--t.referenceCount&&this._removeInactiveBinding(t)}}_lendAction(t){const e=this._actions,n=t._cacheIndex,r=this._nActiveActions++,i=e[r];t._cacheIndex=r,e[r]=t,i._cacheIndex=n,e[n]=i}_takeBackAction(t){const e=this._actions,n=t._cacheIndex,r=--this._nActiveActions,i=e[r];t._cacheIndex=r,e[r]=t,i._cacheIndex=n,e[n]=i}_addInactiveBinding(t,e,n){const r=this._bindingsByRootAndName,i=this._bindings;let s=r[e];void 0===s&&(s={},r[e]=s),s[n]=t,t._cacheIndex=i.length,i.push(t)}_removeInactiveBinding(t){const e=this._bindings,n=t.binding,r=n.rootNode.uuid,i=n.path,s=this._bindingsByRootAndName,o=s[r],a=e[e.length-1],l=t._cacheIndex;a._cacheIndex=l,e[l]=a,e.pop(),delete o[i],0===Object.keys(o).length&&delete s[r]}_lendBinding(t){const e=this._bindings,n=t._cacheIndex,r=this._nActiveBindings++,i=e[r];t._cacheIndex=r,e[r]=t,i._cacheIndex=n,e[n]=i}_takeBackBinding(t){const e=this._bindings,n=t._cacheIndex,r=--this._nActiveBindings,i=e[r];t._cacheIndex=r,e[r]=t,i._cacheIndex=n,e[n]=i}_lendControlInterpolant(){const t=this._controlInterpolants,e=this._nActiveControlInterpolants++;let n=t[e];return void 0===n&&(n=new kp(new Float32Array(2),new Float32Array(2),1,vg),n.__cacheIndex=e,t[e]=n),n}_takeBackControlInterpolant(t){const e=this._controlInterpolants,n=t.__cacheIndex,r=--this._nActiveControlInterpolants,i=e[r];t.__cacheIndex=r,e[r]=t,i.__cacheIndex=n,e[n]=i}clipAction(t,e,n){const r=e||this._root,i=r.uuid;let s="string"===typeof t?jp.findByName(r,t):t;const o=null!==s?s.uuid:t,a=this._actionsByClip[o];let l=null;if(void 0===n&&(n=null!==s?s.blendMode:Re),void 0!==a){const t=a.actionByRoot[i];if(void 0!==t&&t.blendMode===n)return t;l=a.knownActions[0],null===s&&(s=l._clip)}if(null===s)return null;const c=new gg(this,s,e,n);return this._bindAction(c,l),this._addInactiveAction(c,o,i),c}existingAction(t,e){const n=e||this._root,r=n.uuid,i="string"===typeof t?jp.findByName(n,t):t,s=i?i.uuid:t,o=this._actionsByClip[s];return void 0!==o&&o.actionByRoot[r]||null}stopAllAction(){const t=this._actions,e=this._nActiveActions;for(let n=e-1;n>=0;--n)t[n].stop();return this}update(t){t*=this.timeScale;const e=this._actions,n=this._nActiveActions,r=this.time+=t,i=Math.sign(t),s=this._accuIndex^=1;for(let l=0;l!==n;++l){const n=e[l];n._update(r,t,i,s)}const o=this._bindings,a=this._nActiveBindings;for(let l=0;l!==a;++l)o[l].apply(s);return this}setTime(t){this.time=0;for(let e=0;e<this._actions.length;e++)this._actions[e].time=0;return this.update(t)}getRoot(){return this._root}uncacheClip(t){const e=this._actions,n=t.uuid,r=this._actionsByClip,i=r[n];if(void 0!==i){const t=i.knownActions;for(let n=0,r=t.length;n!==r;++n){const r=t[n];this._deactivateAction(r);const i=r._cacheIndex,s=e[e.length-1];r._cacheIndex=null,r._byClipCacheIndex=null,s._cacheIndex=i,e[i]=s,e.pop(),this._removeInactiveBindingsForAction(r)}delete r[n]}}uncacheRoot(t){const e=t.uuid,n=this._actionsByClip;for(const s in n){const t=n[s].actionByRoot,r=t[e];void 0!==r&&(this._deactivateAction(r),this._removeInactiveAction(r))}const r=this._bindingsByRootAndName,i=r[e];if(void 0!==i)for(const s in i){const t=i[s];t.restoreOriginalState(),this._removeInactiveBinding(t)}}uncacheAction(t,e){const n=this.existingAction(t,e);null!==n&&(this._deactivateAction(n),this._removeInactiveAction(n))}}class xg{constructor(t){"string"===typeof t&&(console.warn("THREE.Uniform: Type parameter is no longer needed."),t=arguments[1]),this.value=t}clone(){return new xg(void 0===this.value.clone?this.value:this.value.clone())}}class bg extends Th{constructor(t,e,n=1){super(t,e),this.isInstancedInterleavedBuffer=!0,this.meshPerAttribute=n}copy(t){return super.copy(t),this.meshPerAttribute=t.meshPerAttribute,this}clone(t){const e=super.clone(t);return e.meshPerAttribute=this.meshPerAttribute,e}toJSON(t){const e=super.toJSON(t);return e.isInstancedInterleavedBuffer=!0,e.meshPerAttribute=this.meshPerAttribute,e}}class wg{constructor(t,e,n,r,i){this.isGLBufferAttribute=!0,this.buffer=t,this.type=e,this.itemSize=n,this.elementSize=r,this.count=i,this.version=0}set needsUpdate(t){!0===t&&this.version++}setBuffer(t){return this.buffer=t,this}setType(t,e){return this.type=t,this.elementSize=e,this}setItemSize(t){return this.itemSize=t,this}setCount(t){return this.count=t,this}}class _g{constructor(t,e,n=0,r=1/0){this.ray=new $r(t,e),this.near=n,this.far=r,this.camera=null,this.layers=new hi,this.params={Mesh:{},Line:{threshold:1},LOD:{},Points:{threshold:1},Sprite:{}}}set(t,e){this.ray.set(t,e)}setFromCamera(t,e){e.isPerspectiveCamera?(this.ray.origin.setFromMatrixPosition(e.matrixWorld),this.ray.direction.set(t.x,t.y,.5).unproject(e).sub(this.ray.origin).normalize(),this.camera=e):e.isOrthographicCamera?(this.ray.origin.set(t.x,t.y,(e.near+e.far)/(e.near-e.far)).unproject(e),this.ray.direction.set(0,0,-1).transformDirection(e.matrixWorld),this.camera=e):console.error("THREE.Raycaster: Unsupported camera type: "+e.type)}intersectObject(t,e=!0,n=[]){return Ag(t,this,n,e),n.sort(Mg),n}intersectObjects(t,e=!0,n=[]){for(let r=0,i=t.length;r<i;r++)Ag(t[r],this,n,e);return n.sort(Mg),n}}function Mg(t,e){return t.distance-e.distance}function Ag(t,e,n,r){if(t.layers.test(e.layers)&&t.raycast(e,n),!0===r){const r=t.children;for(let t=0,i=r.length;t<i;t++)Ag(r[t],e,n,!0)}}class Sg{constructor(t=1,e=0,n=0){return this.radius=t,this.phi=e,this.theta=n,this}set(t,e,n){return this.radius=t,this.phi=e,this.theta=n,this}copy(t){return this.radius=t.radius,this.phi=t.phi,this.theta=t.theta,this}makeSafe(){const t=1e-6;return this.phi=Math.max(t,Math.min(Math.PI-t,this.phi)),this}setFromVector3(t){return this.setFromCartesianCoords(t.x,t.y,t.z)}setFromCartesianCoords(t,e,n){return this.radius=Math.sqrt(t*t+e*e+n*n),0===this.radius?(this.theta=0,this.phi=0):(this.theta=Math.atan2(t,n),this.phi=Math.acos(An(e/this.radius,-1,1))),this}clone(){return(new this.constructor).copy(this)}}class Eg{constructor(t=1,e=0,n=0){return this.radius=t,this.theta=e,this.y=n,this}set(t,e,n){return this.radius=t,this.theta=e,this.y=n,this}copy(t){return this.radius=t.radius,this.theta=t.theta,this.y=t.y,this}setFromVector3(t){return this.setFromCartesianCoords(t.x,t.y,t.z)}setFromCartesianCoords(t,e,n){return this.radius=Math.sqrt(t*t+n*n),this.theta=Math.atan2(t,n),this.y=e,this}clone(){return(new this.constructor).copy(this)}}const Tg=new qn;class Cg{constructor(t=new qn(1/0,1/0),e=new qn(-1/0,-1/0)){this.isBox2=!0,this.min=t,this.max=e}set(t,e){return this.min.copy(t),this.max.copy(e),this}setFromPoints(t){this.makeEmpty();for(let e=0,n=t.length;e<n;e++)this.expandByPoint(t[e]);return this}setFromCenterAndSize(t,e){const n=Tg.copy(e).multiplyScalar(.5);return this.min.copy(t).sub(n),this.max.copy(t).add(n),this}clone(){return(new this.constructor).copy(this)}copy(t){return this.min.copy(t.min),this.max.copy(t.max),this}makeEmpty(){return this.min.x=this.min.y=1/0,this.max.x=this.max.y=-1/0,this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y}getCenter(t){return this.isEmpty()?t.set(0,0):t.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(t){return this.isEmpty()?t.set(0,0):t.subVectors(this.max,this.min)}expandByPoint(t){return this.min.min(t),this.max.max(t),this}expandByVector(t){return this.min.sub(t),this.max.add(t),this}expandByScalar(t){return this.min.addScalar(-t),this.max.addScalar(t),this}containsPoint(t){return!(t.x<this.min.x||t.x>this.max.x||t.y<this.min.y||t.y>this.max.y)}containsBox(t){return this.min.x<=t.min.x&&t.max.x<=this.max.x&&this.min.y<=t.min.y&&t.max.y<=this.max.y}getParameter(t,e){return e.set((t.x-this.min.x)/(this.max.x-this.min.x),(t.y-this.min.y)/(this.max.y-this.min.y))}intersectsBox(t){return!(t.max.x<this.min.x||t.min.x>this.max.x||t.max.y<this.min.y||t.min.y>this.max.y)}clampPoint(t,e){return e.copy(t).clamp(this.min,this.max)}distanceToPoint(t){const e=Tg.copy(t).clamp(this.min,this.max);return e.sub(t).length()}intersect(t){return this.min.max(t.min),this.max.min(t.max),this}union(t){return this.min.min(t.min),this.max.max(t.max),this}translate(t){return this.min.add(t),this.max.add(t),this}equals(t){return t.min.equals(this.min)&&t.max.equals(this.max)}}const Rg=new Mr,Ig=new Mr;class Pg{constructor(t=new Mr,e=new Mr){this.start=t,this.end=e}set(t,e){return this.start.copy(t),this.end.copy(e),this}copy(t){return this.start.copy(t.start),this.end.copy(t.end),this}getCenter(t){return t.addVectors(this.start,this.end).multiplyScalar(.5)}delta(t){return t.subVectors(this.end,this.start)}distanceSq(){return this.start.distanceToSquared(this.end)}distance(){return this.start.distanceTo(this.end)}at(t,e){return this.delta(e).multiplyScalar(t).add(this.start)}closestPointToPointParameter(t,e){Rg.subVectors(t,this.start),Ig.subVectors(this.end,this.start);const n=Ig.dot(Ig),r=Ig.dot(Rg);let i=r/n;return e&&(i=An(i,0,1)),i}closestPointToPoint(t,e,n){const r=this.closestPointToPointParameter(t,e);return this.delta(n).multiplyScalar(r).add(this.start)}applyMatrix4(t){return this.start.applyMatrix4(t),this.end.applyMatrix4(t),this}equals(t){return t.start.equals(this.start)&&t.end.equals(this.end)}clone(){return(new this.constructor).copy(this)}}const Lg=new Mr;class Ng extends Si{constructor(t,e){super(),this.light=t,this.light.updateMatrixWorld(),this.matrix=t.matrixWorld,this.matrixAutoUpdate=!1,this.color=e;const n=new os,r=[0,0,0,0,0,1,0,0,0,1,0,1,0,0,0,-1,0,1,0,0,0,0,1,1,0,0,0,0,-1,1];for(let s=0,o=1,a=32;s<a;s++,o++){const t=s/a*Math.PI*2,e=o/a*Math.PI*2;r.push(Math.cos(t),Math.sin(t),1,Math.cos(e),Math.sin(e),1)}n.setAttribute("position",new Zi(r,3));const i=new dd({fog:!1,toneMapped:!1});this.cone=new wd(n,i),this.add(this.cone),this.update()}dispose(){this.cone.geometry.dispose(),this.cone.material.dispose()}update(){this.light.updateMatrixWorld();const t=this.light.distance?this.light.distance:1e3,e=t*Math.tan(this.light.angle);this.cone.scale.set(e,e,t),Lg.setFromMatrixPosition(this.light.target.matrixWorld),this.cone.lookAt(Lg),void 0!==this.color?this.cone.material.color.set(this.color):this.cone.material.color.copy(this.light.color)}}const kg=new Mr,Og=new ti,Dg=new ti;class zg extends wd{constructor(t){const e=Fg(t),n=new os,r=[],i=[],s=new lr(0,0,1),o=new lr(0,1,0);for(let l=0;l<e.length;l++){const t=e[l];t.parent&&t.parent.isBone&&(r.push(0,0,0),r.push(0,0,0),i.push(s.r,s.g,s.b),i.push(o.r,o.g,o.b))}n.setAttribute("position",new Zi(r,3)),n.setAttribute("color",new Zi(i,3));const a=new dd({vertexColors:!0,depthTest:!1,depthWrite:!1,toneMapped:!1,transparent:!0});super(n,a),this.isSkeletonHelper=!0,this.type="SkeletonHelper",this.root=t,this.bones=e,this.matrix=t.matrixWorld,this.matrixAutoUpdate=!1}updateMatrixWorld(t){const e=this.bones,n=this.geometry,r=n.getAttribute("position");Dg.copy(this.root.matrixWorld).invert();for(let i=0,s=0;i<e.length;i++){const t=e[i];t.parent&&t.parent.isBone&&(Og.multiplyMatrices(Dg,t.matrixWorld),kg.setFromMatrixPosition(Og),r.setXYZ(s,kg.x,kg.y,kg.z),Og.multiplyMatrices(Dg,t.parent.matrixWorld),kg.setFromMatrixPosition(Og),r.setXYZ(s+1,kg.x,kg.y,kg.z),s+=2)}n.getAttribute("position").needsUpdate=!0,super.updateMatrixWorld(t)}}function Fg(t){const e=[];!0===t.isBone&&e.push(t);for(let n=0;n<t.children.length;n++)e.push.apply(e,Fg(t.children[n]));return e}class Ug extends As{constructor(t,e,n){const r=new dp(e,4,2),i=new Ui({wireframe:!0,fog:!1,toneMapped:!1});super(r,i),this.light=t,this.light.updateMatrixWorld(),this.color=n,this.type="PointLightHelper",this.matrix=this.light.matrixWorld,this.matrixAutoUpdate=!1,this.update()}dispose(){this.geometry.dispose(),this.material.dispose()}update(){void 0!==this.color?this.material.color.set(this.color):this.material.color.copy(this.light.color)}}const Bg=new Mr,Gg=new lr,Hg=new lr;class Vg extends Si{constructor(t,e,n){super(),this.light=t,this.light.updateMatrixWorld(),this.matrix=t.matrixWorld,this.matrixAutoUpdate=!1,this.color=n;const r=new lp(e);r.rotateY(.5*Math.PI),this.material=new Ui({wireframe:!0,fog:!1,toneMapped:!1}),void 0===this.color&&(this.material.vertexColors=!0);const i=r.getAttribute("position"),s=new Float32Array(3*i.count);r.setAttribute("color",new Hi(s,3)),this.add(new As(r,this.material)),this.update()}dispose(){this.children[0].geometry.dispose(),this.children[0].material.dispose()}update(){const t=this.children[0];if(void 0!==this.color)this.material.color.set(this.color);else{const e=t.geometry.getAttribute("color");Gg.copy(this.light.color),Hg.copy(this.light.groundColor);for(let t=0,n=e.count;t<n;t++){const r=t<n/2?Gg:Hg;e.setXYZ(t,r.r,r.g,r.b)}e.needsUpdate=!0}t.lookAt(Bg.setFromMatrixPosition(this.light.matrixWorld).negate())}}class jg extends wd{constructor(t=10,e=10,n=4473924,r=8947848){n=new lr(n),r=new lr(r);const i=e/2,s=t/e,o=t/2,a=[],l=[];for(let h=0,d=0,f=-o;h<=e;h++,f+=s){a.push(-o,0,f,o,0,f),a.push(f,0,-o,f,0,o);const t=h===i?n:r;t.toArray(l,d),d+=3,t.toArray(l,d),d+=3,t.toArray(l,d),d+=3,t.toArray(l,d),d+=3}const c=new os;c.setAttribute("position",new Zi(a,3)),c.setAttribute("color",new Zi(l,3));const u=new dd({vertexColors:!0,toneMapped:!1});super(c,u),this.type="GridHelper"}}class Wg extends wd{constructor(t=10,e=16,n=8,r=64,i=4473924,s=8947848){i=new lr(i),s=new lr(s);const o=[],a=[];for(let u=0;u<=e;u++){const n=u/e*(2*Math.PI),r=Math.sin(n)*t,l=Math.cos(n)*t;o.push(0,0,0),o.push(r,0,l);const c=1&u?i:s;a.push(c.r,c.g,c.b),a.push(c.r,c.g,c.b)}for(let u=0;u<=n;u++){const e=1&u?i:s,l=t-t/n*u;for(let t=0;t<r;t++){let n=t/r*(2*Math.PI),i=Math.sin(n)*l,s=Math.cos(n)*l;o.push(i,0,s),a.push(e.r,e.g,e.b),n=(t+1)/r*(2*Math.PI),i=Math.sin(n)*l,s=Math.cos(n)*l,o.push(i,0,s),a.push(e.r,e.g,e.b)}}const l=new os;l.setAttribute("position",new Zi(o,3)),l.setAttribute("color",new Zi(a,3));const c=new dd({vertexColors:!0,toneMapped:!1});super(l,c),this.type="PolarGridHelper"}}const qg=new Mr,Yg=new Mr,Xg=new Mr;class Jg extends Si{constructor(t,e,n){super(),this.light=t,this.light.updateMatrixWorld(),this.matrix=t.matrixWorld,this.matrixAutoUpdate=!1,this.color=n,void 0===e&&(e=1);let r=new os;r.setAttribute("position",new Zi([-e,e,0,e,e,0,e,-e,0,-e,-e,0,-e,e,0],3));const i=new dd({fog:!1,toneMapped:!1});this.lightPlane=new yd(r,i),this.add(this.lightPlane),r=new os,r.setAttribute("position",new Zi([0,0,0,0,0,1],3)),this.targetLine=new yd(r,i),this.add(this.targetLine),this.update()}dispose(){this.lightPlane.geometry.dispose(),this.lightPlane.material.dispose(),this.targetLine.geometry.dispose(),this.targetLine.material.dispose()}update(){qg.setFromMatrixPosition(this.light.matrixWorld),Yg.setFromMatrixPosition(this.light.target.matrixWorld),Xg.subVectors(Yg,qg),this.lightPlane.lookAt(Yg),void 0!==this.color?(this.lightPlane.material.color.set(this.color),this.targetLine.material.color.set(this.color)):(this.lightPlane.material.color.copy(this.light.color),this.targetLine.material.color.copy(this.light.color)),this.targetLine.lookAt(Yg),this.targetLine.scale.z=Xg.length()}}const Kg=new Mr,Zg=new ks;class Qg extends wd{constructor(t){const e=new os,n=new dd({color:16777215,vertexColors:!0,toneMapped:!1}),r=[],i=[],s={},o=new lr(16755200),a=new lr(16711680),l=new lr(43775),c=new lr(16777215),u=new lr(3355443);function h(t,e,n){d(t,n),d(e,n)}function d(t,e){r.push(0,0,0),i.push(e.r,e.g,e.b),void 0===s[t]&&(s[t]=[]),s[t].push(r.length/3-1)}h("n1","n2",o),h("n2","n4",o),h("n4","n3",o),h("n3","n1",o),h("f1","f2",o),h("f2","f4",o),h("f4","f3",o),h("f3","f1",o),h("n1","f1",o),h("n2","f2",o),h("n3","f3",o),h("n4","f4",o),h("p","n1",a),h("p","n2",a),h("p","n3",a),h("p","n4",a),h("u1","u2",l),h("u2","u3",l),h("u3","u1",l),h("c","t",c),h("p","c",u),h("cn1","cn2",u),h("cn3","cn4",u),h("cf1","cf2",u),h("cf3","cf4",u),e.setAttribute("position",new Zi(r,3)),e.setAttribute("color",new Zi(i,3)),super(e,n),this.type="CameraHelper",this.camera=t,this.camera.updateProjectionMatrix&&this.camera.updateProjectionMatrix(),this.matrix=t.matrixWorld,this.matrixAutoUpdate=!1,this.pointMap=s,this.update()}update(){const t=this.geometry,e=this.pointMap,n=1,r=1;Zg.projectionMatrixInverse.copy(this.camera.projectionMatrixInverse),$g("c",e,t,Zg,0,0,-1),$g("t",e,t,Zg,0,0,1),$g("n1",e,t,Zg,-n,-r,-1),$g("n2",e,t,Zg,n,-r,-1),$g("n3",e,t,Zg,-n,r,-1),$g("n4",e,t,Zg,n,r,-1),$g("f1",e,t,Zg,-n,-r,1),$g("f2",e,t,Zg,n,-r,1),$g("f3",e,t,Zg,-n,r,1),$g("f4",e,t,Zg,n,r,1),$g("u1",e,t,Zg,.7*n,1.1*r,-1),$g("u2",e,t,Zg,.7*-n,1.1*r,-1),$g("u3",e,t,Zg,0,2*r,-1),$g("cf1",e,t,Zg,-n,0,1),$g("cf2",e,t,Zg,n,0,1),$g("cf3",e,t,Zg,0,-r,1),$g("cf4",e,t,Zg,0,r,1),$g("cn1",e,t,Zg,-n,0,-1),$g("cn2",e,t,Zg,n,0,-1),$g("cn3",e,t,Zg,0,-r,-1),$g("cn4",e,t,Zg,0,r,-1),t.getAttribute("position").needsUpdate=!0}dispose(){this.geometry.dispose(),this.material.dispose()}}function $g(t,e,n,r,i,s,o){Kg.set(i,s,o).unproject(r);const a=e[t];if(void 0!==a){const t=n.getAttribute("position");for(let e=0,n=a.length;e<n;e++)t.setXYZ(a[e],Kg.x,Kg.y,Kg.z)}}const tv=new Er;class ev extends wd{constructor(t,e=16776960){const n=new Uint16Array([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]),r=new Float32Array(24),i=new os;i.setIndex(new Hi(n,1)),i.setAttribute("position",new Hi(r,3)),super(i,new dd({color:e,toneMapped:!1})),this.object=t,this.type="BoxHelper",this.matrixAutoUpdate=!1,this.update()}update(t){if(void 0!==t&&console.warn("THREE.BoxHelper: .update() has no longer arguments."),void 0!==this.object&&tv.setFromObject(this.object),tv.isEmpty())return;const e=tv.min,n=tv.max,r=this.geometry.attributes.position,i=r.array;i[0]=n.x,i[1]=n.y,i[2]=n.z,i[3]=e.x,i[4]=n.y,i[5]=n.z,i[6]=e.x,i[7]=e.y,i[8]=n.z,i[9]=n.x,i[10]=e.y,i[11]=n.z,i[12]=n.x,i[13]=n.y,i[14]=e.z,i[15]=e.x,i[16]=n.y,i[17]=e.z,i[18]=e.x,i[19]=e.y,i[20]=e.z,i[21]=n.x,i[22]=e.y,i[23]=e.z,r.needsUpdate=!0,this.geometry.computeBoundingSphere()}setFromObject(t){return this.object=t,this.update(),this}copy(t,e){return super.copy(t,e),this.object=t.object,this}}class nv extends wd{constructor(t,e=16776960){const n=new Uint16Array([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]),r=[1,1,1,-1,1,1,-1,-1,1,1,-1,1,1,1,-1,-1,1,-1,-1,-1,-1,1,-1,-1],i=new os;i.setIndex(new Hi(n,1)),i.setAttribute("position",new Zi(r,3)),super(i,new dd({color:e,toneMapped:!1})),this.box=t,this.type="Box3Helper",this.geometry.computeBoundingSphere()}updateMatrixWorld(t){const e=this.box;e.isEmpty()||(e.getCenter(this.position),e.getSize(this.scale),this.scale.multiplyScalar(.5),super.updateMatrixWorld(t))}}class rv extends yd{constructor(t,e=1,n=16776960){const r=n,i=[1,-1,1,-1,1,1,-1,-1,1,1,1,1,-1,1,1,-1,-1,1,1,-1,1,1,1,1,0,0,1,0,0,0],s=new os;s.setAttribute("position",new Zi(i,3)),s.computeBoundingSphere(),super(s,new dd({color:r,toneMapped:!1})),this.type="PlaneHelper",this.plane=t,this.size=e;const o=[1,1,1,-1,1,1,-1,-1,1,1,1,1,-1,-1,1,1,-1,1],a=new os;a.setAttribute("position",new Zi(o,3)),a.computeBoundingSphere(),this.add(new As(a,new Ui({color:r,opacity:.2,transparent:!0,depthWrite:!1,toneMapped:!1})))}updateMatrixWorld(t){let e=-this.plane.constant;Math.abs(e)<1e-8&&(e=1e-8),this.scale.set(.5*this.size,.5*this.size,e),this.children[0].material.side=e<0?v:g,this.lookAt(this.plane.normal),super.updateMatrixWorld(t)}}const iv=new Mr;let sv,ov;class av extends Si{constructor(t=new Mr(0,0,1),e=new Mr(0,0,0),n=1,r=16776960,i=.2*n,s=.2*i){super(),this.type="ArrowHelper",void 0===sv&&(sv=new os,sv.setAttribute("position",new Zi([0,0,0,0,1,0],3)),ov=new ff(0,.5,1,5,1),ov.translate(0,-.5,0)),this.position.copy(e),this.line=new yd(sv,new dd({color:r,toneMapped:!1})),this.line.matrixAutoUpdate=!1,this.add(this.line),this.cone=new As(ov,new Ui({color:r,toneMapped:!1})),this.cone.matrixAutoUpdate=!1,this.add(this.cone),this.setDirection(t),this.setLength(n,i,s)}setDirection(t){if(t.y>.99999)this.quaternion.set(0,0,0,1);else if(t.y<-.99999)this.quaternion.set(1,0,0,0);else{iv.set(t.z,0,-t.x).normalize();const e=Math.acos(t.y);this.quaternion.setFromAxisAngle(iv,e)}}setLength(t,e=.2*t,n=.2*e){this.line.scale.set(1,Math.max(1e-4,t-e),1),this.line.updateMatrix(),this.cone.scale.set(n,e,n),this.cone.position.y=t,this.cone.updateMatrix()}setColor(t){this.line.material.color.set(t),this.cone.material.color.set(t)}copy(t){return super.copy(t,!1),this.line.copy(t.line),this.cone.copy(t.cone),this}}class lv extends wd{constructor(t=1){const e=[0,0,0,t,0,0,0,0,0,0,t,0,0,0,0,0,0,t],n=[1,0,0,1,.6,0,0,1,0,.6,1,0,0,0,1,0,.6,1],r=new os;r.setAttribute("position",new Zi(e,3)),r.setAttribute("color",new Zi(n,3));const i=new dd({vertexColors:!0,toneMapped:!1});super(r,i),this.type="AxesHelper"}setColors(t,e,n){const r=new lr,i=this.geometry.attributes.color.array;return r.set(t),r.toArray(i,0),r.toArray(i,3),r.set(e),r.toArray(i,6),r.toArray(i,9),r.set(n),r.toArray(i,12),r.toArray(i,15),this.geometry.attributes.color.needsUpdate=!0,this}dispose(){this.geometry.dispose(),this.material.dispose()}}class cv{constructor(){this.type="ShapePath",this.color=new lr,this.subPaths=[],this.currentPath=null}moveTo(t,e){return this.currentPath=new cf,this.subPaths.push(this.currentPath),this.currentPath.moveTo(t,e),this}lineTo(t,e){return this.currentPath.lineTo(t,e),this}quadraticCurveTo(t,e,n,r){return this.currentPath.quadraticCurveTo(t,e,n,r),this}bezierCurveTo(t,e,n,r,i,s){return this.currentPath.bezierCurveTo(t,e,n,r,i,s),this}splineThru(t){return this.currentPath.splineThru(t),this}toShapes(t,e){function n(t){const e=[];for(let n=0,r=t.length;n<r;n++){const r=t[n],i=new _f;i.curves=r.curves,e.push(i)}return e}function r(t,e){const n=e.length;let r=!1;for(let i=n-1,s=0;s<n;i=s++){let n=e[i],o=e[s],a=o.x-n.x,l=o.y-n.y;if(Math.abs(l)>Number.EPSILON){if(l<0&&(n=e[s],a=-a,o=e[i],l=-l),t.y<n.y||t.y>o.y)continue;if(t.y===n.y){if(t.x===n.x)return!0}else{const e=l*(t.x-n.x)-a*(t.y-n.y);if(0===e)return!0;if(e<0)continue;r=!r}}else{if(t.y!==n.y)continue;if(o.x<=t.x&&t.x<=n.x||n.x<=t.x&&t.x<=o.x)return!0}}return r}const i=ep.isClockWise,s=this.subPaths;if(0===s.length)return[];if(!0===e)return n(s);let o,a,l;const c=[];if(1===s.length)return a=s[0],l=new _f,l.curves=a.curves,c.push(l),c;let u=!i(s[0].getPoints());u=t?!u:u;const h=[],d=[];let f,p,m=[],g=0;d[g]=void 0,m[g]=[];for(let v=0,y=s.length;v<y;v++)a=s[v],f=a.getPoints(),o=i(f),o=t?!o:o,o?(!u&&d[g]&&g++,d[g]={s:new _f,p:f},d[g].s.curves=a.curves,u&&g++,m[g]=[]):m[g].push({h:a,p:f[0]});if(!d[0])return n(s);if(d.length>1){let t=!1,e=0;for(let n=0,r=d.length;n<r;n++)h[n]=[];for(let n=0,i=d.length;n<i;n++){const i=m[n];for(let s=0;s<i.length;s++){const o=i[s];let a=!0;for(let i=0;i<d.length;i++)r(o.p,d[i].p)&&(n!==i&&e++,a?(a=!1,h[i].push(o)):t=!0);a&&h[n].push(o)}}e>0&&!1===t&&(m=h)}for(let v=0,y=d.length;v<y;v++){l=d[v].s,c.push(l),p=m[v];for(let t=0,e=p.length;t<e;t++)l.holes.push(p[t].h)}return c}}class uv{static toHalfFloat(t){Math.abs(t)>65504&&console.warn("THREE.DataUtils.toHalfFloat(): Value out of range."),t=An(t,-65504,65504),dv[0]=t;const e=fv[0],n=e>>23&511;return pv[n]+((8388607&e)>>mv[n])}static fromHalfFloat(t){const e=t>>10;return fv[0]=gv[yv[e]+(1023&t)]+vv[e],dv[0]}}const hv=new ArrayBuffer(4),dv=new Float32Array(hv),fv=new Uint32Array(hv),pv=new Uint32Array(512),mv=new Uint32Array(512);for(let y_=0;y_<256;++y_){const t=y_-127;t<-27?(pv[y_]=0,pv[256|y_]=32768,mv[y_]=24,mv[256|y_]=24):t<-14?(pv[y_]=1024>>-t-14,pv[256|y_]=1024>>-t-14|32768,mv[y_]=-t-1,mv[256|y_]=-t-1):t<=15?(pv[y_]=t+15<<10,pv[256|y_]=t+15<<10|32768,mv[y_]=13,mv[256|y_]=13):t<128?(pv[y_]=31744,pv[256|y_]=64512,mv[y_]=24,mv[256|y_]=24):(pv[y_]=31744,pv[256|y_]=64512,mv[y_]=13,mv[256|y_]=13)}const gv=new Uint32Array(2048),vv=new Uint32Array(64),yv=new Uint32Array(64);for(let y_=1;y_<1024;++y_){let t=y_<<13,e=0;while(0===(8388608&t))t<<=1,e-=8388608;t&=-8388609,e+=947912704,gv[y_]=t|e}for(let y_=1024;y_<2048;++y_)gv[y_]=939524096+(y_-1024<<13);for(let y_=1;y_<31;++y_)vv[y_]=y_<<23;vv[31]=1199570944,vv[32]=2147483648;for(let y_=33;y_<63;++y_)vv[y_]=2147483648+(y_-32<<23);vv[63]=3347054592;for(let y_=1;y_<64;++y_)32!==y_&&(yv[y_]=1024);class xv extends os{constructor(){console.error("THREE.ParametricGeometry has been moved to /examples/jsm/geometries/ParametricGeometry.js"),super()}}class bv extends os{constructor(){console.error("THREE.TextGeometry has been moved to /examples/jsm/geometries/TextGeometry.js"),super()}}function wv(){console.error("THREE.FontLoader has been moved to /examples/jsm/loaders/FontLoader.js")}function _v(){console.error("THREE.Font has been moved to /examples/jsm/loaders/FontLoader.js")}function Mv(){console.error("THREE.ImmediateRenderObject has been removed.")}class Av extends gr{constructor(t,e,n){console.error('THREE.WebGLMultisampleRenderTarget has been removed. Use a normal render target and set the "samples" property to greater 0 to enable multisampling.'),super(t,e,n),this.samples=4}}class Sv extends vr{constructor(t,e,n,r){console.warn("THREE.DataTexture2DArray has been renamed to DataArrayTexture."),super(t,e,n,r)}}class Ev extends xr{constructor(t,e,n,r){console.warn("THREE.DataTexture3D has been renamed to Data3DTexture."),super(t,e,n,r)}}"undefined"!==typeof __THREE_DEVTOOLS__&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("register",{detail:{revision:s}})),"undefined"!==typeof window&&(window.__THREE__?console.warn("WARNING: Multiple instances of Three.js being imported."):window.__THREE__=s);Symbol.toStringTag;const Tv=/^[og]\s*(.+)?/,Cv=/^mtllib /,Rv=/^usemtl /,Iv=/^usemap /,Pv=new Mr,Lv=new Mr,Nv=new Mr,kv=new Mr,Ov=new Mr,Dv=new lr;function zv(){const t={objects:[],object:{},vertices:[],normals:[],colors:[],uvs:[],materials:{},materialLibraries:[],startObject:function(t,e){if(this.object&&!1===this.object.fromDeclaration)return this.object.name=t,void(this.object.fromDeclaration=!1!==e);const n=this.object&&"function"===typeof this.object.currentMaterial?this.object.currentMaterial():void 0;if(this.object&&"function"===typeof this.object._finalize&&this.object._finalize(!0),this.object={name:t||"",fromDeclaration:!1!==e,geometry:{vertices:[],normals:[],colors:[],uvs:[],hasUVIndices:!1},materials:[],smooth:!0,startMaterial:function(t,e){const n=this._finalize(!1);n&&(n.inherited||n.groupCount<=0)&&this.materials.splice(n.index,1);const r={index:this.materials.length,name:t||"",mtllib:Array.isArray(e)&&e.length>0?e[e.length-1]:"",smooth:void 0!==n?n.smooth:this.smooth,groupStart:void 0!==n?n.groupEnd:0,groupEnd:-1,groupCount:-1,inherited:!1,clone:function(t){const e={index:"number"===typeof t?t:this.index,name:this.name,mtllib:this.mtllib,smooth:this.smooth,groupStart:0,groupEnd:-1,groupCount:-1,inherited:!1};return e.clone=this.clone.bind(e),e}};return this.materials.push(r),r},currentMaterial:function(){if(this.materials.length>0)return this.materials[this.materials.length-1]},_finalize:function(t){const e=this.currentMaterial();if(e&&-1===e.groupEnd&&(e.groupEnd=this.geometry.vertices.length/3,e.groupCount=e.groupEnd-e.groupStart,e.inherited=!1),t&&this.materials.length>1)for(let n=this.materials.length-1;n>=0;n--)this.materials[n].groupCount<=0&&this.materials.splice(n,1);return t&&0===this.materials.length&&this.materials.push({name:"",smooth:this.smooth}),e}},n&&n.name&&"function"===typeof n.clone){const t=n.clone(0);t.inherited=!0,this.object.materials.push(t)}this.objects.push(this.object)},finalize:function(){this.object&&"function"===typeof this.object._finalize&&this.object._finalize(!0)},parseVertexIndex:function(t,e){const n=parseInt(t,10);return 3*(n>=0?n-1:n+e/3)},parseNormalIndex:function(t,e){const n=parseInt(t,10);return 3*(n>=0?n-1:n+e/3)},parseUVIndex:function(t,e){const n=parseInt(t,10);return 2*(n>=0?n-1:n+e/2)},addVertex:function(t,e,n){const r=this.vertices,i=this.object.geometry.vertices;i.push(r[t+0],r[t+1],r[t+2]),i.push(r[e+0],r[e+1],r[e+2]),i.push(r[n+0],r[n+1],r[n+2])},addVertexPoint:function(t){const e=this.vertices,n=this.object.geometry.vertices;n.push(e[t+0],e[t+1],e[t+2])},addVertexLine:function(t){const e=this.vertices,n=this.object.geometry.vertices;n.push(e[t+0],e[t+1],e[t+2])},addNormal:function(t,e,n){const r=this.normals,i=this.object.geometry.normals;i.push(r[t+0],r[t+1],r[t+2]),i.push(r[e+0],r[e+1],r[e+2]),i.push(r[n+0],r[n+1],r[n+2])},addFaceNormal:function(t,e,n){const r=this.vertices,i=this.object.geometry.normals;Pv.fromArray(r,t),Lv.fromArray(r,e),Nv.fromArray(r,n),Ov.subVectors(Nv,Lv),kv.subVectors(Pv,Lv),Ov.cross(kv),Ov.normalize(),i.push(Ov.x,Ov.y,Ov.z),i.push(Ov.x,Ov.y,Ov.z),i.push(Ov.x,Ov.y,Ov.z)},addColor:function(t,e,n){const r=this.colors,i=this.object.geometry.colors;void 0!==r[t]&&i.push(r[t+0],r[t+1],r[t+2]),void 0!==r[e]&&i.push(r[e+0],r[e+1],r[e+2]),void 0!==r[n]&&i.push(r[n+0],r[n+1],r[n+2])},addUV:function(t,e,n){const r=this.uvs,i=this.object.geometry.uvs;i.push(r[t+0],r[t+1]),i.push(r[e+0],r[e+1]),i.push(r[n+0],r[n+1])},addDefaultUV:function(){const t=this.object.geometry.uvs;t.push(0,0),t.push(0,0),t.push(0,0)},addUVLine:function(t){const e=this.uvs,n=this.object.geometry.uvs;n.push(e[t+0],e[t+1])},addFace:function(t,e,n,r,i,s,o,a,l){const c=this.vertices.length;let u=this.parseVertexIndex(t,c),h=this.parseVertexIndex(e,c),d=this.parseVertexIndex(n,c);if(this.addVertex(u,h,d),this.addColor(u,h,d),void 0!==o&&""!==o){const t=this.normals.length;u=this.parseNormalIndex(o,t),h=this.parseNormalIndex(a,t),d=this.parseNormalIndex(l,t),this.addNormal(u,h,d)}else this.addFaceNormal(u,h,d);if(void 0!==r&&""!==r){const t=this.uvs.length;u=this.parseUVIndex(r,t),h=this.parseUVIndex(i,t),d=this.parseUVIndex(s,t),this.addUV(u,h,d),this.object.geometry.hasUVIndices=!0}else this.addDefaultUV()},addPointGeometry:function(t){this.object.geometry.type="Points";const e=this.vertices.length;for(let n=0,r=t.length;n<r;n++){const r=this.parseVertexIndex(t[n],e);this.addVertexPoint(r),this.addColor(r)}},addLineGeometry:function(t,e){this.object.geometry.type="Line";const n=this.vertices.length,r=this.uvs.length;for(let i=0,s=t.length;i<s;i++)this.addVertexLine(this.parseVertexIndex(t[i],n));for(let i=0,s=e.length;i<s;i++)this.addUVLine(this.parseUVIndex(e[i],r))}};return t.startObject("",!1),t}class Fv extends Kp{constructor(t){super(t),this.materials=null}load(t,e,n,r){const i=this,s=new Qp(this.manager);s.setPath(this.path),s.setRequestHeader(this.requestHeader),s.setWithCredentials(this.withCredentials),s.load(t,(function(n){try{e(i.parse(n))}catch(s){r?r(s):console.error(s),i.manager.itemError(t)}}),n,r)}setMaterials(t){return this.materials=t,this}parse(t){const e=new zv;-1!==t.indexOf("\r\n")&&(t=t.replace(/\r\n/g,"\n")),-1!==t.indexOf("\\\n")&&(t=t.replace(/\\\n/g,""));const n=t.split("\n");let r="",i="",s=0,o=[];const a="function"===typeof"".trimLeft;for(let u=0,h=n.length;u<h;u++)if(r=n[u],r=a?r.trimLeft():r.trim(),s=r.length,0!==s&&(i=r.charAt(0),"#"!==i))if("v"===i){const t=r.split(/\s+/);switch(t[0]){case"v":e.vertices.push(parseFloat(t[1]),parseFloat(t[2]),parseFloat(t[3])),t.length>=7?(Dv.setRGB(parseFloat(t[4]),parseFloat(t[5]),parseFloat(t[6])).convertSRGBToLinear(),e.colors.push(Dv.r,Dv.g,Dv.b)):e.colors.push(void 0,void 0,void 0);break;case"vn":e.normals.push(parseFloat(t[1]),parseFloat(t[2]),parseFloat(t[3]));break;case"vt":e.uvs.push(parseFloat(t[1]),parseFloat(t[2]));break}}else if("f"===i){const t=r.slice(1).trim(),n=t.split(/\s+/),i=[];for(let e=0,r=n.length;e<r;e++){const t=n[e];if(t.length>0){const e=t.split("/");i.push(e)}}const s=i[0];for(let r=1,o=i.length-1;r<o;r++){const t=i[r],n=i[r+1];e.addFace(s[0],t[0],n[0],s[1],t[1],n[1],s[2],t[2],n[2])}}else if("l"===i){const t=r.substring(1).trim().split(" ");let n=[];const i=[];if(-1===r.indexOf("/"))n=t;else for(let e=0,r=t.length;e<r;e++){const r=t[e].split("/");""!==r[0]&&n.push(r[0]),""!==r[1]&&i.push(r[1])}e.addLineGeometry(n,i)}else if("p"===i){const t=r.slice(1).trim(),n=t.split(" ");e.addPointGeometry(n)}else if(null!==(o=Tv.exec(r))){const t=(" "+o[0].slice(1).trim()).slice(1);e.startObject(t)}else if(Rv.test(r))e.object.startMaterial(r.substring(7).trim(),e.materialLibraries);else if(Cv.test(r))e.materialLibraries.push(r.substring(7).trim());else if(Iv.test(r))console.warn('THREE.OBJLoader: Rendering identifier "usemap" not supported. Textures must be defined in MTL files.');else if("s"===i){if(o=r.split(" "),o.length>1){const t=o[1].trim().toLowerCase();e.object.smooth="0"!==t&&"off"!==t}else e.object.smooth=!0;const t=e.object.currentMaterial();t&&(t.smooth=e.object.smooth)}else{if("\0"===r)continue;console.warn('THREE.OBJLoader: Unexpected line: "'+r+'"')}e.finalize();const l=new mh;l.materialLibraries=[].concat(e.materialLibraries);const c=!(1===e.objects.length&&0===e.objects[0].geometry.vertices.length);if(!0===c)for(let u=0,h=e.objects.length;u<h;u++){const t=e.objects[u],n=t.geometry,r=t.materials,i="Line"===n.type,s="Points"===n.type;let o=!1;if(0===n.vertices.length)continue;const a=new os;a.setAttribute("position",new Zi(n.vertices,3)),n.normals.length>0&&a.setAttribute("normal",new Zi(n.normals,3)),n.colors.length>0&&(o=!0,a.setAttribute("color",new Zi(n.colors,3))),!0===n.hasUVIndices&&a.setAttribute("uv",new Zi(n.uvs,2));const c=[];for(let l=0,u=r.length;l<u;l++){const t=r[l],n=t.name+"_"+t.smooth+"_"+o;let a=e.materials[n];if(null!==this.materials)if(a=this.materials.create(t.name),!i||!a||a instanceof dd){if(s&&a&&!(a instanceof Md)){const t=new Md({size:10,sizeAttenuation:!1});Fi.prototype.copy.call(t,a),t.color.copy(a.color),t.map=a.map,a=t}}else{const t=new dd;Fi.prototype.copy.call(t,a),t.color.copy(a.color),a=t}void 0===a&&(a=i?new dd:s?new Md({size:1,sizeAttenuation:!1}):new Ap,a.name=t.name,a.flatShading=!t.smooth,a.vertexColors=o,e.materials[n]=a),c.push(a)}let h;if(c.length>1){for(let t=0,e=r.length;t<e;t++){const e=r[t];a.addGroup(e.groupStart,e.groupCount,t)}h=i?new wd(a,c):s?new Cd(a,c):new As(a,c)}else h=i?new wd(a,c[0]):s?new Cd(a,c[0]):new As(a,c[0]);h.name=t.name,l.add(h)}else if(e.vertices.length>0){const t=new Md({size:1,sizeAttenuation:!1}),n=new os;n.setAttribute("position",new Zi(e.vertices,3)),e.colors.length>0&&void 0!==e.colors[0]&&(n.setAttribute("color",new Zi(e.colors,3)),t.vertexColors=!0);const r=new Cd(n,t);l.add(r)}return l}}class Uv extends Kp{constructor(t){super(t)}load(t,e,n,r){const i=this,s=""===this.path?Sm.extractUrlBase(t):this.path,o=new Qp(this.manager);o.setPath(this.path),o.setRequestHeader(this.requestHeader),o.setWithCredentials(this.withCredentials),o.load(t,(function(n){try{e(i.parse(n,s))}catch(o){r?r(o):console.error(o),i.manager.itemError(t)}}),n,r)}setMaterialOptions(t){return this.materialOptions=t,this}parse(t,e){const n=t.split("\n");let r={};const i=/\s+/,s={};for(let a=0;a<n.length;a++){let t=n[a];if(t=t.trim(),0===t.length||"#"===t.charAt(0))continue;const e=t.indexOf(" ");let o=e>=0?t.substring(0,e):t;o=o.toLowerCase();let l=e>=0?t.substring(e+1):"";if(l=l.trim(),"newmtl"===o)r={name:l},s[l]=r;else if("ka"===o||"kd"===o||"ks"===o||"ke"===o){const t=l.split(i,3);r[o]=[parseFloat(t[0]),parseFloat(t[1]),parseFloat(t[2])]}else r[o]=l}const o=new Bv(this.resourcePath||e,this.materialOptions);return o.setCrossOrigin(this.crossOrigin),o.setManager(this.manager),o.setMaterials(s),o}}class Bv{constructor(t="",e={}){this.baseUrl=t,this.options=e,this.materialsInfo={},this.materials={},this.materialsArray=[],this.nameLookup={},this.crossOrigin="anonymous",this.side=void 0!==this.options.side?this.options.side:g,this.wrap=void 0!==this.options.wrap?this.options.wrap:dt}setCrossOrigin(t){return this.crossOrigin=t,this}setManager(t){this.manager=t}setMaterials(t){this.materialsInfo=this.convert(t),this.materials={},this.materialsArray=[],this.nameLookup={}}convert(t){if(!this.options)return t;const e={};for(const n in t){const r=t[n],i={};e[n]=i;for(const t in r){let e=!0,n=r[t];const s=t.toLowerCase();switch(s){case"kd":case"ka":case"ks":this.options&&this.options.normalizeRGB&&(n=[n[0]/255,n[1]/255,n[2]/255]),this.options&&this.options.ignoreZeroRGBs&&0===n[0]&&0===n[1]&&0===n[2]&&(e=!1);break}e&&(i[s]=n)}}return e}preload(){for(const t in this.materialsInfo)this.create(t)}getIndex(t){return this.nameLookup[t]}getAsArray(){let t=0;for(const e in this.materialsInfo)this.materialsArray[t]=this.create(e),this.nameLookup[e]=t,t++;return this.materialsArray}create(t){return void 0===this.materials[t]&&this.createMaterial_(t),this.materials[t]}createMaterial_(t){const e=this,n=this.materialsInfo[t],r={name:t,side:this.side};function i(t,e){return"string"!==typeof e||""===e?"":/^https?:\/\//i.test(e)?e:t+e}function s(t,n){if(r[t])return;const s=e.getTextureParams(n,r),o=e.loadTexture(i(e.baseUrl,s.url));o.repeat.copy(s.scale),o.offset.copy(s.offset),o.wrapS=e.wrap,o.wrapT=e.wrap,"map"!==t&&"emissiveMap"!==t||(o.encoding=Oe),r[t]=o}for(const o in n){const t=n[o];let e;if(""!==t)switch(o.toLowerCase()){case"kd":r.color=(new lr).fromArray(t).convertSRGBToLinear();break;case"ks":r.specular=(new lr).fromArray(t).convertSRGBToLinear();break;case"ke":r.emissive=(new lr).fromArray(t).convertSRGBToLinear();break;case"map_kd":s("map",t);break;case"map_ks":s("specularMap",t);break;case"map_ke":s("emissiveMap",t);break;case"norm":s("normalMap",t);break;case"map_bump":case"bump":s("bumpMap",t);break;case"map_d":s("alphaMap",t),r.transparent=!0;break;case"ns":r.shininess=parseFloat(t);break;case"d":e=parseFloat(t),e<1&&(r.opacity=e,r.transparent=!0);break;case"tr":e=parseFloat(t),this.options&&this.options.invertTrProperty&&(e=1-e),e>0&&(r.opacity=1-e,r.transparent=!0);break}}return this.materials[t]=new Ap(r),this.materials[t]}getTextureParams(t,e){const n={scale:new qn(1,1),offset:new qn(0,0)},r=t.split(/\s+/);let i;return i=r.indexOf("-bm"),i>=0&&(e.bumpScale=parseFloat(r[i+1]),r.splice(i,2)),i=r.indexOf("-s"),i>=0&&(n.scale.set(parseFloat(r[i+1]),parseFloat(r[i+2])),r.splice(i,4)),i=r.indexOf("-o"),i>=0&&(n.offset.set(parseFloat(r[i+1]),parseFloat(r[i+2])),r.splice(i,4)),n.url=r.join(" ").trim(),n}loadTexture(t,e,n,r,i){const s=void 0!==this.manager?this.manager:Jp;let o=s.getHandler(t);null===o&&(o=new im(s)),o.setCrossOrigin&&o.setCrossOrigin(this.crossOrigin);const a=o.load(t,n,r,i);return void 0!==e&&(a.mapping=e),a}}class Gv extends tm{constructor(t){super(t)}parse(t,e){const n={mipmaps:[],width:0,height:0,format:null,mipmapCount:1},r=542327876,i=131072,s=512,o=1024,a=2048,l=4096,c=8192,u=16384,h=32768;function d(t){return t.charCodeAt(0)+(t.charCodeAt(1)<<8)+(t.charCodeAt(2)<<16)+(t.charCodeAt(3)<<24)}function f(t){return String.fromCharCode(255&t,t>>8&255,t>>16&255,t>>24&255)}function p(t,e,n,r){const i=n*r*4,s=new Uint8Array(t,e,i),o=new Uint8Array(i);let a=0,l=0;for(let c=0;c<r;c++)for(let t=0;t<n;t++){const t=s[l];l++;const e=s[l];l++;const n=s[l];l++;const r=s[l];l++,o[a]=n,a++,o[a]=e,a++,o[a]=t,a++,o[a]=r,a++}return o}const m=d("DXT1"),g=d("DXT3"),v=d("DXT5"),y=d("ETC1"),x=31,b=0,w=1,_=2,M=3,A=4,S=7,E=21,T=22,C=23,R=24,I=25,P=26,L=28,N=new Int32Array(t,0,x);if(N[b]!==r)return console.error("THREE.DDSLoader.parse: Invalid magic number in DDS header."),n;let k;const O=N[E];let D=!1;switch(O){case m:k=8,n.format=Xt;break;case g:k=16,n.format=Kt;break;case v:k=16,n.format=Zt;break;case y:k=8,n.format=ne;break;default:if(!(32===N[T]&&16711680&N[C]&&65280&N[R]&&255&N[I]&&4278190080&N[P]))return console.error("THREE.DDSLoader.parse: Unsupported FourCC code ",f(O)),n;D=!0,k=64,n.format=Ft}n.mipmapCount=1,N[_]&i&&!1!==e&&(n.mipmapCount=Math.max(1,N[S]));const z=N[L];if(n.isCubemap=!!(z&s),n.isCubemap&&(!(z&o)||!(z&a)||!(z&l)||!(z&c)||!(z&u)||!(z&h)))return console.error("THREE.DDSLoader.parse: Incomplete cubemap faces"),n;n.width=N[A],n.height=N[M];let F=N[w]+4;const U=n.isCubemap?6:1;for(let B=0;B<U;B++){let e=n.width,r=n.height;for(let i=0;i<n.mipmapCount;i++){let i,s;D?(i=p(t,F,e,r),s=i.length):(s=Math.max(4,e)/4*Math.max(4,r)/4*k,i=new Uint8Array(t,F,s));const o={data:i,width:e,height:r};n.mipmaps.push(o),F+=s,e=Math.max(e>>1,1),r=Math.max(r>>1,1)}}return n}}class Hv{constructor(t,e,n){const r=this;let i,s=!1,o=0,a=0;const l=[];this.onStart=void 0,this.onLoad=t,this.onProgress=e,this.onError=n,this.itemStart=function(t){a++,!1===s&&void 0!==r.onStart&&r.onStart(t,o,a),s=!0},this.itemEnd=function(t){o++,void 0!==r.onProgress&&r.onProgress(t,o,a),o===a&&(s=!1,void 0!==r.onLoad&&r.onLoad())},this.itemError=function(t){void 0!==r.onError&&r.onError(t)},this.resolveURL=function(t){return i?i(t):t},this.setURLModifier=function(t){return i=t,this},this.addHandler=function(t,e){return l.push(t,e),this},this.removeHandler=function(t){const e=l.indexOf(t);return-1!==e&&l.splice(e,2),this},this.getHandler=function(t){for(let e=0,n=l.length;e<n;e+=2){const n=l[e],r=l[e+1];if(n.global&&(n.lastIndex=0),n.test(t))return r}return null}}}new Hv;const Vv=new Er;function jv(t){return Vv.setFromObject(t),Vv.getSize(new Mr)}function Wv(t){return Vv.setFromObject(t),Vv.getCenter(new Mr)}function qv(t){const e=t.getAttribute("position").array;let n;const r=void 0!==t.getAttribute("uv");let i;r&&(n=t.getAttribute("uv").array);const s=void 0!==t.getAttribute("normal");s&&(i=t.getAttribute("normal").array);const o=[],a=[],l=[],c=[];let u,h,d,f;const p=new Mr,m=new Mr,g=new Mr,v=new Mr,y=new Mr,x=new Mr,b=new qn,w=new qn,_=new qn;for(let R=0;R<e.length;R+=9)p.x=e[R],p.y=e[R+1],p.z=e[R+2],m.x=e[R+3],m.y=e[R+4],m.z=e[R+5],g.x=e[R+6],g.y=e[R+7],g.z=e[R+8],u=[p,m,g],s&&(v.x=i[R],v.y=i[R+1],v.z=i[R+2],y.x=i[R+3],y.y=i[R+4],y.z=i[R+5],x.x=i[R+6],x.y=i[R+7],x.z=i[R+8],h=[v,y,x]),r&&(b.x=n[R],b.y=n[R+1],w.x=n[R+2],w.y=n[R+3],_.x=n[R+4],_.y=n[R+5],d=[b,w,_]),f=[],u.forEach(((t,e)=>{let n=C(t,a);-1===n&&(n=a.length,a.push(t.clone()),s&&l.push(h[e].clone()),r&&c.push(d[e].clone())),f.push(n)})),o.push(f[0],f[1],f[2]);const M=new Float32Array(3*a.length);let A,S;s&&(A=new Float32Array(3*a.length)),r&&(S=new Float32Array(2*a.length));let E=0,T=0;for(let R=0;R<a.length;R++)T=3*R,M[T]=a[R].x,M[T+1]=a[R].y,M[T+2]=a[R].z,s&&(A[T]=l[R].x,A[T+1]=l[R].y,A[T+2]=l[R].z),r&&(E=2*R,S[E]=c[R].x,S[E+1]=c[R].y);return t.addAttribute("position",new Hi(M,3)),s&&t.addAttribute("normal",new Hi(A,3)),r&&t.addAttribute("uv",new Hi(S,2)),t.setIndex(new Hi(new Uint32Array(o),1)),t;function C(t,e){for(let n=0;n<e.length;n++)if(t.equals(e[n]))return n;return-1}}const Yv={type:"change"},Xv={type:"start"},Jv={type:"end"};class Kv extends yn{constructor(t,e){super(),void 0===e&&console.warn('THREE.OrbitControls: The second parameter "domElement" is now mandatory.'),e===document&&console.error('THREE.OrbitControls: "document" should not be used as the target "domElement". Please use "renderer.domElement" instead.'),this.object=t,this.domElement=e,this.domElement.style.touchAction="none",this.enabled=!0,this.target=new Mr,this.minDistance=0,this.maxDistance=1/0,this.minZoom=0,this.maxZoom=1/0,this.minPolarAngle=0,this.maxPolarAngle=Math.PI,this.minAzimuthAngle=-1/0,this.maxAzimuthAngle=1/0,this.enableDamping=!1,this.dampingFactor=.05,this.enableZoom=!0,this.zoomSpeed=1,this.enableRotate=!0,this.rotateSpeed=1,this.enablePan=!0,this.panSpeed=1,this.screenSpacePanning=!0,this.keyPanSpeed=7,this.autoRotate=!1,this.autoRotateSpeed=2,this.keys={LEFT:"ArrowLeft",UP:"ArrowUp",RIGHT:"ArrowRight",BOTTOM:"ArrowDown"},this.mouseButtons={LEFT:o.ROTATE,MIDDLE:o.DOLLY,RIGHT:o.PAN},this.touches={ONE:a.ROTATE,TWO:a.DOLLY_PAN},this.target0=this.target.clone(),this.position0=this.object.position.clone(),this.zoom0=this.object.zoom,this._domElementKeyEvents=null,this.getPolarAngle=function(){return l.phi},this.getAzimuthalAngle=function(){return l.theta},this.getDistance=function(){return this.object.position.distanceTo(this.target)},this.listenToKeyEvents=function(t){t.addEventListener("keydown",it),this._domElementKeyEvents=t},this.saveState=function(){n.target0.copy(n.target),n.position0.copy(n.object.position),n.zoom0=n.object.zoom},this.reset=function(){n.target.copy(n.target0),n.object.position.copy(n.position0),n.object.zoom=n.zoom0,n.object.updateProjectionMatrix(),n.dispatchEvent(Yv),n.update(),i=r.NONE},this.update=function(){const e=new Mr,o=(new _r).setFromUnitVectors(t.up,new Mr(0,1,0)),a=o.clone().invert(),f=new Mr,p=new _r,m=2*Math.PI;return function(){const t=n.object.position;e.copy(t).sub(n.target),e.applyQuaternion(o),l.setFromVector3(e),n.autoRotate&&i===r.NONE&&E(A()),n.enableDamping?(l.theta+=c.theta*n.dampingFactor,l.phi+=c.phi*n.dampingFactor):(l.theta+=c.theta,l.phi+=c.phi);let g=n.minAzimuthAngle,v=n.maxAzimuthAngle;return isFinite(g)&&isFinite(v)&&(g<-Math.PI?g+=m:g>Math.PI&&(g-=m),v<-Math.PI?v+=m:v>Math.PI&&(v-=m),l.theta=g<=v?Math.max(g,Math.min(v,l.theta)):l.theta>(g+v)/2?Math.max(g,l.theta):Math.min(v,l.theta)),l.phi=Math.max(n.minPolarAngle,Math.min(n.maxPolarAngle,l.phi)),l.makeSafe(),l.radius*=u,l.radius=Math.max(n.minDistance,Math.min(n.maxDistance,l.radius)),!0===n.enableDamping?n.target.addScaledVector(h,n.dampingFactor):n.target.add(h),e.setFromSpherical(l),e.applyQuaternion(a),t.copy(n.target).add(e),n.object.lookAt(n.target),!0===n.enableDamping?(c.theta*=1-n.dampingFactor,c.phi*=1-n.dampingFactor,h.multiplyScalar(1-n.dampingFactor)):(c.set(0,0,0),h.set(0,0,0)),u=1,!!(d||f.distanceToSquared(n.object.position)>s||8*(1-p.dot(n.object.quaternion))>s)&&(n.dispatchEvent(Yv),f.copy(n.object.position),p.copy(n.object.quaternion),d=!1,!0)}}(),this.dispose=function(){n.domElement.removeEventListener("contextmenu",at),n.domElement.removeEventListener("pointerdown",Z),n.domElement.removeEventListener("pointercancel",tt),n.domElement.removeEventListener("wheel",rt),n.domElement.removeEventListener("pointermove",Q),n.domElement.removeEventListener("pointerup",$),null!==n._domElementKeyEvents&&n._domElementKeyEvents.removeEventListener("keydown",it)};const n=this,r={NONE:-1,ROTATE:0,DOLLY:1,PAN:2,TOUCH_ROTATE:3,TOUCH_PAN:4,TOUCH_DOLLY_PAN:5,TOUCH_DOLLY_ROTATE:6};let i=r.NONE;const s=1e-6,l=new Sg,c=new Sg;let u=1;const h=new Mr;let d=!1;const f=new qn,p=new qn,m=new qn,g=new qn,v=new qn,y=new qn,x=new qn,b=new qn,w=new qn,_=[],M={};function A(){return 2*Math.PI/60/60*n.autoRotateSpeed}function S(){return Math.pow(.95,n.zoomSpeed)}function E(t){c.theta-=t}function T(t){c.phi-=t}const C=function(){const t=new Mr;return function(e,n){t.setFromMatrixColumn(n,0),t.multiplyScalar(-e),h.add(t)}}(),R=function(){const t=new Mr;return function(e,r){!0===n.screenSpacePanning?t.setFromMatrixColumn(r,1):(t.setFromMatrixColumn(r,0),t.crossVectors(n.object.up,t)),t.multiplyScalar(e),h.add(t)}}(),I=function(){const t=new Mr;return function(e,r){const i=n.domElement;if(n.object.isPerspectiveCamera){const s=n.object.position;t.copy(s).sub(n.target);let o=t.length();o*=Math.tan(n.object.fov/2*Math.PI/180),C(2*e*o/i.clientHeight,n.object.matrix),R(2*r*o/i.clientHeight,n.object.matrix)}else n.object.isOrthographicCamera?(C(e*(n.object.right-n.object.left)/n.object.zoom/i.clientWidth,n.object.matrix),R(r*(n.object.top-n.object.bottom)/n.object.zoom/i.clientHeight,n.object.matrix)):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - pan disabled."),n.enablePan=!1)}}();function P(t){n.object.isPerspectiveCamera?u/=t:n.object.isOrthographicCamera?(n.object.zoom=Math.max(n.minZoom,Math.min(n.maxZoom,n.object.zoom*t)),n.object.updateProjectionMatrix(),d=!0):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),n.enableZoom=!1)}function L(t){n.object.isPerspectiveCamera?u*=t:n.object.isOrthographicCamera?(n.object.zoom=Math.max(n.minZoom,Math.min(n.maxZoom,n.object.zoom/t)),n.object.updateProjectionMatrix(),d=!0):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),n.enableZoom=!1)}function N(t){f.set(t.clientX,t.clientY)}function k(t){x.set(t.clientX,t.clientY)}function O(t){g.set(t.clientX,t.clientY)}function D(t){p.set(t.clientX,t.clientY),m.subVectors(p,f).multiplyScalar(n.rotateSpeed);const e=n.domElement;E(2*Math.PI*m.x/e.clientHeight),T(2*Math.PI*m.y/e.clientHeight),f.copy(p),n.update()}function z(t){b.set(t.clientX,t.clientY),w.subVectors(b,x),w.y>0?P(S()):w.y<0&&L(S()),x.copy(b),n.update()}function F(t){v.set(t.clientX,t.clientY),y.subVectors(v,g).multiplyScalar(n.panSpeed),I(y.x,y.y),g.copy(v),n.update()}function U(t){t.deltaY<0?L(S()):t.deltaY>0&&P(S()),n.update()}function B(t){let e=!1;switch(t.code){case n.keys.UP:I(0,n.keyPanSpeed),e=!0;break;case n.keys.BOTTOM:I(0,-n.keyPanSpeed),e=!0;break;case n.keys.LEFT:I(n.keyPanSpeed,0),e=!0;break;case n.keys.RIGHT:I(-n.keyPanSpeed,0),e=!0;break}e&&(t.preventDefault(),n.update())}function G(){if(1===_.length)f.set(_[0].pageX,_[0].pageY);else{const t=.5*(_[0].pageX+_[1].pageX),e=.5*(_[0].pageY+_[1].pageY);f.set(t,e)}}function H(){if(1===_.length)g.set(_[0].pageX,_[0].pageY);else{const t=.5*(_[0].pageX+_[1].pageX),e=.5*(_[0].pageY+_[1].pageY);g.set(t,e)}}function V(){const t=_[0].pageX-_[1].pageX,e=_[0].pageY-_[1].pageY,n=Math.sqrt(t*t+e*e);x.set(0,n)}function j(){n.enableZoom&&V(),n.enablePan&&H()}function W(){n.enableZoom&&V(),n.enableRotate&&G()}function q(t){if(1==_.length)p.set(t.pageX,t.pageY);else{const e=ht(t),n=.5*(t.pageX+e.x),r=.5*(t.pageY+e.y);p.set(n,r)}m.subVectors(p,f).multiplyScalar(n.rotateSpeed);const e=n.domElement;E(2*Math.PI*m.x/e.clientHeight),T(2*Math.PI*m.y/e.clientHeight),f.copy(p)}function Y(t){if(1===_.length)v.set(t.pageX,t.pageY);else{const e=ht(t),n=.5*(t.pageX+e.x),r=.5*(t.pageY+e.y);v.set(n,r)}y.subVectors(v,g).multiplyScalar(n.panSpeed),I(y.x,y.y),g.copy(v)}function X(t){const e=ht(t),r=t.pageX-e.x,i=t.pageY-e.y,s=Math.sqrt(r*r+i*i);b.set(0,s),w.set(0,Math.pow(b.y/x.y,n.zoomSpeed)),P(w.y),x.copy(b)}function J(t){n.enableZoom&&X(t),n.enablePan&&Y(t)}function K(t){n.enableZoom&&X(t),n.enableRotate&&q(t)}function Z(t){!1!==n.enabled&&(0===_.length&&(n.domElement.setPointerCapture(t.pointerId),n.domElement.addEventListener("pointermove",Q),n.domElement.addEventListener("pointerup",$)),lt(t),"touch"===t.pointerType?st(t):et(t))}function Q(t){!1!==n.enabled&&("touch"===t.pointerType?ot(t):nt(t))}function $(t){ct(t),0===_.length&&(n.domElement.releasePointerCapture(t.pointerId),n.domElement.removeEventListener("pointermove",Q),n.domElement.removeEventListener("pointerup",$)),n.dispatchEvent(Jv),i=r.NONE}function tt(t){ct(t)}function et(t){let e;switch(t.button){case 0:e=n.mouseButtons.LEFT;break;case 1:e=n.mouseButtons.MIDDLE;break;case 2:e=n.mouseButtons.RIGHT;break;default:e=-1}switch(e){case o.DOLLY:if(!1===n.enableZoom)return;k(t),i=r.DOLLY;break;case o.ROTATE:if(t.ctrlKey||t.metaKey||t.shiftKey){if(!1===n.enablePan)return;O(t),i=r.PAN}else{if(!1===n.enableRotate)return;N(t),i=r.ROTATE}break;case o.PAN:if(t.ctrlKey||t.metaKey||t.shiftKey){if(!1===n.enableRotate)return;N(t),i=r.ROTATE}else{if(!1===n.enablePan)return;O(t),i=r.PAN}break;default:i=r.NONE}i!==r.NONE&&n.dispatchEvent(Xv)}function nt(t){if(!1!==n.enabled)switch(i){case r.ROTATE:if(!1===n.enableRotate)return;D(t);break;case r.DOLLY:if(!1===n.enableZoom)return;z(t);break;case r.PAN:if(!1===n.enablePan)return;F(t);break}}function rt(t){!1!==n.enabled&&!1!==n.enableZoom&&i===r.NONE&&(t.preventDefault(),n.dispatchEvent(Xv),U(t),n.dispatchEvent(Jv))}function it(t){!1!==n.enabled&&!1!==n.enablePan&&B(t)}function st(t){switch(ut(t),_.length){case 1:switch(n.touches.ONE){case a.ROTATE:if(!1===n.enableRotate)return;G(),i=r.TOUCH_ROTATE;break;case a.PAN:if(!1===n.enablePan)return;H(),i=r.TOUCH_PAN;break;default:i=r.NONE}break;case 2:switch(n.touches.TWO){case a.DOLLY_PAN:if(!1===n.enableZoom&&!1===n.enablePan)return;j(),i=r.TOUCH_DOLLY_PAN;break;case a.DOLLY_ROTATE:if(!1===n.enableZoom&&!1===n.enableRotate)return;W(),i=r.TOUCH_DOLLY_ROTATE;break;default:i=r.NONE}break;default:i=r.NONE}i!==r.NONE&&n.dispatchEvent(Xv)}function ot(t){switch(ut(t),i){case r.TOUCH_ROTATE:if(!1===n.enableRotate)return;q(t),n.update();break;case r.TOUCH_PAN:if(!1===n.enablePan)return;Y(t),n.update();break;case r.TOUCH_DOLLY_PAN:if(!1===n.enableZoom&&!1===n.enablePan)return;J(t),n.update();break;case r.TOUCH_DOLLY_ROTATE:if(!1===n.enableZoom&&!1===n.enableRotate)return;K(t),n.update();break;default:i=r.NONE}}function at(t){!1!==n.enabled&&t.preventDefault()}function lt(t){_.push(t)}function ct(t){delete M[t.pointerId];for(let e=0;e<_.length;e++)if(_[e].pointerId==t.pointerId)return void _.splice(e,1)}function ut(t){let e=M[t.pointerId];void 0===e&&(e=new qn,M[t.pointerId]=e),e.set(t.pageX,t.pageY)}function ht(t){const e=t.pointerId===_[0].pointerId?_[1]:_[0];return M[e.pointerId]}n.domElement.addEventListener("contextmenu",at),n.domElement.addEventListener("pointerdown",Z),n.domElement.addEventListener("pointercancel",tt),n.domElement.addEventListener("wheel",rt,{passive:!1}),this.update()}}var Zv=(t,e)=>{const n=t.__vccOpts||t;for(const[r,i]of e)n[r]=i;return n};const Qv={antialias:!0,alpha:!0},$v=(0,r.aZ)({props:{src:{type:String},width:{type:Number},height:{type:Number},position:{type:Object,default:()=>({x:0,y:0,z:0})},rotation:{type:Object,default:()=>({x:0,y:0,z:0})},scale:{type:Object,default:()=>({x:1,y:1,z:1})},lights:{type:Array,default:()=>[]},cameraPosition:{type:Object,default:()=>({x:0,y:0,z:0})},cameraRotation:{type:Object,default:()=>({x:0,y:0,z:0})},cameraUp:{type:Object},cameraLookAt:{type:Object},backgroundColor:{default:16777215},backgroundAlpha:{type:Number,default:1},controlsOptions:{type:Object},crossOrigin:{type:String,default:"anonymous"},requestHeader:{type:Object,default:()=>{}},outputEncoding:{type:Number,default:ke},glOptions:{type:Object}},data(){const t={object:null,raycaster:new _g,mouse:new qn,camera:new Os(45,1,.01,1e5),scene:new Eh,wrapper:new Si,renderer:null,controls:null,allLights:[],clock:"undefined"===typeof performance?Date:performance,reqId:null,loader:null};Object.assign(this,t);const e={size:{width:this.width,height:this.height},progress:{isComplete:!1,lengthComputable:!1,loaded:0}};return e},computed:{loadProgressPercentage(){return this.progress.isComplete?100:this.progress.lengthComputable?100*Math.min(.92,this.progress.loaded/(3*this.progress.total)):100*Math.min(1,this.progress.loaded/this.progress.total)}},mounted(){void 0!==this.width&&void 0!==this.height||(this.size={width:this.$refs.container.offsetWidth,height:this.$refs.container.offsetHeight});const t=Object.assign({},Qv,this.glOptions,{canvas:this.$refs.canvas});this.renderer=new _h(t),this.renderer.shadowMap.enabled=!0,this.renderer.outputEncoding=this.outputEncoding,this.controls=new Kv(this.camera,this.$refs.container),this.scene.add(this.wrapper),this.load(),this.update();const e=this.$refs.container;e.addEventListener("mousedown",this.onMouseDown,!1),e.addEventListener("mousemove",this.onMouseMove,!1),e.addEventListener("mouseup",this.onMouseUp,!1),e.addEventListener("click",this.onClick,!1),e.addEventListener("dblclick",this.onDblclick,!1),window.addEventListener("resize",this.onResize,!1),this.animate()},beforeDestroy(){cancelAnimationFrame(this.reqId),this.renderer.dispose(),this.controls&&this.controls.dispose();const t=this.$refs.container;t.removeEventListener("mousedown",this.onMouseDown,!1),t.removeEventListener("mousemove",this.onMouseMove,!1),t.removeEventListener("mouseup",this.onMouseUp,!1),t.removeEventListener("click",this.onClick,!1),t.removeEventListener("dblclick",this.onDblclick,!1),window.removeEventListener("resize",this.onResize,!1)},watch:{src(){this.load()},rotation:{deep:!0,handler(t){this.object&&this.object.rotation.set(t.x,t.y,t.z)}},position:{deep:!0,handler(t){this.object&&this.object.position.set(t.x,t.y,t.z)}},scale:{deep:!0,handler(t){this.object&&this.object.scale.set(t.x,t.y,t.z)}},lights:{deep:!0,handler(){this.updateLights()}},size:{deep:!0,handler(){this.updateCamera(),this.updateRenderer()}},controlsOptions:{deep:!0,handler(){this.updateControls()}},backgroundAlpha(){this.updateRenderer()},backgroundColor(){this.updateRenderer()}},methods:{onResize(){void 0!==this.width&&void 0!==this.height||this.$nextTick((()=>{this.size={width:this.$refs.container.offsetWidth,height:this.$refs.container.offsetHeight}}))},onMouseDown(t){if(!this.$attrs.onMousedown)return;const e=this.pick(t.clientX,t.clientY);this.$emit("mousedown",t,e)},onMouseMove(t){if(console.log(this.$attrs),!this.$attrs.onMousemove)return;const e=this.pick(t.clientX,t.clientY);this.$emit("mousemove",t,e)},onMouseUp(t){if(!this.$attrs.onMouseup)return;const e=this.pick(t.clientX,t.clientY);this.$emit("mouseup",t,e)},onClick(t){if(!this.$attrs.onClick)return;const e=this.pick(t.clientX,t.clientY);this.$emit("click",t,e)},onDblclick(t){if(!this.$attrs.onDblclick)return;const e=this.pick(t.clientX,t.clientY);this.$emit("dblclick",t,e)},pick(t,e){if(!this.object)return null;if(!this.$refs.container)return;const n=this.$refs.container.getBoundingClientRect();t-=n.left,e-=n.top,this.mouse.x=t/this.size.width*2-1,this.mouse.y=-e/this.size.height*2+1,this.raycaster.setFromCamera(this.mouse,this.camera);const r=this.raycaster.intersectObject(this.object,!0);return(r&&r.length)>0?r[0]:null},update(){this.updateRenderer(),this.updateCamera(),this.updateLights(),this.updateControls()},updateModel(){const{object:t}=this;if(!t)return;const{position:e}=this,{rotation:n}=this,{scale:r}=this;t.position.set(e.x,e.y,e.z),t.rotation.set(n.x,n.y,n.z),t.scale.set(r.x,r.y,r.z)},updateRenderer(){const{renderer:t}=this;t.setSize(this.size.width,this.size.height),t.setPixelRatio(window.devicePixelRatio||1),t.setClearColor(new lr(this.backgroundColor).getHex()),t.setClearAlpha(this.backgroundAlpha)},updateCamera(){const{camera:t}=this,{object:e}=this;if(t.aspect=this.size.width/this.size.height,t.updateProjectionMatrix(),this.cameraLookAt&&this.cameraUp)t.position.set(this.cameraPosition.x,this.cameraPosition.y,this.cameraPosition.z),t.rotation.set(this.cameraRotation.x,this.cameraRotation.y,this.cameraRotation.z),t.up.set(this.cameraUp.x,this.cameraUp.y,this.cameraUp.z),t.lookAt(new Mr(this.cameraLookAt.x,this.cameraLookAt.y,this.cameraLookAt.z));else{if(!e)return;const n=jv(e).length();t.position.set(this.cameraPosition.x,this.cameraPosition.y,this.cameraPosition.z),t.rotation.set(this.cameraRotation.x,this.cameraRotation.y,this.cameraRotation.z),0===this.cameraPosition.x&&0===this.cameraPosition.y&&0===this.cameraPosition.z&&(t.position.z=n),t.lookAt(new Mr)}},updateLights(){this.scene.remove(...this.allLights),this.allLights=[],this.lights.forEach((t=>{if(!t.type)return;const e=t.type.toLowerCase();let n=null;if("ambient"===e||"ambientlight"===e){const e=0===t.color?t.color:t.color||4210752,r=0===t.intensity?t.intensity:t.intensity||1;n=new bm(e,r)}else if("point"===e||"pointlight"===e){const e=0===t.color?t.color:t.color||16777215,r=0===t.intensity?t.intensity:t.intensity||1,i=t.distance||0,s=0===t.decay?t.decay:t.decay||1;n=new vm(e,r,i,s),t.position&&n.position.copy(t.position)}else if("directional"===e||"directionallight"===e){const e=0===t.color?t.color:t.color||16777215,r=0===t.intensity?t.intensity:t.intensity||1;n=new xm(e,r),t.position&&n.position.copy(t.position),t.target&&n.target.copy(t.target)}else if("hemisphere"===e||"hemispherelight"===e){const e=0===t.skyColor?t.skyColor:t.skyColor||16777215,r=0===t.groundColor?t.groundColor:t.groundColor||16777215,i=0===t.intensity?t.intensity:t.intensity||1;n=new om(e,r,i),t.position&&n.position.copy(t.position)}n&&(this.allLights.push(n),this.scene.add(n))}))},updateControls(){this.controlsOptions&&Object.assign(this.controls,this.controlsOptions)},reportProgress(t,e){var n,r,i;"start"===t?(this.progress.isComplete=!1,this.progress.startedAt=Date.now(),this.progress.loaded=0,this.progress.total=0):"end"===t?(this.progress.isComplete=!0,this.progress.endedAt=Date.now()):(this.progress.lengthComputable=null!=(n=null==e?void 0:e.lengthComputable)&&n,this.progress.loaded=null!=(r=null==e?void 0:e.loaded)?r:0,this.progress.total=null!=(i=null==e?void 0:e.total)?i:0)},load(){this.src&&(this.object&&this.wrapper.remove(this.object),this.loader.setRequestHeader(this.requestHeader),this.reportProgress("start"),this.loader.load(this.src,((...t)=>{this.reportProgress("end");const e=this.getObject(...t);this.process(e),this.addObject(e),this.$emit("load")}),(t=>{this.reportProgress("progress",t),this.$emit("progress",t)}),(t=>{this.reportProgress("end"),this.$emit("error",t)})))},process(t){return t},getObject(t){return t},addObject(t){this.object=t,this.wrapper.add(t),this.updateCamera(),this.updateModel();const e=Wv(t);this.wrapper.position.copy(e.negate())},animate(){this.reqId=requestAnimationFrame(this.animate),this.render()},render(){this.renderer.render(this.scene,this.camera)}}}),ty={style:{position:"relative",width:"100%",height:"100%",margin:"0",border:"0",padding:"0"},ref:"container"},ey={style:{position:"absolute","z-index":"2",height:"3px",width:"100%","background-color":"rgba(0, 0, 0, 0.04)"}},ny={key:1,style:{position:"absolute","z-index":"1",width:"100%",height:"100%"}},ry={ref:"canvas",style:{width:"100%",height:"100%"}};function iy(t,e,n,s,o,a){return(0,r.wg)(),(0,r.iD)("div",ty,[!1===t.progress.isComplete?(0,r.WI)(t.$slots,"progress-bar",{key:0,progress:t.progress},(()=>[(0,r._)("div",ey,[(0,r._)("div",{style:(0,i.j5)({width:`${t.loadProgressPercentage}%`,height:"100%",backgroundColor:"#1890ff",transition:"width .2s"})},null,4)])])):(0,r.kq)("",!0),!1===t.progress.isComplete?((0,r.wg)(),(0,r.iD)("div",ny,[(0,r.WI)(t.$slots,"poster")])):(0,r.kq)("",!0),(0,r._)("canvas",ry,null,512)],512)}var sy=Zv($v,[["render",iy]]);const oy=new Hv;oy.addHandler(/\.dds$/i,new Gv);(0,r.aZ)({name:"model-obj",mixins:[sy],props:{lights:{type:Array,default:()=>[{type:"HemisphereLight",position:{x:0,y:1,z:0},skyColor:11184895,groundColor:8413280,intensity:.2},{type:"DirectionalLight",position:{x:1,y:1,z:1},color:16777215,intensity:.8}]},smoothing:{type:Boolean,default:!1},mtlPath:{type:String},mtl:{type:String}},data(){const t=new Fv(oy),e=new Uv(oy);return e.setCrossOrigin(this.crossOrigin),e.setRequestHeader(this.requestHeader),t.setRequestHeader(this.requestHeader),{loader:t,mtlLoader:e}},watch:{mtl(){this.load()}},methods:{process(t){this.smoothing&&t.traverse((t=>{t.geometry&&(t.geometry=qv(t.geometry),t.geometry.computeVertexNormals())}))},load(){if(!this.src)return;this.object&&this.wrapper.remove(this.object);const t=t=>{this.reportProgress("end"),this.process&&this.process(t),this.addObject(t),this.$emit("load")},e=t=>{this.reportProgress("progress",t),this.$emit("progress",t)},n=t=>{this.reportProgress("end"),this.$emit("error",t)};if(this.reportProgress("start"),this.mtl){let{mtlPath:r}=this,i=this.mtl;if(!this.mtlPath){const t=/^(.*\/)([^/]*)$/.exec(this.mtl);t&&(r=t[1],i=t[2])}r&&this.mtlLoader.setPath(r),this.mtlLoader.load(i,(r=>{r.preload(),this.loader.setMaterials(r).load(this.src,t,e,n)}),(()=>{}),n)}else this.loader.load(this.src,t,e,n)}}});
/*!
fflate - fast JavaScript compression/decompression
<https://101arrowz.github.io/fflate>
Licensed under MIT. https://github.com/101arrowz/fflate/blob/master/LICENSE
version 0.6.9
*/var ay={},ly=function(t){return URL.createObjectURL(new Blob([t],{type:"text/javascript"}))},cy=function(t){return new Worker(t)};try{URL.revokeObjectURL(ly(""))}catch(v_){ly=function(t){return"data:application/javascript;charset=UTF-8,"+encodeURI(t)},cy=function(t){return new Worker(t,{type:"module"})}}var uy=function(t,e,n,r,i){var s=cy(ay[e]||(ay[e]=ly(t)));return s.onerror=function(t){return i(t.error,null)},s.onmessage=function(t){return i(null,t.data)},s.postMessage(n,r),s},hy=Uint8Array,dy=Uint16Array,fy=Uint32Array,py=new hy([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),my=new hy([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),gy=new hy([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),vy=function(t,e){for(var n=new dy(31),r=0;r<31;++r)n[r]=e+=1<<t[r-1];var i=new fy(n[30]);for(r=1;r<30;++r)for(var s=n[r];s<n[r+1];++s)i[s]=s-n[r]<<5|r;return[n,i]},yy=vy(py,2),xy=yy[0],by=yy[1];xy[28]=258,by[258]=28;for(var wy=vy(my,0),_y=wy[0],My=wy[1],Ay=new dy(32768),Sy=0;Sy<32768;++Sy){var Ey=(43690&Sy)>>>1|(21845&Sy)<<1;Ey=(52428&Ey)>>>2|(13107&Ey)<<2,Ey=(61680&Ey)>>>4|(3855&Ey)<<4,Ay[Sy]=((65280&Ey)>>>8|(255&Ey)<<8)>>>1}var Ty=function(t,e,n){for(var r=t.length,i=0,s=new dy(e);i<r;++i)++s[t[i]-1];var o,a=new dy(e);for(i=0;i<e;++i)a[i]=a[i-1]+s[i-1]<<1;if(n){o=new dy(1<<e);var l=15-e;for(i=0;i<r;++i)if(t[i])for(var c=i<<4|t[i],u=e-t[i],h=a[t[i]-1]++<<u,d=h|(1<<u)-1;h<=d;++h)o[Ay[h]>>>l]=c}else for(o=new dy(r),i=0;i<r;++i)t[i]&&(o[i]=Ay[a[t[i]-1]++]>>>15-t[i]);return o},Cy=new hy(288);for(Sy=0;Sy<144;++Sy)Cy[Sy]=8;for(Sy=144;Sy<256;++Sy)Cy[Sy]=9;for(Sy=256;Sy<280;++Sy)Cy[Sy]=7;for(Sy=280;Sy<288;++Sy)Cy[Sy]=8;var Ry=new hy(32);for(Sy=0;Sy<32;++Sy)Ry[Sy]=5;var Iy=Ty(Cy,9,0),Py=Ty(Cy,9,1),Ly=Ty(Ry,5,0),Ny=Ty(Ry,5,1),ky=function(t){for(var e=t[0],n=1;n<t.length;++n)t[n]>e&&(e=t[n]);return e},Oy=function(t,e,n){var r=e/8|0;return(t[r]|t[r+1]<<8)>>(7&e)&n},Dy=function(t,e){var n=e/8|0;return(t[n]|t[n+1]<<8|t[n+2]<<16)>>(7&e)},zy=function(t){return(t/8|0)+(7&t&&1)},Fy=function(t,e,n){(null==e||e<0)&&(e=0),(null==n||n>t.length)&&(n=t.length);var r=new(t instanceof dy?dy:t instanceof fy?fy:hy)(n-e);return r.set(t.subarray(e,n)),r},Uy=function(t,e,n){var r=t.length;if(!r||n&&!n.l&&r<5)return e||new hy(0);var i=!e||n,s=!n||n.i;n||(n={}),e||(e=new hy(3*r));var o=function(t){var n=e.length;if(t>n){var r=new hy(Math.max(2*n,t));r.set(e),e=r}},a=n.f||0,l=n.p||0,c=n.b||0,u=n.l,h=n.d,d=n.m,f=n.n,p=8*r;do{if(!u){n.f=a=Oy(t,l,1);var m=Oy(t,l+1,3);if(l+=3,!m){var g=zy(l)+4,v=t[g-4]|t[g-3]<<8,y=g+v;if(y>r){if(s)throw"unexpected EOF";break}i&&o(c+v),e.set(t.subarray(g,y),c),n.b=c+=v,n.p=l=8*y;continue}if(1==m)u=Py,h=Ny,d=9,f=5;else{if(2!=m)throw"invalid block type";var x=Oy(t,l,31)+257,b=Oy(t,l+10,15)+4,w=x+Oy(t,l+5,31)+1;l+=14;for(var _=new hy(w),M=new hy(19),A=0;A<b;++A)M[gy[A]]=Oy(t,l+3*A,7);l+=3*b;var S=ky(M),E=(1<<S)-1,T=Ty(M,S,1);for(A=0;A<w;){var C=T[Oy(t,l,E)];l+=15&C;g=C>>>4;if(g<16)_[A++]=g;else{var R=0,I=0;16==g?(I=3+Oy(t,l,3),l+=2,R=_[A-1]):17==g?(I=3+Oy(t,l,7),l+=3):18==g&&(I=11+Oy(t,l,127),l+=7);while(I--)_[A++]=R}}var P=_.subarray(0,x),L=_.subarray(x);d=ky(P),f=ky(L),u=Ty(P,d,1),h=Ty(L,f,1)}if(l>p){if(s)throw"unexpected EOF";break}}i&&o(c+131072);for(var N=(1<<d)-1,k=(1<<f)-1,O=l;;O=l){R=u[Dy(t,l)&N];var D=R>>>4;if(l+=15&R,l>p){if(s)throw"unexpected EOF";break}if(!R)throw"invalid length/literal";if(D<256)e[c++]=D;else{if(256==D){O=l,u=null;break}var z=D-254;if(D>264){A=D-257;var F=py[A];z=Oy(t,l,(1<<F)-1)+xy[A],l+=F}var U=h[Dy(t,l)&k],B=U>>>4;if(!U)throw"invalid distance";l+=15&U;L=_y[B];if(B>3){F=my[B];L+=Dy(t,l)&(1<<F)-1,l+=F}if(l>p){if(s)throw"unexpected EOF";break}i&&o(c+131072);for(var G=c+z;c<G;c+=4)e[c]=e[c-L],e[c+1]=e[c+1-L],e[c+2]=e[c+2-L],e[c+3]=e[c+3-L];c=G}}n.l=u,n.p=O,n.b=c,u&&(a=1,n.m=d,n.d=h,n.n=f)}while(!a);return c==e.length?e:Fy(e,0,c)},By=function(t,e,n){n<<=7&e;var r=e/8|0;t[r]|=n,t[r+1]|=n>>>8},Gy=function(t,e,n){n<<=7&e;var r=e/8|0;t[r]|=n,t[r+1]|=n>>>8,t[r+2]|=n>>>16},Hy=function(t,e){for(var n=[],r=0;r<t.length;++r)t[r]&&n.push({s:r,f:t[r]});var i=n.length,s=n.slice();if(!i)return[Jy,0];if(1==i){var o=new hy(n[0].s+1);return o[n[0].s]=1,[o,1]}n.sort((function(t,e){return t.f-e.f})),n.push({s:-1,f:25001});var a=n[0],l=n[1],c=0,u=1,h=2;n[0]={s:-1,f:a.f+l.f,l:a,r:l};while(u!=i-1)a=n[n[c].f<n[h].f?c++:h++],l=n[c!=u&&n[c].f<n[h].f?c++:h++],n[u++]={s:-1,f:a.f+l.f,l:a,r:l};var d=s[0].s;for(r=1;r<i;++r)s[r].s>d&&(d=s[r].s);var f=new dy(d+1),p=Vy(n[u-1],f,0);if(p>e){r=0;var m=0,g=p-e,v=1<<g;for(s.sort((function(t,e){return f[e.s]-f[t.s]||t.f-e.f}));r<i;++r){var y=s[r].s;if(!(f[y]>e))break;m+=v-(1<<p-f[y]),f[y]=e}m>>>=g;while(m>0){var x=s[r].s;f[x]<e?m-=1<<e-f[x]++-1:++r}for(;r>=0&&m;--r){var b=s[r].s;f[b]==e&&(--f[b],++m)}p=e}return[new hy(f),p]},Vy=function(t,e,n){return-1==t.s?Math.max(Vy(t.l,e,n+1),Vy(t.r,e,n+1)):e[t.s]=n},jy=function(t){var e=t.length;while(e&&!t[--e]);for(var n=new dy(++e),r=0,i=t[0],s=1,o=function(t){n[r++]=t},a=1;a<=e;++a)if(t[a]==i&&a!=e)++s;else{if(!i&&s>2){for(;s>138;s-=138)o(32754);s>2&&(o(s>10?s-11<<5|28690:s-3<<5|12305),s=0)}else if(s>3){for(o(i),--s;s>6;s-=6)o(8304);s>2&&(o(s-3<<5|8208),s=0)}while(s--)o(i);s=1,i=t[a]}return[n.subarray(0,r),e]},Wy=function(t,e){for(var n=0,r=0;r<e.length;++r)n+=t[r]*e[r];return n},qy=function(t,e,n){var r=n.length,i=zy(e+2);t[i]=255&r,t[i+1]=r>>>8,t[i+2]=255^t[i],t[i+3]=255^t[i+1];for(var s=0;s<r;++s)t[i+s+4]=n[s];return 8*(i+4+r)},Yy=function(t,e,n,r,i,s,o,a,l,c,u){By(e,u++,n),++i[256];for(var h=Hy(i,15),d=h[0],f=h[1],p=Hy(s,15),m=p[0],g=p[1],v=jy(d),y=v[0],x=v[1],b=jy(m),w=b[0],_=b[1],M=new dy(19),A=0;A<y.length;++A)M[31&y[A]]++;for(A=0;A<w.length;++A)M[31&w[A]]++;for(var S=Hy(M,7),E=S[0],T=S[1],C=19;C>4&&!E[gy[C-1]];--C);var R,I,P,L,N=c+5<<3,k=Wy(i,Cy)+Wy(s,Ry)+o,O=Wy(i,d)+Wy(s,m)+o+14+3*C+Wy(M,E)+(2*M[16]+3*M[17]+7*M[18]);if(N<=k&&N<=O)return qy(e,u,t.subarray(l,l+c));if(By(e,u,1+(O<k)),u+=2,O<k){R=Ty(d,f,0),I=d,P=Ty(m,g,0),L=m;var D=Ty(E,T,0);By(e,u,x-257),By(e,u+5,_-1),By(e,u+10,C-4),u+=14;for(A=0;A<C;++A)By(e,u+3*A,E[gy[A]]);u+=3*C;for(var z=[y,w],F=0;F<2;++F){var U=z[F];for(A=0;A<U.length;++A){var B=31&U[A];By(e,u,D[B]),u+=E[B],B>15&&(By(e,u,U[A]>>>5&127),u+=U[A]>>>12)}}}else R=Iy,I=Cy,P=Ly,L=Ry;for(A=0;A<a;++A)if(r[A]>255){B=r[A]>>>18&31;Gy(e,u,R[B+257]),u+=I[B+257],B>7&&(By(e,u,r[A]>>>23&31),u+=py[B]);var G=31&r[A];Gy(e,u,P[G]),u+=L[G],G>3&&(Gy(e,u,r[A]>>>5&8191),u+=my[G])}else Gy(e,u,R[r[A]]),u+=I[r[A]];return Gy(e,u,R[256]),u+I[256]},Xy=new fy([65540,131080,131088,131104,262176,1048704,1048832,2114560,2117632]),Jy=new hy(0),Ky=function(t,e,n,r,i,s){var o=t.length,a=new hy(r+o+5*(1+Math.ceil(o/7e3))+i),l=a.subarray(r,a.length-i),c=0;if(!e||o<8)for(var u=0;u<=o;u+=65535){var h=u+65535;h<o?c=qy(l,c,t.subarray(u,h)):(l[u]=s,c=qy(l,c,t.subarray(u,o)))}else{for(var d=Xy[e-1],f=d>>>13,p=8191&d,m=(1<<n)-1,g=new dy(32768),v=new dy(m+1),y=Math.ceil(n/3),x=2*y,b=function(e){return(t[e]^t[e+1]<<y^t[e+2]<<x)&m},w=new fy(25e3),_=new dy(288),M=new dy(32),A=0,S=0,E=(u=0,0),T=0,C=0;u<o;++u){var R=b(u),I=32767&u,P=v[R];if(g[I]=P,v[R]=I,T<=u){var L=o-u;if((A>7e3||E>24576)&&L>423){c=Yy(t,l,0,w,_,M,S,E,C,u-C,c),E=A=S=0,C=u;for(var N=0;N<286;++N)_[N]=0;for(N=0;N<30;++N)M[N]=0}var k=2,O=0,D=p,z=I-P&32767;if(L>2&&R==b(u-z)){var F=Math.min(f,L)-1,U=Math.min(32767,u),B=Math.min(258,L);while(z<=U&&--D&&I!=P){if(t[u+k]==t[u+k-z]){for(var G=0;G<B&&t[u+G]==t[u+G-z];++G);if(G>k){if(k=G,O=z,G>F)break;var H=Math.min(z,G-2),V=0;for(N=0;N<H;++N){var j=u-z+N+32768&32767,W=g[j],q=j-W+32768&32767;q>V&&(V=q,P=j)}}}I=P,P=g[I],z+=I-P+32768&32767}}if(O){w[E++]=268435456|by[k]<<18|My[O];var Y=31&by[k],X=31&My[O];S+=py[Y]+my[X],++_[257+Y],++M[X],T=u+k,++A}else w[E++]=t[u],++_[t[u]]}}c=Yy(t,l,s,w,_,M,S,E,C,u-C,c),!s&&7&c&&(c=qy(l,c+1,Jy))}return Fy(a,0,r+zy(c)+i)},Zy=function(){for(var t=new fy(256),e=0;e<256;++e){var n=e,r=9;while(--r)n=(1&n&&3988292384)^n>>>1;t[e]=n}return t}(),Qy=function(){var t=-1;return{p:function(e){for(var n=t,r=0;r<e.length;++r)n=Zy[255&n^e[r]]^n>>>8;t=n},d:function(){return~t}}},$y=function(){var t=1,e=0;return{p:function(n){for(var r=t,i=e,s=n.length,o=0;o!=s;){for(var a=Math.min(o+2655,s);o<a;++o)i+=r+=n[o];r=(65535&r)+15*(r>>16),i=(65535&i)+15*(i>>16)}t=r,e=i},d:function(){return t%=65521,e%=65521,(255&t)<<24|t>>>8<<16|(255&e)<<8|e>>>8}}},tx=function(t,e,n,r,i){return Ky(t,null==e.level?6:e.level,null==e.mem?Math.ceil(1.5*Math.max(8,Math.min(13,Math.log(t.length)))):12+e.mem,n,r,!i)},ex=function(t,e){var n={};for(var r in t)n[r]=t[r];for(var r in e)n[r]=e[r];return n},nx=function(t,e,n){for(var r=t(),i=t.toString(),s=i.slice(i.indexOf("[")+1,i.lastIndexOf("]")).replace(/ /g,"").split(","),o=0;o<r.length;++o){var a=r[o],l=s[o];if("function"==typeof a){e+=";"+l+"=";var c=a.toString();if(a.prototype)if(-1!=c.indexOf("[native code]")){var u=c.indexOf(" ",8)+1;e+=c.slice(u,c.indexOf("(",u))}else for(var h in e+=c,a.prototype)e+=";"+l+".prototype."+h+"="+a.prototype[h].toString();else e+=c}else n[l]=a}return[e,n]},rx=[],ix=function(t){var e=[];for(var n in t)(t[n]instanceof hy||t[n]instanceof dy||t[n]instanceof fy)&&e.push((t[n]=new t[n].constructor(t[n])).buffer);return e},sx=function(t,e,n,r){var i;if(!rx[n]){for(var s="",o={},a=t.length-1,l=0;l<a;++l)i=nx(t[l],s,o),s=i[0],o=i[1];rx[n]=nx(t[a],s,o)}var c=ex({},rx[n][1]);return uy(rx[n][0]+";onmessage=function(e){for(var k in e.data)self[k]=e.data[k];onmessage="+e.toString()+"}",n,c,ix(c),r)},ox=function(){return[hy,dy,fy,py,my,gy,xy,_y,Py,Ny,Ay,Ty,ky,Oy,Dy,zy,Fy,Uy,Ox,dx,fx]},ax=function(){return[hy,dy,fy,py,my,gy,by,My,Iy,Cy,Ly,Ry,Ay,Xy,Jy,Ty,By,Gy,Hy,Vy,jy,Wy,qy,Yy,zy,Fy,Ky,tx,Px,dx]},lx=function(){return[wx,Ax,bx,Qy,Zy]},cx=function(){return[_x,Mx]},ux=function(){return[Sx,bx,$y]},hx=function(){return[Ex]},dx=function(t){return postMessage(t,[t.buffer])},fx=function(t){return t&&t.size&&new hy(t.size)},px=function(t,e,n,r,i,s){var o=sx(n,r,i,(function(t,e){o.terminate(),s(t,e)}));return o.postMessage([t,e],e.consume?[t.buffer]:[]),function(){o.terminate()}},mx=function(t){return t.ondata=function(t,e){return postMessage([t,e],[t.buffer])},function(e){return t.push(e.data[0],e.data[1])}},gx=function(t,e,n,r,i){var s,o=sx(t,r,i,(function(t,n){t?(o.terminate(),e.ondata.call(e,t)):(n[1]&&o.terminate(),e.ondata.call(e,t,n[0],n[1]))}));o.postMessage(n),e.push=function(t,n){if(s)throw"stream finished";if(!e.ondata)throw"no stream handler";o.postMessage([t,s=n],[t.buffer])},e.terminate=function(){o.terminate()}},vx=function(t,e){return t[e]|t[e+1]<<8},yx=function(t,e){return(t[e]|t[e+1]<<8|t[e+2]<<16|t[e+3]<<24)>>>0},xx=function(t,e){return yx(t,e)+4294967296*yx(t,e+4)},bx=function(t,e,n){for(;n;++e)t[e]=n,n>>>=8},wx=function(t,e){var n=e.filename;if(t[0]=31,t[1]=139,t[2]=8,t[8]=e.level<2?4:9==e.level?2:0,t[9]=3,0!=e.mtime&&bx(t,4,Math.floor(new Date(e.mtime||Date.now())/1e3)),n){t[3]=8;for(var r=0;r<=n.length;++r)t[r+10]=n.charCodeAt(r)}},_x=function(t){if(31!=t[0]||139!=t[1]||8!=t[2])throw"invalid gzip data";var e=t[3],n=10;4&e&&(n+=t[10]|2+(t[11]<<8));for(var r=(e>>3&1)+(e>>4&1);r>0;r-=!t[n++]);return n+(2&e)},Mx=function(t){var e=t.length;return(t[e-4]|t[e-3]<<8|t[e-2]<<16|t[e-1]<<24)>>>0},Ax=function(t){return 10+(t.filename&&t.filename.length+1||0)},Sx=function(t,e){var n=e.level,r=0==n?0:n<6?1:9==n?3:2;t[0]=120,t[1]=r<<6|(r?32-2*r:1)},Ex=function(t){if(8!=(15&t[0])||t[0]>>>4>7||(t[0]<<8|t[1])%31)throw"invalid zlib data";if(32&t[1])throw"invalid zlib data: preset dictionaries not supported"};function Tx(t,e){return e||"function"!=typeof t||(e=t,t={}),this.ondata=e,t}var Cx=function(){function t(t,e){e||"function"!=typeof t||(e=t,t={}),this.ondata=e,this.o=t||{}}return t.prototype.p=function(t,e){this.ondata(tx(t,this.o,0,0,!e),e)},t.prototype.push=function(t,e){if(this.d)throw"stream finished";if(!this.ondata)throw"no stream handler";this.d=e,this.p(t,e||!1)},t}(),Rx=function(){function t(t,e){gx([ax,function(){return[mx,Cx]}],this,Tx.call(this,t,e),(function(t){var e=new Cx(t.data);onmessage=mx(e)}),6)}return t}();function Ix(t,e,n){if(n||(n=e,e={}),"function"!=typeof n)throw"no callback";return px(t,e,[ax],(function(t){return dx(Px(t.data[0],t.data[1]))}),0,n)}function Px(t,e){return tx(t,e||{},0,0)}var Lx=function(){function t(t){this.s={},this.p=new hy(0),this.ondata=t}return t.prototype.e=function(t){if(this.d)throw"stream finished";if(!this.ondata)throw"no stream handler";var e=this.p.length,n=new hy(e+t.length);n.set(this.p),n.set(t,e),this.p=n},t.prototype.c=function(t){this.d=this.s.i=t||!1;var e=this.s.b,n=Uy(this.p,this.o,this.s);this.ondata(Fy(n,e,this.s.b),this.d),this.o=Fy(n,this.s.b-32768),this.s.b=this.o.length,this.p=Fy(this.p,this.s.p/8|0),this.s.p&=7},t.prototype.push=function(t,e){this.e(t),this.c(e)},t}(),Nx=function(){function t(t){this.ondata=t,gx([ox,function(){return[mx,Lx]}],this,0,(function(){var t=new Lx;onmessage=mx(t)}),7)}return t}();function kx(t,e,n){if(n||(n=e,e={}),"function"!=typeof n)throw"no callback";return px(t,e,[ox],(function(t){return dx(Ox(t.data[0],fx(t.data[1])))}),1,n)}function Ox(t,e){return Uy(t,e)}var Dx=function(){function t(t,e){this.c=Qy(),this.l=0,this.v=1,Cx.call(this,t,e)}return t.prototype.push=function(t,e){Cx.prototype.push.call(this,t,e)},t.prototype.p=function(t,e){this.c.p(t),this.l+=t.length;var n=tx(t,this.o,this.v&&Ax(this.o),e&&8,!e);this.v&&(wx(n,this.o),this.v=0),e&&(bx(n,n.length-8,this.c.d()),bx(n,n.length-4,this.l)),this.ondata(n,e)},t}(),zx=function(){function t(t,e){gx([ax,lx,function(){return[mx,Cx,Dx]}],this,Tx.call(this,t,e),(function(t){var e=new Dx(t.data);onmessage=mx(e)}),8)}return t}();function Fx(t,e,n){if(n||(n=e,e={}),"function"!=typeof n)throw"no callback";return px(t,e,[ax,lx,function(){return[Ux]}],(function(t){return dx(Ux(t.data[0],t.data[1]))}),2,n)}function Ux(t,e){e||(e={});var n=Qy(),r=t.length;n.p(t);var i=tx(t,e,Ax(e),8),s=i.length;return wx(i,e),bx(i,s-8,n.d()),bx(i,s-4,r),i}var Bx=function(){function t(t){this.v=1,Lx.call(this,t)}return t.prototype.push=function(t,e){if(Lx.prototype.e.call(this,t),this.v){var n=this.p.length>3?_x(this.p):4;if(n>=this.p.length&&!e)return;this.p=this.p.subarray(n),this.v=0}if(e){if(this.p.length<8)throw"invalid gzip stream";this.p=this.p.subarray(0,-8)}Lx.prototype.c.call(this,e)},t}(),Gx=function(){function t(t){this.ondata=t,gx([ox,cx,function(){return[mx,Lx,Bx]}],this,0,(function(){var t=new Bx;onmessage=mx(t)}),9)}return t}();function Hx(t,e,n){if(n||(n=e,e={}),"function"!=typeof n)throw"no callback";return px(t,e,[ox,cx,function(){return[Vx]}],(function(t){return dx(Vx(t.data[0]))}),3,n)}function Vx(t,e){return Uy(t.subarray(_x(t),-8),e||new hy(Mx(t)))}var jx=function(){function t(t,e){this.c=$y(),this.v=1,Cx.call(this,t,e)}return t.prototype.push=function(t,e){Cx.prototype.push.call(this,t,e)},t.prototype.p=function(t,e){this.c.p(t);var n=tx(t,this.o,this.v&&2,e&&4,!e);this.v&&(Sx(n,this.o),this.v=0),e&&bx(n,n.length-4,this.c.d()),this.ondata(n,e)},t}(),Wx=function(){function t(t,e){gx([ax,ux,function(){return[mx,Cx,jx]}],this,Tx.call(this,t,e),(function(t){var e=new jx(t.data);onmessage=mx(e)}),10)}return t}();function qx(t,e,n){if(n||(n=e,e={}),"function"!=typeof n)throw"no callback";return px(t,e,[ax,ux,function(){return[Yx]}],(function(t){return dx(Yx(t.data[0],t.data[1]))}),4,n)}function Yx(t,e){e||(e={});var n=$y();n.p(t);var r=tx(t,e,2,4);return Sx(r,e),bx(r,r.length-4,n.d()),r}var Xx=function(){function t(t){this.v=1,Lx.call(this,t)}return t.prototype.push=function(t,e){if(Lx.prototype.e.call(this,t),this.v){if(this.p.length<2&&!e)return;this.p=this.p.subarray(2),this.v=0}if(e){if(this.p.length<4)throw"invalid zlib stream";this.p=this.p.subarray(0,-4)}Lx.prototype.c.call(this,e)},t}(),Jx=function(){function t(t){this.ondata=t,gx([ox,hx,function(){return[mx,Lx,Xx]}],this,0,(function(){var t=new Xx;onmessage=mx(t)}),11)}return t}();function Kx(t,e,n){if(n||(n=e,e={}),"function"!=typeof n)throw"no callback";return px(t,e,[ox,hx,function(){return[Zx]}],(function(t){return dx(Zx(t.data[0],fx(t.data[1])))}),5,n)}function Zx(t,e){return Uy((Ex(t),t.subarray(2,-4)),e)}var Qx=function(){function t(t){this.G=Bx,this.I=Lx,this.Z=Xx,this.ondata=t}return t.prototype.push=function(t,e){if(!this.ondata)throw"no stream handler";if(this.s)this.s.push(t,e);else{if(this.p&&this.p.length){var n=new hy(this.p.length+t.length);n.set(this.p),n.set(t,this.p.length)}else this.p=t;if(this.p.length>2){var r=this,i=function(){r.ondata.apply(r,arguments)};this.s=31==this.p[0]&&139==this.p[1]&&8==this.p[2]?new this.G(i):8!=(15&this.p[0])||this.p[0]>>4>7||(this.p[0]<<8|this.p[1])%31?new this.I(i):new this.Z(i),this.s.push(this.p,e),this.p=null}}},t}(),$x=function(){function t(t){this.G=Gx,this.I=Nx,this.Z=Jx,this.ondata=t}return t.prototype.push=function(t,e){Qx.prototype.push.call(this,t,e)},t}();function tb(t,e,n){if(n||(n=e,e={}),"function"!=typeof n)throw"no callback";return 31==t[0]&&139==t[1]&&8==t[2]?Hx(t,e,n):8!=(15&t[0])||t[0]>>4>7||(t[0]<<8|t[1])%31?kx(t,e,n):Kx(t,e,n)}function eb(t,e){return 31==t[0]&&139==t[1]&&8==t[2]?Vx(t,e):8!=(15&t[0])||t[0]>>4>7||(t[0]<<8|t[1])%31?Ox(t,e):Zx(t,e)}var nb=function(t,e,n,r){for(var i in t){var s=t[i],o=e+i;s instanceof hy?n[o]=[s,r]:Array.isArray(s)?n[o]=[s[0],ex(r,s[1])]:nb(s,o+"/",n,r)}},rb="undefined"!=typeof TextEncoder&&new TextEncoder,ib="undefined"!=typeof TextDecoder&&new TextDecoder,sb=0;try{ib.decode(Jy,{stream:!0}),sb=1}catch(v_){}var ob=function(t){for(var e="",n=0;;){var r=t[n++],i=(r>127)+(r>223)+(r>239);if(n+i>t.length)return[e,Fy(t,n-1)];i?3==i?(r=((15&r)<<18|(63&t[n++])<<12|(63&t[n++])<<6|63&t[n++])-65536,e+=String.fromCharCode(55296|r>>10,56320|1023&r)):e+=1&i?String.fromCharCode((31&r)<<6|63&t[n++]):String.fromCharCode((15&r)<<12|(63&t[n++])<<6|63&t[n++]):e+=String.fromCharCode(r)}},ab=function(){function t(t){this.ondata=t,sb?this.t=new TextDecoder:this.p=Jy}return t.prototype.push=function(t,e){if(!this.ondata)throw"no callback";if(e=!!e,this.t){if(this.ondata(this.t.decode(t,{stream:!0}),e),e){if(this.t.decode().length)throw"invalid utf-8 data";this.t=null}}else{if(!this.p)throw"stream finished";var n=new hy(this.p.length+t.length);n.set(this.p),n.set(t,this.p.length);var r=ob(n),i=r[0],s=r[1];if(e){if(s.length)throw"invalid utf-8 data";this.p=null}else this.p=s;this.ondata(i,e)}},t}(),lb=function(){function t(t){this.ondata=t}return t.prototype.push=function(t,e){if(!this.ondata)throw"no callback";if(this.d)throw"stream finished";this.ondata(cb(t),this.d=e||!1)},t}();function cb(t,e){if(e){for(var n=new hy(t.length),r=0;r<t.length;++r)n[r]=t.charCodeAt(r);return n}if(rb)return rb.encode(t);var i=t.length,s=new hy(t.length+(t.length>>1)),o=0,a=function(t){s[o++]=t};for(r=0;r<i;++r){if(o+5>s.length){var l=new hy(o+8+(i-r<<1));l.set(s),s=l}var c=t.charCodeAt(r);c<128||e?a(c):c<2048?(a(192|c>>6),a(128|63&c)):c>55295&&c<57344?(c=65536+(1047552&c)|1023&t.charCodeAt(++r),a(240|c>>18),a(128|c>>12&63),a(128|c>>6&63),a(128|63&c)):(a(224|c>>12),a(128|c>>6&63),a(128|63&c))}return Fy(s,0,o)}function ub(t,e){if(e){for(var n="",r=0;r<t.length;r+=16384)n+=String.fromCharCode.apply(null,t.subarray(r,r+16384));return n}if(ib)return ib.decode(t);var i=ob(t),s=i[0],o=i[1];if(o.length)throw"invalid utf-8 data";return s}var hb=function(t){return 1==t?3:t<6?2:9==t?1:0},db=function(t,e){return e+30+vx(t,e+26)+vx(t,e+28)},fb=function(t,e,n){var r=vx(t,e+28),i=ub(t.subarray(e+46,e+46+r),!(2048&vx(t,e+8))),s=e+46+r,o=yx(t,e+20),a=n&&4294967295==o?pb(t,s):[o,yx(t,e+24),yx(t,e+42)],l=a[0],c=a[1],u=a[2];return[vx(t,e+10),l,c,i,s+vx(t,e+30)+vx(t,e+32),u]},pb=function(t,e){for(;1!=vx(t,e);e+=4+vx(t,e+2));return[xx(t,e+12),xx(t,e+4),xx(t,e+20)]},mb=function(t){var e=0;if(t)for(var n in t){var r=t[n].length;if(r>65535)throw"extra field too long";e+=r+4}return e},gb=function(t,e,n,r,i,s,o,a){var l=r.length,c=n.extra,u=a&&a.length,h=mb(c);bx(t,e,null!=o?33639248:67324752),e+=4,null!=o&&(t[e++]=20,t[e++]=n.os),t[e]=20,e+=2,t[e++]=n.flag<<1|(null==s&&8),t[e++]=i&&8,t[e++]=255&n.compression,t[e++]=n.compression>>8;var d=new Date(null==n.mtime?Date.now():n.mtime),f=d.getFullYear()-1980;if(f<0||f>119)throw"date not in range 1980-2099";if(bx(t,e,f<<25|d.getMonth()+1<<21|d.getDate()<<16|d.getHours()<<11|d.getMinutes()<<5|d.getSeconds()>>>1),e+=4,null!=s&&(bx(t,e,n.crc),bx(t,e+4,s),bx(t,e+8,n.size)),bx(t,e+12,l),bx(t,e+14,h),e+=16,null!=o&&(bx(t,e,u),bx(t,e+6,n.attrs),bx(t,e+10,o),e+=14),t.set(r,e),e+=l,h)for(var p in c){var m=c[p],g=m.length;bx(t,e,+p),bx(t,e+2,g),t.set(m,e+4),e+=4+g}return u&&(t.set(a,e),e+=u),e},vb=function(t,e,n,r,i){bx(t,e,101010256),bx(t,e+8,n),bx(t,e+10,n),bx(t,e+12,r),bx(t,e+16,i)},yb=function(){function t(t){this.filename=t,this.c=Qy(),this.size=0,this.compression=0}return t.prototype.process=function(t,e){this.ondata(null,t,e)},t.prototype.push=function(t,e){if(!this.ondata)throw"no callback - add to ZIP archive before pushing";this.c.p(t),this.size+=t.length,e&&(this.crc=this.c.d()),this.process(t,e||!1)},t}(),xb=function(){function t(t,e){var n=this;e||(e={}),yb.call(this,t),this.d=new Cx(e,(function(t,e){n.ondata(null,t,e)})),this.compression=8,this.flag=hb(e.level)}return t.prototype.process=function(t,e){try{this.d.push(t,e)}catch(v_){this.ondata(v_,null,e)}},t.prototype.push=function(t,e){yb.prototype.push.call(this,t,e)},t}(),bb=function(){function t(t,e){var n=this;e||(e={}),yb.call(this,t),this.d=new Rx(e,(function(t,e,r){n.ondata(t,e,r)})),this.compression=8,this.flag=hb(e.level),this.terminate=this.d.terminate}return t.prototype.process=function(t,e){this.d.push(t,e)},t.prototype.push=function(t,e){yb.prototype.push.call(this,t,e)},t}(),wb=function(){function t(t){this.ondata=t,this.u=[],this.d=1}return t.prototype.add=function(t){var e=this;if(2&this.d)throw"stream finished";var n=cb(t.filename),r=n.length,i=t.comment,s=i&&cb(i),o=r!=t.filename.length||s&&i.length!=s.length,a=r+mb(t.extra)+30;if(r>65535)throw"filename too long";var l=new hy(a);gb(l,0,t,n,o);var c=[l],u=function(){for(var t=0,n=c;t<n.length;t++){var r=n[t];e.ondata(null,r,!1)}c=[]},h=this.d;this.d=0;var d=this.u.length,f=ex(t,{f:n,u:o,o:s,t:function(){t.terminate&&t.terminate()},r:function(){if(u(),h){var t=e.u[d+1];t?t.r():e.d=1}h=1}}),p=0;t.ondata=function(n,r,i){if(n)e.ondata(n,r,i),e.terminate();else if(p+=r.length,c.push(r),i){var s=new hy(16);bx(s,0,134695760),bx(s,4,t.crc),bx(s,8,p),bx(s,12,t.size),c.push(s),f.c=p,f.b=a+p+16,f.crc=t.crc,f.size=t.size,h&&f.r(),h=1}else h&&u()},this.u.push(f)},t.prototype.end=function(){var t=this;if(2&this.d){if(1&this.d)throw"stream finishing";throw"stream finished"}this.d?this.e():this.u.push({r:function(){1&t.d&&(t.u.splice(-1,1),t.e())},t:function(){}}),this.d=3},t.prototype.e=function(){for(var t=0,e=0,n=0,r=0,i=this.u;r<i.length;r++){var s=i[r];n+=46+s.f.length+mb(s.extra)+(s.o?s.o.length:0)}for(var o=new hy(n+22),a=0,l=this.u;a<l.length;a++){s=l[a];gb(o,t,s,s.f,s.u,s.c,e,s.o),t+=46+s.f.length+mb(s.extra)+(s.o?s.o.length:0),e+=s.b}vb(o,t,this.u.length,n,e),this.ondata(null,o,!0),this.d=2},t.prototype.terminate=function(){for(var t=0,e=this.u;t<e.length;t++){var n=e[t];n.t()}this.d=2},t}();function _b(t,e,n){if(n||(n=e,e={}),"function"!=typeof n)throw"no callback";var r={};nb(t,"",r,e);var i=Object.keys(r),s=i.length,o=0,a=0,l=s,c=new Array(s),u=[],h=function(){for(var t=0;t<u.length;++t)u[t]()},d=function(){var t=new hy(a+22),e=o,r=a-o;a=0;for(var i=0;i<l;++i){var s=c[i];try{var u=s.c.length;gb(t,a,s,s.f,s.u,u);var h=30+s.f.length+mb(s.extra),d=a+h;t.set(s.c,d),gb(t,o,s,s.f,s.u,u,a,s.m),o+=16+h+(s.m?s.m.length:0),a=d+u}catch(v_){return n(v_,null)}}vb(t,o,c.length,r,e),n(null,t)};s||d();for(var f=function(t){var e=i[t],l=r[e],f=l[0],p=l[1],m=Qy(),g=f.length;m.p(f);var v=cb(e),y=v.length,x=p.comment,b=x&&cb(x),w=b&&b.length,_=mb(p.extra),M=0==p.level?0:8,A=function(r,i){if(r)h(),n(r,null);else{var l=i.length;c[t]=ex(p,{size:g,crc:m.d(),c:i,f:v,m:b,u:y!=e.length||b&&x.length!=w,compression:M}),o+=30+y+_+l,a+=76+2*(y+_)+(w||0)+l,--s||d()}};if(y>65535&&A("filename too long",null),M)if(g<16e4)try{A(null,Px(f,p))}catch(v_){A(v_,null)}else u.push(Ix(f,p,A));else A(null,f)},p=0;p<l;++p)f(p);return h}function Mb(t,e){e||(e={});var n={},r=[];nb(t,"",n,e);var i=0,s=0;for(var o in n){var a=n[o],l=a[0],c=a[1],u=0==c.level?0:8,h=cb(o),d=h.length,f=c.comment,p=f&&cb(f),m=p&&p.length,g=mb(c.extra);if(d>65535)throw"filename too long";var v=u?Px(l,c):l,y=v.length,x=Qy();x.p(l),r.push(ex(c,{size:l.length,crc:x.d(),c:v,f:h,m:p,u:d!=o.length||p&&f.length!=m,o:i,compression:u})),i+=30+d+g+y,s+=76+2*(d+g)+(m||0)+y}for(var b=new hy(s+22),w=i,_=s-i,M=0;M<r.length;++M){h=r[M];gb(b,h.o,h,h.f,h.u,h.c.length);var A=30+h.f.length+mb(h.extra);b.set(h.c,h.o+A),gb(b,i,h,h.f,h.u,h.c.length,h.o,h.m),i+=16+A+(h.m?h.m.length:0)}return vb(b,i,r.length,_,w),b}var Ab=function(){function t(){}return t.prototype.push=function(t,e){this.ondata(null,t,e)},t.compression=0,t}(),Sb=function(){function t(){var t=this;this.i=new Lx((function(e,n){t.ondata(null,e,n)}))}return t.prototype.push=function(t,e){try{this.i.push(t,e)}catch(v_){this.ondata(v_,t,e)}},t.compression=8,t}(),Eb=function(){function t(t,e){var n=this;e<32e4?this.i=new Lx((function(t,e){n.ondata(null,t,e)})):(this.i=new Nx((function(t,e,r){n.ondata(t,e,r)})),this.terminate=this.i.terminate)}return t.prototype.push=function(t,e){this.i.terminate&&(t=Fy(t,0)),this.i.push(t,e)},t.compression=8,t}(),Tb=function(){function t(t){this.onfile=t,this.k=[],this.o={0:Ab},this.p=Jy}return t.prototype.push=function(t,e){var n=this;if(!this.onfile)throw"no callback";if(!this.p)throw"stream finished";if(this.c>0){var r=Math.min(this.c,t.length),i=t.subarray(0,r);if(this.c-=r,this.d?this.d.push(i,!this.c):this.k[0].push(i),t=t.subarray(r),t.length)return this.push(t,e)}else{var s=0,o=0,a=void 0,l=void 0;this.p.length?t.length?(l=new hy(this.p.length+t.length),l.set(this.p),l.set(t,this.p.length)):l=this.p:l=t;for(var c=l.length,u=this.c,h=u&&this.d,d=function(){var t,e=yx(l,o);if(67324752==e){s=1,a=o,f.d=null,f.c=0;var r=vx(l,o+6),i=vx(l,o+8),h=2048&r,d=8&r,p=vx(l,o+26),m=vx(l,o+28);if(c>o+30+p+m){var g=[];f.k.unshift(g),s=2;var v,y=yx(l,o+18),x=yx(l,o+22),b=ub(l.subarray(o+30,o+=30+p),!h);4294967295==y?(t=d?[-2]:pb(l,o),y=t[0],x=t[1]):d&&(y=-1),o+=m,f.c=y;var w={name:b,compression:i,start:function(){if(!w.ondata)throw"no callback";if(y){var t=n.o[i];if(!t)throw"unknown compression type "+i;v=y<0?new t(b):new t(b,y,x),v.ondata=function(t,e,n){w.ondata(t,e,n)};for(var e=0,r=g;e<r.length;e++){var s=r[e];v.push(s,!1)}n.k[0]==g&&n.c?n.d=v:v.push(Jy,!0)}else w.ondata(null,Jy,!0)},terminate:function(){v&&v.terminate&&v.terminate()}};y>=0&&(w.size=y,w.originalSize=x),f.onfile(w)}return"break"}if(u){if(134695760==e)return a=o+=12+(-2==u&&8),s=3,f.c=0,"break";if(33639248==e)return a=o-=4,s=3,f.c=0,"break"}},f=this;o<c-4;++o){var p=d();if("break"===p)break}if(this.p=Jy,u<0){var m=s?l.subarray(0,a-12-(-2==u&&8)-(134695760==yx(l,a-16)&&4)):l.subarray(0,o);h?h.push(m,!!s):this.k[+(2==s)].push(m)}if(2&s)return this.push(l.subarray(o),e);this.p=l.subarray(o)}if(e){if(this.c)throw"invalid zip file";this.p=null}},t.prototype.register=function(t){this.o[t.compression]=t},t}();function Cb(t,e){if("function"!=typeof e)throw"no callback";for(var n=[],r=function(){for(var t=0;t<n.length;++t)n[t]()},i={},s=t.length-22;101010256!=yx(t,s);--s)if(!s||t.length-s>65558)return void e("invalid zip file",null);var o=vx(t,s+8);o||e(null,{});var a=o,l=yx(t,s+16),c=4294967295==l;if(c){if(s=yx(t,s-12),101075792!=yx(t,s))return void e("invalid zip file",null);a=o=yx(t,s+32),l=yx(t,s+48)}for(var u=function(s){var a=fb(t,l,c),u=a[0],h=a[1],d=a[2],f=a[3],p=a[4],m=a[5],g=db(t,m);l=p;var v=function(t,n){t?(r(),e(t,null)):(i[f]=n,--o||e(null,i))};if(u)if(8==u){var y=t.subarray(g,g+h);if(h<32e4)try{v(null,Ox(y,new hy(d)))}catch(x){v(x,null)}else n.push(kx(y,{size:d},v))}else v("unknown compression type "+u,null);else v(null,Fy(t,g,g+h))},h=0;h<a;++h)u();return r}function Rb(t){for(var e={},n=t.length-22;101010256!=yx(t,n);--n)if(!n||t.length-n>65558)throw"invalid zip file";var r=vx(t,n+8);if(!r)return{};var i=yx(t,n+16),s=4294967295==i;if(s){if(n=yx(t,n-12),101075792!=yx(t,n))throw"invalid zip file";r=yx(t,n+32),i=yx(t,n+48)}for(var o=0;o<r;++o){var a=fb(t,i,s),l=a[0],c=a[1],u=a[2],h=a[3],d=a[4],f=a[5],p=db(t,f);if(i=d,l){if(8!=l)throw"unknown compression type "+l;e[h]=Ox(t.subarray(p,p+c),new hy(u))}else e[h]=Fy(t,p,p+c)}return e}var Ib=Object.freeze(Object.defineProperty({__proto__:null,Deflate:Cx,AsyncDeflate:Rx,deflate:Ix,deflateSync:Px,Inflate:Lx,AsyncInflate:Nx,inflate:kx,inflateSync:Ox,Gzip:Dx,AsyncGzip:zx,gzip:Fx,gzipSync:Ux,Gunzip:Bx,AsyncGunzip:Gx,gunzip:Hx,gunzipSync:Vx,Zlib:jx,AsyncZlib:Wx,zlib:qx,zlibSync:Yx,Unzlib:Xx,AsyncUnzlib:Jx,unzlib:Kx,unzlibSync:Zx,compress:Fx,AsyncCompress:zx,compressSync:Ux,Compress:Dx,Decompress:Qx,AsyncDecompress:$x,decompress:tb,decompressSync:eb,DecodeUTF8:ab,EncodeUTF8:lb,strToU8:cb,strFromU8:ub,ZipPassThrough:yb,ZipDeflate:xb,AsyncZipDeflate:bb,Zip:wb,zip:_b,zipSync:Mb,UnzipPassThrough:Ab,UnzipInflate:Sb,AsyncUnzipInflate:Eb,Unzip:Tb,unzip:Cb,unzipSync:Rb},Symbol.toStringTag,{value:"Module"}));function Pb(t,e,n){const r=n.length-t-1;if(e>=n[r])return r-1;if(e<=n[t])return t;let i=t,s=r,o=Math.floor((i+s)/2);while(e<n[o]||e>=n[o+1])e<n[o]?s=o:i=o,o=Math.floor((i+s)/2);return o}function Lb(t,e,n,r){const i=[],s=[],o=[];i[0]=1;for(let a=1;a<=n;++a){s[a]=e-r[t+1-a],o[a]=r[t+a]-e;let n=0;for(let t=0;t<a;++t){const e=o[t+1],r=s[a-t],l=i[t]/(e+r);i[t]=n+e*l,n=r*l}i[a]=n}return i}function Nb(t,e,n,r){const i=Pb(t,r,e),s=Lb(i,r,t,e),o=new mr(0,0,0,0);for(let a=0;a<=t;++a){const e=n[i-t+a],r=s[a],l=e.w*r;o.x+=e.x*l,o.y+=e.y*l,o.z+=e.z*l,o.w+=e.w*r}return o}function kb(t,e,n,r,i){const s=[];for(let h=0;h<=n;++h)s[h]=0;const o=[];for(let h=0;h<=r;++h)o[h]=s.slice(0);const a=[];for(let h=0;h<=n;++h)a[h]=s.slice(0);a[0][0]=1;const l=s.slice(0),c=s.slice(0);for(let h=1;h<=n;++h){l[h]=e-i[t+1-h],c[h]=i[t+h]-e;let n=0;for(let t=0;t<h;++t){const e=c[t+1],r=l[h-t];a[h][t]=e+r;const i=a[t][h-1]/a[h][t];a[t][h]=n+e*i,n=r*i}a[h][h]=n}for(let h=0;h<=n;++h)o[0][h]=a[h][n];for(let h=0;h<=n;++h){let t=0,e=1;const i=[];for(let r=0;r<=n;++r)i[r]=s.slice(0);i[0][0]=1;for(let s=1;s<=r;++s){let r=0;const l=h-s,c=n-s;h>=s&&(i[e][0]=i[t][0]/a[c+1][l],r=i[e][0]*a[l][c]);const u=l>=-1?1:-l,d=h-1<=c?s-1:n-h;for(let n=u;n<=d;++n)i[e][n]=(i[t][n]-i[t][n-1])/a[c+1][l+n],r+=i[e][n]*a[l+n][c];h<=c&&(i[e][s]=-i[t][s-1]/a[c+1][h],r+=i[e][s]*a[h][c]),o[s][h]=r;const f=t;t=e,e=f}}let u=n;for(let h=1;h<=r;++h){for(let t=0;t<=n;++t)o[h][t]*=u;u*=n-h}return o}function Ob(t,e,n,r,i){const s=i<t?i:t,o=[],a=Pb(t,r,e),l=kb(a,r,t,s,e),c=[];for(let u=0;u<n.length;++u){const t=n[u].clone(),e=t.w;t.x*=e,t.y*=e,t.z*=e,c[u]=t}for(let u=0;u<=s;++u){const e=c[a-t].clone().multiplyScalar(l[u][0]);for(let n=1;n<=t;++n)e.add(c[a-t+n].clone().multiplyScalar(l[u][n]));o[u]=e}for(let u=s+1;u<=i+1;++u)o[u]=new mr(0,0,0);return o}function Db(t,e){let n=1;for(let i=2;i<=t;++i)n*=i;let r=1;for(let i=2;i<=e;++i)r*=i;for(let i=2;i<=t-e;++i)r*=i;return n/r}function zb(t){const e=t.length,n=[],r=[];for(let s=0;s<e;++s){const e=t[s];n[s]=new Mr(e.x,e.y,e.z),r[s]=e.w}const i=[];for(let s=0;s<e;++s){const t=n[s].clone();for(let e=1;e<=s;++e)t.sub(i[s-e].clone().multiplyScalar(Db(s,e)*r[e]));i[s]=t.divideScalar(r[0])}return i}function Fb(t,e,n,r,i){const s=Ob(t,e,n,r,i);return zb(s)}class Ub extends kd{constructor(t,e,n,r,i){super(),this.degree=t,this.knots=e,this.controlPoints=[],this.startKnot=r||0,this.endKnot=i||this.knots.length-1;for(let s=0;s<n.length;++s){const t=n[s];this.controlPoints[s]=new mr(t.x,t.y,t.z,t.w)}}getPoint(t,e=new Mr){const n=e,r=this.knots[this.startKnot]+t*(this.knots[this.endKnot]-this.knots[this.startKnot]),i=Nb(this.degree,this.knots,this.controlPoints,r);return 1!==i.w&&i.divideScalar(i.w),n.set(i.x,i.y,i.z)}getTangent(t,e=new Mr){const n=e,r=this.knots[0]+t*(this.knots[this.knots.length-1]-this.knots[0]),i=Fb(this.degree,this.knots,this.controlPoints,r,1);return n.copy(i[1]).normalize(),n}}let Bb,Gb,Hb;class Vb extends Kp{constructor(t){super(t)}load(t,e,n,r){const i=this,s=""===i.path?Sm.extractUrlBase(t):i.path,o=new Qp(this.manager);o.setPath(i.path),o.setResponseType("arraybuffer"),o.setRequestHeader(i.requestHeader),o.setWithCredentials(i.withCredentials),o.load(t,(function(n){try{e(i.parse(n,s))}catch(v_){r?r(v_):console.error(v_),i.manager.itemError(t)}}),n,r)}parse(t,e){if(Zb(t))Bb=(new Xb).parse(t);else{const e=lw(t);if(!Qb(e))throw new Error("THREE.FBXLoader: Unknown format.");if($b(e)<7e3)throw new Error("THREE.FBXLoader: FBX version not supported, FileVersion: "+$b(e));Bb=(new Yb).parse(e)}const n=new im(this.manager).setPath(this.resourcePath||e).setCrossOrigin(this.crossOrigin);return new jb(n,this.manager).parse(Bb)}}class jb{constructor(t,e){this.textureLoader=t,this.manager=e}parse(){Gb=this.parseConnections();const t=this.parseImages(),e=this.parseTextures(t),n=this.parseMaterials(e),r=this.parseDeformers(),i=(new Wb).parse(r);return this.parseScene(r,i,n),Hb}parseConnections(){const t=new Map;if("Connections"in Bb){const e=Bb.Connections.connections;e.forEach((function(e){const n=e[0],r=e[1],i=e[2];t.has(n)||t.set(n,{parents:[],children:[]});const s={ID:r,relationship:i};t.get(n).parents.push(s),t.has(r)||t.set(r,{parents:[],children:[]});const o={ID:n,relationship:i};t.get(r).children.push(o)}))}return t}parseImages(){const t={},e={};if("Video"in Bb.Objects){const n=Bb.Objects.Video;for(const r in n){const i=n[r],s=parseInt(r);if(t[s]=i.RelativeFilename||i.Filename,"Content"in i){const t=i.Content instanceof ArrayBuffer&&i.Content.byteLength>0,s="string"===typeof i.Content&&""!==i.Content;if(t||s){const t=this.parseImage(n[r]);e[i.RelativeFilename||i.Filename]=t}}}}for(const n in t){const r=t[n];void 0!==e[r]?t[n]=e[r]:t[n]=t[n].split("\\").pop()}return t}parseImage(t){const e=t.Content,n=t.RelativeFilename||t.Filename,r=n.slice(n.lastIndexOf(".")+1).toLowerCase();let i;switch(r){case"bmp":i="image/bmp";break;case"jpg":case"jpeg":i="image/jpeg";break;case"png":i="image/png";break;case"tif":i="image/tiff";break;case"tga":null===this.manager.getHandler(".tga")&&console.warn("FBXLoader: TGA loader not found, skipping ",n),i="image/tga";break;default:return void console.warn('FBXLoader: Image type "'+r+'" is not supported.')}if("string"===typeof e)return"data:"+i+";base64,"+e;{const t=new Uint8Array(e);return window.URL.createObjectURL(new Blob([t],{type:i}))}}parseTextures(t){const e=new Map;if("Texture"in Bb.Objects){const n=Bb.Objects.Texture;for(const r in n){const i=this.parseTexture(n[r],t);e.set(parseInt(r),i)}}return e}parseTexture(t,e){const n=this.loadTexture(t,e);n.ID=t.id,n.name=t.attrName;const r=t.WrapModeU,i=t.WrapModeV,s=void 0!==r?r.value:0,o=void 0!==i?i.value:0;if(n.wrapS=0===s?dt:ft,n.wrapT=0===o?dt:ft,"Scaling"in t){const e=t.Scaling.value;n.repeat.x=e[0],n.repeat.y=e[1]}if("Translation"in t){const e=t.Translation.value;n.offset.x=e[0],n.offset.y=e[1]}return n}loadTexture(t,e){let n;const r=this.textureLoader.path,i=Gb.get(t.id).children;let s;void 0!==i&&i.length>0&&void 0!==e[i[0].ID]&&(n=e[i[0].ID],0!==n.indexOf("blob:")&&0!==n.indexOf("data:")||this.textureLoader.setPath(void 0));const o=t.FileName.slice(-3).toLowerCase();if("tga"===o){const e=this.manager.getHandler(".tga");null===e?(console.warn("FBXLoader: TGA loader not found, creating placeholder texture for",t.RelativeFilename),s=new pr):(e.setPath(this.textureLoader.path),s=e.load(n))}else"psd"===o?(console.warn("FBXLoader: PSD textures are not supported, creating placeholder texture for",t.RelativeFilename),s=new pr):s=this.textureLoader.load(n);return this.textureLoader.setPath(r),s}parseMaterials(t){const e=new Map;if("Material"in Bb.Objects){const n=Bb.Objects.Material;for(const r in n){const i=this.parseMaterial(n[r],t);null!==i&&e.set(parseInt(r),i)}}return e}parseMaterial(t,e){const n=t.id,r=t.attrName;let i=t.ShadingModel;if("object"===typeof i&&(i=i.value),!Gb.has(n))return null;const s=this.parseParameters(t,e,n);let o;switch(i.toLowerCase()){case"phong":o=new Ap;break;case"lambert":o=new Tp;break;default:console.warn('THREE.FBXLoader: unknown material type "%s". Defaulting to MeshPhongMaterial.',i),o=new Ap;break}return o.setValues(s),o.name=r,o}parseParameters(t,e,n){const r={};t.BumpFactor&&(r.bumpScale=t.BumpFactor.value),t.Diffuse?r.color=(new lr).fromArray(t.Diffuse.value):!t.DiffuseColor||"Color"!==t.DiffuseColor.type&&"ColorRGB"!==t.DiffuseColor.type||(r.color=(new lr).fromArray(t.DiffuseColor.value)),t.DisplacementFactor&&(r.displacementScale=t.DisplacementFactor.value),t.Emissive?r.emissive=(new lr).fromArray(t.Emissive.value):!t.EmissiveColor||"Color"!==t.EmissiveColor.type&&"ColorRGB"!==t.EmissiveColor.type||(r.emissive=(new lr).fromArray(t.EmissiveColor.value)),t.EmissiveFactor&&(r.emissiveIntensity=parseFloat(t.EmissiveFactor.value)),t.Opacity&&(r.opacity=parseFloat(t.Opacity.value)),r.opacity<1&&(r.transparent=!0),t.ReflectionFactor&&(r.reflectivity=t.ReflectionFactor.value),t.Shininess&&(r.shininess=t.Shininess.value),t.Specular?r.specular=(new lr).fromArray(t.Specular.value):t.SpecularColor&&"Color"===t.SpecularColor.type&&(r.specular=(new lr).fromArray(t.SpecularColor.value));const i=this;return Gb.get(n).children.forEach((function(t){const n=t.relationship;switch(n){case"Bump":r.bumpMap=i.getTexture(e,t.ID);break;case"Maya|TEX_ao_map":r.aoMap=i.getTexture(e,t.ID);break;case"DiffuseColor":case"Maya|TEX_color_map":r.map=i.getTexture(e,t.ID),void 0!==r.map&&(r.map.encoding=Oe);break;case"DisplacementColor":r.displacementMap=i.getTexture(e,t.ID);break;case"EmissiveColor":r.emissiveMap=i.getTexture(e,t.ID),void 0!==r.emissiveMap&&(r.emissiveMap.encoding=Oe);break;case"NormalMap":case"Maya|TEX_normal_map":r.normalMap=i.getTexture(e,t.ID);break;case"ReflectionColor":r.envMap=i.getTexture(e,t.ID),void 0!==r.envMap&&(r.envMap.mapping=ct,r.envMap.encoding=Oe);break;case"SpecularColor":r.specularMap=i.getTexture(e,t.ID),void 0!==r.specularMap&&(r.specularMap.encoding=Oe);break;case"TransparentColor":case"TransparencyFactor":r.alphaMap=i.getTexture(e,t.ID),r.transparent=!0;break;case"AmbientColor":case"ShininessExponent":case"SpecularFactor":case"VectorDisplacementColor":default:console.warn("THREE.FBXLoader: %s map is not supported in three.js, skipping texture.",n);break}})),r}getTexture(t,e){return"LayeredTexture"in Bb.Objects&&e in Bb.Objects.LayeredTexture&&(console.warn("THREE.FBXLoader: layered textures are not supported in three.js. Discarding all but first layer."),e=Gb.get(e).children[0].ID),t.get(e)}parseDeformers(){const t={},e={};if("Deformer"in Bb.Objects){const n=Bb.Objects.Deformer;for(const r in n){const i=n[r],s=Gb.get(parseInt(r));if("Skin"===i.attrType){const e=this.parseSkeleton(s,n);e.ID=r,s.parents.length>1&&console.warn("THREE.FBXLoader: skeleton attached to more than one geometry is not supported."),e.geometryID=s.parents[0].ID,t[r]=e}else if("BlendShape"===i.attrType){const t={id:r};t.rawTargets=this.parseMorphTargets(s,n),t.id=r,s.parents.length>1&&console.warn("THREE.FBXLoader: morph target attached to more than one geometry is not supported."),e[r]=t}}}return{skeletons:t,morphTargets:e}}parseSkeleton(t,e){const n=[];return t.children.forEach((function(t){const r=e[t.ID];if("Cluster"!==r.attrType)return;const i={ID:t.ID,indices:[],weights:[],transformLink:(new ti).fromArray(r.TransformLink.a)};"Indexes"in r&&(i.indices=r.Indexes.a,i.weights=r.Weights.a),n.push(i)})),{rawBones:n,bones:[]}}parseMorphTargets(t,e){const n=[];for(let r=0;r<t.children.length;r++){const i=t.children[r],s=e[i.ID],o={name:s.attrName,initialWeight:s.DeformPercent,id:s.id,fullWeights:s.FullWeights.a};if("BlendShapeChannel"!==s.attrType)return;o.geoID=Gb.get(parseInt(i.ID)).children.filter((function(t){return void 0===t.relationship}))[0].ID,n.push(o)}return n}parseScene(t,e,n){Hb=new mh;const r=this.parseModels(t.skeletons,e,n),i=Bb.Objects.Model,s=this;r.forEach((function(t){const e=i[t.ID];s.setLookAtProperties(t,e);const n=Gb.get(t.ID).parents;n.forEach((function(e){const n=r.get(e.ID);void 0!==n&&n.add(t)})),null===t.parent&&Hb.add(t)})),this.bindSkeleton(t.skeletons,e,r),this.createAmbientLight(),Hb.traverse((function(t){if(t.userData.transformData){t.parent&&(t.userData.transformData.parentMatrix=t.parent.matrix,t.userData.transformData.parentMatrixWorld=t.parent.matrixWorld);const e=sw(t.userData.transformData);t.applyMatrix4(e),t.updateWorldMatrix()}}));const o=(new qb).parse();1===Hb.children.length&&Hb.children[0].isGroup&&(Hb.children[0].animations=o,Hb=Hb.children[0]),Hb.animations=o}parseModels(t,e,n){const r=new Map,i=Bb.Objects.Model;for(const s in i){const o=parseInt(s),a=i[s],l=Gb.get(o);let c=this.buildSkeleton(l,t,o,a.attrName);if(!c){switch(a.attrType){case"Camera":c=this.createCamera(l);break;case"Light":c=this.createLight(l);break;case"Mesh":c=this.createMesh(l,e,n);break;case"NurbsCurve":c=this.createCurve(l,e);break;case"LimbNode":case"Root":c=new ed;break;case"Null":default:c=new mh;break}c.name=a.attrName?pg.sanitizeNodeName(a.attrName):"",c.ID=o}this.getTransformData(c,a),r.set(o,c)}return r}buildSkeleton(t,e,n,r){let i=null;return t.parents.forEach((function(t){for(const s in e){const o=e[s];o.rawBones.forEach((function(e,s){if(e.ID===t.ID){const t=i;i=new ed,i.matrixWorld.copy(e.transformLink),i.name=r?pg.sanitizeNodeName(r):"",i.ID=n,o.bones[s]=i,null!==t&&i.add(t)}}))}})),i}createCamera(t){let e,n;if(t.children.forEach((function(t){const e=Bb.Objects.NodeAttribute[t.ID];void 0!==e&&(n=e)})),void 0===n)e=new Si;else{let t=0;void 0!==n.CameraProjectionType&&1===n.CameraProjectionType.value&&(t=1);let r=1;void 0!==n.NearPlane&&(r=n.NearPlane.value/1e3);let i=1e3;void 0!==n.FarPlane&&(i=n.FarPlane.value/1e3);let s=window.innerWidth,o=window.innerHeight;void 0!==n.AspectWidth&&void 0!==n.AspectHeight&&(s=n.AspectWidth.value,o=n.AspectHeight.value);const a=s/o;let l=45;void 0!==n.FieldOfView&&(l=n.FieldOfView.value);const c=n.FocalLength?n.FocalLength.value:null;switch(t){case 0:e=new Os(l,a,r,i),null!==c&&e.setFocalLength(c);break;case 1:e=new Dl(-s/2,s/2,o/2,-o/2,r,i);break;default:console.warn("THREE.FBXLoader: Unknown camera type "+t+"."),e=new Si;break}}return e}createLight(t){let e,n;if(t.children.forEach((function(t){const e=Bb.Objects.NodeAttribute[t.ID];void 0!==e&&(n=e)})),void 0===n)e=new Si;else{let t;t=void 0===n.LightType?0:n.LightType.value;let r=16777215;void 0!==n.Color&&(r=(new lr).fromArray(n.Color.value));let i=void 0===n.Intensity?1:n.Intensity.value/100;void 0!==n.CastLightOnObject&&0===n.CastLightOnObject.value&&(i=0);let s=0;void 0!==n.FarAttenuationEnd&&(s=void 0!==n.EnableFarAttenuation&&0===n.EnableFarAttenuation.value?0:n.FarAttenuationEnd.value);const o=1;switch(t){case 0:e=new vm(r,i,s,o);break;case 1:e=new xm(r,i);break;case 2:let t=Math.PI/3;void 0!==n.InnerAngle&&(t=Wn.degToRad(n.InnerAngle.value));let a=0;void 0!==n.OuterAngle&&(a=Wn.degToRad(n.OuterAngle.value),a=Math.max(a,1)),e=new dm(r,i,s,t,a,o);break;default:console.warn("THREE.FBXLoader: Unknown light type "+n.LightType.value+", defaulting to a PointLight."),e=new vm(r,i);break}void 0!==n.CastShadows&&1===n.CastShadows.value&&(e.castShadow=!0)}return e}createMesh(t,e,n){let r,i=null,s=null;const o=[];return t.children.forEach((function(t){e.has(t.ID)&&(i=e.get(t.ID)),n.has(t.ID)&&o.push(n.get(t.ID))})),o.length>1?s=o:o.length>0?s=o[0]:(s=new Ap({color:13421772}),o.push(s)),"color"in i.attributes&&o.forEach((function(t){t.vertexColors=!0})),i.FBX_Deformer?(r=new td(i,s),r.normalizeSkinWeights()):r=new As(i,s),r}createCurve(t,e){const n=t.children.reduce((function(t,n){return e.has(n.ID)&&(t=e.get(n.ID)),t}),null),r=new dd({color:3342591,linewidth:1});return new yd(n,r)}getTransformData(t,e){const n={};"InheritType"in e&&(n.inheritType=parseInt(e.InheritType.value)),n.eulerOrder="RotationOrder"in e?ow(e.RotationOrder.value):"ZYX","Lcl_Translation"in e&&(n.translation=e.Lcl_Translation.value),"PreRotation"in e&&(n.preRotation=e.PreRotation.value),"Lcl_Rotation"in e&&(n.rotation=e.Lcl_Rotation.value),"PostRotation"in e&&(n.postRotation=e.PostRotation.value),"Lcl_Scaling"in e&&(n.scale=e.Lcl_Scaling.value),"ScalingOffset"in e&&(n.scalingOffset=e.ScalingOffset.value),"ScalingPivot"in e&&(n.scalingPivot=e.ScalingPivot.value),"RotationOffset"in e&&(n.rotationOffset=e.RotationOffset.value),"RotationPivot"in e&&(n.rotationPivot=e.RotationPivot.value),t.userData.transformData=n}setLookAtProperties(t,e){if("LookAtProperty"in e){const e=Gb.get(t.ID).children;e.forEach((function(e){if("LookAtProperty"===e.relationship){const n=Bb.Objects.Model[e.ID];if("Lcl_Translation"in n){const e=n.Lcl_Translation.value;void 0!==t.target?(t.target.position.fromArray(e),Hb.add(t.target)):t.lookAt((new Mr).fromArray(e))}}}))}}bindSkeleton(t,e,n){const r=this.parsePoseNodes();for(const i in t){const s=t[i],o=Gb.get(parseInt(s.ID)).parents;o.forEach((function(t){if(e.has(t.ID)){const e=t.ID,i=Gb.get(e);i.parents.forEach((function(t){if(n.has(t.ID)){const e=n.get(t.ID);e.bind(new sd(s.bones),r[t.ID])}}))}}))}}parsePoseNodes(){const t={};if("Pose"in Bb.Objects){const e=Bb.Objects.Pose;for(const n in e)if("BindPose"===e[n].attrType&&e[n].NbPoseNodes>0){const r=e[n].PoseNode;Array.isArray(r)?r.forEach((function(e){t[e.Node]=(new ti).fromArray(e.Matrix.a)})):t[r.Node]=(new ti).fromArray(r.Matrix.a)}}return t}createAmbientLight(){if("GlobalSettings"in Bb&&"AmbientColor"in Bb.GlobalSettings){const t=Bb.GlobalSettings.AmbientColor.value,e=t[0],n=t[1],r=t[2];if(0!==e||0!==n||0!==r){const t=new lr(e,n,r);Hb.add(new bm(t,1))}}}}class Wb{parse(t){const e=new Map;if("Geometry"in Bb.Objects){const n=Bb.Objects.Geometry;for(const r in n){const i=Gb.get(parseInt(r)),s=this.parseGeometry(i,n[r],t);e.set(parseInt(r),s)}}return e}parseGeometry(t,e,n){switch(e.attrType){case"Mesh":return this.parseMeshGeometry(t,e,n);case"NurbsCurve":return this.parseNurbsGeometry(e)}}parseMeshGeometry(t,e,n){const r=n.skeletons,i=[],s=t.parents.map((function(t){return Bb.Objects.Model[t.ID]}));if(0===s.length)return;const o=t.children.reduce((function(t,e){return void 0!==r[e.ID]&&(t=r[e.ID]),t}),null);t.children.forEach((function(t){void 0!==n.morphTargets[t.ID]&&i.push(n.morphTargets[t.ID])}));const a=s[0],l={};"RotationOrder"in a&&(l.eulerOrder=ow(a.RotationOrder.value)),"InheritType"in a&&(l.inheritType=parseInt(a.InheritType.value)),"GeometricTranslation"in a&&(l.translation=a.GeometricTranslation.value),"GeometricRotation"in a&&(l.rotation=a.GeometricRotation.value),"GeometricScaling"in a&&(l.scale=a.GeometricScaling.value);const c=sw(l);return this.genGeometry(e,o,i,c)}genGeometry(t,e,n,r){const i=new os;t.attrName&&(i.name=t.attrName);const s=this.parseGeoNode(t,e),o=this.genBuffers(s),a=new Zi(o.vertex,3);if(a.applyMatrix4(r),i.setAttribute("position",a),o.colors.length>0&&i.setAttribute("color",new Zi(o.colors,3)),e&&(i.setAttribute("skinIndex",new Yi(o.weightsIndices,4)),i.setAttribute("skinWeight",new Zi(o.vertexWeights,4)),i.FBX_Deformer=e),o.normal.length>0){const t=(new Yn).getNormalMatrix(r),e=new Zi(o.normal,3);e.applyNormalMatrix(t),i.setAttribute("normal",e)}if(o.uvs.forEach((function(t,e){let n="uv"+(e+1).toString();0===e&&(n="uv"),i.setAttribute(n,new Zi(o.uvs[e],2))})),s.material&&"AllSame"!==s.material.mappingType){let t=o.materialIndex[0],e=0;if(o.materialIndex.forEach((function(n,r){n!==t&&(i.addGroup(e,r-e,t),t=n,e=r)})),i.groups.length>0){const e=i.groups[i.groups.length-1],n=e.start+e.count;n!==o.materialIndex.length&&i.addGroup(n,o.materialIndex.length-n,t)}0===i.groups.length&&i.addGroup(0,o.materialIndex.length,o.materialIndex[0])}return this.addMorphTargets(i,t,n,r),i}parseGeoNode(t,e){const n={};if(n.vertexPositions=void 0!==t.Vertices?t.Vertices.a:[],n.vertexIndices=void 0!==t.PolygonVertexIndex?t.PolygonVertexIndex.a:[],t.LayerElementColor&&(n.color=this.parseVertexColors(t.LayerElementColor[0])),t.LayerElementMaterial&&(n.material=this.parseMaterialIndices(t.LayerElementMaterial[0])),t.LayerElementNormal&&(n.normal=this.parseNormals(t.LayerElementNormal[0])),t.LayerElementUV){n.uv=[];let e=0;while(t.LayerElementUV[e])t.LayerElementUV[e].UV&&n.uv.push(this.parseUVs(t.LayerElementUV[e])),e++}return n.weightTable={},null!==e&&(n.skeleton=e,e.rawBones.forEach((function(t,e){t.indices.forEach((function(r,i){void 0===n.weightTable[r]&&(n.weightTable[r]=[]),n.weightTable[r].push({id:e,weight:t.weights[i]})}))}))),n}genBuffers(t){const e={vertex:[],normal:[],colors:[],uvs:[],materialIndex:[],vertexWeights:[],weightsIndices:[]};let n=0,r=0,i=!1,s=[],o=[],a=[],l=[],c=[],u=[];const h=this;return t.vertexIndices.forEach((function(d,f){let p,m=!1;d<0&&(d^=-1,m=!0);let g=[],v=[];if(s.push(3*d,3*d+1,3*d+2),t.color){const e=nw(f,n,d,t.color);a.push(e[0],e[1],e[2])}if(t.skeleton){if(void 0!==t.weightTable[d]&&t.weightTable[d].forEach((function(t){v.push(t.weight),g.push(t.id)})),v.length>4){i||(console.warn("THREE.FBXLoader: Vertex has more than 4 skinning weights assigned to vertex. Deleting additional weights."),i=!0);const t=[0,0,0,0],e=[0,0,0,0];v.forEach((function(n,r){let i=n,s=g[r];e.forEach((function(e,n,r){if(i>e){r[n]=i,i=e;const o=t[n];t[n]=s,s=o}}))})),g=t,v=e}while(v.length<4)v.push(0),g.push(0);for(let t=0;t<4;++t)c.push(v[t]),u.push(g[t])}if(t.normal){const e=nw(f,n,d,t.normal);o.push(e[0],e[1],e[2])}t.material&&"AllSame"!==t.material.mappingType&&(p=nw(f,n,d,t.material)[0]),t.uv&&t.uv.forEach((function(t,e){const r=nw(f,n,d,t);void 0===l[e]&&(l[e]=[]),l[e].push(r[0]),l[e].push(r[1])})),r++,m&&(h.genFace(e,t,s,p,o,a,l,c,u,r),n++,r=0,s=[],o=[],a=[],l=[],c=[],u=[])})),e}genFace(t,e,n,r,i,s,o,a,l,c){for(let u=2;u<c;u++)t.vertex.push(e.vertexPositions[n[0]]),t.vertex.push(e.vertexPositions[n[1]]),t.vertex.push(e.vertexPositions[n[2]]),t.vertex.push(e.vertexPositions[n[3*(u-1)]]),t.vertex.push(e.vertexPositions[n[3*(u-1)+1]]),t.vertex.push(e.vertexPositions[n[3*(u-1)+2]]),t.vertex.push(e.vertexPositions[n[3*u]]),t.vertex.push(e.vertexPositions[n[3*u+1]]),t.vertex.push(e.vertexPositions[n[3*u+2]]),e.skeleton&&(t.vertexWeights.push(a[0]),t.vertexWeights.push(a[1]),t.vertexWeights.push(a[2]),t.vertexWeights.push(a[3]),t.vertexWeights.push(a[4*(u-1)]),t.vertexWeights.push(a[4*(u-1)+1]),t.vertexWeights.push(a[4*(u-1)+2]),t.vertexWeights.push(a[4*(u-1)+3]),t.vertexWeights.push(a[4*u]),t.vertexWeights.push(a[4*u+1]),t.vertexWeights.push(a[4*u+2]),t.vertexWeights.push(a[4*u+3]),t.weightsIndices.push(l[0]),t.weightsIndices.push(l[1]),t.weightsIndices.push(l[2]),t.weightsIndices.push(l[3]),t.weightsIndices.push(l[4*(u-1)]),t.weightsIndices.push(l[4*(u-1)+1]),t.weightsIndices.push(l[4*(u-1)+2]),t.weightsIndices.push(l[4*(u-1)+3]),t.weightsIndices.push(l[4*u]),t.weightsIndices.push(l[4*u+1]),t.weightsIndices.push(l[4*u+2]),t.weightsIndices.push(l[4*u+3])),e.color&&(t.colors.push(s[0]),t.colors.push(s[1]),t.colors.push(s[2]),t.colors.push(s[3*(u-1)]),t.colors.push(s[3*(u-1)+1]),t.colors.push(s[3*(u-1)+2]),t.colors.push(s[3*u]),t.colors.push(s[3*u+1]),t.colors.push(s[3*u+2])),e.material&&"AllSame"!==e.material.mappingType&&(t.materialIndex.push(r),t.materialIndex.push(r),t.materialIndex.push(r)),e.normal&&(t.normal.push(i[0]),t.normal.push(i[1]),t.normal.push(i[2]),t.normal.push(i[3*(u-1)]),t.normal.push(i[3*(u-1)+1]),t.normal.push(i[3*(u-1)+2]),t.normal.push(i[3*u]),t.normal.push(i[3*u+1]),t.normal.push(i[3*u+2])),e.uv&&e.uv.forEach((function(e,n){void 0===t.uvs[n]&&(t.uvs[n]=[]),t.uvs[n].push(o[n][0]),t.uvs[n].push(o[n][1]),t.uvs[n].push(o[n][2*(u-1)]),t.uvs[n].push(o[n][2*(u-1)+1]),t.uvs[n].push(o[n][2*u]),t.uvs[n].push(o[n][2*u+1])}))}addMorphTargets(t,e,n,r){if(0===n.length)return;t.morphTargetsRelative=!0,t.morphAttributes.position=[];const i=this;n.forEach((function(n){n.rawTargets.forEach((function(n){const s=Bb.Objects.Geometry[n.geoID];void 0!==s&&i.genMorphGeometry(t,e,s,r,n.name)}))}))}genMorphGeometry(t,e,n,r,i){const s=void 0!==e.PolygonVertexIndex?e.PolygonVertexIndex.a:[],o=void 0!==n.Vertices?n.Vertices.a:[],a=void 0!==n.Indexes?n.Indexes.a:[],l=3*t.attributes.position.count,c=new Float32Array(l);for(let f=0;f<a.length;f++){const t=3*a[f];c[t]=o[3*f],c[t+1]=o[3*f+1],c[t+2]=o[3*f+2]}const u={vertexIndices:s,vertexPositions:c},h=this.genBuffers(u),d=new Zi(h.vertex,3);d.name=i||n.attrName,d.applyMatrix4(r),t.morphAttributes.position.push(d)}parseNormals(t){const e=t.MappingInformationType,n=t.ReferenceInformationType,r=t.Normals.a;let i=[];return"IndexToDirect"===n&&("NormalIndex"in t?i=t.NormalIndex.a:"NormalsIndex"in t&&(i=t.NormalsIndex.a)),{dataSize:3,buffer:r,indices:i,mappingType:e,referenceType:n}}parseUVs(t){const e=t.MappingInformationType,n=t.ReferenceInformationType,r=t.UV.a;let i=[];return"IndexToDirect"===n&&(i=t.UVIndex.a),{dataSize:2,buffer:r,indices:i,mappingType:e,referenceType:n}}parseVertexColors(t){const e=t.MappingInformationType,n=t.ReferenceInformationType,r=t.Colors.a;let i=[];return"IndexToDirect"===n&&(i=t.ColorIndex.a),{dataSize:4,buffer:r,indices:i,mappingType:e,referenceType:n}}parseMaterialIndices(t){const e=t.MappingInformationType,n=t.ReferenceInformationType;if("NoMappingInformation"===e)return{dataSize:1,buffer:[0],indices:[0],mappingType:"AllSame",referenceType:n};const r=t.Materials.a,i=[];for(let s=0;s<r.length;++s)i.push(s);return{dataSize:1,buffer:r,indices:i,mappingType:e,referenceType:n}}parseNurbsGeometry(t){if(void 0===Ub)return console.error("THREE.FBXLoader: The loader relies on NURBSCurve for any nurbs present in the model. Nurbs will show up as empty geometry."),new os;const e=parseInt(t.Order);if(isNaN(e))return console.error("THREE.FBXLoader: Invalid Order %s given for geometry ID: %s",t.Order,t.id),new os;const n=e-1,r=t.KnotVector.a,i=[],s=t.Points.a;for(let u=0,h=s.length;u<h;u+=4)i.push((new mr).fromArray(s,u));let o,a;if("Closed"===t.Form)i.push(i[0]);else if("Periodic"===t.Form){o=n,a=r.length-1-o;for(let t=0;t<n;++t)i.push(i[t])}const l=new Ub(n,r,i,o,a),c=l.getPoints(12*i.length);return(new os).setFromPoints(c)}}class qb{parse(){const t=[],e=this.parseClips();if(void 0!==e)for(const n in e){const r=e[n],i=this.addClip(r);t.push(i)}return t}parseClips(){if(void 0===Bb.Objects.AnimationCurve)return;const t=this.parseAnimationCurveNodes();this.parseAnimationCurves(t);const e=this.parseAnimationLayers(t),n=this.parseAnimStacks(e);return n}parseAnimationCurveNodes(){const t=Bb.Objects.AnimationCurveNode,e=new Map;for(const n in t){const r=t[n];if(null!==r.attrName.match(/S|R|T|DeformPercent/)){const t={id:r.id,attr:r.attrName,curves:{}};e.set(t.id,t)}}return e}parseAnimationCurves(t){const e=Bb.Objects.AnimationCurve;for(const n in e){const r={id:e[n].id,times:e[n].KeyTime.a.map(tw),values:e[n].KeyValueFloat.a},i=Gb.get(r.id);if(void 0!==i){const e=i.parents[0].ID,n=i.parents[0].relationship;n.match(/X/)?t.get(e).curves["x"]=r:n.match(/Y/)?t.get(e).curves["y"]=r:n.match(/Z/)?t.get(e).curves["z"]=r:n.match(/d|DeformPercent/)&&t.has(e)&&(t.get(e).curves["morph"]=r)}}}parseAnimationLayers(t){const e=Bb.Objects.AnimationLayer,n=new Map;for(const r in e){const e=[],i=Gb.get(parseInt(r));if(void 0!==i){const s=i.children;s.forEach((function(n,r){if(t.has(n.ID)){const i=t.get(n.ID);if(void 0!==i.curves.x||void 0!==i.curves.y||void 0!==i.curves.z){if(void 0===e[r]){const t=Gb.get(n.ID).parents.filter((function(t){return void 0!==t.relationship}))[0].ID;if(void 0!==t){const i=Bb.Objects.Model[t.toString()];if(void 0===i)return void console.warn("THREE.FBXLoader: Encountered a unused curve.",n);const s={modelName:i.attrName?pg.sanitizeNodeName(i.attrName):"",ID:i.id,initialPosition:[0,0,0],initialRotation:[0,0,0],initialScale:[1,1,1]};Hb.traverse((function(t){t.ID===i.id&&(s.transform=t.matrix,t.userData.transformData&&(s.eulerOrder=t.userData.transformData.eulerOrder))})),s.transform||(s.transform=new ti),"PreRotation"in i&&(s.preRotation=i.PreRotation.value),"PostRotation"in i&&(s.postRotation=i.PostRotation.value),e[r]=s}}e[r]&&(e[r][i.attr]=i)}else if(void 0!==i.curves.morph){if(void 0===e[r]){const t=Gb.get(n.ID).parents.filter((function(t){return void 0!==t.relationship}))[0].ID,i=Gb.get(t).parents[0].ID,s=Gb.get(i).parents[0].ID,o=Gb.get(s).parents[0].ID,a=Bb.Objects.Model[o],l={modelName:a.attrName?pg.sanitizeNodeName(a.attrName):"",morphName:Bb.Objects.Deformer[t].attrName};e[r]=l}e[r][i.attr]=i}}})),n.set(parseInt(r),e)}}return n}parseAnimStacks(t){const e=Bb.Objects.AnimationStack,n={};for(const r in e){const i=Gb.get(parseInt(r)).children;i.length>1&&console.warn("THREE.FBXLoader: Encountered an animation stack with multiple layers, this is currently not supported. Ignoring subsequent layers.");const s=t.get(i[0].ID);n[r]={name:e[r].attrName,layer:s}}return n}addClip(t){let e=[];const n=this;return t.layer.forEach((function(t){e=e.concat(n.generateTracks(t))})),new jp(t.name,-1,e)}generateTracks(t){const e=[];let n=new Mr,r=new _r,i=new Mr;if(t.transform&&t.transform.decompose(n,r,i),n=n.toArray(),r=(new ui).setFromQuaternion(r,t.eulerOrder).toArray(),i=i.toArray(),void 0!==t.T&&Object.keys(t.T.curves).length>0){const r=this.generateVectorTrack(t.modelName,t.T.curves,n,"position");void 0!==r&&e.push(r)}if(void 0!==t.R&&Object.keys(t.R.curves).length>0){const n=this.generateRotationTrack(t.modelName,t.R.curves,r,t.preRotation,t.postRotation,t.eulerOrder);void 0!==n&&e.push(n)}if(void 0!==t.S&&Object.keys(t.S.curves).length>0){const n=this.generateVectorTrack(t.modelName,t.S.curves,i,"scale");void 0!==n&&e.push(n)}if(void 0!==t.DeformPercent){const n=this.generateMorphTrack(t);void 0!==n&&e.push(n)}return e}generateVectorTrack(t,e,n,r){const i=this.getTimesForAllAxes(e),s=this.getKeyframeTrackValues(i,e,n);return new Vp(t+"."+r,i,s)}generateRotationTrack(t,e,n,r,i,s){void 0!==e.x&&(this.interpolateRotations(e.x),e.x.values=e.x.values.map(Wn.degToRad)),void 0!==e.y&&(this.interpolateRotations(e.y),e.y.values=e.y.values.map(Wn.degToRad)),void 0!==e.z&&(this.interpolateRotations(e.z),e.z.values=e.z.values.map(Wn.degToRad));const o=this.getTimesForAllAxes(e),a=this.getKeyframeTrackValues(o,e,n);void 0!==r&&(r=r.map(Wn.degToRad),r.push(s),r=(new ui).fromArray(r),r=(new _r).setFromEuler(r)),void 0!==i&&(i=i.map(Wn.degToRad),i.push(s),i=(new ui).fromArray(i),i=(new _r).setFromEuler(i).invert());const l=new _r,c=new ui,u=[];for(let h=0;h<a.length;h+=3)c.set(a[h],a[h+1],a[h+2],s),l.setFromEuler(c),void 0!==r&&l.premultiply(r),void 0!==i&&l.multiply(i),l.toArray(u,h/3*4);return new Gp(t+".quaternion",o,u)}generateMorphTrack(t){const e=t.DeformPercent.curves.morph,n=e.values.map((function(t){return t/100})),r=Hb.getObjectByName(t.modelName).morphTargetDictionary[t.morphName];return new Up(t.modelName+".morphTargetInfluences["+r+"]",e.times,n)}getTimesForAllAxes(t){let e=[];if(void 0!==t.x&&(e=e.concat(t.x.times)),void 0!==t.y&&(e=e.concat(t.y.times)),void 0!==t.z&&(e=e.concat(t.z.times)),e=e.sort((function(t,e){return t-e})),e.length>1){let t=1,n=e[0];for(let r=1;r<e.length;r++){const i=e[r];i!==n&&(e[t]=i,n=i,t++)}e=e.slice(0,t)}return e}getKeyframeTrackValues(t,e,n){const r=n,i=[];let s=-1,o=-1,a=-1;return t.forEach((function(t){if(e.x&&(s=e.x.times.indexOf(t)),e.y&&(o=e.y.times.indexOf(t)),e.z&&(a=e.z.times.indexOf(t)),-1!==s){const t=e.x.values[s];i.push(t),r[0]=t}else i.push(r[0]);if(-1!==o){const t=e.y.values[o];i.push(t),r[1]=t}else i.push(r[1]);if(-1!==a){const t=e.z.values[a];i.push(t),r[2]=t}else i.push(r[2])})),i}interpolateRotations(t){for(let e=1;e<t.values.length;e++){const n=t.values[e-1],r=t.values[e]-n,i=Math.abs(r);if(i>=180){const s=i/180,o=r/s;let a=n+o;const l=t.times[e-1],c=t.times[e]-l,u=c/s;let h=l+u;const d=[],f=[];while(h<t.times[e])d.push(h),h+=u,f.push(a),a+=o;t.times=hw(t.times,e,d),t.values=hw(t.values,e,f)}}}}class Yb{getPrevNode(){return this.nodeStack[this.currentIndent-2]}getCurrentNode(){return this.nodeStack[this.currentIndent-1]}getCurrentProp(){return this.currentProp}pushStack(t){this.nodeStack.push(t),this.currentIndent+=1}popStack(){this.nodeStack.pop(),this.currentIndent-=1}setCurrentProp(t,e){this.currentProp=t,this.currentPropName=e}parse(t){this.currentIndent=0,this.allNodes=new Kb,this.nodeStack=[],this.currentProp=[],this.currentPropName="";const e=this,n=t.split(/[\r\n]+/);return n.forEach((function(t,r){const i=t.match(/^[\s\t]*;/),s=t.match(/^[\s\t]*$/);if(i||s)return;const o=t.match("^\\t{"+e.currentIndent+"}(\\w+):(.*){",""),a=t.match("^\\t{"+e.currentIndent+"}(\\w+):[\\s\\t\\r\\n](.*)"),l=t.match("^\\t{"+(e.currentIndent-1)+"}}");o?e.parseNodeBegin(t,o):a?e.parseNodeProperty(t,a,n[++r]):l?e.popStack():t.match(/^[^\s\t}]/)&&e.parseNodePropertyContinued(t)})),this.allNodes}parseNodeBegin(t,e){const n=e[1].trim().replace(/^"/,"").replace(/"$/,""),r=e[2].split(",").map((function(t){return t.trim().replace(/^"/,"").replace(/"$/,"")})),i={name:n},s=this.parseNodeAttr(r),o=this.getCurrentNode();0===this.currentIndent?this.allNodes.add(n,i):n in o?("PoseNode"===n?o.PoseNode.push(i):void 0!==o[n].id&&(o[n]={},o[n][o[n].id]=o[n]),""!==s.id&&(o[n][s.id]=i)):"number"===typeof s.id?(o[n]={},o[n][s.id]=i):"Properties70"!==n&&(o[n]="PoseNode"===n?[i]:i),"number"===typeof s.id&&(i.id=s.id),""!==s.name&&(i.attrName=s.name),""!==s.type&&(i.attrType=s.type),this.pushStack(i)}parseNodeAttr(t){let e=t[0];""!==t[0]&&(e=parseInt(t[0]),isNaN(e)&&(e=t[0]));let n="",r="";return t.length>1&&(n=t[1].replace(/^(\w+)::/,""),r=t[2]),{id:e,name:n,type:r}}parseNodeProperty(t,e,n){let r=e[1].replace(/^"/,"").replace(/"$/,"").trim(),i=e[2].replace(/^"/,"").replace(/"$/,"").trim();"Content"===r&&","===i&&(i=n.replace(/"/g,"").replace(/,$/,"").trim());const s=this.getCurrentNode(),o=s.name;if("Properties70"!==o){if("C"===r){const t=i.split(",").slice(1),e=parseInt(t[0]),n=parseInt(t[1]);let o=i.split(",").slice(3);o=o.map((function(t){return t.trim().replace(/^"/,"")})),r="connections",i=[e,n],cw(i,o),void 0===s[r]&&(s[r]=[])}"Node"===r&&(s.id=i),r in s&&Array.isArray(s[r])?s[r].push(i):"a"!==r?s[r]=i:s.a=i,this.setCurrentProp(s,r),"a"===r&&","!==i.slice(-1)&&(s.a=aw(i))}else this.parseNodeSpecialProperty(t,r,i)}parseNodePropertyContinued(t){const e=this.getCurrentNode();e.a+=t,","!==t.slice(-1)&&(e.a=aw(e.a))}parseNodeSpecialProperty(t,e,n){const r=n.split('",').map((function(t){return t.trim().replace(/^\"/,"").replace(/\s/,"_")})),i=r[0],s=r[1],o=r[2],a=r[3];let l=r[4];switch(s){case"int":case"enum":case"bool":case"ULongLong":case"double":case"Number":case"FieldOfView":l=parseFloat(l);break;case"Color":case"ColorRGB":case"Vector3D":case"Lcl_Translation":case"Lcl_Rotation":case"Lcl_Scaling":l=aw(l);break}this.getPrevNode()[i]={type:s,type2:o,flag:a,value:l},this.setCurrentProp(this.getPrevNode(),i)}}class Xb{parse(t){const e=new Jb(t);e.skip(23);const n=e.getUint32();if(n<6400)throw new Error("THREE.FBXLoader: FBX version not supported, FileVersion: "+n);const r=new Kb;while(!this.endOfContent(e)){const t=this.parseNode(e,n);null!==t&&r.add(t.name,t)}return r}endOfContent(t){return t.size()%16===0?(t.getOffset()+160+16&-16)>=t.size():t.getOffset()+160+16>=t.size()}parseNode(t,e){const n={},r=e>=7500?t.getUint64():t.getUint32(),i=e>=7500?t.getUint64():t.getUint32();e>=7500?t.getUint64():t.getUint32();const s=t.getUint8(),o=t.getString(s);if(0===r)return null;const a=[];for(let h=0;h<i;h++)a.push(this.parseProperty(t));const l=a.length>0?a[0]:"",c=a.length>1?a[1]:"",u=a.length>2?a[2]:"";n.singleProperty=1===i&&t.getOffset()===r;while(r>t.getOffset()){const r=this.parseNode(t,e);null!==r&&this.parseSubNode(o,n,r)}return n.propertyList=a,"number"===typeof l&&(n.id=l),""!==c&&(n.attrName=c),""!==u&&(n.attrType=u),""!==o&&(n.name=o),n}parseSubNode(t,e,n){if(!0===n.singleProperty){const t=n.propertyList[0];Array.isArray(t)?(e[n.name]=n,n.a=t):e[n.name]=t}else if("Connections"===t&&"C"===n.name){const t=[];n.propertyList.forEach((function(e,n){0!==n&&t.push(e)})),void 0===e.connections&&(e.connections=[]),e.connections.push(t)}else if("Properties70"===n.name){const t=Object.keys(n);t.forEach((function(t){e[t]=n[t]}))}else if("Properties70"===t&&"P"===n.name){let t=n.propertyList[0],r=n.propertyList[1];const i=n.propertyList[2],s=n.propertyList[3];let o;0===t.indexOf("Lcl ")&&(t=t.replace("Lcl ","Lcl_")),0===r.indexOf("Lcl ")&&(r=r.replace("Lcl ","Lcl_")),o="Color"===r||"ColorRGB"===r||"Vector"===r||"Vector3D"===r||0===r.indexOf("Lcl_")?[n.propertyList[4],n.propertyList[5],n.propertyList[6]]:n.propertyList[4],e[t]={type:r,type2:i,flag:s,value:o}}else void 0===e[n.name]?"number"===typeof n.id?(e[n.name]={},e[n.name][n.id]=n):e[n.name]=n:"PoseNode"===n.name?(Array.isArray(e[n.name])||(e[n.name]=[e[n.name]]),e[n.name].push(n)):void 0===e[n.name][n.id]&&(e[n.name][n.id]=n)}parseProperty(t){const e=t.getString(1);let n;switch(e){case"C":return t.getBoolean();case"D":return t.getFloat64();case"F":return t.getFloat32();case"I":return t.getInt32();case"L":return t.getInt64();case"R":return n=t.getUint32(),t.getArrayBuffer(n);case"S":return n=t.getUint32(),t.getString(n);case"Y":return t.getInt16();case"b":case"c":case"d":case"f":case"i":case"l":const r=t.getUint32(),i=t.getUint32(),s=t.getUint32();if(0===i)switch(e){case"b":case"c":return t.getBooleanArray(r);case"d":return t.getFloat64Array(r);case"f":return t.getFloat32Array(r);case"i":return t.getInt32Array(r);case"l":return t.getInt64Array(r)}"undefined"===typeof Ib&&console.error("THREE.FBXLoader: External library fflate.min.js required.");const o=Zx(new Uint8Array(t.getArrayBuffer(s))),a=new Jb(o.buffer);switch(e){case"b":case"c":return a.getBooleanArray(r);case"d":return a.getFloat64Array(r);case"f":return a.getFloat32Array(r);case"i":return a.getInt32Array(r);case"l":return a.getInt64Array(r)}break;default:throw new Error("THREE.FBXLoader: Unknown property type "+e)}}}class Jb{constructor(t,e){this.dv=new DataView(t),this.offset=0,this.littleEndian=void 0===e||e}getOffset(){return this.offset}size(){return this.dv.buffer.byteLength}skip(t){this.offset+=t}getBoolean(){return 1===(1&this.getUint8())}getBooleanArray(t){const e=[];for(let n=0;n<t;n++)e.push(this.getBoolean());return e}getUint8(){const t=this.dv.getUint8(this.offset);return this.offset+=1,t}getInt16(){const t=this.dv.getInt16(this.offset,this.littleEndian);return this.offset+=2,t}getInt32(){const t=this.dv.getInt32(this.offset,this.littleEndian);return this.offset+=4,t}getInt32Array(t){const e=[];for(let n=0;n<t;n++)e.push(this.getInt32());return e}getUint32(){const t=this.dv.getUint32(this.offset,this.littleEndian);return this.offset+=4,t}getInt64(){let t,e;return this.littleEndian?(t=this.getUint32(),e=this.getUint32()):(e=this.getUint32(),t=this.getUint32()),2147483648&e?(e=4294967295&~e,t=4294967295&~t,4294967295===t&&(e=e+1&4294967295),t=t+1&4294967295,-(4294967296*e+t)):4294967296*e+t}getInt64Array(t){const e=[];for(let n=0;n<t;n++)e.push(this.getInt64());return e}getUint64(){let t,e;return this.littleEndian?(t=this.getUint32(),e=this.getUint32()):(e=this.getUint32(),t=this.getUint32()),4294967296*e+t}getFloat32(){const t=this.dv.getFloat32(this.offset,this.littleEndian);return this.offset+=4,t}getFloat32Array(t){const e=[];for(let n=0;n<t;n++)e.push(this.getFloat32());return e}getFloat64(){const t=this.dv.getFloat64(this.offset,this.littleEndian);return this.offset+=8,t}getFloat64Array(t){const e=[];for(let n=0;n<t;n++)e.push(this.getFloat64());return e}getArrayBuffer(t){const e=this.dv.buffer.slice(this.offset,this.offset+t);return this.offset+=t,e}getString(t){let e=[];for(let r=0;r<t;r++)e[r]=this.getUint8();const n=e.indexOf(0);return n>=0&&(e=e.slice(0,n)),Sm.decodeText(new Uint8Array(e))}}class Kb{add(t,e){this[t]=e}}function Zb(t){const e="Kaydara FBX Binary  \0";return t.byteLength>=e.length&&e===lw(t,0,e.length)}function Qb(t){const e=["K","a","y","d","a","r","a","\\","F","B","X","\\","B","i","n","a","r","y","\\","\\"];let n=0;function r(e){const r=t[e-1];return t=t.slice(n+e),n++,r}for(let i=0;i<e.length;++i){const t=r(1);if(t===e[i])return!1}return!0}function $b(t){const e=/FBXVersion: (\d+)/,n=t.match(e);if(n){const t=parseInt(n[1]);return t}throw new Error("THREE.FBXLoader: Cannot find the version number for the file given.")}function tw(t){return t/46186158e3}const ew=[];function nw(t,e,n,r){let i;switch(r.mappingType){case"ByPolygonVertex":i=t;break;case"ByPolygon":i=e;break;case"ByVertice":i=n;break;case"AllSame":i=r.indices[0];break;default:console.warn("THREE.FBXLoader: unknown attribute mapping type "+r.mappingType)}"IndexToDirect"===r.referenceType&&(i=r.indices[i]);const s=i*r.dataSize,o=s+r.dataSize;return uw(ew,r.buffer,s,o)}const rw=new ui,iw=new Mr;function sw(t){const e=new ti,n=new ti,r=new ti,i=new ti,s=new ti,o=new ti,a=new ti,l=new ti,c=new ti,u=new ti,h=new ti,d=new ti,f=t.inheritType?t.inheritType:0;if(t.translation&&e.setPosition(iw.fromArray(t.translation)),t.preRotation){const e=t.preRotation.map(Wn.degToRad);e.push(t.eulerOrder),n.makeRotationFromEuler(rw.fromArray(e))}if(t.rotation){const e=t.rotation.map(Wn.degToRad);e.push(t.eulerOrder),r.makeRotationFromEuler(rw.fromArray(e))}if(t.postRotation){const e=t.postRotation.map(Wn.degToRad);e.push(t.eulerOrder),i.makeRotationFromEuler(rw.fromArray(e)),i.invert()}t.scale&&s.scale(iw.fromArray(t.scale)),t.scalingOffset&&a.setPosition(iw.fromArray(t.scalingOffset)),t.scalingPivot&&o.setPosition(iw.fromArray(t.scalingPivot)),t.rotationOffset&&l.setPosition(iw.fromArray(t.rotationOffset)),t.rotationPivot&&c.setPosition(iw.fromArray(t.rotationPivot)),t.parentMatrixWorld&&(h.copy(t.parentMatrix),u.copy(t.parentMatrixWorld));const p=n.clone().multiply(r).multiply(i),m=new ti;m.extractRotation(u);const g=new ti;g.copyPosition(u);const v=g.clone().invert().multiply(u),y=m.clone().invert().multiply(v),x=s,b=new ti;if(0===f)b.copy(m).multiply(p).multiply(y).multiply(x);else if(1===f)b.copy(m).multiply(y).multiply(p).multiply(x);else{const t=(new ti).scale((new Mr).setFromMatrixScale(h)),e=t.clone().invert(),n=y.clone().multiply(e);b.copy(m).multiply(p).multiply(n).multiply(x)}const w=c.clone().invert(),_=o.clone().invert();let M=e.clone().multiply(l).multiply(c).multiply(n).multiply(r).multiply(i).multiply(w).multiply(a).multiply(o).multiply(s).multiply(_);const A=(new ti).copyPosition(M),S=u.clone().multiply(A);return d.copyPosition(S),M=d.clone().multiply(b),M.premultiply(u.invert()),M}function ow(t){t=t||0;const e=["ZYX","YZX","XZY","ZXY","YXZ","XYZ"];return 6===t?(console.warn("THREE.FBXLoader: unsupported Euler Order: Spherical XYZ. Animations and rotations may be incorrect."),e[0]):e[t]}function aw(t){const e=t.split(",").map((function(t){return parseFloat(t)}));return e}function lw(t,e,n){return void 0===e&&(e=0),void 0===n&&(n=t.byteLength),Sm.decodeText(new Uint8Array(t,e,n))}function cw(t,e){for(let n=0,r=t.length,i=e.length;n<i;n++,r++)t[r]=e[n]}function uw(t,e,n,r){for(let i=n,s=0;i<r;i++,s++)t[s]=e[i];return t}function hw(t,e,n){return t.slice(0,e).concat(n).concat(t.slice(e))}(0,r.aZ)({name:"model-fbx",mixins:[sy],props:{lights:{type:Array,default(){return[{type:"HemisphereLight",position:{x:0,y:1,z:0},skyColor:16777215,groundColor:16777215,intensity:.8},{type:"DirectionalLight",position:{x:1,y:1,z:1},color:16777215,intensity:.8}]}}},data(){return{loader:new Vb}},methods:{getObject(t){return this.animations=t.animations,t}}});const dw=(0,r.aZ)({name:"model-three",mixins:[sy],data(){const t=new Cm;return t.setCrossOrigin(this.crossOrigin),t.setRequestHeader(this.requestHeader),{loader:t}}});class fw extends Kp{constructor(t){super(t)}load(t,e,n,r){const i=this,s=new Qp(this.manager);s.setPath(this.path),s.setResponseType("arraybuffer"),s.setRequestHeader(this.requestHeader),s.setWithCredentials(this.withCredentials),s.load(t,(function(n){try{e(i.parse(n))}catch(v_){r?r(v_):console.error(v_),i.manager.itemError(t)}}),n,r)}parse(t){function e(t){const e=new DataView(t),r=50,i=e.getUint32(80,!0),s=84+i*r;if(s===e.byteLength)return!0;const o=[115,111,108,105,100];for(let a=0;a<5;a++)if(n(o,e,a))return!1;return!0}function n(t,e,n){for(let r=0,i=t.length;r<i;r++)if(t[r]!==e.getUint8(n+r))return!1;return!0}function r(t){const e=new DataView(t),n=e.getUint32(80,!0);let r,i,s,o,a,l,c,u,h=!1;for(let v=0;v<70;v++)1129270351==e.getUint32(v,!1)&&82==e.getUint8(v+4)&&61==e.getUint8(v+5)&&(h=!0,o=new Float32Array(3*n*3),a=e.getUint8(v+6)/255,l=e.getUint8(v+7)/255,c=e.getUint8(v+8)/255,u=e.getUint8(v+9)/255);const d=84,f=50,p=new os,m=new Float32Array(3*n*3),g=new Float32Array(3*n*3);for(let v=0;v<n;v++){const t=d+v*f,n=e.getFloat32(t,!0),u=e.getFloat32(t+4,!0),p=e.getFloat32(t+8,!0);if(h){const n=e.getUint16(t+48,!0);0===(32768&n)?(r=(31&n)/31,i=(n>>5&31)/31,s=(n>>10&31)/31):(r=a,i=l,s=c)}for(let a=1;a<=3;a++){const l=t+12*a,c=3*v*3+3*(a-1);m[c]=e.getFloat32(l,!0),m[c+1]=e.getFloat32(l+4,!0),m[c+2]=e.getFloat32(l+8,!0),g[c]=n,g[c+1]=u,g[c+2]=p,h&&(o[c]=r,o[c+1]=i,o[c+2]=s)}}return p.setAttribute("position",new Hi(m,3)),p.setAttribute("normal",new Hi(g,3)),h&&(p.setAttribute("color",new Hi(o,3)),p.hasColors=!0,p.alpha=u),p}function i(t){const e=new os,n=/solid([\s\S]*?)endsolid/g,r=/facet([\s\S]*?)endfacet/g;let i=0;const s=/[\s]+([+-]?(?:\d*)(?:\.\d*)?(?:[eE][+-]?\d+)?)/.source,o=new RegExp("vertex"+s+s+s,"g"),a=new RegExp("normal"+s+s+s,"g"),l=[],c=[],u=new Mr;let h,d=0,f=0,p=0;while(null!==(h=n.exec(t))){f=p;const t=h[0];while(null!==(h=r.exec(t))){let t=0,e=0;const n=h[0];while(null!==(h=a.exec(n)))u.x=parseFloat(h[1]),u.y=parseFloat(h[2]),u.z=parseFloat(h[3]),e++;while(null!==(h=o.exec(n)))l.push(parseFloat(h[1]),parseFloat(h[2]),parseFloat(h[3])),c.push(u.x,u.y,u.z),t++,p++;1!==e&&console.error("THREE.STLLoader: Something isn't right with the normal of face number "+i),3!==t&&console.error("THREE.STLLoader: Something isn't right with the vertices of face number "+i),i++}const n=f,s=p-f;e.addGroup(n,s,d),d++}return e.setAttribute("position",new Zi(l,3)),e.setAttribute("normal",new Zi(c,3)),e}function s(t){return"string"!==typeof t?Sm.decodeText(new Uint8Array(t)):t}function o(t){if("string"===typeof t){const e=new Uint8Array(t.length);for(let n=0;n<t.length;n++)e[n]=255&t.charCodeAt(n);return e.buffer||e}return t}const a=o(t);return e(a)?r(a):i(s(t))}}(0,r.aZ)({name:"model-stl",mixins:[sy],props:{lights:{type:Array,default(){return[{type:"HemisphereLight",position:{x:0,y:1,z:0},skyColor:11184895,groundColor:8413280,intensity:.2},{type:"DirectionalLight",position:{x:1,y:1,z:1},color:16777215,intensity:.8}]}}},data(){return{loader:new fw}},methods:{getObject(t){return new As(t,new Ap)}}});const pw=new lr;class mw extends Kp{constructor(t){super(t),this.propertyNameMapping={}}load(t,e,n,r){const i=this,s=new Qp(this.manager);s.setPath(this.path),s.setResponseType("arraybuffer"),s.setRequestHeader(this.requestHeader),s.setWithCredentials(this.withCredentials),s.load(t,(function(n){try{e(i.parse(n))}catch(v_){r?r(v_):console.error(v_),i.manager.itemError(t)}}),n,r)}setPropertyNameMapping(t){this.propertyNameMapping=t}parse(t){function e(t){const e=/^ply([\s\S]*)end_header\r?\n/;let n="",r=0;const i=e.exec(t);null!==i&&(n=i[1],r=new Blob([i[0]]).size);const s={comments:[],elements:[],headerLength:r,objInfo:""},o=n.split("\n");let a;function l(t,e){const n={type:t[0]};return"list"===n.type?(n.name=t[3],n.countType=t[1],n.itemType=t[2]):n.name=t[1],n.name in e&&(n.name=e[n.name]),n}for(let c=0;c<o.length;c++){let t=o[c];if(t=t.trim(),""===t)continue;const e=t.split(/\s+/),n=e.shift();switch(t=e.join(" "),n){case"format":s.format=e[0],s.version=e[1];break;case"comment":s.comments.push(t);break;case"element":void 0!==a&&s.elements.push(a),a={},a.name=e[0],a.count=parseInt(e[1]),a.properties=[];break;case"property":a.properties.push(l(e,h.propertyNameMapping));break;case"obj_info":s.objInfo=t;break;default:console.log("unhandled",n,e)}}return void 0!==a&&s.elements.push(a),s}function n(t,e){switch(e){case"char":case"uchar":case"short":case"ushort":case"int":case"uint":case"int8":case"uint8":case"int16":case"uint16":case"int32":case"uint32":return parseInt(t);case"float":case"double":case"float32":case"float64":return parseFloat(t)}}function r(t,e){const r=e.split(/\s+/),i={};for(let s=0;s<t.length;s++)if("list"===t[s].type){const e=[],o=n(r.shift(),t[s].countType);for(let i=0;i<o;i++)e.push(n(r.shift(),t[s].itemType));i[t[s].name]=e}else i[t[s].name]=n(r.shift(),t[s].type);return i}function i(t,e){const n={indices:[],vertices:[],normals:[],uvs:[],faceVertexUvs:[],colors:[]};let i;const a=/end_header\s([\s\S]*)$/;let l="";null!==(i=a.exec(t))&&(l=i[1]);const c=l.split("\n");let u=0,h=0;for(let s=0;s<c.length;s++){let t=c[s];if(t=t.trim(),""===t)continue;h>=e.elements[u].count&&(u++,h=0);const i=r(e.elements[u].properties,t);o(n,e.elements[u].name,i),h++}return s(n)}function s(t){let e=new os;return t.indices.length>0&&e.setIndex(t.indices),e.setAttribute("position",new Zi(t.vertices,3)),t.normals.length>0&&e.setAttribute("normal",new Zi(t.normals,3)),t.uvs.length>0&&e.setAttribute("uv",new Zi(t.uvs,2)),t.colors.length>0&&e.setAttribute("color",new Zi(t.colors,3)),t.faceVertexUvs.length>0&&(e=e.toNonIndexed(),e.setAttribute("uv",new Zi(t.faceVertexUvs,2))),e.computeBoundingSphere(),e}function o(t,e,n){function r(t){for(let e=0,r=t.length;e<r;e++){const r=t[e];if(r in n)return r}return null}const i=r(["x","px","posx"])||"x",s=r(["y","py","posy"])||"y",o=r(["z","pz","posz"])||"z",a=r(["nx","normalx"]),l=r(["ny","normaly"]),c=r(["nz","normalz"]),u=r(["s","u","texture_u","tx"]),h=r(["t","v","texture_v","ty"]),d=r(["red","diffuse_red","r","diffuse_r"]),f=r(["green","diffuse_green","g","diffuse_g"]),p=r(["blue","diffuse_blue","b","diffuse_b"]);if("vertex"===e)t.vertices.push(n[i],n[s],n[o]),null!==a&&null!==l&&null!==c&&t.normals.push(n[a],n[l],n[c]),null!==u&&null!==h&&t.uvs.push(n[u],n[h]),null!==d&&null!==f&&null!==p&&(pw.setRGB(n[d]/255,n[f]/255,n[p]/255).convertSRGBToLinear(),t.colors.push(pw.r,pw.g,pw.b));else if("face"===e){const e=n.vertex_indices||n.vertex_index,r=n.texcoord;3===e.length?(t.indices.push(e[0],e[1],e[2]),r&&6===r.length&&(t.faceVertexUvs.push(r[0],r[1]),t.faceVertexUvs.push(r[2],r[3]),t.faceVertexUvs.push(r[4],r[5]))):4===e.length&&(t.indices.push(e[0],e[1],e[3]),t.indices.push(e[1],e[2],e[3]))}}function a(t,e,n,r){switch(n){case"int8":case"char":return[t.getInt8(e),1];case"uint8":case"uchar":return[t.getUint8(e),1];case"int16":case"short":return[t.getInt16(e,r),2];case"uint16":case"ushort":return[t.getUint16(e,r),2];case"int32":case"int":return[t.getInt32(e,r),4];case"uint32":case"uint":return[t.getUint32(e,r),4];case"float32":case"float":return[t.getFloat32(e,r),4];case"float64":case"double":return[t.getFloat64(e,r),8]}}function l(t,e,n,r){const i={};let s,o=0;for(let l=0;l<n.length;l++)if("list"===n[l].type){const c=[];s=a(t,e+o,n[l].countType,r);const u=s[0];o+=s[1];for(let i=0;i<u;i++)s=a(t,e+o,n[l].itemType,r),c.push(s[0]),o+=s[1];i[n[l].name]=c}else s=a(t,e+o,n[l].type,r),i[n[l].name]=s[0],o+=s[1];return[i,o]}function c(t,e){const n={indices:[],vertices:[],normals:[],uvs:[],faceVertexUvs:[],colors:[]},r="binary_little_endian"===e.format,i=new DataView(t,e.headerLength);let a,c=0;for(let s=0;s<e.elements.length;s++)for(let t=0;t<e.elements[s].count;t++){a=l(i,c,e.elements[s].properties,r),c+=a[1];const t=a[0];o(n,e.elements[s].name,t)}return s(n)}let u;const h=this;if(t instanceof ArrayBuffer){const n=Sm.decodeText(new Uint8Array(t)),r=e(n);u="ascii"===r.format?i(n,r):c(t,r)}else u=i(t,e(t));return u}}(0,r.aZ)({name:"model-ply",mixins:[sy],props:{lights:{type:Array,default:()=>[{type:"HemisphereLight",position:{x:0,y:1,z:0},skyColor:11184895,groundColor:8413280,intensity:.2},{type:"DirectionalLight",position:{x:1,y:1,z:1},color:16777215,intensity:.8}]}},data(){return{loader:new mw}},methods:{getObject(t){return t.computeVertexNormals(),new As(t,new _p)}}});class gw extends rm{constructor(t){super(t)}parse(t){function e(t){switch(t.image_type){case h:case p:(t.colormap_length>256||24!==t.colormap_size||1!==t.colormap_type)&&console.error("THREE.TGALoader: Invalid type colormap data for indexed type.");break;case d:case f:case m:case g:t.colormap_type&&console.error("THREE.TGALoader: Invalid type colormap data for colormap type.");break;case u:console.error("THREE.TGALoader: No data.");default:console.error('THREE.TGALoader: Invalid type "%s".',t.image_type)}(t.width<=0||t.height<=0)&&console.error("THREE.TGALoader: Invalid image size."),8!==t.pixel_size&&16!==t.pixel_size&&24!==t.pixel_size&&32!==t.pixel_size&&console.error('THREE.TGALoader: Invalid pixel size "%s".',t.pixel_size)}function n(t,e,n,r,i){let s,o;const a=n.pixel_size>>3,l=n.width*n.height*a;if(e&&(o=i.subarray(r,r+=n.colormap_length*(n.colormap_size>>3))),t){let t,e,n;s=new Uint8Array(l);let o=0;const c=new Uint8Array(a);while(o<l)if(t=i[r++],e=1+(127&t),128&t){for(n=0;n<a;++n)c[n]=i[r++];for(n=0;n<e;++n)s.set(c,o+n*a);o+=a*e}else{for(e*=a,n=0;n<e;++n)s[o+n]=i[r++];o+=e}}else s=i.subarray(r,r+=e?n.width*n.height:l);return{pixel_data:s,palettes:o}}function r(t,e,n,r,i,s,o,a,l){const c=l;let u,h,d,f=0;const p=S.width;for(d=e;d!==r;d+=n)for(h=i;h!==o;h+=s,f++)u=a[f],t[4*(h+p*d)+3]=255,t[4*(h+p*d)+2]=c[3*u+0],t[4*(h+p*d)+1]=c[3*u+1],t[4*(h+p*d)+0]=c[3*u+2];return t}function i(t,e,n,r,i,s,o,a){let l,c,u,h=0;const d=S.width;for(u=e;u!==r;u+=n)for(c=i;c!==o;c+=s,h+=2)l=a[h+0]+(a[h+1]<<8),t[4*(c+d*u)+0]=(31744&l)>>7,t[4*(c+d*u)+1]=(992&l)>>2,t[4*(c+d*u)+2]=(31&l)<<3,t[4*(c+d*u)+3]=32768&l?0:255;return t}function s(t,e,n,r,i,s,o,a){let l,c,u=0;const h=S.width;for(c=e;c!==r;c+=n)for(l=i;l!==o;l+=s,u+=3)t[4*(l+h*c)+3]=255,t[4*(l+h*c)+2]=a[u+0],t[4*(l+h*c)+1]=a[u+1],t[4*(l+h*c)+0]=a[u+2];return t}function o(t,e,n,r,i,s,o,a){let l,c,u=0;const h=S.width;for(c=e;c!==r;c+=n)for(l=i;l!==o;l+=s,u+=4)t[4*(l+h*c)+2]=a[u+0],t[4*(l+h*c)+1]=a[u+1],t[4*(l+h*c)+0]=a[u+2],t[4*(l+h*c)+3]=a[u+3];return t}function a(t,e,n,r,i,s,o,a){let l,c,u,h=0;const d=S.width;for(u=e;u!==r;u+=n)for(c=i;c!==o;c+=s,h++)l=a[h],t[4*(c+d*u)+0]=l,t[4*(c+d*u)+1]=l,t[4*(c+d*u)+2]=l,t[4*(c+d*u)+3]=255;return t}function l(t,e,n,r,i,s,o,a){let l,c,u=0;const h=S.width;for(c=e;c!==r;c+=n)for(l=i;l!==o;l+=s,u+=2)t[4*(l+h*c)+0]=a[u+0],t[4*(l+h*c)+1]=a[u+0],t[4*(l+h*c)+2]=a[u+0],t[4*(l+h*c)+3]=a[u+1];return t}function c(t,e,n,c,u){let h,d,f,p,m,g;switch((S.flags&v)>>y){default:case w:h=0,f=1,m=e,d=0,p=1,g=n;break;case x:h=0,f=1,m=e,d=n-1,p=-1,g=-1;break;case _:h=e-1,f=-1,m=-1,d=0,p=1,g=n;break;case b:h=e-1,f=-1,m=-1,d=n-1,p=-1,g=-1;break}if(C)switch(S.pixel_size){case 8:a(t,d,p,g,h,f,m,c);break;case 16:l(t,d,p,g,h,f,m,c);break;default:console.error("THREE.TGALoader: Format not supported.");break}else switch(S.pixel_size){case 8:r(t,d,p,g,h,f,m,c,u);break;case 16:i(t,d,p,g,h,f,m,c);break;case 24:s(t,d,p,g,h,f,m,c);break;case 32:o(t,d,p,g,h,f,m,c);break;default:console.error("THREE.TGALoader: Format not supported.");break}return t}const u=0,h=1,d=2,f=3,p=9,m=10,g=11,v=48,y=4,x=0,b=1,w=2,_=3;t.length<19&&console.error("THREE.TGALoader: Not enough data to contain header.");let M=0;const A=new Uint8Array(t),S={id_length:A[M++],colormap_type:A[M++],image_type:A[M++],colormap_index:A[M++]|A[M++]<<8,colormap_length:A[M++]|A[M++]<<8,colormap_size:A[M++],origin:[A[M++]|A[M++]<<8,A[M++]|A[M++]<<8],width:A[M++]|A[M++]<<8,height:A[M++]|A[M++]<<8,pixel_size:A[M++],flags:A[M++]};e(S),S.id_length+M>t.length&&console.error("THREE.TGALoader: No data."),M+=S.id_length;let E=!1,T=!1,C=!1;switch(S.image_type){case p:E=!0,T=!0;break;case h:T=!0;break;case m:E=!0;break;case d:break;case g:E=!0,C=!0;break;case f:C=!0;break}const R=new Uint8Array(S.width*S.height*4),I=n(E,T,S,M,A);return c(R,S.width,S.height,I.pixel_data,I.palettes),{data:R,width:S.width,height:S.height,flipY:!0,generateMipmaps:!0,minFilter:Mt}}}class vw extends Kp{constructor(t){super(t)}load(t,e,n,r){const i=this,s=""===i.path?Sm.extractUrlBase(t):i.path,o=new Qp(i.manager);o.setPath(i.path),o.setRequestHeader(i.requestHeader),o.setWithCredentials(i.withCredentials),o.load(t,(function(n){try{e(i.parse(n,s))}catch(v_){r?r(v_):console.error(v_),i.manager.itemError(t)}}),n,r)}parse(t,e){function n(t,e){const n=[],r=t.childNodes;for(let i=0,s=r.length;i<s;i++){const t=r[i];t.nodeName===e&&n.push(t)}return n}function r(t){if(0===t.length)return[];const e=t.trim().split(/\s+/),n=new Array(e.length);for(let r=0,i=e.length;r<i;r++)n[r]=e[r];return n}function i(t){if(0===t.length)return[];const e=t.trim().split(/\s+/),n=new Array(e.length);for(let r=0,i=e.length;r<i;r++)n[r]=parseFloat(e[r]);return n}function s(t){if(0===t.length)return[];const e=t.trim().split(/\s+/),n=new Array(e.length);for(let r=0,i=e.length;r<i;r++)n[r]=parseInt(e[r]);return n}function o(t){return t.substring(1)}function a(){return"three_default_"+Re++}function l(t){return 0===Object.keys(t).length}function c(t){return{unit:u(n(t,"unit")[0]),upAxis:h(n(t,"up_axis")[0])}}function u(t){return void 0!==t&&!0===t.hasAttribute("meter")?parseFloat(t.getAttribute("meter")):1}function h(t){return void 0!==t?t.textContent:"Y_UP"}function d(t,e,r,i){const s=n(t,e)[0];if(void 0!==s){const t=n(s,r);for(let e=0;e<t.length;e++)i(t[e])}}function f(t,e){for(const n in t){const r=t[n];r.build=e(t[n])}}function p(t,e){return void 0!==t.build||(t.build=e(t)),t.build}function m(t){const e={sources:{},samplers:{},channels:{}};let n=!1;for(let r=0,i=t.childNodes.length;r<i;r++){const i=t.childNodes[r];if(1!==i.nodeType)continue;let s;switch(i.nodeName){case"source":s=i.getAttribute("id"),e.sources[s]=Et(i);break;case"sampler":s=i.getAttribute("id"),e.samplers[s]=v(i);break;case"channel":s=i.getAttribute("target"),e.channels[s]=x(i);break;case"animation":m(i),n=!0;break;default:console.log(i)}}!1===n&&(Ie.animations[t.getAttribute("id")||Wn.generateUUID()]=e)}function v(t){const e={inputs:{}};for(let n=0,r=t.childNodes.length;n<r;n++){const r=t.childNodes[n];if(1===r.nodeType)switch(r.nodeName){case"input":const t=o(r.getAttribute("source")),n=r.getAttribute("semantic");e.inputs[n]=t;break}}return e}function x(t){const e={},n=t.getAttribute("target");let r=n.split("/");const i=r.shift();let s=r.shift();const a=-1!==s.indexOf("("),l=-1!==s.indexOf(".");if(l)r=s.split("."),s=r.shift(),e.member=r.shift();else if(a){const t=s.split("(");s=t.shift();for(let e=0;e<t.length;e++)t[e]=parseInt(t[e].replace(/\)/,""));e.indices=t}return e.id=i,e.sid=s,e.arraySyntax=a,e.memberSyntax=l,e.sampler=o(t.getAttribute("source")),e}function b(t){const e=[],n=t.channels,r=t.samplers,i=t.sources;for(const s in n)if(n.hasOwnProperty(s)){const t=n[s],o=r[t.sampler],a=o.inputs.INPUT,l=o.inputs.OUTPUT,c=i[a],u=i[l],h=_(t,c,u);T(h,e)}return e}function w(t){return p(Ie.animations[t],b)}function _(t,e,n){const r=Ie.nodes[t.id],i=he(r.id),s=r.transforms[t.sid],o=r.matrix.clone().transpose();let a,l,c,u,h,d;const f={};switch(s){case"matrix":for(c=0,u=e.array.length;c<u;c++)if(a=e.array[c],l=c*n.stride,void 0===f[a]&&(f[a]={}),!0===t.arraySyntax){const e=n.array[l],r=t.indices[0]+4*t.indices[1];f[a][r]=e}else for(h=0,d=n.stride;h<d;h++)f[a][h]=n.array[l+h];break;case"translate":console.warn('THREE.ColladaLoader: Animation transform type "%s" not yet implemented.',s);break;case"rotate":console.warn('THREE.ColladaLoader: Animation transform type "%s" not yet implemented.',s);break;case"scale":console.warn('THREE.ColladaLoader: Animation transform type "%s" not yet implemented.',s);break}const p=M(f,o),m={name:i.uuid,keyframes:p};return m}function M(t,e){const n=[];for(const i in t)n.push({time:parseFloat(i),value:t[i]});n.sort(r);for(let i=0;i<16;i++)C(n,i,e.elements[i]);return n;function r(t,e){return t.time-e.time}}const A=new Mr,S=new Mr,E=new _r;function T(t,e){const n=t.keyframes,r=t.name,i=[],s=[],o=[],a=[];for(let l=0,c=n.length;l<c;l++){const t=n[l],e=t.time,r=t.value;te.fromArray(r).transpose(),te.decompose(A,E,S),i.push(e),s.push(A.x,A.y,A.z),o.push(E.x,E.y,E.z,E.w),a.push(S.x,S.y,S.z)}return s.length>0&&e.push(new Vp(r+".position",i,s)),o.length>0&&e.push(new Gp(r+".quaternion",i,o)),a.length>0&&e.push(new Vp(r+".scale",i,a)),e}function C(t,e,n){let r,i,s,o=!0;for(i=0,s=t.length;i<s;i++)r=t[i],void 0===r.value[e]?r.value[e]=null:o=!1;if(!0===o)for(i=0,s=t.length;i<s;i++)r=t[i],r.value[e]=n;else R(t,e)}function R(t,e){let n,r;for(let i=0,s=t.length;i<s;i++){const s=t[i];if(null===s.value[e]){if(n=I(t,i,e),r=P(t,i,e),null===n){s.value[e]=r.value[e];continue}if(null===r){s.value[e]=n.value[e];continue}L(s,n,r,e)}}}function I(t,e,n){while(e>=0){const r=t[e];if(null!==r.value[n])return r;e--}return null}function P(t,e,n){while(e<t.length){const r=t[e];if(null!==r.value[n])return r;e++}return null}function L(t,e,n,r){n.time-e.time!==0?t.value[r]=(t.time-e.time)*(n.value[r]-e.value[r])/(n.time-e.time)+e.value[r]:t.value[r]=e.value[r]}function N(t){const e={name:t.getAttribute("id")||"default",start:parseFloat(t.getAttribute("start")||0),end:parseFloat(t.getAttribute("end")||0),animations:[]};for(let n=0,r=t.childNodes.length;n<r;n++){const r=t.childNodes[n];if(1===r.nodeType)switch(r.nodeName){case"instance_animation":e.animations.push(o(r.getAttribute("url")));break}}Ie.clips[t.getAttribute("id")]=e}function k(t){const e=[],n=t.name,r=t.end-t.start||-1,i=t.animations;for(let s=0,o=i.length;s<o;s++){const t=w(i[s]);for(let n=0,r=t.length;n<r;n++)e.push(t[n])}return new jp(n,r,e)}function O(t){return p(Ie.clips[t],k)}function D(t){const e={};for(let n=0,r=t.childNodes.length;n<r;n++){const r=t.childNodes[n];if(1===r.nodeType)switch(r.nodeName){case"skin":e.id=o(r.getAttribute("source")),e.skin=z(r);break;case"morph":e.id=o(r.getAttribute("source")),console.warn("THREE.ColladaLoader: Morph target animation not supported yet.");break}}Ie.controllers[t.getAttribute("id")]=e}function z(t){const e={sources:{}};for(let n=0,r=t.childNodes.length;n<r;n++){const r=t.childNodes[n];if(1===r.nodeType)switch(r.nodeName){case"bind_shape_matrix":e.bindShapeMatrix=i(r.textContent);break;case"source":const t=r.getAttribute("id");e.sources[t]=Et(r);break;case"joints":e.joints=F(r);break;case"vertex_weights":e.vertexWeights=U(r);break}}return e}function F(t){const e={inputs:{}};for(let n=0,r=t.childNodes.length;n<r;n++){const r=t.childNodes[n];if(1===r.nodeType)switch(r.nodeName){case"input":const t=r.getAttribute("semantic"),n=o(r.getAttribute("source"));e.inputs[t]=n;break}}return e}function U(t){const e={inputs:{}};for(let n=0,r=t.childNodes.length;n<r;n++){const r=t.childNodes[n];if(1===r.nodeType)switch(r.nodeName){case"input":const t=r.getAttribute("semantic"),n=o(r.getAttribute("source")),i=parseInt(r.getAttribute("offset"));e.inputs[t]={id:n,offset:i};break;case"vcount":e.vcount=s(r.textContent);break;case"v":e.v=s(r.textContent);break}}return e}function B(t){const e={id:t.id},n=Ie.geometries[e.id];return void 0!==t.skin&&(e.skin=G(t.skin),n.sources.skinIndices=e.skin.indices,n.sources.skinWeights=e.skin.weights),e}function G(t){const e=4,n={joints:[],indices:{array:[],stride:e},weights:{array:[],stride:e}},r=t.sources,i=t.vertexWeights,s=i.vcount,o=i.v,a=i.inputs.JOINT.offset,l=i.inputs.WEIGHT.offset,c=t.sources[t.joints.inputs.JOINT],u=t.sources[t.joints.inputs.INV_BIND_MATRIX],h=r[i.inputs.WEIGHT.id].array;let d,f,p,m=0;for(d=0,p=s.length;d<p;d++){const t=s[d],r=[];for(f=0;f<t;f++){const t=o[m+a],e=o[m+l],n=h[e];r.push({index:t,weight:n}),m+=2}for(r.sort(g),f=0;f<e;f++){const t=r[f];void 0!==t?(n.indices.array.push(t.index),n.weights.array.push(t.weight)):(n.indices.array.push(0),n.weights.array.push(0))}}for(t.bindShapeMatrix?n.bindMatrix=(new ti).fromArray(t.bindShapeMatrix).transpose():n.bindMatrix=(new ti).identity(),d=0,p=c.array.length;d<p;d++){const t=c.array[d],e=(new ti).fromArray(u.array,d*u.stride).transpose();n.joints.push({name:t,boneInverse:e})}return n;function g(t,e){return e.weight-t.weight}}function H(t){return p(Ie.controllers[t],B)}function V(t){const e={init_from:n(t,"init_from")[0].textContent};Ie.images[t.getAttribute("id")]=e}function j(t){return void 0!==t.build?t.build:t.init_from}function W(t){const e=Ie.images[t];return void 0!==e?p(e,j):(console.warn("THREE.ColladaLoader: Couldn't find image with ID:",t),null)}function q(t){const e={};for(let n=0,r=t.childNodes.length;n<r;n++){const r=t.childNodes[n];if(1===r.nodeType)switch(r.nodeName){case"profile_COMMON":e.profile=Y(r);break}}Ie.effects[t.getAttribute("id")]=e}function Y(t){const e={surfaces:{},samplers:{}};for(let n=0,r=t.childNodes.length;n<r;n++){const r=t.childNodes[n];if(1===r.nodeType)switch(r.nodeName){case"newparam":X(r,e);break;case"technique":e.technique=Z(r);break;case"extra":e.extra=rt(r);break}}return e}function X(t,e){const n=t.getAttribute("sid");for(let r=0,i=t.childNodes.length;r<i;r++){const i=t.childNodes[r];if(1===i.nodeType)switch(i.nodeName){case"surface":e.surfaces[n]=J(i);break;case"sampler2D":e.samplers[n]=K(i);break}}}function J(t){const e={};for(let n=0,r=t.childNodes.length;n<r;n++){const r=t.childNodes[n];if(1===r.nodeType)switch(r.nodeName){case"init_from":e.init_from=r.textContent;break}}return e}function K(t){const e={};for(let n=0,r=t.childNodes.length;n<r;n++){const r=t.childNodes[n];if(1===r.nodeType)switch(r.nodeName){case"source":e.source=r.textContent;break}}return e}function Z(t){const e={};for(let n=0,r=t.childNodes.length;n<r;n++){const r=t.childNodes[n];if(1===r.nodeType)switch(r.nodeName){case"constant":case"lambert":case"blinn":case"phong":e.type=r.nodeName,e.parameters=Q(r);break;case"extra":e.extra=rt(r);break}}return e}function Q(t){const e={};for(let n=0,r=t.childNodes.length;n<r;n++){const r=t.childNodes[n];if(1===r.nodeType)switch(r.nodeName){case"emission":case"diffuse":case"specular":case"bump":case"ambient":case"shininess":case"transparency":e[r.nodeName]=$(r);break;case"transparent":e[r.nodeName]={opaque:r.hasAttribute("opaque")?r.getAttribute("opaque"):"A_ONE",data:$(r)};break}}return e}function $(t){const e={};for(let n=0,r=t.childNodes.length;n<r;n++){const r=t.childNodes[n];if(1===r.nodeType)switch(r.nodeName){case"color":e[r.nodeName]=i(r.textContent);break;case"float":e[r.nodeName]=parseFloat(r.textContent);break;case"texture":e[r.nodeName]={id:r.getAttribute("texture"),extra:tt(r)};break}}return e}function tt(t){const e={technique:{}};for(let n=0,r=t.childNodes.length;n<r;n++){const r=t.childNodes[n];if(1===r.nodeType)switch(r.nodeName){case"extra":et(r,e);break}}return e}function et(t,e){for(let n=0,r=t.childNodes.length;n<r;n++){const r=t.childNodes[n];if(1===r.nodeType)switch(r.nodeName){case"technique":nt(r,e);break}}}function nt(t,e){for(let n=0,r=t.childNodes.length;n<r;n++){const r=t.childNodes[n];if(1===r.nodeType)switch(r.nodeName){case"repeatU":case"repeatV":case"offsetU":case"offsetV":e.technique[r.nodeName]=parseFloat(r.textContent);break;case"wrapU":case"wrapV":"TRUE"===r.textContent.toUpperCase()?e.technique[r.nodeName]=1:"FALSE"===r.textContent.toUpperCase()?e.technique[r.nodeName]=0:e.technique[r.nodeName]=parseInt(r.textContent);break;case"bump":e[r.nodeName]=st(r);break}}}function rt(t){const e={};for(let n=0,r=t.childNodes.length;n<r;n++){const r=t.childNodes[n];if(1===r.nodeType)switch(r.nodeName){case"technique":e.technique=it(r);break}}return e}function it(t){const e={};for(let n=0,r=t.childNodes.length;n<r;n++){const r=t.childNodes[n];if(1===r.nodeType)switch(r.nodeName){case"double_sided":e[r.nodeName]=parseInt(r.textContent);break;case"bump":e[r.nodeName]=st(r);break}}return e}function st(t){const e={};for(let n=0,r=t.childNodes.length;n<r;n++){const r=t.childNodes[n];if(1===r.nodeType)switch(r.nodeName){case"texture":e[r.nodeName]={id:r.getAttribute("texture"),texcoord:r.getAttribute("texcoord"),extra:tt(r)};break}}return e}function ot(t){return t}function at(t){return p(Ie.effects[t],ot)}function lt(t){const e={name:t.getAttribute("name")};for(let n=0,r=t.childNodes.length;n<r;n++){const r=t.childNodes[n];if(1===r.nodeType)switch(r.nodeName){case"instance_effect":e.url=o(r.getAttribute("url"));break}}Ie.materials[t.getAttribute("id")]=e}function ct(t){let e,n=t.slice(2+(t.lastIndexOf(".")-1>>>0));switch(n=n.toLowerCase(),n){case"tga":e=Se;break;default:e=Ae}return e}function ut(t){const e=at(t.url),n=e.profile.technique;let r;switch(n.type){case"phong":case"blinn":r=new Ap;break;case"lambert":r=new Tp;break;default:r=new Ui;break}function i(t,n=null){const r=e.profile.samplers[t.id];let i=null;if(void 0!==r){const t=e.profile.surfaces[r.source];i=W(t.init_from)}else console.warn("THREE.ColladaLoader: Undefined sampler. Access image directly (see #12530)."),i=W(t.id);if(null!==i){const e=ct(i);if(void 0!==e){const r=e.load(i),s=t.extra;if(void 0!==s&&void 0!==s.technique&&!1===l(s.technique)){const t=s.technique;r.wrapS=t.wrapU?dt:ft,r.wrapT=t.wrapV?dt:ft,r.offset.set(t.offsetU||0,t.offsetV||0),r.repeat.set(t.repeatU||1,t.repeatV||1)}else r.wrapS=dt,r.wrapT=dt;return null!==n&&(r.encoding=n),r}return console.warn("THREE.ColladaLoader: Loader for texture %s not found.",i),null}return console.warn("THREE.ColladaLoader: Couldn't create texture with ID:",t.id),null}r.name=t.name||"";const s=n.parameters;for(const l in s){const t=s[l];switch(l){case"diffuse":t.color&&r.color.fromArray(t.color),t.texture&&(r.map=i(t.texture,Oe));break;case"specular":t.color&&r.specular&&r.specular.fromArray(t.color),t.texture&&(r.specularMap=i(t.texture));break;case"bump":t.texture&&(r.normalMap=i(t.texture));break;case"ambient":t.texture&&(r.lightMap=i(t.texture,Oe));break;case"shininess":t.float&&r.shininess&&(r.shininess=t.float);break;case"emission":t.color&&r.emissive&&r.emissive.fromArray(t.color),t.texture&&(r.emissiveMap=i(t.texture,Oe));break}}r.color.convertSRGBToLinear(),r.specular&&r.specular.convertSRGBToLinear(),r.emissive&&r.emissive.convertSRGBToLinear();let o=s["transparent"],a=s["transparency"];if(void 0===a&&o&&(a={float:1}),void 0===o&&a&&(o={opaque:"A_ONE",data:{color:[1,1,1,1]}}),o&&a)if(o.data.texture)r.transparent=!0;else{const t=o.data.color;switch(o.opaque){case"A_ONE":r.opacity=t[3]*a.float;break;case"RGB_ZERO":r.opacity=1-t[0]*a.float;break;case"A_ZERO":r.opacity=1-t[3]*a.float;break;case"RGB_ONE":r.opacity=t[0]*a.float;break;default:console.warn('THREE.ColladaLoader: Invalid opaque type "%s" of transparent tag.',o.opaque)}r.opacity<1&&(r.transparent=!0)}if(void 0!==n.extra&&void 0!==n.extra.technique){const t=n.extra.technique;for(const e in t){const n=t[e];switch(e){case"double_sided":r.side=1===n?y:g;break;case"bump":r.normalMap=i(n.texture),r.normalScale=new qn(1,1);break}}}return r}function ht(t){return p(Ie.materials[t],ut)}function pt(t){const e={name:t.getAttribute("name")};for(let n=0,r=t.childNodes.length;n<r;n++){const r=t.childNodes[n];if(1===r.nodeType)switch(r.nodeName){case"optics":e.optics=mt(r);break}}Ie.cameras[t.getAttribute("id")]=e}function mt(t){for(let e=0;e<t.childNodes.length;e++){const n=t.childNodes[e];switch(n.nodeName){case"technique_common":return gt(n)}}return{}}function gt(t){const e={};for(let n=0;n<t.childNodes.length;n++){const r=t.childNodes[n];switch(r.nodeName){case"perspective":case"orthographic":e.technique=r.nodeName,e.parameters=vt(r);break}}return e}function vt(t){const e={};for(let n=0;n<t.childNodes.length;n++){const r=t.childNodes[n];switch(r.nodeName){case"xfov":case"yfov":case"xmag":case"ymag":case"znear":case"zfar":case"aspect_ratio":e[r.nodeName]=parseFloat(r.textContent);break}}return e}function yt(t){let e;switch(t.optics.technique){case"perspective":e=new Os(t.optics.parameters.yfov,t.optics.parameters.aspect_ratio,t.optics.parameters.znear,t.optics.parameters.zfar);break;case"orthographic":let n=t.optics.parameters.ymag,r=t.optics.parameters.xmag;const i=t.optics.parameters.aspect_ratio;r=void 0===r?n*i:r,n=void 0===n?r/i:n,r*=.5,n*=.5,e=new Dl(-r,r,n,-n,t.optics.parameters.znear,t.optics.parameters.zfar);break;default:e=new Os;break}return e.name=t.name||"",e}function xt(t){const e=Ie.cameras[t];return void 0!==e?p(e,yt):(console.warn("THREE.ColladaLoader: Couldn't find camera with ID:",t),null)}function bt(t){let e={};for(let n=0,r=t.childNodes.length;n<r;n++){const r=t.childNodes[n];if(1===r.nodeType)switch(r.nodeName){case"technique_common":e=wt(r);break}}Ie.lights[t.getAttribute("id")]=e}function wt(t){const e={};for(let n=0,r=t.childNodes.length;n<r;n++){const r=t.childNodes[n];if(1===r.nodeType)switch(r.nodeName){case"directional":case"point":case"spot":case"ambient":e.technique=r.nodeName,e.parameters=_t(r)}}return e}function _t(t){const e={};for(let n=0,r=t.childNodes.length;n<r;n++){const r=t.childNodes[n];if(1===r.nodeType)switch(r.nodeName){case"color":const t=i(r.textContent);e.color=(new lr).fromArray(t).convertSRGBToLinear();break;case"falloff_angle":e.falloffAngle=parseFloat(r.textContent);break;case"quadratic_attenuation":const n=parseFloat(r.textContent);e.distance=n?Math.sqrt(1/n):0;break}}return e}function Mt(t){let e;switch(t.technique){case"directional":e=new xm;break;case"point":e=new vm;break;case"spot":e=new dm;break;case"ambient":e=new bm;break}return t.parameters.color&&e.color.copy(t.parameters.color),t.parameters.distance&&(e.distance=t.parameters.distance),e}function At(t){const e=Ie.lights[t];return void 0!==e?p(e,Mt):(console.warn("THREE.ColladaLoader: Couldn't find light with ID:",t),null)}function St(t){const e={name:t.getAttribute("name"),sources:{},vertices:{},primitives:[]},r=n(t,"mesh")[0];if(void 0!==r){for(let t=0;t<r.childNodes.length;t++){const n=r.childNodes[t];if(1!==n.nodeType)continue;const i=n.getAttribute("id");switch(n.nodeName){case"source":e.sources[i]=Et(n);break;case"vertices":e.vertices=Tt(n);break;case"polygons":console.warn("THREE.ColladaLoader: Unsupported primitive type: ",n.nodeName);break;case"lines":case"linestrips":case"polylist":case"triangles":e.primitives.push(Ct(n));break;default:console.log(n)}}Ie.geometries[t.getAttribute("id")]=e}}function Et(t){const e={array:[],stride:3};for(let s=0;s<t.childNodes.length;s++){const o=t.childNodes[s];if(1===o.nodeType)switch(o.nodeName){case"float_array":e.array=i(o.textContent);break;case"Name_array":e.array=r(o.textContent);break;case"technique_common":const t=n(o,"accessor")[0];void 0!==t&&(e.stride=parseInt(t.getAttribute("stride")));break}}return e}function Tt(t){const e={};for(let n=0;n<t.childNodes.length;n++){const r=t.childNodes[n];1===r.nodeType&&(e[r.getAttribute("semantic")]=o(r.getAttribute("source")))}return e}function Ct(t){const e={type:t.nodeName,material:t.getAttribute("material"),count:parseInt(t.getAttribute("count")),inputs:{},stride:0,hasUV:!1};for(let n=0,r=t.childNodes.length;n<r;n++){const r=t.childNodes[n];if(1===r.nodeType)switch(r.nodeName){case"input":const t=o(r.getAttribute("source")),n=r.getAttribute("semantic"),i=parseInt(r.getAttribute("offset")),a=parseInt(r.getAttribute("set")),l=a>0?n+a:n;e.inputs[l]={id:t,offset:i},e.stride=Math.max(e.stride,i+1),"TEXCOORD"===n&&(e.hasUV=!0);break;case"vcount":e.vcount=s(r.textContent);break;case"p":e.p=s(r.textContent);break}}return e}function Rt(t){const e={};for(let n=0;n<t.length;n++){const r=t[n];void 0===e[r.type]&&(e[r.type]=[]),e[r.type].push(r)}return e}function It(t){let e=0;for(let n=0,r=t.length;n<r;n++){const r=t[n];!0===r.hasUV&&e++}e>0&&e<t.length&&(t.uvsNeedsFix=!0)}function Pt(t){const e={},n=t.sources,r=t.vertices,i=t.primitives;if(0===i.length)return{};const s=Rt(i);for(const o in s){const t=s[o];It(t),e[o]=Lt(t,n,r)}return e}function Lt(t,e,n){const r={},i={array:[],stride:0},s={array:[],stride:0},o={array:[],stride:0},a={array:[],stride:0},l={array:[],stride:0},c={array:[],stride:4},u={array:[],stride:4},h=new os,d=[];let f=0;for(let p=0;p<t.length;p++){const r=t[p],m=r.inputs;let g=0;switch(r.type){case"lines":case"linestrips":g=2*r.count;break;case"triangles":g=3*r.count;break;case"polylist":for(let t=0;t<r.count;t++){const e=r.vcount[t];switch(e){case 3:g+=3;break;case 4:g+=6;break;default:g+=3*(e-2);break}}break;default:console.warn("THREE.ColladaLoader: Unknow primitive type:",r.type)}h.addGroup(f,g,p),f+=g,r.material&&d.push(r.material);for(const h in m){const d=m[h];switch(h){case"VERTEX":for(const h in n){const f=n[h];switch(h){case"POSITION":const n=i.array.length;if(Nt(r,e[f],d.offset,i.array),i.stride=e[f].stride,e.skinWeights&&e.skinIndices&&(Nt(r,e.skinIndices,d.offset,c.array),Nt(r,e.skinWeights,d.offset,u.array)),!1===r.hasUV&&!0===t.uvsNeedsFix){const t=(i.array.length-n)/i.stride;for(let e=0;e<t;e++)o.array.push(0,0)}break;case"NORMAL":Nt(r,e[f],d.offset,s.array),s.stride=e[f].stride;break;case"COLOR":Nt(r,e[f],d.offset,l.array),l.stride=e[f].stride;break;case"TEXCOORD":Nt(r,e[f],d.offset,o.array),o.stride=e[f].stride;break;case"TEXCOORD1":Nt(r,e[f],d.offset,a.array),o.stride=e[f].stride;break;default:console.warn('THREE.ColladaLoader: Semantic "%s" not handled in geometry build process.',h)}}break;case"NORMAL":Nt(r,e[d.id],d.offset,s.array),s.stride=e[d.id].stride;break;case"COLOR":Nt(r,e[d.id],d.offset,l.array,!0),l.stride=e[d.id].stride;break;case"TEXCOORD":Nt(r,e[d.id],d.offset,o.array),o.stride=e[d.id].stride;break;case"TEXCOORD1":Nt(r,e[d.id],d.offset,a.array),a.stride=e[d.id].stride;break}}}return i.array.length>0&&h.setAttribute("position",new Zi(i.array,i.stride)),s.array.length>0&&h.setAttribute("normal",new Zi(s.array,s.stride)),l.array.length>0&&h.setAttribute("color",new Zi(l.array,l.stride)),o.array.length>0&&h.setAttribute("uv",new Zi(o.array,o.stride)),a.array.length>0&&h.setAttribute("uv2",new Zi(a.array,a.stride)),c.array.length>0&&h.setAttribute("skinIndex",new Zi(c.array,c.stride)),u.array.length>0&&h.setAttribute("skinWeight",new Zi(u.array,u.stride)),r.data=h,r.type=t[0].type,r.materialKeys=d,r}function Nt(t,e,n,r,i=!1){const s=t.p,o=t.stride,a=t.vcount;function l(t){let e=s[t+n]*u;const o=e+u;for(;e<o;e++)r.push(c[e]);if(i){const t=r.length-u-1;Ee.setRGB(r[t+0],r[t+1],r[t+2]).convertSRGBToLinear(),r[t+0]=Ee.r,r[t+1]=Ee.g,r[t+2]=Ee.b}}const c=e.array,u=e.stride;if(void 0!==t.vcount){let t=0;for(let e=0,n=a.length;e<n;e++){const n=a[e];if(4===n){const e=t+0*o,n=t+1*o,r=t+2*o,i=t+3*o;l(e),l(n),l(i),l(n),l(r),l(i)}else if(3===n){const e=t+0*o,n=t+1*o,r=t+2*o;l(e),l(n),l(r)}else if(n>4)for(let e=1,r=n-2;e<=r;e++){const n=t+0*o,r=t+o*e,i=t+o*(e+1);l(n),l(r),l(i)}t+=o*n}}else for(let h=0,d=s.length;h<d;h+=o)l(h)}function kt(t){return p(Ie.geometries[t],Pt)}function Ot(t){const e={name:t.getAttribute("name")||"",joints:{},links:[]};for(let n=0;n<t.childNodes.length;n++){const r=t.childNodes[n];if(1===r.nodeType)switch(r.nodeName){case"technique_common":Ft(r,e);break}}Ie.kinematicsModels[t.getAttribute("id")]=e}function Dt(t){return void 0!==t.build?t.build:t}function zt(t){return p(Ie.kinematicsModels[t],Dt)}function Ft(t,e){for(let n=0;n<t.childNodes.length;n++){const r=t.childNodes[n];if(1===r.nodeType)switch(r.nodeName){case"joint":e.joints[r.getAttribute("sid")]=Ut(r);break;case"link":e.links.push(Gt(r));break}}}function Ut(t){let e;for(let n=0;n<t.childNodes.length;n++){const r=t.childNodes[n];if(1===r.nodeType)switch(r.nodeName){case"prismatic":case"revolute":e=Bt(r);break}}return e}function Bt(t){const e={sid:t.getAttribute("sid"),name:t.getAttribute("name")||"",axis:new Mr,limits:{min:0,max:0},type:t.nodeName,static:!1,zeroPosition:0,middlePosition:0};for(let n=0;n<t.childNodes.length;n++){const r=t.childNodes[n];if(1===r.nodeType)switch(r.nodeName){case"axis":const t=i(r.textContent);e.axis.fromArray(t);break;case"limits":const n=r.getElementsByTagName("max")[0],s=r.getElementsByTagName("min")[0];e.limits.max=parseFloat(n.textContent),e.limits.min=parseFloat(s.textContent);break}}return e.limits.min>=e.limits.max&&(e.static=!0),e.middlePosition=(e.limits.min+e.limits.max)/2,e}function Gt(t){const e={sid:t.getAttribute("sid"),name:t.getAttribute("name")||"",attachments:[],transforms:[]};for(let n=0;n<t.childNodes.length;n++){const r=t.childNodes[n];if(1===r.nodeType)switch(r.nodeName){case"attachment_full":e.attachments.push(Ht(r));break;case"matrix":case"translate":case"rotate":e.transforms.push(Vt(r));break}}return e}function Ht(t){const e={joint:t.getAttribute("joint").split("/").pop(),transforms:[],links:[]};for(let n=0;n<t.childNodes.length;n++){const r=t.childNodes[n];if(1===r.nodeType)switch(r.nodeName){case"link":e.links.push(Gt(r));break;case"matrix":case"translate":case"rotate":e.transforms.push(Vt(r));break}}return e}function Vt(t){const e={type:t.nodeName},n=i(t.textContent);switch(e.type){case"matrix":e.obj=new ti,e.obj.fromArray(n).transpose();break;case"translate":e.obj=new Mr,e.obj.fromArray(n);break;case"rotate":e.obj=new Mr,e.obj.fromArray(n),e.angle=Wn.degToRad(n[3]);break}return e}function jt(t){const e={name:t.getAttribute("name")||"",rigidBodies:{}};for(let n=0;n<t.childNodes.length;n++){const r=t.childNodes[n];if(1===r.nodeType)switch(r.nodeName){case"rigid_body":e.rigidBodies[r.getAttribute("name")]={},Wt(r,e.rigidBodies[r.getAttribute("name")]);break}}Ie.physicsModels[t.getAttribute("id")]=e}function Wt(t,e){for(let n=0;n<t.childNodes.length;n++){const r=t.childNodes[n];if(1===r.nodeType)switch(r.nodeName){case"technique_common":qt(r,e);break}}}function qt(t,e){for(let n=0;n<t.childNodes.length;n++){const r=t.childNodes[n];if(1===r.nodeType)switch(r.nodeName){case"inertia":e.inertia=i(r.textContent);break;case"mass":e.mass=i(r.textContent)[0];break}}}function Yt(t){const e={bindJointAxis:[]};for(let n=0;n<t.childNodes.length;n++){const r=t.childNodes[n];if(1===r.nodeType)switch(r.nodeName){case"bind_joint_axis":e.bindJointAxis.push(Xt(r));break}}Ie.kinematicsScenes[o(t.getAttribute("url"))]=e}function Xt(t){const e={target:t.getAttribute("target").split("/").pop()};for(let n=0;n<t.childNodes.length;n++){const r=t.childNodes[n];if(1===r.nodeType)switch(r.nodeName){case"axis":const t=r.getElementsByTagName("param")[0];e.axis=t.textContent;const n=e.axis.split("inst_").pop().split("axis")[0];e.jointIndex=n.substring(0,n.length-1);break}}return e}function Jt(t){return void 0!==t.build?t.build:t}function Kt(t){return p(Ie.kinematicsScenes[t],Jt)}function Zt(){const t=Object.keys(Ie.kinematicsModels)[0],e=Object.keys(Ie.kinematicsScenes)[0],n=Object.keys(Ie.visualScenes)[0];if(void 0===t||void 0===e)return;const r=zt(t),i=Kt(e),s=me(n),o=i.bindJointAxis,a={};for(let u=0,h=o.length;u<h;u++){const t=o[u],e=be.querySelector('[sid="'+t.target+'"]');if(e){const n=e.parentElement;l(t.jointIndex,n)}}function l(t,e){const n=e.getAttribute("name"),i=r.joints[t];s.traverse((function(r){r.name===n&&(a[t]={object:r,transforms:Qt(e),joint:i,position:i.zeroPosition})}))}const c=new ti;Ce={joints:r&&r.joints,getJointValue:function(t){const e=a[t];if(e)return e.position;console.warn("THREE.ColladaLoader: Joint "+t+" doesn't exist.")},setJointValue:function(t,e){const n=a[t];if(n){const r=n.joint;if(e>r.limits.max||e<r.limits.min)console.warn("THREE.ColladaLoader: Joint "+t+" value "+e+" outside of limits (min: "+r.limits.min+", max: "+r.limits.max+").");else if(r.static)console.warn("THREE.ColladaLoader: Joint "+t+" is static.");else{const i=n.object,s=r.axis,o=n.transforms;te.identity();for(let n=0;n<o.length;n++){const i=o[n];if(i.sid&&-1!==i.sid.indexOf(t))switch(r.type){case"revolute":te.multiply(c.makeRotationAxis(s,Wn.degToRad(e)));break;case"prismatic":te.multiply(c.makeTranslation(s.x*e,s.y*e,s.z*e));break;default:console.warn("THREE.ColladaLoader: Unknown joint type: "+r.type);break}else switch(i.type){case"matrix":te.multiply(i.obj);break;case"translate":te.multiply(c.makeTranslation(i.obj.x,i.obj.y,i.obj.z));break;case"scale":te.scale(i.obj);break;case"rotate":te.multiply(c.makeRotationAxis(i.obj,i.angle));break}}i.matrix.copy(te),i.matrix.decompose(i.position,i.quaternion,i.scale),a[t].position=e}}else console.log("THREE.ColladaLoader: "+t+" does not exist.")}}}function Qt(t){const e=[],n=be.querySelector('[id="'+t.id+'"]');for(let r=0;r<n.childNodes.length;r++){const t=n.childNodes[r];if(1!==t.nodeType)continue;let s,o;switch(t.nodeName){case"matrix":s=i(t.textContent);const n=(new ti).fromArray(s).transpose();e.push({sid:t.getAttribute("sid"),type:t.nodeName,obj:n});break;case"translate":case"scale":s=i(t.textContent),o=(new Mr).fromArray(s),e.push({sid:t.getAttribute("sid"),type:t.nodeName,obj:o});break;case"rotate":s=i(t.textContent),o=(new Mr).fromArray(s);const r=Wn.degToRad(s[3]);e.push({sid:t.getAttribute("sid"),type:t.nodeName,obj:o,angle:r});break}}return e}function $t(t){const e=t.getElementsByTagName("node");for(let n=0;n<e.length;n++){const t=e[n];!1===t.hasAttribute("id")&&t.setAttribute("id",a())}}const te=new ti,ee=new Mr;function ne(t){const e={name:t.getAttribute("name")||"",type:t.getAttribute("type"),id:t.getAttribute("id"),sid:t.getAttribute("sid"),matrix:new ti,nodes:[],instanceCameras:[],instanceControllers:[],instanceLights:[],instanceGeometries:[],instanceNodes:[],transforms:{}};for(let n=0;n<t.childNodes.length;n++){const r=t.childNodes[n];if(1!==r.nodeType)continue;let s;switch(r.nodeName){case"node":e.nodes.push(r.getAttribute("id")),ne(r);break;case"instance_camera":e.instanceCameras.push(o(r.getAttribute("url")));break;case"instance_controller":e.instanceControllers.push(re(r));break;case"instance_light":e.instanceLights.push(o(r.getAttribute("url")));break;case"instance_geometry":e.instanceGeometries.push(re(r));break;case"instance_node":e.instanceNodes.push(o(r.getAttribute("url")));break;case"matrix":s=i(r.textContent),e.matrix.multiply(te.fromArray(s).transpose()),e.transforms[r.getAttribute("sid")]=r.nodeName;break;case"translate":s=i(r.textContent),ee.fromArray(s),e.matrix.multiply(te.makeTranslation(ee.x,ee.y,ee.z)),e.transforms[r.getAttribute("sid")]=r.nodeName;break;case"rotate":s=i(r.textContent);const t=Wn.degToRad(s[3]);e.matrix.multiply(te.makeRotationAxis(ee.fromArray(s),t)),e.transforms[r.getAttribute("sid")]=r.nodeName;break;case"scale":s=i(r.textContent),e.matrix.scale(ee.fromArray(s)),e.transforms[r.getAttribute("sid")]=r.nodeName;break;case"extra":break;default:console.log(r)}}return ue(e.id)?console.warn("THREE.ColladaLoader: There is already a node with ID %s. Exclude current node from further processing.",e.id):Ie.nodes[e.id]=e,e}function re(t){const e={id:o(t.getAttribute("url")),materials:{},skeletons:[]};for(let n=0;n<t.childNodes.length;n++){const r=t.childNodes[n];switch(r.nodeName){case"bind_material":const t=r.getElementsByTagName("instance_material");for(let n=0;n<t.length;n++){const r=t[n],i=r.getAttribute("symbol"),s=r.getAttribute("target");e.materials[i]=o(s)}break;case"skeleton":e.skeletons.push(o(r.textContent));break}}return e}function ie(t,e){const n=[],r=[];let i,s,o;for(i=0;i<t.length;i++){const r=t[i];let s;if(ue(r))s=he(r),se(s,e,n);else if(pe(r)){const t=Ie.visualScenes[r],i=t.children;for(let r=0;r<i.length;r++){const t=i[r];if("JOINT"===t.type){const r=he(t.id);se(r,e,n)}}}else console.error("THREE.ColladaLoader: Unable to find root bone of skeleton with ID:",r)}for(i=0;i<e.length;i++)for(s=0;s<n.length;s++)if(o=n[s],o.bone.name===e[i].name){r[i]=o,o.processed=!0;break}for(i=0;i<n.length;i++)o=n[i],!1===o.processed&&(r.push(o),o.processed=!0);const a=[],l=[];for(i=0;i<r.length;i++)o=r[i],a.push(o.bone),l.push(o.boneInverse);return new sd(a,l)}function se(t,e,n){t.traverse((function(t){if(!0===t.isBone){let r;for(let n=0;n<e.length;n++){const i=e[n];if(i.name===t.name){r=i.boneInverse;break}}void 0===r&&(r=new ti),n.push({bone:t,boneInverse:r,processed:!1})}}))}function oe(t){const e=[],n=t.matrix,r=t.nodes,i=t.type,s=t.instanceCameras,o=t.instanceControllers,a=t.instanceLights,l=t.instanceGeometries,c=t.instanceNodes;for(let h=0,d=r.length;h<d;h++)e.push(he(r[h]));for(let h=0,d=s.length;h<d;h++){const t=xt(s[h]);null!==t&&e.push(t.clone())}for(let h=0,d=o.length;h<d;h++){const t=o[h],n=H(t.id),r=kt(n.id),i=ce(r,t.materials),s=t.skeletons,a=n.skin.joints,l=ie(s,a);for(let o=0,c=i.length;o<c;o++){const t=i[o];t.isSkinnedMesh&&(t.bind(l,n.skin.bindMatrix),t.normalizeSkinWeights()),e.push(t)}}for(let h=0,d=a.length;h<d;h++){const t=At(a[h]);null!==t&&e.push(t.clone())}for(let h=0,d=l.length;h<d;h++){const t=l[h],n=kt(t.id),r=ce(n,t.materials);for(let i=0,s=r.length;i<s;i++)e.push(r[i])}for(let h=0,d=c.length;h<d;h++)e.push(he(c[h]).clone());let u;if(0===r.length&&1===e.length)u=e[0];else{u="JOINT"===i?new ed:new mh;for(let t=0;t<e.length;t++)u.add(e[t])}return u.name="JOINT"===i?t.sid:t.name,u.matrix.copy(n),u.matrix.decompose(u.position,u.quaternion,u.scale),u}const ae=new Ui({color:16711935});function le(t,e){const n=[];for(let r=0,i=t.length;r<i;r++){const i=e[t[r]];void 0===i?(console.warn("THREE.ColladaLoader: Material with key %s not found. Apply fallback material.",t[r]),n.push(ae)):n.push(ht(i))}return n}function ce(t,e){const n=[];for(const r in t){const i=t[r],s=le(i.materialKeys,e);0===s.length&&("lines"===r||"linestrips"===r?s.push(new dd):s.push(new Ap));const o=void 0!==i.data.attributes.skinIndex,a=1===s.length?s[0]:s;let l;switch(r){case"lines":l=new wd(i.data,a);break;case"linestrips":l=new yd(i.data,a);break;case"triangles":case"polylist":l=o?new td(i.data,a):new As(i.data,a);break}n.push(l)}return n}function ue(t){return void 0!==Ie.nodes[t]}function he(t){return p(Ie.nodes[t],oe)}function de(t){const e={name:t.getAttribute("name"),children:[]};$t(t);const r=n(t,"node");for(let n=0;n<r.length;n++)e.children.push(ne(r[n]));Ie.visualScenes[t.getAttribute("id")]=e}function fe(t){const e=new mh;e.name=t.name;const n=t.children;for(let r=0;r<n.length;r++){const t=n[r];e.add(he(t.id))}return e}function pe(t){return void 0!==Ie.visualScenes[t]}function me(t){return p(Ie.visualScenes[t],fe)}function ge(t){const e=n(t,"instance_visual_scene")[0];return me(o(e.getAttribute("url")))}function ve(){const t=Ie.clips;if(!0===l(t)){if(!1===l(Ie.animations)){const t=[];for(const e in Ie.animations){const n=w(e);for(let e=0,r=n.length;e<r;e++)t.push(n[e])}Te.push(new jp("default",-1,t))}}else for(const e in t)Te.push(O(e))}function ye(t){let e="";const n=[t];while(n.length){const t=n.shift();t.nodeType===Node.TEXT_NODE?e+=t.textContent:(e+="\n",n.push.apply(n,t.childNodes))}return e.trim()}if(0===t.length)return{scene:new Eh};const xe=(new DOMParser).parseFromString(t,"application/xml"),be=n(xe,"COLLADA")[0],we=xe.getElementsByTagName("parsererror")[0];if(void 0!==we){const t=n(we,"div")[0];let e;return e=t?t.textContent:ye(we),console.error("THREE.ColladaLoader: Failed to parse collada file.\n",e),null}const _e=be.getAttribute("version");console.log("THREE.ColladaLoader: File version",_e);const Me=c(n(be,"asset")[0]),Ae=new im(this.manager);let Se;Ae.setPath(this.resourcePath||e).setCrossOrigin(this.crossOrigin),gw&&(Se=new gw(this.manager),Se.setPath(this.resourcePath||e));const Ee=new lr,Te=[];let Ce={},Re=0;const Ie={animations:{},clips:{},controllers:{},images:{},effects:{},materials:{},cameras:{},lights:{},geometries:{},nodes:{},visualScenes:{},kinematicsModels:{},physicsModels:{},kinematicsScenes:{}};d(be,"library_animations","animation",m),d(be,"library_animation_clips","animation_clip",N),d(be,"library_controllers","controller",D),d(be,"library_images","image",V),d(be,"library_effects","effect",q),d(be,"library_materials","material",lt),d(be,"library_cameras","camera",pt),d(be,"library_lights","light",bt),d(be,"library_geometries","geometry",St),d(be,"library_nodes","node",ne),d(be,"library_visual_scenes","visual_scene",de),d(be,"library_kinematics_models","kinematics_model",Ot),d(be,"library_physics_models","physics_model",jt),d(be,"scene","instance_kinematics_scene",Yt),f(Ie.animations,b),f(Ie.clips,k),f(Ie.controllers,B),f(Ie.images,j),f(Ie.effects,ot),f(Ie.materials,ut),f(Ie.cameras,yt),f(Ie.lights,Mt),f(Ie.geometries,Pt),f(Ie.visualScenes,fe),ve(),Zt();const Pe=ge(n(be,"scene")[0]);return Pe.animations=Te,"Z_UP"===Me.upAxis&&Pe.quaternion.setFromEuler(new ui(-Math.PI/2,0,0)),Pe.scale.multiplyScalar(Me.unit),{get animations(){return console.warn("THREE.ColladaLoader: Please access animations over scene.animations now."),Te},kinematics:Ce,library:Ie,scene:Pe}}}const yw=(0,r.aZ)({name:"model-collada",mixins:[sy],props:{lights:{type:Array,default:()=>[{type:"HemisphereLight",position:{x:0,y:1,z:0},skyColor:11184895,groundColor:8413280,intensity:.2},{type:"DirectionalLight",position:{x:1,y:1,z:1},color:16777215,intensity:.8}]},smoothing:{type:Boolean,default:!1}},data(){const t=new vw;return t.setCrossOrigin(this.crossOrigin),{loader:t}},methods:{getObject(t){return t.scene}}});class xw extends Kp{constructor(t){super(t),this.dracoLoader=null,this.ktx2Loader=null,this.meshoptDecoder=null,this.pluginCallbacks=[],this.register((function(t){return new Sw(t)})),this.register((function(t){return new Lw(t)})),this.register((function(t){return new Nw(t)})),this.register((function(t){return new Tw(t)})),this.register((function(t){return new Cw(t)})),this.register((function(t){return new Rw(t)})),this.register((function(t){return new Iw(t)})),this.register((function(t){return new Aw(t)})),this.register((function(t){return new Pw(t)})),this.register((function(t){return new Ew(t)})),this.register((function(t){return new _w(t)})),this.register((function(t){return new kw(t)}))}load(t,e,n,r){const i=this;let s;s=""!==this.resourcePath?this.resourcePath:""!==this.path?this.path:Sm.extractUrlBase(t),this.manager.itemStart(t);const o=function(e){r?r(e):console.error(e),i.manager.itemError(t),i.manager.itemEnd(t)},a=new Qp(this.manager);a.setPath(this.path),a.setResponseType("arraybuffer"),a.setRequestHeader(this.requestHeader),a.setWithCredentials(this.withCredentials),a.load(t,(function(n){try{i.parse(n,s,(function(n){e(n),i.manager.itemEnd(t)}),o)}catch(v_){o(v_)}}),n,o)}setDRACOLoader(t){return this.dracoLoader=t,this}setDDSLoader(){throw new Error('THREE.GLTFLoader: "MSFT_texture_dds" no longer supported. Please update to "KHR_texture_basisu".')}setKTX2Loader(t){return this.ktx2Loader=t,this}setMeshoptDecoder(t){return this.meshoptDecoder=t,this}register(t){return-1===this.pluginCallbacks.indexOf(t)&&this.pluginCallbacks.push(t),this}unregister(t){return-1!==this.pluginCallbacks.indexOf(t)&&this.pluginCallbacks.splice(this.pluginCallbacks.indexOf(t),1),this}parse(t,e,n,r){let i;const s={},o={};if("string"===typeof t)i=t;else{const e=Sm.decodeText(new Uint8Array(t,0,4));if(e===Ow){try{s[ww.KHR_BINARY_GLTF]=new Fw(t)}catch(c){return void(r&&r(c))}i=s[ww.KHR_BINARY_GLTF].content}else i=Sm.decodeText(new Uint8Array(t))}const a=JSON.parse(i);if(void 0===a.asset||a.asset.version[0]<2)return void(r&&r(new Error("THREE.GLTFLoader: Unsupported asset. glTF versions >=2.0 are supported.")));const l=new h_(a,{path:e||this.resourcePath||"",crossOrigin:this.crossOrigin,requestHeader:this.requestHeader,manager:this.manager,ktx2Loader:this.ktx2Loader,meshoptDecoder:this.meshoptDecoder});l.fileLoader.setRequestHeader(this.requestHeader);for(let u=0;u<this.pluginCallbacks.length;u++){const t=this.pluginCallbacks[u](l);o[t.name]=t,s[t.name]=!0}if(a.extensionsUsed)for(let u=0;u<a.extensionsUsed.length;++u){const t=a.extensionsUsed[u],e=a.extensionsRequired||[];switch(t){case ww.KHR_MATERIALS_UNLIT:s[t]=new Mw;break;case ww.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS:s[t]=new Hw;break;case ww.KHR_DRACO_MESH_COMPRESSION:s[t]=new Uw(a,this.dracoLoader);break;case ww.KHR_TEXTURE_TRANSFORM:s[t]=new Bw;break;case ww.KHR_MESH_QUANTIZATION:s[t]=new Vw;break;default:e.indexOf(t)>=0&&void 0===o[t]&&console.warn('THREE.GLTFLoader: Unknown extension "'+t+'".')}}l.setExtensions(s),l.setPlugins(o),l.parse(n,r)}parseAsync(t,e){const n=this;return new Promise((function(r,i){n.parse(t,e,r,i)}))}}function bw(){let t={};return{get:function(e){return t[e]},add:function(e,n){t[e]=n},remove:function(e){delete t[e]},removeAll:function(){t={}}}}const ww={KHR_BINARY_GLTF:"KHR_binary_glTF",KHR_DRACO_MESH_COMPRESSION:"KHR_draco_mesh_compression",KHR_LIGHTS_PUNCTUAL:"KHR_lights_punctual",KHR_MATERIALS_CLEARCOAT:"KHR_materials_clearcoat",KHR_MATERIALS_IOR:"KHR_materials_ior",KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS:"KHR_materials_pbrSpecularGlossiness",KHR_MATERIALS_SHEEN:"KHR_materials_sheen",KHR_MATERIALS_SPECULAR:"KHR_materials_specular",KHR_MATERIALS_TRANSMISSION:"KHR_materials_transmission",KHR_MATERIALS_IRIDESCENCE:"KHR_materials_iridescence",KHR_MATERIALS_UNLIT:"KHR_materials_unlit",KHR_MATERIALS_VOLUME:"KHR_materials_volume",KHR_TEXTURE_BASISU:"KHR_texture_basisu",KHR_TEXTURE_TRANSFORM:"KHR_texture_transform",KHR_MESH_QUANTIZATION:"KHR_mesh_quantization",KHR_MATERIALS_EMISSIVE_STRENGTH:"KHR_materials_emissive_strength",EXT_TEXTURE_WEBP:"EXT_texture_webp",EXT_MESHOPT_COMPRESSION:"EXT_meshopt_compression"};class _w{constructor(t){this.parser=t,this.name=ww.KHR_LIGHTS_PUNCTUAL,this.cache={refs:{},uses:{}}}_markDefs(){const t=this.parser,e=this.parser.json.nodes||[];for(let n=0,r=e.length;n<r;n++){const r=e[n];r.extensions&&r.extensions[this.name]&&void 0!==r.extensions[this.name].light&&t._addNodeRef(this.cache,r.extensions[this.name].light)}}_loadLight(t){const e=this.parser,n="light:"+t;let r=e.cache.get(n);if(r)return r;const i=e.json,s=i.extensions&&i.extensions[this.name]||{},o=s.lights||[],a=o[t];let l;const c=new lr(16777215);void 0!==a.color&&c.fromArray(a.color);const u=void 0!==a.range?a.range:0;switch(a.type){case"directional":l=new xm(c),l.target.position.set(0,0,-1),l.add(l.target);break;case"point":l=new vm(c),l.distance=u;break;case"spot":l=new dm(c),l.distance=u,a.spot=a.spot||{},a.spot.innerConeAngle=void 0!==a.spot.innerConeAngle?a.spot.innerConeAngle:0,a.spot.outerConeAngle=void 0!==a.spot.outerConeAngle?a.spot.outerConeAngle:Math.PI/4,l.angle=a.spot.outerConeAngle,l.penumbra=1-a.spot.innerConeAngle/a.spot.outerConeAngle,l.target.position.set(0,0,-1),l.add(l.target);break;default:throw new Error("THREE.GLTFLoader: Unexpected light type: "+a.type)}return l.position.set(0,0,0),l.decay=2,void 0!==a.intensity&&(l.intensity=a.intensity),l.name=e.createUniqueName(a.name||"light_"+t),r=Promise.resolve(l),e.cache.add(n,r),r}createNodeAttachment(t){const e=this,n=this.parser,r=n.json,i=r.nodes[t],s=i.extensions&&i.extensions[this.name]||{},o=s.light;return void 0===o?null:this._loadLight(o).then((function(t){return n._getNodeRef(e.cache,o,t)}))}}class Mw{constructor(){this.name=ww.KHR_MATERIALS_UNLIT}getMaterialType(){return Ui}extendParams(t,e,n){const r=[];t.color=new lr(1,1,1),t.opacity=1;const i=e.pbrMetallicRoughness;if(i){if(Array.isArray(i.baseColorFactor)){const e=i.baseColorFactor;t.color.fromArray(e),t.opacity=e[3]}void 0!==i.baseColorTexture&&r.push(n.assignTexture(t,"map",i.baseColorTexture,Oe))}return Promise.all(r)}}class Aw{constructor(t){this.parser=t,this.name=ww.KHR_MATERIALS_EMISSIVE_STRENGTH}extendMaterialParams(t,e){const n=this.parser,r=n.json.materials[t];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();const i=r.extensions[this.name].emissiveStrength;return void 0!==i&&(e.emissiveIntensity=i),Promise.resolve()}}class Sw{constructor(t){this.parser=t,this.name=ww.KHR_MATERIALS_CLEARCOAT}getMaterialType(t){const e=this.parser,n=e.json.materials[t];return n.extensions&&n.extensions[this.name]?Mp:null}extendMaterialParams(t,e){const n=this.parser,r=n.json.materials[t];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();const i=[],s=r.extensions[this.name];if(void 0!==s.clearcoatFactor&&(e.clearcoat=s.clearcoatFactor),void 0!==s.clearcoatTexture&&i.push(n.assignTexture(e,"clearcoatMap",s.clearcoatTexture)),void 0!==s.clearcoatRoughnessFactor&&(e.clearcoatRoughness=s.clearcoatRoughnessFactor),void 0!==s.clearcoatRoughnessTexture&&i.push(n.assignTexture(e,"clearcoatRoughnessMap",s.clearcoatRoughnessTexture)),void 0!==s.clearcoatNormalTexture&&(i.push(n.assignTexture(e,"clearcoatNormalMap",s.clearcoatNormalTexture)),void 0!==s.clearcoatNormalTexture.scale)){const t=s.clearcoatNormalTexture.scale;e.clearcoatNormalScale=new qn(t,t)}return Promise.all(i)}}class Ew{constructor(t){this.parser=t,this.name=ww.KHR_MATERIALS_IRIDESCENCE}getMaterialType(t){const e=this.parser,n=e.json.materials[t];return n.extensions&&n.extensions[this.name]?Mp:null}extendMaterialParams(t,e){const n=this.parser,r=n.json.materials[t];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();const i=[],s=r.extensions[this.name];return void 0!==s.iridescenceFactor&&(e.iridescence=s.iridescenceFactor),void 0!==s.iridescenceTexture&&i.push(n.assignTexture(e,"iridescenceMap",s.iridescenceTexture)),void 0!==s.iridescenceIor&&(e.iridescenceIOR=s.iridescenceIor),void 0===e.iridescenceThicknessRange&&(e.iridescenceThicknessRange=[100,400]),void 0!==s.iridescenceThicknessMinimum&&(e.iridescenceThicknessRange[0]=s.iridescenceThicknessMinimum),void 0!==s.iridescenceThicknessMaximum&&(e.iridescenceThicknessRange[1]=s.iridescenceThicknessMaximum),void 0!==s.iridescenceThicknessTexture&&i.push(n.assignTexture(e,"iridescenceThicknessMap",s.iridescenceThicknessTexture)),Promise.all(i)}}class Tw{constructor(t){this.parser=t,this.name=ww.KHR_MATERIALS_SHEEN}getMaterialType(t){const e=this.parser,n=e.json.materials[t];return n.extensions&&n.extensions[this.name]?Mp:null}extendMaterialParams(t,e){const n=this.parser,r=n.json.materials[t];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();const i=[];e.sheenColor=new lr(0,0,0),e.sheenRoughness=0,e.sheen=1;const s=r.extensions[this.name];return void 0!==s.sheenColorFactor&&e.sheenColor.fromArray(s.sheenColorFactor),void 0!==s.sheenRoughnessFactor&&(e.sheenRoughness=s.sheenRoughnessFactor),void 0!==s.sheenColorTexture&&i.push(n.assignTexture(e,"sheenColorMap",s.sheenColorTexture,Oe)),void 0!==s.sheenRoughnessTexture&&i.push(n.assignTexture(e,"sheenRoughnessMap",s.sheenRoughnessTexture)),Promise.all(i)}}class Cw{constructor(t){this.parser=t,this.name=ww.KHR_MATERIALS_TRANSMISSION}getMaterialType(t){const e=this.parser,n=e.json.materials[t];return n.extensions&&n.extensions[this.name]?Mp:null}extendMaterialParams(t,e){const n=this.parser,r=n.json.materials[t];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();const i=[],s=r.extensions[this.name];return void 0!==s.transmissionFactor&&(e.transmission=s.transmissionFactor),void 0!==s.transmissionTexture&&i.push(n.assignTexture(e,"transmissionMap",s.transmissionTexture)),Promise.all(i)}}class Rw{constructor(t){this.parser=t,this.name=ww.KHR_MATERIALS_VOLUME}getMaterialType(t){const e=this.parser,n=e.json.materials[t];return n.extensions&&n.extensions[this.name]?Mp:null}extendMaterialParams(t,e){const n=this.parser,r=n.json.materials[t];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();const i=[],s=r.extensions[this.name];e.thickness=void 0!==s.thicknessFactor?s.thicknessFactor:0,void 0!==s.thicknessTexture&&i.push(n.assignTexture(e,"thicknessMap",s.thicknessTexture)),e.attenuationDistance=s.attenuationDistance||0;const o=s.attenuationColor||[1,1,1];return e.attenuationColor=new lr(o[0],o[1],o[2]),Promise.all(i)}}class Iw{constructor(t){this.parser=t,this.name=ww.KHR_MATERIALS_IOR}getMaterialType(t){const e=this.parser,n=e.json.materials[t];return n.extensions&&n.extensions[this.name]?Mp:null}extendMaterialParams(t,e){const n=this.parser,r=n.json.materials[t];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();const i=r.extensions[this.name];return e.ior=void 0!==i.ior?i.ior:1.5,Promise.resolve()}}class Pw{constructor(t){this.parser=t,this.name=ww.KHR_MATERIALS_SPECULAR}getMaterialType(t){const e=this.parser,n=e.json.materials[t];return n.extensions&&n.extensions[this.name]?Mp:null}extendMaterialParams(t,e){const n=this.parser,r=n.json.materials[t];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();const i=[],s=r.extensions[this.name];e.specularIntensity=void 0!==s.specularFactor?s.specularFactor:1,void 0!==s.specularTexture&&i.push(n.assignTexture(e,"specularIntensityMap",s.specularTexture));const o=s.specularColorFactor||[1,1,1];return e.specularColor=new lr(o[0],o[1],o[2]),void 0!==s.specularColorTexture&&i.push(n.assignTexture(e,"specularColorMap",s.specularColorTexture,Oe)),Promise.all(i)}}class Lw{constructor(t){this.parser=t,this.name=ww.KHR_TEXTURE_BASISU}loadTexture(t){const e=this.parser,n=e.json,r=n.textures[t];if(!r.extensions||!r.extensions[this.name])return null;const i=r.extensions[this.name],s=e.options.ktx2Loader;if(!s){if(n.extensionsRequired&&n.extensionsRequired.indexOf(this.name)>=0)throw new Error("THREE.GLTFLoader: setKTX2Loader must be called before loading KTX2 textures");return null}return e.loadTextureImage(t,i.source,s)}}class Nw{constructor(t){this.parser=t,this.name=ww.EXT_TEXTURE_WEBP,this.isSupported=null}loadTexture(t){const e=this.name,n=this.parser,r=n.json,i=r.textures[t];if(!i.extensions||!i.extensions[e])return null;const s=i.extensions[e],o=r.images[s.source];let a=n.textureLoader;if(o.uri){const t=n.options.manager.getHandler(o.uri);null!==t&&(a=t)}return this.detectSupport().then((function(i){if(i)return n.loadTextureImage(t,s.source,a);if(r.extensionsRequired&&r.extensionsRequired.indexOf(e)>=0)throw new Error("THREE.GLTFLoader: WebP required by asset but unsupported.");return n.loadTexture(t)}))}detectSupport(){return this.isSupported||(this.isSupported=new Promise((function(t){const e=new Image;e.src="data:image/webp;base64,UklGRiIAAABXRUJQVlA4IBYAAAAwAQCdASoBAAEADsD+JaQAA3AAAAAA",e.onload=e.onerror=function(){t(1===e.height)}}))),this.isSupported}}class kw{constructor(t){this.name=ww.EXT_MESHOPT_COMPRESSION,this.parser=t}loadBufferView(t){const e=this.parser.json,n=e.bufferViews[t];if(n.extensions&&n.extensions[this.name]){const t=n.extensions[this.name],r=this.parser.getDependency("buffer",t.buffer),i=this.parser.options.meshoptDecoder;if(!i||!i.supported){if(e.extensionsRequired&&e.extensionsRequired.indexOf(this.name)>=0)throw new Error("THREE.GLTFLoader: setMeshoptDecoder must be called before loading compressed files");return null}return Promise.all([r,i.ready]).then((function(e){const n=t.byteOffset||0,r=t.byteLength||0,s=t.count,o=t.byteStride,a=new ArrayBuffer(s*o),l=new Uint8Array(e[0],n,r);return i.decodeGltfBuffer(new Uint8Array(a),s,o,l,t.mode,t.filter),a}))}return null}}const Ow="glTF",Dw=12,zw={JSON:1313821514,BIN:5130562};class Fw{constructor(t){this.name=ww.KHR_BINARY_GLTF,this.content=null,this.body=null;const e=new DataView(t,0,Dw);if(this.header={magic:Sm.decodeText(new Uint8Array(t.slice(0,4))),version:e.getUint32(4,!0),length:e.getUint32(8,!0)},this.header.magic!==Ow)throw new Error("THREE.GLTFLoader: Unsupported glTF-Binary header.");if(this.header.version<2)throw new Error("THREE.GLTFLoader: Legacy binary file detected.");const n=this.header.length-Dw,r=new DataView(t,Dw);let i=0;while(i<n){const e=r.getUint32(i,!0);i+=4;const n=r.getUint32(i,!0);if(i+=4,n===zw.JSON){const n=new Uint8Array(t,Dw+i,e);this.content=Sm.decodeText(n)}else if(n===zw.BIN){const n=Dw+i;this.body=t.slice(n,n+e)}i+=e}if(null===this.content)throw new Error("THREE.GLTFLoader: JSON content not found.")}}class Uw{constructor(t,e){if(!e)throw new Error("THREE.GLTFLoader: No DRACOLoader instance provided.");this.name=ww.KHR_DRACO_MESH_COMPRESSION,this.json=t,this.dracoLoader=e,this.dracoLoader.preload()}decodePrimitive(t,e){const n=this.json,r=this.dracoLoader,i=t.extensions[this.name].bufferView,s=t.extensions[this.name].attributes,o={},a={},l={};for(const c in s){const t=Qw[c]||c.toLowerCase();o[t]=s[c]}for(const c in t.attributes){const e=Qw[c]||c.toLowerCase();if(void 0!==s[c]){const r=n.accessors[t.attributes[c]],i=Xw[r.componentType];l[e]=i,a[e]=!0===r.normalized}}return e.getDependency("bufferView",i).then((function(t){return new Promise((function(e){r.decodeDracoFile(t,(function(t){for(const e in t.attributes){const n=t.attributes[e],r=a[e];void 0!==r&&(n.normalized=r)}e(t)}),o,l)}))}))}}class Bw{constructor(){this.name=ww.KHR_TEXTURE_TRANSFORM}extendTexture(t,e){return void 0!==e.texCoord&&console.warn('THREE.GLTFLoader: Custom UV sets in "'+this.name+'" extension not yet supported.'),void 0===e.offset&&void 0===e.rotation&&void 0===e.scale||(t=t.clone(),void 0!==e.offset&&t.offset.fromArray(e.offset),void 0!==e.rotation&&(t.rotation=e.rotation),void 0!==e.scale&&t.repeat.fromArray(e.scale),t.needsUpdate=!0),t}}class Gw extends _p{constructor(t){super(),this.isGLTFSpecularGlossinessMaterial=!0;const e=["#ifdef USE_SPECULARMAP","\tuniform sampler2D specularMap;","#endif"].join("\n"),n=["#ifdef USE_GLOSSINESSMAP","\tuniform sampler2D glossinessMap;","#endif"].join("\n"),r=["vec3 specularFactor = specular;","#ifdef USE_SPECULARMAP","\tvec4 texelSpecular = texture2D( specularMap, vUv );","\t// reads channel RGB, compatible with a glTF Specular-Glossiness (RGBA) texture","\tspecularFactor *= texelSpecular.rgb;","#endif"].join("\n"),i=["float glossinessFactor = glossiness;","#ifdef USE_GLOSSINESSMAP","\tvec4 texelGlossiness = texture2D( glossinessMap, vUv );","\t// reads channel A, compatible with a glTF Specular-Glossiness (RGBA) texture","\tglossinessFactor *= texelGlossiness.a;","#endif"].join("\n"),s=["PhysicalMaterial material;","material.diffuseColor = diffuseColor.rgb * ( 1. - max( specularFactor.r, max( specularFactor.g, specularFactor.b ) ) );","vec3 dxy = max( abs( dFdx( geometryNormal ) ), abs( dFdy( geometryNormal ) ) );","float geometryRoughness = max( max( dxy.x, dxy.y ), dxy.z );","material.roughness = max( 1.0 - glossinessFactor, 0.0525 ); // 0.0525 corresponds to the base mip of a 256 cubemap.","material.roughness += geometryRoughness;","material.roughness = min( material.roughness, 1.0 );","material.specularColor = specularFactor;"].join("\n"),o={specular:{value:(new lr).setHex(16777215)},glossiness:{value:1},specularMap:{value:null},glossinessMap:{value:null}};this._extraUniforms=o,this.onBeforeCompile=function(t){for(const e in o)t.uniforms[e]=o[e];t.fragmentShader=t.fragmentShader.replace("uniform float roughness;","uniform vec3 specular;").replace("uniform float metalness;","uniform float glossiness;").replace("#include <roughnessmap_pars_fragment>",e).replace("#include <metalnessmap_pars_fragment>",n).replace("#include <roughnessmap_fragment>",r).replace("#include <metalnessmap_fragment>",i).replace("#include <lights_physical_fragment>",s)},Object.defineProperties(this,{specular:{get:function(){return o.specular.value},set:function(t){o.specular.value=t}},specularMap:{get:function(){return o.specularMap.value},set:function(t){o.specularMap.value=t,t?this.defines.USE_SPECULARMAP="":delete this.defines.USE_SPECULARMAP}},glossiness:{get:function(){return o.glossiness.value},set:function(t){o.glossiness.value=t}},glossinessMap:{get:function(){return o.glossinessMap.value},set:function(t){o.glossinessMap.value=t,t?(this.defines.USE_GLOSSINESSMAP="",this.defines.USE_UV=""):(delete this.defines.USE_GLOSSINESSMAP,delete this.defines.USE_UV)}}}),delete this.metalness,delete this.roughness,delete this.metalnessMap,delete this.roughnessMap,this.setValues(t)}copy(t){return super.copy(t),this.specularMap=t.specularMap,this.specular.copy(t.specular),this.glossinessMap=t.glossinessMap,this.glossiness=t.glossiness,delete this.metalness,delete this.roughness,delete this.metalnessMap,delete this.roughnessMap,this}}class Hw{constructor(){this.name=ww.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS,this.specularGlossinessParams=["color","map","lightMap","lightMapIntensity","aoMap","aoMapIntensity","emissive","emissiveIntensity","emissiveMap","bumpMap","bumpScale","normalMap","normalMapType","displacementMap","displacementScale","displacementBias","specularMap","specular","glossinessMap","glossiness","alphaMap","envMap","envMapIntensity"]}getMaterialType(){return Gw}extendParams(t,e,n){const r=e.extensions[this.name];t.color=new lr(1,1,1),t.opacity=1;const i=[];if(Array.isArray(r.diffuseFactor)){const e=r.diffuseFactor;t.color.fromArray(e),t.opacity=e[3]}if(void 0!==r.diffuseTexture&&i.push(n.assignTexture(t,"map",r.diffuseTexture,Oe)),t.emissive=new lr(0,0,0),t.glossiness=void 0!==r.glossinessFactor?r.glossinessFactor:1,t.specular=new lr(1,1,1),Array.isArray(r.specularFactor)&&t.specular.fromArray(r.specularFactor),void 0!==r.specularGlossinessTexture){const e=r.specularGlossinessTexture;i.push(n.assignTexture(t,"glossinessMap",e)),i.push(n.assignTexture(t,"specularMap",e,Oe))}return Promise.all(i)}createMaterial(t){const e=new Gw(t);return e.fog=!0,e.color=t.color,e.map=void 0===t.map?null:t.map,e.lightMap=null,e.lightMapIntensity=1,e.aoMap=void 0===t.aoMap?null:t.aoMap,e.aoMapIntensity=1,e.emissive=t.emissive,e.emissiveIntensity=void 0===t.emissiveIntensity?1:t.emissiveIntensity,e.emissiveMap=void 0===t.emissiveMap?null:t.emissiveMap,e.bumpMap=void 0===t.bumpMap?null:t.bumpMap,e.bumpScale=1,e.normalMap=void 0===t.normalMap?null:t.normalMap,e.normalMapType=Fe,t.normalScale&&(e.normalScale=t.normalScale),e.displacementMap=null,e.displacementScale=1,e.displacementBias=0,e.specularMap=void 0===t.specularMap?null:t.specularMap,e.specular=t.specular,e.glossinessMap=void 0===t.glossinessMap?null:t.glossinessMap,e.glossiness=t.glossiness,e.alphaMap=null,e.envMap=void 0===t.envMap?null:t.envMap,e.envMapIntensity=1,e}}class Vw{constructor(){this.name=ww.KHR_MESH_QUANTIZATION}}class jw extends Lp{constructor(t,e,n,r){super(t,e,n,r)}copySampleValue_(t){const e=this.resultBuffer,n=this.sampleValues,r=this.valueSize,i=t*r*3+r;for(let s=0;s!==r;s++)e[s]=n[i+s];return e}}jw.prototype.interpolate_=function(t,e,n,r){const i=this.resultBuffer,s=this.sampleValues,o=this.valueSize,a=2*o,l=3*o,c=r-e,u=(n-e)/c,h=u*u,d=h*u,f=t*l,p=f-l,m=-2*d+3*h,g=d-h,v=1-m,y=g-h+u;for(let x=0;x!==o;x++){const t=s[p+x+o],e=s[p+x+a]*c,n=s[f+x+o],r=s[f+x]*c;i[x]=v*t+y*e+m*n+g*r}return i};const Ww=new _r;class qw extends jw{interpolate_(t,e,n,r){const i=super.interpolate_(t,e,n,r);return Ww.fromArray(i).normalize().toArray(i),i}}const Yw={FLOAT:5126,FLOAT_MAT3:35675,FLOAT_MAT4:35676,FLOAT_VEC2:35664,FLOAT_VEC3:35665,FLOAT_VEC4:35666,LINEAR:9729,REPEAT:10497,SAMPLER_2D:35678,POINTS:0,LINES:1,LINE_LOOP:2,LINE_STRIP:3,TRIANGLES:4,TRIANGLE_STRIP:5,TRIANGLE_FAN:6,UNSIGNED_BYTE:5121,UNSIGNED_SHORT:5123},Xw={5120:Int8Array,5121:Uint8Array,5122:Int16Array,5123:Uint16Array,5125:Uint32Array,5126:Float32Array},Jw={9728:mt,9729:bt,9984:gt,9985:wt,9986:yt,9987:Mt},Kw={33071:ft,33648:pt,10497:dt},Zw={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16},Qw={POSITION:"position",NORMAL:"normal",TANGENT:"tangent",TEXCOORD_0:"uv",TEXCOORD_1:"uv2",COLOR_0:"color",WEIGHTS_0:"skinWeight",JOINTS_0:"skinIndex"},$w={scale:"scale",translation:"position",rotation:"quaternion",weights:"morphTargetInfluences"},t_={CUBICSPLINE:void 0,LINEAR:Ae,STEP:Me},e_={OPAQUE:"OPAQUE",MASK:"MASK",BLEND:"BLEND"};function n_(t){return void 0===t["DefaultMaterial"]&&(t["DefaultMaterial"]=new _p({color:16777215,emissive:0,metalness:1,roughness:1,transparent:!1,depthTest:!0,side:g})),t["DefaultMaterial"]}function r_(t,e,n){for(const r in n.extensions)void 0===t[r]&&(e.userData.gltfExtensions=e.userData.gltfExtensions||{},e.userData.gltfExtensions[r]=n.extensions[r])}function i_(t,e){void 0!==e.extras&&("object"===typeof e.extras?Object.assign(t.userData,e.extras):console.warn("THREE.GLTFLoader: Ignoring primitive type .extras, "+e.extras))}function s_(t,e,n){let r=!1,i=!1,s=!1;for(let c=0,u=e.length;c<u;c++){const t=e[c];if(void 0!==t.POSITION&&(r=!0),void 0!==t.NORMAL&&(i=!0),void 0!==t.COLOR_0&&(s=!0),r&&i&&s)break}if(!r&&!i&&!s)return Promise.resolve(t);const o=[],a=[],l=[];for(let c=0,u=e.length;c<u;c++){const u=e[c];if(r){const e=void 0!==u.POSITION?n.getDependency("accessor",u.POSITION):t.attributes.position;o.push(e)}if(i){const e=void 0!==u.NORMAL?n.getDependency("accessor",u.NORMAL):t.attributes.normal;a.push(e)}if(s){const e=void 0!==u.COLOR_0?n.getDependency("accessor",u.COLOR_0):t.attributes.color;l.push(e)}}return Promise.all([Promise.all(o),Promise.all(a),Promise.all(l)]).then((function(e){const n=e[0],o=e[1],a=e[2];return r&&(t.morphAttributes.position=n),i&&(t.morphAttributes.normal=o),s&&(t.morphAttributes.color=a),t.morphTargetsRelative=!0,t}))}function o_(t,e){if(t.updateMorphTargets(),void 0!==e.weights)for(let n=0,r=e.weights.length;n<r;n++)t.morphTargetInfluences[n]=e.weights[n];if(e.extras&&Array.isArray(e.extras.targetNames)){const n=e.extras.targetNames;if(t.morphTargetInfluences.length===n.length){t.morphTargetDictionary={};for(let e=0,r=n.length;e<r;e++)t.morphTargetDictionary[n[e]]=e}else console.warn("THREE.GLTFLoader: Invalid extras.targetNames length. Ignoring names.")}}function a_(t){const e=t.extensions&&t.extensions[ww.KHR_DRACO_MESH_COMPRESSION];let n;return n=e?"draco:"+e.bufferView+":"+e.indices+":"+l_(e.attributes):t.indices+":"+l_(t.attributes)+":"+t.mode,n}function l_(t){let e="";const n=Object.keys(t).sort();for(let r=0,i=n.length;r<i;r++)e+=n[r]+":"+t[n[r]]+";";return e}function c_(t){switch(t){case Int8Array:return 1/127;case Uint8Array:return 1/255;case Int16Array:return 1/32767;case Uint16Array:return 1/65535;default:throw new Error("THREE.GLTFLoader: Unsupported normalized accessor component type.")}}function u_(t){return t.search(/\.jpe?g($|\?)/i)>0||0===t.search(/^data\:image\/jpeg/)?"image/jpeg":t.search(/\.webp($|\?)/i)>0||0===t.search(/^data\:image\/webp/)?"image/webp":"image/png"}class h_{constructor(t={},e={}){this.json=t,this.extensions={},this.plugins={},this.options=e,this.cache=new bw,this.associations=new Map,this.primitiveCache={},this.meshCache={refs:{},uses:{}},this.cameraCache={refs:{},uses:{}},this.lightCache={refs:{},uses:{}},this.sourceCache={},this.textureCache={},this.nodeNamesUsed={};const n=!0===/^((?!chrome|android).)*safari/i.test(navigator.userAgent),r=navigator.userAgent.indexOf("Firefox")>-1,i=r?navigator.userAgent.match(/Firefox\/([0-9]+)\./)[1]:-1;"undefined"===typeof createImageBitmap||n||r&&i<98?this.textureLoader=new im(this.options.manager):this.textureLoader=new Lm(this.options.manager),this.textureLoader.setCrossOrigin(this.options.crossOrigin),this.textureLoader.setRequestHeader(this.options.requestHeader),this.fileLoader=new Qp(this.options.manager),this.fileLoader.setResponseType("arraybuffer"),"use-credentials"===this.options.crossOrigin&&this.fileLoader.setWithCredentials(!0)}setExtensions(t){this.extensions=t}setPlugins(t){this.plugins=t}parse(t,e){const n=this,r=this.json,i=this.extensions;this.cache.removeAll(),this._invokeAll((function(t){return t._markDefs&&t._markDefs()})),Promise.all(this._invokeAll((function(t){return t.beforeRoot&&t.beforeRoot()}))).then((function(){return Promise.all([n.getDependencies("scene"),n.getDependencies("animation"),n.getDependencies("camera")])})).then((function(e){const s={scene:e[0][r.scene||0],scenes:e[0],animations:e[1],cameras:e[2],asset:r.asset,parser:n,userData:{}};r_(i,s,r),i_(s,r),Promise.all(n._invokeAll((function(t){return t.afterRoot&&t.afterRoot(s)}))).then((function(){t(s)}))})).catch(e)}_markDefs(){const t=this.json.nodes||[],e=this.json.skins||[],n=this.json.meshes||[];for(let r=0,i=e.length;r<i;r++){const n=e[r].joints;for(let e=0,r=n.length;e<r;e++)t[n[e]].isBone=!0}for(let r=0,i=t.length;r<i;r++){const e=t[r];void 0!==e.mesh&&(this._addNodeRef(this.meshCache,e.mesh),void 0!==e.skin&&(n[e.mesh].isSkinnedMesh=!0)),void 0!==e.camera&&this._addNodeRef(this.cameraCache,e.camera)}}_addNodeRef(t,e){void 0!==e&&(void 0===t.refs[e]&&(t.refs[e]=t.uses[e]=0),t.refs[e]++)}_getNodeRef(t,e,n){if(t.refs[e]<=1)return n;const r=n.clone(),i=(t,e)=>{const n=this.associations.get(t);null!=n&&this.associations.set(e,n);for(const[r,s]of t.children.entries())i(s,e.children[r])};return i(n,r),r.name+="_instance_"+t.uses[e]++,r}_invokeOne(t){const e=Object.values(this.plugins);e.push(this);for(let n=0;n<e.length;n++){const r=t(e[n]);if(r)return r}return null}_invokeAll(t){const e=Object.values(this.plugins);e.unshift(this);const n=[];for(let r=0;r<e.length;r++){const i=t(e[r]);i&&n.push(i)}return n}getDependency(t,e){const n=t+":"+e;let r=this.cache.get(n);if(!r){switch(t){case"scene":r=this.loadScene(e);break;case"node":r=this.loadNode(e);break;case"mesh":r=this._invokeOne((function(t){return t.loadMesh&&t.loadMesh(e)}));break;case"accessor":r=this.loadAccessor(e);break;case"bufferView":r=this._invokeOne((function(t){return t.loadBufferView&&t.loadBufferView(e)}));break;case"buffer":r=this.loadBuffer(e);break;case"material":r=this._invokeOne((function(t){return t.loadMaterial&&t.loadMaterial(e)}));break;case"texture":r=this._invokeOne((function(t){return t.loadTexture&&t.loadTexture(e)}));break;case"skin":r=this.loadSkin(e);break;case"animation":r=this._invokeOne((function(t){return t.loadAnimation&&t.loadAnimation(e)}));break;case"camera":r=this.loadCamera(e);break;default:throw new Error("Unknown type: "+t)}this.cache.add(n,r)}return r}getDependencies(t){let e=this.cache.get(t);if(!e){const n=this,r=this.json[t+("mesh"===t?"es":"s")]||[];e=Promise.all(r.map((function(e,r){return n.getDependency(t,r)}))),this.cache.add(t,e)}return e}loadBuffer(t){const e=this.json.buffers[t],n=this.fileLoader;if(e.type&&"arraybuffer"!==e.type)throw new Error("THREE.GLTFLoader: "+e.type+" buffer type is not supported.");if(void 0===e.uri&&0===t)return Promise.resolve(this.extensions[ww.KHR_BINARY_GLTF].body);const r=this.options;return new Promise((function(t,i){n.load(Sm.resolveURL(e.uri,r.path),t,void 0,(function(){i(new Error('THREE.GLTFLoader: Failed to load buffer "'+e.uri+'".'))}))}))}loadBufferView(t){const e=this.json.bufferViews[t];return this.getDependency("buffer",e.buffer).then((function(t){const n=e.byteLength||0,r=e.byteOffset||0;return t.slice(r,r+n)}))}loadAccessor(t){const e=this,n=this.json,r=this.json.accessors[t];if(void 0===r.bufferView&&void 0===r.sparse)return Promise.resolve(null);const i=[];return void 0!==r.bufferView?i.push(this.getDependency("bufferView",r.bufferView)):i.push(null),void 0!==r.sparse&&(i.push(this.getDependency("bufferView",r.sparse.indices.bufferView)),i.push(this.getDependency("bufferView",r.sparse.values.bufferView))),Promise.all(i).then((function(t){const i=t[0],s=Zw[r.type],o=Xw[r.componentType],a=o.BYTES_PER_ELEMENT,l=a*s,c=r.byteOffset||0,u=void 0!==r.bufferView?n.bufferViews[r.bufferView].byteStride:void 0,h=!0===r.normalized;let d,f;if(u&&u!==l){const t=Math.floor(c/u),n="InterleavedBuffer:"+r.bufferView+":"+r.componentType+":"+t+":"+r.count;let l=e.cache.get(n);l||(d=new o(i,t*u,r.count*u/a),l=new Th(d,u/a),e.cache.add(n,l)),f=new Rh(l,s,c%u/a,h)}else d=null===i?new o(r.count*s):new o(i,c,r.count*s),f=new Hi(d,s,h);if(void 0!==r.sparse){const e=Zw.SCALAR,n=Xw[r.sparse.indices.componentType],a=r.sparse.indices.byteOffset||0,l=r.sparse.values.byteOffset||0,c=new n(t[1],a,r.sparse.count*e),u=new o(t[2],l,r.sparse.count*s);null!==i&&(f=new Hi(f.array.slice(),f.itemSize,f.normalized));for(let t=0,r=c.length;t<r;t++){const e=c[t];if(f.setX(e,u[t*s]),s>=2&&f.setY(e,u[t*s+1]),s>=3&&f.setZ(e,u[t*s+2]),s>=4&&f.setW(e,u[t*s+3]),s>=5)throw new Error("THREE.GLTFLoader: Unsupported itemSize in sparse BufferAttribute.")}}return f}))}loadTexture(t){const e=this.json,n=this.options,r=e.textures[t],i=r.source,s=e.images[i];let o=this.textureLoader;if(s.uri){const t=n.manager.getHandler(s.uri);null!==t&&(o=t)}return this.loadTextureImage(t,i,o)}loadTextureImage(t,e,n){const r=this,i=this.json,s=i.textures[t],o=i.images[e],a=(o.uri||o.bufferView)+":"+s.sampler;if(this.textureCache[a])return this.textureCache[a];const l=this.loadImageSource(e,n).then((function(e){e.flipY=!1,s.name&&(e.name=s.name);const n=i.samplers||{},o=n[s.sampler]||{};return e.magFilter=Jw[o.magFilter]||bt,e.minFilter=Jw[o.minFilter]||Mt,e.wrapS=Kw[o.wrapS]||dt,e.wrapT=Kw[o.wrapT]||dt,r.associations.set(e,{textures:t}),e})).catch((function(){return null}));return this.textureCache[a]=l,l}loadImageSource(t,e){const n=this,r=this.json,i=this.options;if(void 0!==this.sourceCache[t])return this.sourceCache[t].then((t=>t.clone()));const s=r.images[t],o=self.URL||self.webkitURL;let a=s.uri||"",l=!1;if(void 0!==s.bufferView)a=n.getDependency("bufferView",s.bufferView).then((function(t){l=!0;const e=new Blob([t],{type:s.mimeType});return a=o.createObjectURL(e),a}));else if(void 0===s.uri)throw new Error("THREE.GLTFLoader: Image "+t+" is missing URI and bufferView");const c=Promise.resolve(a).then((function(t){return new Promise((function(n,r){let s=n;!0===e.isImageBitmapLoader&&(s=function(t){const e=new pr(t);e.needsUpdate=!0,n(e)}),e.load(Sm.resolveURL(t,i.path),s,void 0,r)}))})).then((function(t){return!0===l&&o.revokeObjectURL(a),t.userData.mimeType=s.mimeType||u_(s.uri),t})).catch((function(t){throw console.error("THREE.GLTFLoader: Couldn't load texture",a),t}));return this.sourceCache[t]=c,c}assignTexture(t,e,n,r){const i=this;return this.getDependency("texture",n.index).then((function(s){if(void 0===n.texCoord||0==n.texCoord||"aoMap"===e&&1==n.texCoord||console.warn("THREE.GLTFLoader: Custom UV set "+n.texCoord+" for texture "+e+" not yet supported."),i.extensions[ww.KHR_TEXTURE_TRANSFORM]){const t=void 0!==n.extensions?n.extensions[ww.KHR_TEXTURE_TRANSFORM]:void 0;if(t){const e=i.associations.get(s);s=i.extensions[ww.KHR_TEXTURE_TRANSFORM].extendTexture(s,t),i.associations.set(s,e)}}return void 0!==r&&(s.encoding=r),t[e]=s,s}))}assignFinalMaterial(t){const e=t.geometry;let n=t.material;const r=void 0===e.attributes.tangent,i=void 0!==e.attributes.color,s=void 0===e.attributes.normal;if(t.isPoints){const t="PointsMaterial:"+n.uuid;let e=this.cache.get(t);e||(e=new Md,Fi.prototype.copy.call(e,n),e.color.copy(n.color),e.map=n.map,e.sizeAttenuation=!1,this.cache.add(t,e)),n=e}else if(t.isLine){const t="LineBasicMaterial:"+n.uuid;let e=this.cache.get(t);e||(e=new dd,Fi.prototype.copy.call(e,n),e.color.copy(n.color),this.cache.add(t,e)),n=e}if(r||i||s){let t="ClonedMaterial:"+n.uuid+":";n.isGLTFSpecularGlossinessMaterial&&(t+="specular-glossiness:"),r&&(t+="derivative-tangents:"),i&&(t+="vertex-colors:"),s&&(t+="flat-shading:");let e=this.cache.get(t);e||(e=n.clone(),i&&(e.vertexColors=!0),s&&(e.flatShading=!0),r&&(e.normalScale&&(e.normalScale.y*=-1),e.clearcoatNormalScale&&(e.clearcoatNormalScale.y*=-1)),this.cache.add(t,e),this.associations.set(e,this.associations.get(n))),n=e}n.aoMap&&void 0===e.attributes.uv2&&void 0!==e.attributes.uv&&e.setAttribute("uv2",e.attributes.uv),t.material=n}getMaterialType(){return _p}loadMaterial(t){const e=this,n=this.json,r=this.extensions,i=n.materials[t];let s;const o={},a=i.extensions||{},l=[];if(a[ww.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS]){const t=r[ww.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS];s=t.getMaterialType(),l.push(t.extendParams(o,i,e))}else if(a[ww.KHR_MATERIALS_UNLIT]){const t=r[ww.KHR_MATERIALS_UNLIT];s=t.getMaterialType(),l.push(t.extendParams(o,i,e))}else{const n=i.pbrMetallicRoughness||{};if(o.color=new lr(1,1,1),o.opacity=1,Array.isArray(n.baseColorFactor)){const t=n.baseColorFactor;o.color.fromArray(t),o.opacity=t[3]}void 0!==n.baseColorTexture&&l.push(e.assignTexture(o,"map",n.baseColorTexture,Oe)),o.metalness=void 0!==n.metallicFactor?n.metallicFactor:1,o.roughness=void 0!==n.roughnessFactor?n.roughnessFactor:1,void 0!==n.metallicRoughnessTexture&&(l.push(e.assignTexture(o,"metalnessMap",n.metallicRoughnessTexture)),l.push(e.assignTexture(o,"roughnessMap",n.metallicRoughnessTexture))),s=this._invokeOne((function(e){return e.getMaterialType&&e.getMaterialType(t)})),l.push(Promise.all(this._invokeAll((function(e){return e.extendMaterialParams&&e.extendMaterialParams(t,o)}))))}!0===i.doubleSided&&(o.side=y);const c=i.alphaMode||e_.OPAQUE;if(c===e_.BLEND?(o.transparent=!0,o.depthWrite=!1):(o.transparent=!1,c===e_.MASK&&(o.alphaTest=void 0!==i.alphaCutoff?i.alphaCutoff:.5)),void 0!==i.normalTexture&&s!==Ui&&(l.push(e.assignTexture(o,"normalMap",i.normalTexture)),o.normalScale=new qn(1,1),void 0!==i.normalTexture.scale)){const t=i.normalTexture.scale;o.normalScale.set(t,t)}return void 0!==i.occlusionTexture&&s!==Ui&&(l.push(e.assignTexture(o,"aoMap",i.occlusionTexture)),void 0!==i.occlusionTexture.strength&&(o.aoMapIntensity=i.occlusionTexture.strength)),void 0!==i.emissiveFactor&&s!==Ui&&(o.emissive=(new lr).fromArray(i.emissiveFactor)),void 0!==i.emissiveTexture&&s!==Ui&&l.push(e.assignTexture(o,"emissiveMap",i.emissiveTexture,Oe)),Promise.all(l).then((function(){let n;return n=s===Gw?r[ww.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS].createMaterial(o):new s(o),i.name&&(n.name=i.name),i_(n,i),e.associations.set(n,{materials:t}),i.extensions&&r_(r,n,i),n}))}createUniqueName(t){const e=pg.sanitizeNodeName(t||"");let n=e;for(let r=1;this.nodeNamesUsed[n];++r)n=e+"_"+r;return this.nodeNamesUsed[n]=!0,n}loadGeometries(t){const e=this,n=this.extensions,r=this.primitiveCache;function i(t){return n[ww.KHR_DRACO_MESH_COMPRESSION].decodePrimitive(t,e).then((function(n){return p_(n,t,e)}))}const s=[];for(let o=0,a=t.length;o<a;o++){const n=t[o],a=a_(n),l=r[a];if(l)s.push(l.promise);else{let t;t=n.extensions&&n.extensions[ww.KHR_DRACO_MESH_COMPRESSION]?i(n):p_(new os,n,e),r[a]={primitive:n,promise:t},s.push(t)}}return Promise.all(s)}loadMesh(t){const e=this,n=this.json,r=this.extensions,i=n.meshes[t],s=i.primitives,o=[];for(let a=0,l=s.length;a<l;a++){const t=void 0===s[a].material?n_(this.cache):this.getDependency("material",s[a].material);o.push(t)}return o.push(e.loadGeometries(s)),Promise.all(o).then((function(n){const o=n.slice(0,n.length-1),a=n[n.length-1],l=[];for(let u=0,h=a.length;u<h;u++){const n=a[u],c=s[u];let h;const d=o[u];if(c.mode===Yw.TRIANGLES||c.mode===Yw.TRIANGLE_STRIP||c.mode===Yw.TRIANGLE_FAN||void 0===c.mode)h=!0===i.isSkinnedMesh?new td(n,d):new As(n,d),!0!==h.isSkinnedMesh||h.geometry.attributes.skinWeight.normalized||h.normalizeSkinWeights(),c.mode===Yw.TRIANGLE_STRIP?h.geometry=m_(h.geometry,Le):c.mode===Yw.TRIANGLE_FAN&&(h.geometry=m_(h.geometry,Ne));else if(c.mode===Yw.LINES)h=new wd(n,d);else if(c.mode===Yw.LINE_STRIP)h=new yd(n,d);else if(c.mode===Yw.LINE_LOOP)h=new _d(n,d);else{if(c.mode!==Yw.POINTS)throw new Error("THREE.GLTFLoader: Primitive mode unsupported: "+c.mode);h=new Cd(n,d)}Object.keys(h.geometry.morphAttributes).length>0&&o_(h,i),h.name=e.createUniqueName(i.name||"mesh_"+t),i_(h,i),c.extensions&&r_(r,h,c),e.assignFinalMaterial(h),l.push(h)}for(let r=0,i=l.length;r<i;r++)e.associations.set(l[r],{meshes:t,primitives:r});if(1===l.length)return l[0];const c=new mh;e.associations.set(c,{meshes:t});for(let t=0,e=l.length;t<e;t++)c.add(l[t]);return c}))}loadCamera(t){let e;const n=this.json.cameras[t],r=n[n.type];if(r)return"perspective"===n.type?e=new Os(Wn.radToDeg(r.yfov),r.aspectRatio||1,r.znear||1,r.zfar||2e6):"orthographic"===n.type&&(e=new Dl(-r.xmag,r.xmag,r.ymag,-r.ymag,r.znear,r.zfar)),n.name&&(e.name=this.createUniqueName(n.name)),i_(e,n),Promise.resolve(e);console.warn("THREE.GLTFLoader: Missing camera parameters.")}loadSkin(t){const e=this.json.skins[t],n={joints:e.joints};return void 0===e.inverseBindMatrices?Promise.resolve(n):this.getDependency("accessor",e.inverseBindMatrices).then((function(t){return n.inverseBindMatrices=t,n}))}loadAnimation(t){const e=this.json,n=e.animations[t],r=[],i=[],s=[],o=[],a=[];for(let l=0,c=n.channels.length;l<c;l++){const t=n.channels[l],e=n.samplers[t.sampler],c=t.target,u=void 0!==c.node?c.node:c.id,h=void 0!==n.parameters?n.parameters[e.input]:e.input,d=void 0!==n.parameters?n.parameters[e.output]:e.output;r.push(this.getDependency("node",u)),i.push(this.getDependency("accessor",h)),s.push(this.getDependency("accessor",d)),o.push(e),a.push(c)}return Promise.all([Promise.all(r),Promise.all(i),Promise.all(s),Promise.all(o),Promise.all(a)]).then((function(e){const r=e[0],i=e[1],s=e[2],o=e[3],a=e[4],l=[];for(let t=0,n=r.length;t<n;t++){const e=r[t],n=i[t],c=s[t],u=o[t],h=a[t];if(void 0===e)continue;let d;switch(e.updateMatrix(),e.matrixAutoUpdate=!0,$w[h.path]){case $w.weights:d=Up;break;case $w.rotation:d=Gp;break;case $w.position:case $w.scale:default:d=Vp;break}const f=e.name?e.name:e.uuid,p=void 0!==u.interpolation?t_[u.interpolation]:Ae,m=[];$w[h.path]===$w.weights?e.traverse((function(t){t.morphTargetInfluences&&m.push(t.name?t.name:t.uuid)})):m.push(f);let g=c.array;if(c.normalized){const t=c_(g.constructor),e=new Float32Array(g.length);for(let n=0,r=g.length;n<r;n++)e[n]=g[n]*t;g=e}for(let t=0,r=m.length;t<r;t++){const e=new d(m[t]+"."+$w[h.path],n.array,g,p);"CUBICSPLINE"===u.interpolation&&(e.createInterpolant=function(t){const e=this instanceof Gp?qw:jw;return new e(this.times,this.values,this.getValueSize()/3,t)},e.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline=!0),l.push(e)}}const c=n.name?n.name:"animation_"+t;return new jp(c,void 0,l)}))}createNodeMesh(t){const e=this.json,n=this,r=e.nodes[t];return void 0===r.mesh?null:n.getDependency("mesh",r.mesh).then((function(t){const e=n._getNodeRef(n.meshCache,r.mesh,t);return void 0!==r.weights&&e.traverse((function(t){if(t.isMesh)for(let e=0,n=r.weights.length;e<n;e++)t.morphTargetInfluences[e]=r.weights[e]})),e}))}loadNode(t){const e=this.json,n=this.extensions,r=this,i=e.nodes[t],s=i.name?r.createUniqueName(i.name):"";return function(){const e=[],n=r._invokeOne((function(e){return e.createNodeMesh&&e.createNodeMesh(t)}));return n&&e.push(n),void 0!==i.camera&&e.push(r.getDependency("camera",i.camera).then((function(t){return r._getNodeRef(r.cameraCache,i.camera,t)}))),r._invokeAll((function(e){return e.createNodeAttachment&&e.createNodeAttachment(t)})).forEach((function(t){e.push(t)})),Promise.all(e)}().then((function(e){let o;if(o=!0===i.isBone?new ed:e.length>1?new mh:1===e.length?e[0]:new Si,o!==e[0])for(let t=0,n=e.length;t<n;t++)o.add(e[t]);if(i.name&&(o.userData.name=i.name,o.name=s),i_(o,i),i.extensions&&r_(n,o,i),void 0!==i.matrix){const t=new ti;t.fromArray(i.matrix),o.applyMatrix4(t)}else void 0!==i.translation&&o.position.fromArray(i.translation),void 0!==i.rotation&&o.quaternion.fromArray(i.rotation),void 0!==i.scale&&o.scale.fromArray(i.scale);return r.associations.has(o)||r.associations.set(o,{}),r.associations.get(o).nodes=t,o}))}loadScene(t){const e=this.json,n=this.extensions,r=this.json.scenes[t],i=this,s=new mh;r.name&&(s.name=i.createUniqueName(r.name)),i_(s,r),r.extensions&&r_(n,s,r);const o=r.nodes||[],a=[];for(let l=0,c=o.length;l<c;l++)a.push(d_(o[l],s,e,i));return Promise.all(a).then((function(){const t=t=>{const e=new Map;for(const[n,r]of i.associations)(n instanceof Fi||n instanceof pr)&&e.set(n,r);return t.traverse((t=>{const n=i.associations.get(t);null!=n&&e.set(t,n)})),e};return i.associations=t(s),s}))}}function d_(t,e,n,r){const i=n.nodes[t];return r.getDependency("node",t).then((function(t){if(void 0===i.skin)return t;let e;return r.getDependency("skin",i.skin).then((function(t){e=t;const n=[];for(let i=0,s=e.joints.length;i<s;i++)n.push(r.getDependency("node",e.joints[i]));return Promise.all(n)})).then((function(n){return t.traverse((function(t){if(!t.isMesh)return;const r=[],i=[];for(let s=0,o=n.length;s<o;s++){const t=n[s];if(t){r.push(t);const n=new ti;void 0!==e.inverseBindMatrices&&n.fromArray(e.inverseBindMatrices.array,16*s),i.push(n)}else console.warn('THREE.GLTFLoader: Joint "%s" could not be found.',e.joints[s])}t.bind(new sd(r,i),t.matrixWorld)})),t}))})).then((function(t){e.add(t);const s=[];if(i.children){const e=i.children;for(let i=0,o=e.length;i<o;i++){const o=e[i];s.push(d_(o,t,n,r))}}return Promise.all(s)}))}function f_(t,e,n){const r=e.attributes,i=new Er;if(void 0===r.POSITION)return;{const t=n.json.accessors[r.POSITION],e=t.min,s=t.max;if(void 0===e||void 0===s)return void console.warn("THREE.GLTFLoader: Missing min/max properties for accessor POSITION.");if(i.set(new Mr(e[0],e[1],e[2]),new Mr(s[0],s[1],s[2])),t.normalized){const e=c_(Xw[t.componentType]);i.min.multiplyScalar(e),i.max.multiplyScalar(e)}}const s=e.targets;if(void 0!==s){const t=new Mr,e=new Mr;for(let r=0,i=s.length;r<i;r++){const i=s[r];if(void 0!==i.POSITION){const r=n.json.accessors[i.POSITION],s=r.min,o=r.max;if(void 0!==s&&void 0!==o){if(e.setX(Math.max(Math.abs(s[0]),Math.abs(o[0]))),e.setY(Math.max(Math.abs(s[1]),Math.abs(o[1]))),e.setZ(Math.max(Math.abs(s[2]),Math.abs(o[2]))),r.normalized){const t=c_(Xw[r.componentType]);e.multiplyScalar(t)}t.max(e)}else console.warn("THREE.GLTFLoader: Missing min/max properties for accessor POSITION.")}}i.expandByVector(t)}t.boundingBox=i;const o=new Wr;i.getCenter(o.center),o.radius=i.min.distanceTo(i.max)/2,t.boundingSphere=o}function p_(t,e,n){const r=e.attributes,i=[];function s(e,r){return n.getDependency("accessor",e).then((function(e){t.setAttribute(r,e)}))}for(const o in r){const e=Qw[o]||o.toLowerCase();e in t.attributes||i.push(s(r[o],e))}if(void 0!==e.indices&&!t.index){const r=n.getDependency("accessor",e.indices).then((function(e){t.setIndex(e)}));i.push(r)}return i_(t,e),f_(t,e,n),Promise.all(i).then((function(){return void 0!==e.targets?s_(t,e.targets,n):t}))}function m_(t,e){let n=t.getIndex();if(null===n){const e=[],r=t.getAttribute("position");if(void 0===r)return console.error("THREE.GLTFLoader.toTrianglesDrawMode(): Undefined position attribute. Processing not possible."),t;for(let t=0;t<r.count;t++)e.push(t);t.setIndex(e),n=t.getIndex()}const r=n.count-2,i=[];if(e===Ne)for(let o=1;o<=r;o++)i.push(n.getX(0)),i.push(n.getX(o)),i.push(n.getX(o+1));else for(let o=0;o<r;o++)o%2===0?(i.push(n.getX(o)),i.push(n.getX(o+1)),i.push(n.getX(o+2))):(i.push(n.getX(o+2)),i.push(n.getX(o+1)),i.push(n.getX(o)));i.length/3!==r&&console.error("THREE.GLTFLoader.toTrianglesDrawMode(): Unable to generate correct amount of triangles.");const s=t.clone();return s.setIndex(i),s}const g_=(0,r.aZ)({name:"model-gltf",mixins:[sy],props:{lights:{type:Array,default:()=>[{type:"AmbientLight",color:11184810},{type:"DirectionalLight",position:{x:1,y:1,z:1},color:16777215,intensity:.8}]},gammaOutput:{type:Boolean,default:!0}},data(){const t=new xw;return t.setCrossOrigin(this.crossOrigin),t.setRequestHeader(this.requestHeader),{loader:t}},methods:{load(){this.src&&(this.object&&this.wrapper.remove(this.object),this.reportProgress("start"),this.loader.load(this.src,(t=>{this.reportProgress("end"),this.addObject(t.scene),this.$emit("load")}),(t=>{this.reportProgress("progress",t),this.$emit("progress",t)}),(t=>{this.reportProgress("end"),this.$emit("error",t)})))}}});(0,r.aZ)({name:"model-json",extends:dw}),(0,r.aZ)({name:"model-dae",extends:yw}),Symbol("VUE_3D_MODEL_INSTALLED")},89:function(t,e){"use strict";e.Z=(t,e)=>{const n=t.__vccOpts||t;for(const[r,i]of e)n[r]=i;return n}}}]);
//# sourceMappingURL=chunk-vendors.1e08fe53.js.map